{
  "name": "{{WORKFLOW_NAME}}",
  "nodes": [
    {
      "parameters": {
        "rule": { "interval": [{ "field": "hours", "hoursInterval": 1 }] }
      },
      "id": "schedule",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [240, 300]
    },
    {
      "parameters": {
        "url": "https://api.github.com/repos/{{OWNER}}/{{REPO}}",
        "options": {
          "response": { "response": { "fullResponse": true } }
        }
      },
      "id": "github-api",
      "name": "GitHub API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [460, 300]
    },
    {
      "parameters": {
        "jsCode": "// è·å–å½“å‰ star æ•°é‡\nconst currentStars = $input.first().json.body.stargazers_count;\nconst repo = $input.first().json.body.full_name;\n\n// è·å–ä¹‹å‰çš„è®°å½•ï¼ˆä½¿ç”¨é™æ€æ•°æ®å­˜å‚¨ï¼‰\nconst staticData = $getWorkflowStaticData('global');\nconst previousStars = staticData.previousStars || 0;\n\n// è®¡ç®—æ–°å¢\nconst newStars = currentStars - previousStars;\n\n// æ›´æ–°è®°å½•\nstaticData.previousStars = currentStars;\n\nreturn {\n  repo,\n  currentStars,\n  previousStars,\n  newStars,\n  hasNewStars: newStars > 0\n};"
      },
      "id": "process-data",
      "name": "å¤„ç†æ•°æ®",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.hasNewStars }}",
              "value2": true
            }
          ]
        }
      },
      "id": "check-new-stars",
      "name": "æ£€æŸ¥æ–°å¢",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [900, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{$env.FEISHU_BOT_WEBHOOK}}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"msg_type\":\"text\",\"content\":{\"text\":\"ğŸŒŸ GitHub Star é€šçŸ¥\\n\\nä»“åº“: \" + $json.repo + \"\\nå½“å‰ Stars: \" + $json.currentStars + \"\\næ–°å¢: +\" + $json.newStars}}"
      },
      "id": "notify",
      "name": "é£ä¹¦é€šçŸ¥",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1120, 300]
    },
    {
      "parameters": {},
      "id": "error-trigger",
      "name": "Error Trigger",
      "type": "n8n-nodes-base.errorTrigger",
      "typeVersion": 1,
      "position": [240, 500]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{$env.FEISHU_BOT_WEBHOOK}}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"msg_type\":\"text\",\"content\":{\"text\":\"âŒ GitHub API é”™è¯¯: \" + $json.error.message}}"
      },
      "id": "error-notify",
      "name": "é”™è¯¯é€šçŸ¥",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [460, 500]
    }
  ],
  "connections": {
    "Schedule Trigger": { "main": [[{ "node": "GitHub API", "type": "main", "index": 0 }]] },
    "GitHub API": { "main": [[{ "node": "å¤„ç†æ•°æ®", "type": "main", "index": 0 }]] },
    "å¤„ç†æ•°æ®": { "main": [[{ "node": "æ£€æŸ¥æ–°å¢", "type": "main", "index": 0 }]] },
    "æ£€æŸ¥æ–°å¢": { "main": [[{ "node": "é£ä¹¦é€šçŸ¥", "type": "main", "index": 0 }], []] },
    "Error Trigger": { "main": [[{ "node": "é”™è¯¯é€šçŸ¥", "type": "main", "index": 0 }]] }
  },
  "settings": { "executionOrder": "v1" }
}

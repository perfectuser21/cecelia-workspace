FROM node:20-alpine
RUN apk add --no-cache git && \
    git config --global --add safe.directory '*'
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY dist/ ./dist/
ENV PORT=5211
EXPOSE 5211
CMD ["node", "dist/dashboard/server.js"]

# PRD - Advance KR1: Intent Recognition API

## 需求来源
Brain 自动调度任务，推进 KR1 关键成果。

## 功能描述
实现自然语言到 OKR/Project/Task 的意图识别功能，支持 Cecelia 理解用户输入并自动创建相应的任务实体。

### 核心能力
1. **意图分类**：识别用户输入属于 Goal、Project 还是 Task
2. **实体提取**：从自然语言中提取标题、描述、优先级等字段
3. **关联推理**：推断新任务应该关联到哪个现有 Goal/Project
4. **置信度评估**：为识别结果提供置信度评分

### API 设计
```typescript
POST /api/intent/recognize
{
  "input": "我要做一个用户登录功能",
  "context": {
    "current_project": "cecelia-workspace",
    "recent_goals": ["Task Intelligence"]
  }
}

Response:
{
  "intent_type": "task",
  "entity": {
    "title": "实现用户登录功能",
    "description": "添加基础的用户认证和会话管理",
    "priority": "P1",
    "suggested_project": "cecelia-workspace",
    "suggested_goal": "Task Intelligence"
  },
  "confidence": 0.92,
  "alternatives": [...]
}
```

## 涉及文件
- `apps/core/src/api/routes/intent.ts` - 新增意图识别路由
- `apps/core/src/services/intent-recognizer.ts` - 核心识别逻辑
- `apps/core/src/types/intent.ts` - 类型定义
- `tests/intent/recognizer.test.ts` - 单元测试

## 成功标准
- [ ] API 端点实现并可正确识别 Goal/Project/Task 意图
- [ ] 实体提取准确率 > 85%（基于测试用例）
- [ ] 单元测试覆盖主要场景（至少 10 个测试用例）
- [ ] 文档更新：API 使用说明

## 非目标
- 不实现 LLM 调用（使用规则引擎即可）
- 不实现批量识别
- 不集成到前端（仅后端 API）

## 技术方案
使用基于规则的 NLP 方法：
1. 关键词匹配识别意图类型
2. 正则表达式提取实体
3. 基于 PARA 层级的关联推理

## 验收清单
- API 响应格式符合规范
- 测试用例全部通过
- 错误处理完善（无效输入、空输入等）
- 日志记录完整

---
id: dod-kr1-intent-recognition
version: 1.0.0
created: 2026-02-01
updated: 2026-02-01
changelog:
  - 1.0.0: 初始版本
---

# DoD - KR1: 意图识别 - 自然语言→OKR/Project/Task

QA: docs/QA-DECISION.md

## 验收标准

### 1. 意图分类功能
- [ ] 实现至少 5 种基本意图识别：create_goal, create_task, query_goal, update_task, query_status
      Test: apps/core/src/brain/__tests__/intent.test.js + contract:intent_recognition_basic
- [ ] 单元测试准确率 >= 85%（20 个测试用例，覆盖 5 种意图）
      Test: apps/core/src/brain/__tests__/intent-integration.test.js (accuracy test)
- [ ] API 调用返回正确意图：`curl -X POST /api/brain/intent -d '{"text":"创建一个高优先级目标：完成用户系统"}' | jq .intent` 返回 "create_goal"
      Test: apps/core/src/brain/__tests__/intent-api.test.js + contract:intent_api_contract

### 2. 实体提取功能
- [ ] 能从自然语言中提取 title、priority、deadline、status 等关键字段
      Test: apps/core/src/brain/__tests__/intent.test.js + contract:entity_extraction_core
- [ ] 测试用例验证：给定 "本月完成 P0 的认证重构"，能提取 { title: "认证重构", priority: "P0", deadline: "2026-02-28" }
      Test: apps/core/src/brain/__tests__/intent-api.test.js (entity extraction tests)
- [ ] 优先级识别：支持 "重要/紧急" → P0, "普通" → P1, "不急" → P2 的映射
      Test: apps/core/src/brain/__tests__/intent-api.test.js (priority mapping tests)

### 3. 上下文管理
- [ ] 实现简单的上下文存储：保存最近提到的 goal/task ID
      Test: apps/core/src/brain/__tests__/context-manager.test.js + contract:context_management_basic
- [ ] 代词解析：用户说 "那个目标" 时，能从上下文找到最近提到的 goal_id
      Test: apps/core/src/brain/__tests__/context-manager.test.js
- [ ] 测试：连续两次调用 API，第二次输入 "给它加个任务" 能正确关联第一次创建的 goal
      Test: apps/core/src/brain/__tests__/intent-integration.test.js

### 4. API 集成
- [ ] POST /api/brain/intent 端点实现并通过手动测试
      Test: apps/core/src/brain/__tests__/intent-api.test.js
- [ ] 返回格式包含 intent、entities、confidence 字段
      Test: apps/core/src/brain/__tests__/intent-api.test.js
- [ ] 错误处理：无法识别时返回 { intent: "unknown", confidence: 0, suggestions: [...] }
      Test: apps/core/src/brain/__tests__/intent-api.test.js

### 5. 文档和测试
- [ ] 添加 `docs/KR1-INTENT-RECOGNITION.md` 说明设计和使用方法
      Test: manual:验证文档存在且内容完整（包含设计说明、API 使用示例、测试方法）
- [ ] 单元测试覆盖率 >= 80%（运行 `npm test -- apps/core/src/brain/__tests__/intent-recognizer.test.js`）
      Test: npm test -- apps/core/src/brain/__tests__/intent-recognizer.test.js --coverage
- [ ] 在 Brain status 中更新 KR1 progress 到 >= 50%
      Test: manual:调用 GET /api/brain/status 验证 KR1 进度更新

### 测试验收
- [ ] npm run qa 通过
      Test: npm run qa

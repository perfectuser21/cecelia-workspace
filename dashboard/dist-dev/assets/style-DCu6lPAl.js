import{r as v,aY as us,ae as N}from"./index-CFNaiXDE.js";import{d as ds,i as ve,T as Nt,s as ke,p as Ee,a as Mt,b as fs,y as hs,c as gs}from"./transform-CHVD-xw7.js";var ms=1e-12;function nn(e){return((e=Math.exp(e))+1/e)/2}function ps(e){return((e=Math.exp(e))-1/e)/2}function ys(e){return((e=Math.exp(2*e))-1)/(e+1)}const xs=function e(t,n,o){function s(i,r){var c=i[0],u=i[1],d=i[2],l=r[0],f=r[1],m=r[2],g=l-c,E=f-u,p=g*g+E*E,w,h;if(p<ms)h=Math.log(m/d)/t,w=function(V){return[c+V*g,u+V*E,d*Math.exp(t*V*h)]};else{var S=Math.sqrt(p),M=(m*m-d*d+o*p)/(2*d*n*S),I=(m*m-d*d-o*p)/(2*m*n*S),k=Math.log(Math.sqrt(M*M+1)-M),R=Math.log(Math.sqrt(I*I+1)-I);h=(R-k)/t,w=function(V){var B=V*h,$=nn(k),H=d/(n*S)*($*ys(t*B+k)-ps(k));return[c+H*g,u+H*E,d*$/nn(t*B+k)]}}return w.duration=h*1e3*t/Math.SQRT2,w}return s.rho=function(i){var r=Math.max(.001,+i),c=r*r,u=c*c;return e(r,c,u)},s}(Math.SQRT2,2,4);var zn={exports:{}},Tn={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ge=v;function ws(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Es=typeof Object.is=="function"?Object.is:ws,Ss=Ge.useState,bs=Ge.useEffect,vs=Ge.useLayoutEffect,Ns=Ge.useDebugValue;function Ms(e,t){var n=t(),o=Ss({inst:{value:n,getSnapshot:t}}),s=o[0].inst,i=o[1];return vs(function(){s.value=n,s.getSnapshot=t,_t(s)&&i({inst:s})},[e,n,t]),bs(function(){return _t(s)&&i({inst:s}),e(function(){_t(s)&&i({inst:s})})},[e]),Ns(n),n}function _t(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Es(e,n)}catch{return!0}}function _s(e,t){return t()}var As=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_s:Ms;Tn.useSyncExternalStore=Ge.useSyncExternalStore!==void 0?Ge.useSyncExternalStore:As;zn.exports=Tn;var $s=zn.exports;const lt=e=>()=>e;function Cs(e,{sourceEvent:t,target:n,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function At(e){e.stopImmediatePropagation()}function et(e){e.preventDefault(),e.stopImmediatePropagation()}function zs(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ts(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function on(){return this.__zoom||ve}function Is(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ks(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ds(e,t,n){var o=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],r=e.invertY(t[1][1])-n[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r))}function Rs(){var e=zs,t=Ts,n=Ds,o=Is,s=ks,i=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],c=250,u=xs,d=ds("start","zoom","end"),l,f,m,g=500,E=150,p=0,w=10;function h(a){a.property("__zoom",on).on("wheel.zoom",B,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",H).filter(s).on("touchstart.zoom",P).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(a,b,x,_){var z=a.selection?a.selection():a;z.property("__zoom",on),a!==z?k(a,b,x,_):z.interrupt().each(function(){R(this,arguments).event(_).start().zoom(null,typeof b=="function"?b.apply(this,arguments):b).end()})},h.scaleBy=function(a,b,x,_){h.scaleTo(a,function(){var z=this.__zoom.k,y=typeof b=="function"?b.apply(this,arguments):b;return z*y},x,_)},h.scaleTo=function(a,b,x,_){h.transform(a,function(){var z=t.apply(this,arguments),y=this.__zoom,A=x==null?I(z):typeof x=="function"?x.apply(this,arguments):x,C=y.invert(A),T=typeof b=="function"?b.apply(this,arguments):b;return n(M(S(y,T),A,C),z,r)},x,_)},h.translateBy=function(a,b,x,_){h.transform(a,function(){return n(this.__zoom.translate(typeof b=="function"?b.apply(this,arguments):b,typeof x=="function"?x.apply(this,arguments):x),t.apply(this,arguments),r)},null,_)},h.translateTo=function(a,b,x,_,z){h.transform(a,function(){var y=t.apply(this,arguments),A=this.__zoom,C=_==null?I(y):typeof _=="function"?_.apply(this,arguments):_;return n(ve.translate(C[0],C[1]).scale(A.k).translate(typeof b=="function"?-b.apply(this,arguments):-b,typeof x=="function"?-x.apply(this,arguments):-x),y,r)},_,z)};function S(a,b){return b=Math.max(i[0],Math.min(i[1],b)),b===a.k?a:new Nt(b,a.x,a.y)}function M(a,b,x){var _=b[0]-x[0]*a.k,z=b[1]-x[1]*a.k;return _===a.x&&z===a.y?a:new Nt(a.k,_,z)}function I(a){return[(+a[0][0]+ +a[1][0])/2,(+a[0][1]+ +a[1][1])/2]}function k(a,b,x,_){a.on("start.zoom",function(){R(this,arguments).event(_).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event(_).end()}).tween("zoom",function(){var z=this,y=arguments,A=R(z,y).event(_),C=t.apply(z,y),T=x==null?I(C):typeof x=="function"?x.apply(z,y):x,O=Math.max(C[1][0]-C[0][0],C[1][1]-C[0][1]),F=z.__zoom,W=typeof b=="function"?b.apply(z,y):b,Z=u(F.invert(T).concat(O/F.k),W.invert(T).concat(O/W.k));return function(G){if(G===1)G=W;else{var K=Z(G),J=O/K[2];G=new Nt(J,T[0]-K[0]*J,T[1]-K[1]*J)}A.zoom(null,G)}})}function R(a,b,x){return!x&&a.__zooming||new V(a,b)}function V(a,b){this.that=a,this.args=b,this.active=0,this.sourceEvent=null,this.extent=t.apply(a,b),this.taps=0}V.prototype={event:function(a){return a&&(this.sourceEvent=a),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(a,b){return this.mouse&&a!=="mouse"&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&a!=="touch"&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&a!=="touch"&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(a){var b=ke(this.that).datum();d.call(a,this.that,new Cs(a,{sourceEvent:this.sourceEvent,target:h,transform:this.that.__zoom,dispatch:d}),b)}};function B(a,...b){if(!e.apply(this,arguments))return;var x=R(this,b).event(a),_=this.__zoom,z=Math.max(i[0],Math.min(i[1],_.k*Math.pow(2,o.apply(this,arguments)))),y=Ee(a);if(x.wheel)(x.mouse[0][0]!==y[0]||x.mouse[0][1]!==y[1])&&(x.mouse[1]=_.invert(x.mouse[0]=y)),clearTimeout(x.wheel);else{if(_.k===z)return;x.mouse=[y,_.invert(y)],Mt(this),x.start()}et(a),x.wheel=setTimeout(A,E),x.zoom("mouse",n(M(S(_,z),x.mouse[0],x.mouse[1]),x.extent,r));function A(){x.wheel=null,x.end()}}function $(a,...b){if(m||!e.apply(this,arguments))return;var x=a.currentTarget,_=R(this,b,!0).event(a),z=ke(a.view).on("mousemove.zoom",T,!0).on("mouseup.zoom",O,!0),y=Ee(a,x),A=a.clientX,C=a.clientY;fs(a.view),At(a),_.mouse=[y,this.__zoom.invert(y)],Mt(this),_.start();function T(F){if(et(F),!_.moved){var W=F.clientX-A,Z=F.clientY-C;_.moved=W*W+Z*Z>p}_.event(F).zoom("mouse",n(M(_.that.__zoom,_.mouse[0]=Ee(F,x),_.mouse[1]),_.extent,r))}function O(F){z.on("mousemove.zoom mouseup.zoom",null),hs(F.view,_.moved),et(F),_.event(F).end()}}function H(a,...b){if(e.apply(this,arguments)){var x=this.__zoom,_=Ee(a.changedTouches?a.changedTouches[0]:a,this),z=x.invert(_),y=x.k*(a.shiftKey?.5:2),A=n(M(S(x,y),_,z),t.apply(this,b),r);et(a),c>0?ke(this).transition().duration(c).call(k,A,_,a):ke(this).call(h.transform,A,_,a)}}function P(a,...b){if(e.apply(this,arguments)){var x=a.touches,_=x.length,z=R(this,b,a.changedTouches.length===_).event(a),y,A,C,T;for(At(a),A=0;A<_;++A)C=x[A],T=Ee(C,this),T=[T,this.__zoom.invert(T),C.identifier],z.touch0?!z.touch1&&z.touch0[2]!==T[2]&&(z.touch1=T,z.taps=0):(z.touch0=T,y=!0,z.taps=1+!!l);l&&(l=clearTimeout(l)),y&&(z.taps<2&&(f=T[0],l=setTimeout(function(){l=null},g)),Mt(this),z.start())}}function L(a,...b){if(this.__zooming){var x=R(this,b).event(a),_=a.changedTouches,z=_.length,y,A,C,T;for(et(a),y=0;y<z;++y)A=_[y],C=Ee(A,this),x.touch0&&x.touch0[2]===A.identifier?x.touch0[0]=C:x.touch1&&x.touch1[2]===A.identifier&&(x.touch1[0]=C);if(A=x.that.__zoom,x.touch1){var O=x.touch0[0],F=x.touch0[1],W=x.touch1[0],Z=x.touch1[1],G=(G=W[0]-O[0])*G+(G=W[1]-O[1])*G,K=(K=Z[0]-F[0])*K+(K=Z[1]-F[1])*K;A=S(A,Math.sqrt(G/K)),C=[(O[0]+W[0])/2,(O[1]+W[1])/2],T=[(F[0]+Z[0])/2,(F[1]+Z[1])/2]}else if(x.touch0)C=x.touch0[0],T=x.touch0[1];else return;x.zoom("touch",n(M(A,C,T),x.extent,r))}}function D(a,...b){if(this.__zooming){var x=R(this,b).event(a),_=a.changedTouches,z=_.length,y,A;for(At(a),m&&clearTimeout(m),m=setTimeout(function(){m=null},g),y=0;y<z;++y)A=_[y],x.touch0&&x.touch0[2]===A.identifier?delete x.touch0:x.touch1&&x.touch1[2]===A.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(A=Ee(A,this),Math.hypot(f[0]-A[0],f[1]-A[1])<w)){var C=ke(this).on("dblclick.zoom");C&&C.apply(this,arguments)}}}return h.wheelDelta=function(a){return arguments.length?(o=typeof a=="function"?a:lt(+a),h):o},h.filter=function(a){return arguments.length?(e=typeof a=="function"?a:lt(!!a),h):e},h.touchable=function(a){return arguments.length?(s=typeof a=="function"?a:lt(!!a),h):s},h.extent=function(a){return arguments.length?(t=typeof a=="function"?a:lt([[+a[0][0],+a[0][1]],[+a[1][0],+a[1][1]]]),h):t},h.scaleExtent=function(a){return arguments.length?(i[0]=+a[0],i[1]=+a[1],h):[i[0],i[1]]},h.translateExtent=function(a){return arguments.length?(r[0][0]=+a[0][0],r[1][0]=+a[1][0],r[0][1]=+a[0][1],r[1][1]=+a[1][1],h):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},h.constrain=function(a){return arguments.length?(n=a,h):n},h.duration=function(a){return arguments.length?(c=+a,h):c},h.interpolate=function(a){return arguments.length?(u=a,h):u},h.on=function(){var a=d.on.apply(d,arguments);return a===d?h:a},h.clickDistance=function(a){return arguments.length?(p=(a=+a)*a,h):Math.sqrt(p)},h.tapDistance=function(a){return arguments.length?(w=+a,h):w},h}function re(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=re(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var In={exports:{}},kn={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xt=v,Ps=$s;function Hs(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vs=typeof Object.is=="function"?Object.is:Hs,Bs=Ps.useSyncExternalStore,Ls=xt.useRef,Fs=xt.useEffect,Os=xt.useMemo,Ys=xt.useDebugValue;kn.useSyncExternalStoreWithSelector=function(e,t,n,o,s){var i=Ls(null);if(i.current===null){var r={hasValue:!1,value:null};i.current=r}else r=i.current;i=Os(function(){function u(g){if(!d){if(d=!0,l=g,g=o(g),s!==void 0&&r.hasValue){var E=r.value;if(s(E,g))return f=E}return f=g}if(E=f,Vs(l,g))return E;var p=o(g);return s!==void 0&&s(E,p)?(l=g,E):(l=g,f=p)}var d=!1,l,f,m=n===void 0?null:n;return[function(){return u(t())},m===null?void 0:function(){return u(m())}]},[t,n,o,s]);var c=Bs(e,i[0],i[1]);return Fs(function(){r.hasValue=!0,r.value=c},[c]),Ys(c),c};In.exports=kn;var Us=In.exports;const Ws=us(Us),Xs={},sn=e=>{let t;const n=new Set,o=(l,f)=>{const m=typeof l=="function"?l(t):l;if(!Object.is(m,t)){const g=t;t=f??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(E=>E(t,g))}},s=()=>t,u={setState:o,getState:s,getInitialState:()=>d,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{(Xs?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(o,s,u);return u},Zs=e=>e?sn(e):sn,{useDebugValue:Gs}=N,{useSyncExternalStoreWithSelector:Ks}=Ws,js=e=>e;function Dn(e,t=js,n){const o=Ks(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Gs(o),o}const rn=(e,t)=>{const n=Zs(e),o=(s,i=t)=>Dn(n,s,i);return Object.assign(o,n),o},qs=(e,t)=>e?rn(e,t):rn;function se(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const wt=v.createContext(null),Qs=wt.Provider,xe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Rn=xe.error001();function Q(e,t){const n=v.useContext(wt);if(n===null)throw new Error(Rn);return Dn(n,e,t)}const ne=()=>{const e=v.useContext(wt);if(e===null)throw new Error(Rn);return v.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Js=e=>e.userSelectionActive?"none":"all";function Pn({position:e,children:t,className:n,style:o,...s}){const i=Q(Js),r=`${e}`.split("-");return N.createElement("div",{className:re(["react-flow__panel",n,...r]),style:{...o,pointerEvents:i},...s},t)}function er({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:N.createElement(Pn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},N.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const tr=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:r=[2,4],labelBgBorderRadius:c=2,children:u,className:d,...l})=>{const f=v.useRef(null),[m,g]=v.useState({x:0,y:0,width:0,height:0}),E=re(["react-flow__edge-textwrapper",d]);return v.useEffect(()=>{if(f.current){const p=f.current.getBBox();g({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),typeof n>"u"||!n?null:N.createElement("g",{transform:`translate(${e-m.width/2} ${t-m.height/2})`,className:E,visibility:m.width?"visible":"hidden",...l},s&&N.createElement("rect",{width:m.width+2*r[0],x:-r[0],y:-r[1],height:m.height+2*r[1],className:"react-flow__edge-textbg",style:i,rx:c,ry:c}),N.createElement("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:f,style:o},n),u)};var nr=v.memo(tr);const Ft=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ke=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Ot=(e={x:0,y:0},t)=>({x:Ke(e.x,t[0][0],t[1][0]),y:Ke(e.y,t[0][1],t[1][1])}),cn=(e,t,n)=>e<t?Ke(Math.abs(e-t),1,50)/50:e>n?-Ke(Math.abs(e-n),1,50)/50:0,Hn=(e,t)=>{const n=cn(e.x,35,t.width-35)*20,o=cn(e.y,35,t.height-35)*20;return[n,o]},Vn=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Bn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),rt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),Ln=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),an=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Qi=(e,t)=>Ln(Bn(rt(e),rt(t))),kt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},or=e=>le(e.width)&&le(e.height)&&le(e.x)&&le(e.y),le=e=>!isNaN(e)&&isFinite(e),ee=Symbol.for("internals"),Fn=["Enter"," ","Escape"],sr=(e,t)=>{},rr=e=>"nativeEvent"in e;function Dt(e){var s,i;const t=rr(e)?e.nativeEvent:e,n=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const On=e=>"clientX"in e,Ne=(e,t)=>{var i,r;const n=On(e),o=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=n?e.clientY:(r=e.touches)==null?void 0:r[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},gt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},at=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:l,markerEnd:f,markerStart:m,interactionWidth:g=20})=>N.createElement(N.Fragment,null,N.createElement("path",{id:e,style:l,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:m}),g&&N.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),s&&le(n)&&le(o)?N.createElement(nr,{x:n,y:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d}):null);at.displayName="BaseEdge";function tt(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(i=>i.id===e);s&&n(o,{...s})}}function Yn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,c=o<t?o+r:o-r;return[i,c,s,r]}function Un({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:c}){const u=e*.125+s*.375+r*.375+n*.125,d=t*.125+i*.375+c*.375+o*.125,l=Math.abs(u-e),f=Math.abs(d-t);return[u,d,l,f]}var Re;(function(e){e.Strict="strict",e.Loose="loose"})(Re||(Re={}));var De;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(De||(De={}));var it;(function(e){e.Partial="partial",e.Full="full"})(it||(it={}));var be;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(be||(be={}));var mt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(mt||(mt={}));var Y;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Y||(Y={}));function ln({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===Y.Left||e===Y.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Wn({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:i=Y.Top}){const[r,c]=ln({pos:n,x1:e,y1:t,x2:o,y2:s}),[u,d]=ln({pos:i,x1:o,y1:s,x2:e,y2:t}),[l,f,m,g]=Un({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:r,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${r},${c} ${u},${d} ${o},${s}`,l,f,m,g]}const Yt=v.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=Y.Bottom,targetPosition:i=Y.Top,label:r,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:l,labelBgBorderRadius:f,style:m,markerEnd:g,markerStart:E,interactionWidth:p})=>{const[w,h,S]=Wn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i});return N.createElement(at,{path:w,labelX:h,labelY:S,label:r,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:l,labelBgBorderRadius:f,style:m,markerEnd:g,markerStart:E,interactionWidth:p})});Yt.displayName="SimpleBezierEdge";const un={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},ir=({source:e,sourcePosition:t=Y.Bottom,target:n})=>t===Y.Left||t===Y.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},dn=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function cr({source:e,sourcePosition:t=Y.Bottom,target:n,targetPosition:o=Y.Top,center:s,offset:i}){const r=un[t],c=un[o],u={x:e.x+r.x*i,y:e.y+r.y*i},d={x:n.x+c.x*i,y:n.y+c.y*i},l=ir({source:u,sourcePosition:t,target:d}),f=l.x!==0?"x":"y",m=l[f];let g=[],E,p;const w={x:0,y:0},h={x:0,y:0},[S,M,I,k]=Yn({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[f]*c[f]===-1){E=s.x??S,p=s.y??M;const V=[{x:E,y:u.y},{x:E,y:d.y}],B=[{x:u.x,y:p},{x:d.x,y:p}];r[f]===m?g=f==="x"?V:B:g=f==="x"?B:V}else{const V=[{x:u.x,y:d.y}],B=[{x:d.x,y:u.y}];if(f==="x"?g=r.x===m?B:V:g=r.y===m?V:B,t===o){const D=Math.abs(e[f]-n[f]);if(D<=i){const a=Math.min(i-1,i-D);r[f]===m?w[f]=(u[f]>e[f]?-1:1)*a:h[f]=(d[f]>n[f]?-1:1)*a}}if(t!==o){const D=f==="x"?"y":"x",a=r[f]===c[D],b=u[D]>d[D],x=u[D]<d[D];(r[f]===1&&(!a&&b||a&&x)||r[f]!==1&&(!a&&x||a&&b))&&(g=f==="x"?V:B)}const $={x:u.x+w.x,y:u.y+w.y},H={x:d.x+h.x,y:d.y+h.y},P=Math.max(Math.abs($.x-g[0].x),Math.abs(H.x-g[0].x)),L=Math.max(Math.abs($.y-g[0].y),Math.abs(H.y-g[0].y));P>=L?(E=($.x+H.x)/2,p=g[0].y):(E=g[0].x,p=($.y+H.y)/2)}return[[e,{x:u.x+w.x,y:u.y+w.y},...g,{x:d.x+h.x,y:d.y+h.y},n],E,p,I,k]}function ar(e,t,n,o){const s=Math.min(dn(e,t)/2,dn(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const d=e.x<n.x?-1:1,l=e.y<n.y?1:-1;return`L ${i+s*d},${r}Q ${i},${r} ${i},${r+s*l}`}const c=e.x<n.x?1:-1,u=e.y<n.y?-1:1;return`L ${i},${r+s*u}Q ${i},${r} ${i+s*c},${r}`}function Rt({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:i=Y.Top,borderRadius:r=5,centerX:c,centerY:u,offset:d=20}){const[l,f,m,g,E]=cr({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:i,center:{x:c,y:u},offset:d});return[l.reduce((w,h,S)=>{let M="";return S>0&&S<l.length-1?M=ar(l[S-1],h,l[S+1],r):M=`${S===0?"M":"L"}${h.x} ${h.y}`,w+=M,w},""),f,m,g,E]}const Et=v.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:l,sourcePosition:f=Y.Bottom,targetPosition:m=Y.Top,markerEnd:g,markerStart:E,pathOptions:p,interactionWidth:w})=>{const[h,S,M]=Rt({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:o,targetPosition:m,borderRadius:p==null?void 0:p.borderRadius,offset:p==null?void 0:p.offset});return N.createElement(at,{path:h,labelX:S,labelY:M,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:l,markerEnd:g,markerStart:E,interactionWidth:w})});Et.displayName="SmoothStepEdge";const Ut=v.memo(e=>{var t;return N.createElement(Et,{...e,pathOptions:v.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Ut.displayName="StepEdge";function lr({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,i,r,c]=Yn({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,i,r,c]}const Wt=v.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:l,markerEnd:f,markerStart:m,interactionWidth:g})=>{const[E,p,w]=lr({sourceX:e,sourceY:t,targetX:n,targetY:o});return N.createElement(at,{path:E,labelX:p,labelY:w,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:l,markerEnd:f,markerStart:m,interactionWidth:g})});Wt.displayName="StraightEdge";function ut(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function fn({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){switch(e){case Y.Left:return[t-ut(t-o,i),n];case Y.Right:return[t+ut(o-t,i),n];case Y.Top:return[t,n-ut(n-s,i)];case Y.Bottom:return[t,n+ut(s-n,i)]}}function Xn({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:i=Y.Top,curvature:r=.25}){const[c,u]=fn({pos:n,x1:e,y1:t,x2:o,y2:s,c:r}),[d,l]=fn({pos:i,x1:o,y1:s,x2:e,y2:t,c:r}),[f,m,g,E]=Un({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:u,targetControlX:d,targetControlY:l});return[`M${e},${t} C${c},${u} ${d},${l} ${o},${s}`,f,m,g,E]}const pt=v.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=Y.Bottom,targetPosition:i=Y.Top,label:r,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:l,labelBgBorderRadius:f,style:m,markerEnd:g,markerStart:E,pathOptions:p,interactionWidth:w})=>{const[h,S,M]=Xn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i,curvature:p==null?void 0:p.curvature});return N.createElement(at,{path:h,labelX:S,labelY:M,label:r,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:l,labelBgBorderRadius:f,style:m,markerEnd:g,markerStart:E,interactionWidth:w})});pt.displayName="BezierEdge";const Xt=v.createContext(null),ur=Xt.Provider;Xt.Consumer;const dr=()=>v.useContext(Xt),fr=e=>"id"in e&&"source"in e&&"target"in e,hr=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,Pt=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,gr=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),mr=(e,t)=>{if(!e.source||!e.target)return t;let n;return fr(e)?n={...e}:n={...e,id:hr(e)},gr(n,t)?t:t.concat(n)},Ht=({x:e,y:t},[n,o,s],i,[r,c])=>{const u={x:(e-n)/s,y:(t-o)/s};return i?{x:r*Math.round(u.x/r),y:c*Math.round(u.y/c)}:u},Zn=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Xe=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},Zt=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:i,y:r}=Xe(s,t).positionAbsolute;return Bn(o,rt({x:i,y:r,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ln(n)},Gn=(e,t,[n,o,s]=[0,0,1],i=!1,r=!1,c=[0,0])=>{const u={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(l=>{const{width:f,height:m,selectable:g=!0,hidden:E=!1}=l;if(r&&!g||E)return!1;const{positionAbsolute:p}=Xe(l,c),w={x:p.x,y:p.y,width:f||0,height:m||0},h=kt(u,w),S=typeof f>"u"||typeof m>"u"||f===null||m===null,M=i&&h>0,I=(f||0)*(m||0);(S||M||h>=I||l.dragging)&&d.push(l)}),d},Kn=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},jn=(e,t,n,o,s,i=.1)=>{const r=t/(e.width*(1+i)),c=n/(e.height*(1+i)),u=Math.min(r,c),d=Ke(u,o,s),l=e.x+e.width/2,f=e.y+e.height/2,m=t/2-l*d,g=n/2-f*d;return{x:m,y:g,zoom:d}},Ie=(e,t=0)=>e.transition().duration(t);function hn(e,t,n,o){return(t[n]||[]).reduce((s,i)=>{var r,c;return`${e.id}-${i.id}-${n}`!==o&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(((r=e.positionAbsolute)==null?void 0:r.x)??0)+i.x+i.width/2,y:(((c=e.positionAbsolute)==null?void 0:c.y)??0)+i.y+i.height/2}),s},[])}function pr(e,t,n,o,s,i){const{x:r,y:c}=Ne(e),d=t.elementsFromPoint(r,c).find(E=>E.classList.contains("react-flow__handle"));if(d){const E=d.getAttribute("data-nodeid");if(E){const p=Gt(void 0,d),w=d.getAttribute("data-handleid"),h=i({nodeId:E,id:w,type:p});if(h){const S=s.find(M=>M.nodeId===E&&M.type===p&&M.id===w);return{handle:{id:w,type:p,nodeId:E,x:(S==null?void 0:S.x)||n.x,y:(S==null?void 0:S.y)||n.y},validHandleResult:h}}}}let l=[],f=1/0;if(s.forEach(E=>{const p=Math.sqrt((E.x-n.x)**2+(E.y-n.y)**2);if(p<=o){const w=i(E);p<=f&&(p<f?l=[{handle:E,validHandleResult:w}]:p===f&&l.push({handle:E,validHandleResult:w}),f=p)}}),!l.length)return{handle:null,validHandleResult:qn()};if(l.length===1)return l[0];const m=l.some(({validHandleResult:E})=>E.isValid),g=l.some(({handle:E})=>E.type==="target");return l.find(({handle:E,validHandleResult:p})=>g?E.type==="target":m?p.isValid:!0)||l[0]}const yr={source:null,target:null,sourceHandle:null,targetHandle:null},qn=()=>({handleDomNode:null,isValid:!1,connection:yr,endHandle:null});function Qn(e,t,n,o,s,i,r){const c=s==="target",u=r.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...qn(),handleDomNode:u};if(u){const l=Gt(void 0,u),f=u.getAttribute("data-nodeid"),m=u.getAttribute("data-handleid"),g=u.classList.contains("connectable"),E=u.classList.contains("connectableend"),p={source:c?f:n,sourceHandle:c?m:o,target:c?n:f,targetHandle:c?o:m};d.connection=p,g&&E&&(t===Re.Strict?c&&l==="source"||!c&&l==="target":f!==n||m!==o)&&(d.endHandle={nodeId:f,handleId:m,type:l},d.isValid=i(p))}return d}function xr({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,i)=>{if(i[ee]){const{handleBounds:r}=i[ee];let c=[],u=[];r&&(c=hn(i,r,"source",`${t}-${n}-${o}`),u=hn(i,r,"target",`${t}-${n}-${o}`)),s.push(...c,...u)}return s},[])}function Gt(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function $t(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function wr(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Jn({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:i,setState:r,isValidConnection:c,edgeUpdaterType:u,onReconnectEnd:d}){const l=Vn(e.target),{connectionMode:f,domNode:m,autoPanOnConnect:g,connectionRadius:E,onConnectStart:p,panBy:w,getNodes:h,cancelConnection:S}=i();let M=0,I;const{x:k,y:R}=Ne(e),V=l==null?void 0:l.elementFromPoint(k,R),B=Gt(u,V),$=m==null?void 0:m.getBoundingClientRect();if(!$||!B)return;let H,P=Ne(e,$),L=!1,D=null,a=!1,b=null;const x=xr({nodes:h(),nodeId:n,handleId:t,handleType:B}),_=()=>{if(!g)return;const[A,C]=Hn(P,$);w({x:A,y:C}),M=requestAnimationFrame(_)};r({connectionPosition:P,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:B,connectionStartHandle:{nodeId:n,handleId:t,type:B},connectionEndHandle:null}),p==null||p(e,{nodeId:n,handleId:t,handleType:B});function z(A){const{transform:C}=i();P=Ne(A,$);const{handle:T,validHandleResult:O}=pr(A,l,Ht(P,C,!1,[1,1]),E,x,F=>Qn(F,f,n,t,s?"target":"source",c,l));if(I=T,L||(_(),L=!0),b=O.handleDomNode,D=O.connection,a=O.isValid,r({connectionPosition:I&&a?Zn({x:I.x,y:I.y},C):P,connectionStatus:wr(!!I,a),connectionEndHandle:O.endHandle}),!I&&!a&&!b)return $t(H);D.source!==D.target&&b&&($t(H),H=b,b.classList.add("connecting","react-flow__handle-connecting"),b.classList.toggle("valid",a),b.classList.toggle("react-flow__handle-valid",a))}function y(A){var C,T;(I||b)&&D&&a&&(o==null||o(D)),(T=(C=i()).onConnectEnd)==null||T.call(C,A),u&&(d==null||d(A)),$t(H),S(),cancelAnimationFrame(M),L=!1,a=!1,D=null,b=null,l.removeEventListener("mousemove",z),l.removeEventListener("mouseup",y),l.removeEventListener("touchmove",z),l.removeEventListener("touchend",y)}l.addEventListener("mousemove",z),l.addEventListener("mouseup",y),l.addEventListener("touchmove",z),l.addEventListener("touchend",y)}const gn=()=>!0,Er=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Sr=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:r}=o;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.handleId)===t&&(r==null?void 0:r.type)===n}},eo=v.forwardRef(({type:e="source",position:t=Y.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:r,onConnect:c,children:u,className:d,onMouseDown:l,onTouchStart:f,...m},g)=>{var $,H;const E=r||null,p=e==="target",w=ne(),h=dr(),{connectOnClick:S,noPanClassName:M}=Q(Er,se),{connecting:I,clickConnecting:k}=Q(Sr(h,E,e),se);h||(H=($=w.getState()).onError)==null||H.call($,"010",xe.error010());const R=P=>{const{defaultEdgeOptions:L,onConnect:D,hasDefaultEdges:a}=w.getState(),b={...L,...P};if(a){const{edges:x,setEdges:_}=w.getState();_(mr(b,x))}D==null||D(b),c==null||c(b)},V=P=>{if(!h)return;const L=On(P);s&&(L&&P.button===0||!L)&&Jn({event:P,handleId:E,nodeId:h,onConnect:R,isTarget:p,getState:w.getState,setState:w.setState,isValidConnection:n||w.getState().isValidConnection||gn}),L?l==null||l(P):f==null||f(P)},B=P=>{const{onClickConnectStart:L,onClickConnectEnd:D,connectionClickStartHandle:a,connectionMode:b,isValidConnection:x}=w.getState();if(!h||!a&&!s)return;if(!a){L==null||L(P,{nodeId:h,handleId:E,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:h,type:e,handleId:E}});return}const _=Vn(P.target),z=n||x||gn,{connection:y,isValid:A}=Qn({nodeId:h,id:E,type:e},b,a.nodeId,a.handleId||null,a.type,z,_);A&&R(y),D==null||D(P),w.setState({connectionClickStartHandle:null})};return N.createElement("div",{"data-handleid":E,"data-nodeid":h,"data-handlepos":t,"data-id":`${h}-${E}-${e}`,className:re(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",M,d,{source:!p,target:p,connectable:o,connectablestart:s,connectableend:i,connecting:k,connectionindicator:o&&(s&&!I||i&&I)}]),onMouseDown:V,onTouchStart:V,onClick:S?B:void 0,ref:g,...m},u)});eo.displayName="Handle";var yt=v.memo(eo);const to=({data:e,isConnectable:t,targetPosition:n=Y.Top,sourcePosition:o=Y.Bottom})=>N.createElement(N.Fragment,null,N.createElement(yt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,N.createElement(yt,{type:"source",position:o,isConnectable:t}));to.displayName="DefaultNode";var Vt=v.memo(to);const no=({data:e,isConnectable:t,sourcePosition:n=Y.Bottom})=>N.createElement(N.Fragment,null,e==null?void 0:e.label,N.createElement(yt,{type:"source",position:n,isConnectable:t}));no.displayName="InputNode";var oo=v.memo(no);const so=({data:e,isConnectable:t,targetPosition:n=Y.Top})=>N.createElement(N.Fragment,null,N.createElement(yt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);so.displayName="OutputNode";var ro=v.memo(so);const Kt=()=>null;Kt.displayName="GroupNode";const br=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),dt=e=>e.id;function vr(e,t){return se(e.selectedNodes.map(dt),t.selectedNodes.map(dt))&&se(e.selectedEdges.map(dt),t.selectedEdges.map(dt))}const io=v.memo(({onSelectionChange:e})=>{const t=ne(),{selectedNodes:n,selectedEdges:o}=Q(br,vr);return v.useEffect(()=>{const s={nodes:n,edges:o};e==null||e(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,o,e]),null});io.displayName="SelectionListener";const Nr=e=>!!e.onSelectionChange;function Mr({onSelectionChange:e}){const t=Q(Nr);return e||t?N.createElement(io,{onSelectionChange:e}):null}const _r=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Fe(e,t){v.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function X(e,t,n){v.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const Ar=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:i,onConnectEnd:r,onClickConnectStart:c,onClickConnectEnd:u,nodesDraggable:d,nodesConnectable:l,nodesFocusable:f,edgesFocusable:m,edgesUpdatable:g,elevateNodesOnSelect:E,minZoom:p,maxZoom:w,nodeExtent:h,onNodesChange:S,onEdgesChange:M,elementsSelectable:I,connectionMode:k,snapGrid:R,snapToGrid:V,translateExtent:B,connectOnClick:$,defaultEdgeOptions:H,fitView:P,fitViewOptions:L,onNodesDelete:D,onEdgesDelete:a,onNodeDrag:b,onNodeDragStart:x,onNodeDragStop:_,onSelectionDrag:z,onSelectionDragStart:y,onSelectionDragStop:A,noPanClassName:C,nodeOrigin:T,rfId:O,autoPanOnConnect:F,autoPanOnNodeDrag:W,onError:Z,connectionRadius:G,isValidConnection:K,nodeDragThreshold:J})=>{const{setNodes:j,setEdges:ue,setDefaultNodesAndEdges:ce,setMinZoom:de,setMaxZoom:ae,setTranslateExtent:te,setNodeExtent:ge,reset:q}=Q(_r,se),U=ne();return v.useEffect(()=>{const ie=o==null?void 0:o.map(Me=>({...Me,...H}));return ce(n,ie),()=>{q()}},[]),X("defaultEdgeOptions",H,U.setState),X("connectionMode",k,U.setState),X("onConnect",s,U.setState),X("onConnectStart",i,U.setState),X("onConnectEnd",r,U.setState),X("onClickConnectStart",c,U.setState),X("onClickConnectEnd",u,U.setState),X("nodesDraggable",d,U.setState),X("nodesConnectable",l,U.setState),X("nodesFocusable",f,U.setState),X("edgesFocusable",m,U.setState),X("edgesUpdatable",g,U.setState),X("elementsSelectable",I,U.setState),X("elevateNodesOnSelect",E,U.setState),X("snapToGrid",V,U.setState),X("snapGrid",R,U.setState),X("onNodesChange",S,U.setState),X("onEdgesChange",M,U.setState),X("connectOnClick",$,U.setState),X("fitViewOnInit",P,U.setState),X("fitViewOnInitOptions",L,U.setState),X("onNodesDelete",D,U.setState),X("onEdgesDelete",a,U.setState),X("onNodeDrag",b,U.setState),X("onNodeDragStart",x,U.setState),X("onNodeDragStop",_,U.setState),X("onSelectionDrag",z,U.setState),X("onSelectionDragStart",y,U.setState),X("onSelectionDragStop",A,U.setState),X("noPanClassName",C,U.setState),X("nodeOrigin",T,U.setState),X("rfId",O,U.setState),X("autoPanOnConnect",F,U.setState),X("autoPanOnNodeDrag",W,U.setState),X("onError",Z,U.setState),X("connectionRadius",G,U.setState),X("isValidConnection",K,U.setState),X("nodeDragThreshold",J,U.setState),Fe(e,j),Fe(t,ue),Fe(p,de),Fe(w,ae),Fe(B,te),Fe(h,ge),null},mn={display:"none"},$r={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},co="react-flow__node-desc",ao="react-flow__edge-desc",Cr="react-flow__aria-live",zr=e=>e.ariaLiveMessage;function Tr({rfId:e}){const t=Q(zr);return N.createElement("div",{id:`${Cr}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:$r},t)}function Ir({rfId:e,disableKeyboardA11y:t}){return N.createElement(N.Fragment,null,N.createElement("div",{id:`${co}-${e}`,style:mn},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),N.createElement("div",{id:`${ao}-${e}`,style:mn},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&N.createElement(Tr,{rfId:e}))}var ct=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=v.useState(!1),s=v.useRef(!1),i=v.useRef(new Set([])),[r,c]=v.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),l=d.reduce((f,m)=>f.concat(...m),[]);return[d,l]}return[[],[]]},[e]);return v.useEffect(()=>{const u=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||u;if(e!==null){const l=g=>{if(s.current=g.ctrlKey||g.metaKey||g.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Dt(g))return!1;const p=yn(g.code,c);i.current.add(g[p]),pn(r,i.current,!1)&&(g.preventDefault(),o(!0))},f=g=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Dt(g))return!1;const p=yn(g.code,c);pn(r,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(g[p]),g.key==="Meta"&&i.current.clear(),s.current=!1},m=()=>{i.current.clear(),o(!1)};return d==null||d.addEventListener("keydown",l),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",m),()=>{d==null||d.removeEventListener("keydown",l),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",m)}}},[e,o]),n};function pn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function yn(e,t){return t.includes(e)?"code":"key"}function lo(e,t,n,o){var c,u;const s=e.parentNode||e.parentId;if(!s)return n;const i=t.get(s),r=Xe(i,o);return lo(i,t,{x:(n.x??0)+r.x,y:(n.y??0)+r.y,z:(((c=i[ee])==null?void 0:c.z)??0)>(n.z??0)?((u=i[ee])==null?void 0:u.z)??0:n.z??0},o)}function uo(e,t,n){e.forEach(o=>{var i;const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n!=null&&n[o.id]){const{x:r,y:c,z:u}=lo(o,e,{...o.position,z:((i=o[ee])==null?void 0:i.z)??0},t);o.positionAbsolute={x:r,y:c},o[ee].z=u,n!=null&&n[o.id]&&(o[ee].isParent=!0)}})}function Ct(e,t,n,o){const s=new Map,i={},r=o?1e3:0;return e.forEach(c=>{var g;const u=(le(c.zIndex)?c.zIndex:0)+(c.selected?r:0),d=t.get(c.id),l={...c,positionAbsolute:{x:c.position.x,y:c.position.y}},f=c.parentNode||c.parentId;f&&(i[f]=!0);const m=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==c.type;Object.defineProperty(l,ee,{enumerable:!1,value:{handleBounds:m||(g=d==null?void 0:d[ee])==null?void 0:g.handleBounds,z:u}}),s.set(c.id,l)}),uo(s,n,i),s}function fo(e,t={}){const{getNodes:n,width:o,height:s,minZoom:i,maxZoom:r,d3Zoom:c,d3Selection:u,fitViewOnInitDone:d,fitViewOnInit:l,nodeOrigin:f}=e(),m=t.initial&&!d&&l;if(c&&u&&(m||!t.initial)){const E=n().filter(w=>{var S;const h=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return(S=t.nodes)!=null&&S.length?h&&t.nodes.some(M=>M.id===w.id):h}),p=E.every(w=>w.width&&w.height);if(E.length>0&&p){const w=Zt(E,f),{x:h,y:S,zoom:M}=jn(w,o,s,t.minZoom??i,t.maxZoom??r,t.padding??.1),I=ve.translate(h,S).scale(M);return typeof t.duration=="number"&&t.duration>0?c.transform(Ie(u,t.duration),I):c.transform(u,I),!0}}return!1}function kr(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[ee]:o[ee],selected:n.selected})}),new Map(t)}function Dr(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function ft({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:i,onNodesChange:r,onEdgesChange:c,hasDefaultNodes:u,hasDefaultEdges:d}=n();e!=null&&e.length&&(u&&o({nodeInternals:kr(e,s)}),r==null||r(e)),t!=null&&t.length&&(d&&o({edges:Dr(t,i)}),c==null||c(t))}const Oe=()=>{},Rr={zoomIn:Oe,zoomOut:Oe,zoomTo:Oe,getZoom:()=>1,setViewport:Oe,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Oe,fitBounds:Oe,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Pr=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Hr=()=>{const e=ne(),{d3Zoom:t,d3Selection:n}=Q(Pr,se);return v.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(Ie(n,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(Ie(n,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(Ie(n,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[r,c,u]=e.getState().transform,d=ve.translate(s.x??r,s.y??c).scale(s.zoom??u);t.transform(Ie(n,i==null?void 0:i.duration),d)},getViewport:()=>{const[s,i,r]=e.getState().transform;return{x:s,y:i,zoom:r}},fitView:s=>fo(e.getState,s),setCenter:(s,i,r)=>{const{width:c,height:u,maxZoom:d}=e.getState(),l=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:d,f=c/2-s*l,m=u/2-i*l,g=ve.translate(f,m).scale(l);t.transform(Ie(n,r==null?void 0:r.duration),g)},fitBounds:(s,i)=>{const{width:r,height:c,minZoom:u,maxZoom:d}=e.getState(),{x:l,y:f,zoom:m}=jn(s,r,c,u,d,(i==null?void 0:i.padding)??.1),g=ve.translate(l,f).scale(m);t.transform(Ie(n,i==null?void 0:i.duration),g)},project:s=>{const{transform:i,snapToGrid:r,snapGrid:c}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Ht(s,i,r,c)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:r,snapGrid:c,domNode:u}=e.getState();if(!u)return s;const{x:d,y:l}=u.getBoundingClientRect(),f={x:s.x-d,y:s.y-l};return Ht(f,i,r,c)},flowToScreenPosition:s=>{const{transform:i,domNode:r}=e.getState();if(!r)return s;const{x:c,y:u}=r.getBoundingClientRect(),d=Zn(s,i);return{x:d.x+c,y:d.y+u}},viewportInitialized:!0}:Rr,[t,n])};function jt(){const e=Hr(),t=ne(),n=v.useCallback(()=>t.getState().getNodes().map(p=>({...p})),[]),o=v.useCallback(p=>t.getState().nodeInternals.get(p),[]),s=v.useCallback(()=>{const{edges:p=[]}=t.getState();return p.map(w=>({...w}))},[]),i=v.useCallback(p=>{const{edges:w=[]}=t.getState();return w.find(h=>h.id===p)},[]),r=v.useCallback(p=>{const{getNodes:w,setNodes:h,hasDefaultNodes:S,onNodesChange:M}=t.getState(),I=w(),k=typeof p=="function"?p(I):p;if(S)h(k);else if(M){const R=k.length===0?I.map(V=>({type:"remove",id:V.id})):k.map(V=>({item:V,type:"reset"}));M(R)}},[]),c=v.useCallback(p=>{const{edges:w=[],setEdges:h,hasDefaultEdges:S,onEdgesChange:M}=t.getState(),I=typeof p=="function"?p(w):p;if(S)h(I);else if(M){const k=I.length===0?w.map(R=>({type:"remove",id:R.id})):I.map(R=>({item:R,type:"reset"}));M(k)}},[]),u=v.useCallback(p=>{const w=Array.isArray(p)?p:[p],{getNodes:h,setNodes:S,hasDefaultNodes:M,onNodesChange:I}=t.getState();if(M){const R=[...h(),...w];S(R)}else if(I){const k=w.map(R=>({item:R,type:"add"}));I(k)}},[]),d=v.useCallback(p=>{const w=Array.isArray(p)?p:[p],{edges:h=[],setEdges:S,hasDefaultEdges:M,onEdgesChange:I}=t.getState();if(M)S([...h,...w]);else if(I){const k=w.map(R=>({item:R,type:"add"}));I(k)}},[]),l=v.useCallback(()=>{const{getNodes:p,edges:w=[],transform:h}=t.getState(),[S,M,I]=h;return{nodes:p().map(k=>({...k})),edges:w.map(k=>({...k})),viewport:{x:S,y:M,zoom:I}}},[]),f=v.useCallback(({nodes:p,edges:w})=>{const{nodeInternals:h,getNodes:S,edges:M,hasDefaultNodes:I,hasDefaultEdges:k,onNodesDelete:R,onEdgesDelete:V,onNodesChange:B,onEdgesChange:$}=t.getState(),H=(p||[]).map(b=>b.id),P=(w||[]).map(b=>b.id),L=S().reduce((b,x)=>{const _=x.parentNode||x.parentId,z=!H.includes(x.id)&&_&&b.find(A=>A.id===_);return(typeof x.deletable=="boolean"?x.deletable:!0)&&(H.includes(x.id)||z)&&b.push(x),b},[]),D=M.filter(b=>typeof b.deletable=="boolean"?b.deletable:!0),a=D.filter(b=>P.includes(b.id));if(L||a){const b=Kn(L,D),x=[...a,...b],_=x.reduce((z,y)=>(z.includes(y.id)||z.push(y.id),z),[]);if((k||I)&&(k&&t.setState({edges:M.filter(z=>!_.includes(z.id))}),I&&(L.forEach(z=>{h.delete(z.id)}),t.setState({nodeInternals:new Map(h)}))),_.length>0&&(V==null||V(x),$&&$(_.map(z=>({id:z,type:"remove"})))),L.length>0&&(R==null||R(L),B)){const z=L.map(y=>({id:y.id,type:"remove"}));B(z)}}},[]),m=v.useCallback(p=>{const w=or(p),h=w?null:t.getState().nodeInternals.get(p.id);return!w&&!h?[null,null,w]:[w?p:an(h),h,w]},[]),g=v.useCallback((p,w=!0,h)=>{const[S,M,I]=m(p);return S?(h||t.getState().getNodes()).filter(k=>{if(!I&&(k.id===M.id||!k.positionAbsolute))return!1;const R=an(k),V=kt(R,S);return w&&V>0||V>=S.width*S.height}):[]},[]),E=v.useCallback((p,w,h=!0)=>{const[S]=m(p);if(!S)return!1;const M=kt(S,w);return h&&M>0||M>=S.width*S.height},[]);return v.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:i,setNodes:r,setEdges:c,addNodes:u,addEdges:d,toObject:l,deleteElements:f,getIntersectingNodes:g,isNodeIntersecting:E}),[e,n,o,s,i,r,c,u,d,l,f,g,E])}const Vr={actInsideInputWithModifier:!1};var Br=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ne(),{deleteElements:o}=jt(),s=ct(e,Vr),i=ct(t);v.useEffect(()=>{if(s){const{edges:r,getNodes:c}=n.getState(),u=c().filter(l=>l.selected),d=r.filter(l=>l.selected);o({nodes:u,edges:d}),n.setState({nodesSelectionActive:!1})}},[s]),v.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function Lr(e){const t=ne();v.useEffect(()=>{let n;const o=()=>{var i,r;if(!e.current)return;const s=Ft(e.current);(s.height===0||s.width===0)&&((r=(i=t.getState()).onError)==null||r.call(i,"004",xe.error004())),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const qt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Fr=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ht=e=>({x:e.x,y:e.y,zoom:e.k}),Ye=(e,t)=>e.target.closest(`.${t}`),xn=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),wn=e=>{const t=e.ctrlKey&&gt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Or=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Yr=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:r=!1,panOnScrollSpeed:c=.5,panOnScrollMode:u=De.Free,zoomOnDoubleClick:d=!0,elementsSelectable:l,panOnDrag:f=!0,defaultViewport:m,translateExtent:g,minZoom:E,maxZoom:p,zoomActivationKeyCode:w,preventScrolling:h=!0,children:S,noWheelClassName:M,noPanClassName:I})=>{const k=v.useRef(),R=ne(),V=v.useRef(!1),B=v.useRef(!1),$=v.useRef(null),H=v.useRef({x:0,y:0,zoom:0}),{d3Zoom:P,d3Selection:L,d3ZoomHandler:D,userSelectionActive:a}=Q(Or,se),b=ct(w),x=v.useRef(0),_=v.useRef(!1),z=v.useRef();return Lr($),v.useEffect(()=>{if($.current){const y=$.current.getBoundingClientRect(),A=Rs().scaleExtent([E,p]).translateExtent(g),C=ke($.current).call(A),T=ve.translate(m.x,m.y).scale(Ke(m.zoom,E,p)),O=[[0,0],[y.width,y.height]],F=A.constrain()(T,O,g);A.transform(C,F),A.wheelDelta(wn),R.setState({d3Zoom:A,d3Selection:C,d3ZoomHandler:C.on("wheel.zoom"),transform:[F.x,F.y,F.k],domNode:$.current.closest(".react-flow")})}},[]),v.useEffect(()=>{L&&P&&(r&&!b&&!a?L.on("wheel.zoom",y=>{if(Ye(y,M))return!1;y.preventDefault(),y.stopImmediatePropagation();const A=L.property("__zoom").k||1;if(y.ctrlKey&&i){const K=Ee(y),J=wn(y),j=A*Math.pow(2,J);P.scaleTo(L,j,K,y);return}const C=y.deltaMode===1?20:1;let T=u===De.Vertical?0:y.deltaX*C,O=u===De.Horizontal?0:y.deltaY*C;!gt()&&y.shiftKey&&u!==De.Vertical&&(T=y.deltaY*C,O=0),P.translateBy(L,-(T/A)*c,-(O/A)*c,{internal:!0});const F=ht(L.property("__zoom")),{onViewportChangeStart:W,onViewportChange:Z,onViewportChangeEnd:G}=R.getState();clearTimeout(z.current),_.current||(_.current=!0,t==null||t(y,F),W==null||W(F)),_.current&&(e==null||e(y,F),Z==null||Z(F),z.current=setTimeout(()=>{n==null||n(y,F),G==null||G(F),_.current=!1},150))},{passive:!1}):typeof D<"u"&&L.on("wheel.zoom",function(y,A){if(!h&&y.type==="wheel"&&!y.ctrlKey||Ye(y,M))return null;y.preventDefault(),D.call(this,y,A)},{passive:!1}))},[a,r,u,L,P,D,b,i,h,M,t,e,n]),v.useEffect(()=>{P&&P.on("start",y=>{var T,O;if(!y.sourceEvent||y.sourceEvent.internal)return null;x.current=(T=y.sourceEvent)==null?void 0:T.button;const{onViewportChangeStart:A}=R.getState(),C=ht(y.transform);V.current=!0,H.current=C,((O=y.sourceEvent)==null?void 0:O.type)==="mousedown"&&R.setState({paneDragging:!0}),A==null||A(C),t==null||t(y.sourceEvent,C)})},[P,t]),v.useEffect(()=>{P&&(a&&!V.current?P.on("zoom",null):a||P.on("zoom",y=>{var C;const{onViewportChange:A}=R.getState();if(R.setState({transform:[y.transform.x,y.transform.y,y.transform.k]}),B.current=!!(o&&xn(f,x.current??0)),(e||A)&&!((C=y.sourceEvent)!=null&&C.internal)){const T=ht(y.transform);A==null||A(T),e==null||e(y.sourceEvent,T)}}))},[a,P,e,f,o]),v.useEffect(()=>{P&&P.on("end",y=>{if(!y.sourceEvent||y.sourceEvent.internal)return null;const{onViewportChangeEnd:A}=R.getState();if(V.current=!1,R.setState({paneDragging:!1}),o&&xn(f,x.current??0)&&!B.current&&o(y.sourceEvent),B.current=!1,(n||A)&&Fr(H.current,y.transform)){const C=ht(y.transform);H.current=C,clearTimeout(k.current),k.current=setTimeout(()=>{A==null||A(C),n==null||n(y.sourceEvent,C)},r?150:0)}})},[P,r,f,n,o]),v.useEffect(()=>{P&&P.filter(y=>{const A=b||s,C=i&&y.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&y.button===1&&y.type==="mousedown"&&(Ye(y,"react-flow__node")||Ye(y,"react-flow__edge")))return!0;if(!f&&!A&&!r&&!d&&!i||a||!d&&y.type==="dblclick"||Ye(y,M)&&y.type==="wheel"||Ye(y,I)&&(y.type!=="wheel"||r&&y.type==="wheel"&&!b)||!i&&y.ctrlKey&&y.type==="wheel"||!A&&!r&&!C&&y.type==="wheel"||!f&&(y.type==="mousedown"||y.type==="touchstart")||Array.isArray(f)&&!f.includes(y.button)&&y.type==="mousedown")return!1;const T=Array.isArray(f)&&f.includes(y.button)||!y.button||y.button<=1;return(!y.ctrlKey||y.type==="wheel")&&T})},[a,P,s,i,r,d,f,l,b]),N.createElement("div",{className:"react-flow__renderer",ref:$,style:qt},S)},Ur=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Wr(){const{userSelectionActive:e,userSelectionRect:t}=Q(Ur,se);return e&&t?N.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function En(e,t){const n=t.parentNode||t.parentId,o=e.find(s=>s.id===n);if(o){const s=t.position.x+t.width-o.width,i=t.position.y+t.height-o.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),i>0&&(o.style.height+=i),t.position.x<0){const r=Math.abs(t.position.x);o.position.x=o.position.x-r,o.style.width+=r,t.position.x=0}if(t.position.y<0){const r=Math.abs(t.position.y);o.position.y=o.position.y-r,o.style.height+=r,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function ho(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const i=e.filter(c=>c.id===s.id);if(i.length===0)return o.push(s),o;const r={...s};for(const c of i)if(c)switch(c.type){case"select":{r.selected=c.selected;break}case"position":{typeof c.position<"u"&&(r.position=c.position),typeof c.positionAbsolute<"u"&&(r.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(r.dragging=c.dragging),r.expandParent&&En(o,r);break}case"dimensions":{typeof c.dimensions<"u"&&(r.width=c.dimensions.width,r.height=c.dimensions.height),typeof c.updateStyle<"u"&&(r.style={...r.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(r.resizing=c.resizing),r.expandParent&&En(o,r);break}case"remove":return o}return o.push(r),o},n)}function go(e,t){return ho(e,t)}function Xr(e,t){return ho(e,t)}const Se=(e,t)=>({id:e,type:"select",selected:t});function We(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(Se(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(Se(o.id,!1))),n},[])}const zt=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Zr=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),mo=v.memo(({isSelecting:e,selectionMode:t=it.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:r,onPaneScroll:c,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:l,children:f})=>{const m=v.useRef(null),g=ne(),E=v.useRef(0),p=v.useRef(0),w=v.useRef(),{userSelectionActive:h,elementsSelectable:S,dragging:M}=Q(Zr,se),I=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),E.current=0,p.current=0},k=D=>{i==null||i(D),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},R=D=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){D.preventDefault();return}r==null||r(D)},V=c?D=>c(D):void 0,B=D=>{const{resetSelectedElements:a,domNode:b}=g.getState();if(w.current=b==null?void 0:b.getBoundingClientRect(),!S||!e||D.button!==0||D.target!==m.current||!w.current)return;const{x,y:_}=Ne(D,w.current);a(),g.setState({userSelectionRect:{width:0,height:0,startX:x,startY:_,x,y:_}}),o==null||o(D)},$=D=>{const{userSelectionRect:a,nodeInternals:b,edges:x,transform:_,onNodesChange:z,onEdgesChange:y,nodeOrigin:A,getNodes:C}=g.getState();if(!e||!w.current||!a)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const T=Ne(D,w.current),O=a.startX??0,F=a.startY??0,W={...a,x:T.x<O?T.x:O,y:T.y<F?T.y:F,width:Math.abs(T.x-O),height:Math.abs(T.y-F)},Z=C(),G=Gn(b,W,_,t===it.Partial,!0,A),K=Kn(G,x).map(j=>j.id),J=G.map(j=>j.id);if(E.current!==J.length){E.current=J.length;const j=We(Z,J);j.length&&(z==null||z(j))}if(p.current!==K.length){p.current=K.length;const j=We(x,K);j.length&&(y==null||y(j))}g.setState({userSelectionRect:W})},H=D=>{if(D.button!==0)return;const{userSelectionRect:a}=g.getState();!h&&a&&D.target===m.current&&(k==null||k(D)),g.setState({nodesSelectionActive:E.current>0}),I(),s==null||s(D)},P=D=>{h&&(g.setState({nodesSelectionActive:E.current>0}),s==null||s(D)),I()},L=S&&(e||h);return N.createElement("div",{className:re(["react-flow__pane",{dragging:M,selection:e}]),onClick:L?void 0:zt(k,m),onContextMenu:zt(R,m),onWheel:zt(V,m),onMouseEnter:L?void 0:u,onMouseDown:L?B:void 0,onMouseMove:L?$:d,onMouseUp:L?H:void 0,onMouseLeave:L?P:l,ref:m,style:qt},f,N.createElement(Wr,null))});mo.displayName="Pane";function po(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const o=t.get(n);return o?o.selected?!0:po(o,t):!1}function Sn(e,t,n){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Gr(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!po(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,r;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((r=s.positionAbsolute)==null?void 0:r.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function Kr(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function yo(e,t,n,o,s=[0,0],i){const r=Kr(e,e.extent||o);let c=r;const u=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(u&&e.width&&e.height){const f=n.get(u),{x:m,y:g}=Xe(f,s).positionAbsolute;c=f&&le(m)&&le(g)&&le(f.width)&&le(f.height)?[[m+e.width*s[0],g+e.height*s[1]],[m+f.width-e.width+e.width*s[0],g+f.height-e.height+e.height*s[1]]]:c}else i==null||i("005",xe.error005()),c=r;else if(e.extent&&u&&e.extent!=="parent"){const f=n.get(u),{x:m,y:g}=Xe(f,s).positionAbsolute;c=[[e.extent[0][0]+m,e.extent[0][1]+g],[e.extent[1][0]+m,e.extent[1][1]+g]]}let d={x:0,y:0};if(u){const f=n.get(u);d=Xe(f,s).positionAbsolute}const l=c&&c!=="parent"?Ot(t,c):t;return{position:{x:l.x-d.x,y:l.y-d.y},positionAbsolute:l}}function Tt({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const bn=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),r=t.getBoundingClientRect(),c={x:r.width*o[0],y:r.height*o[1]};return i.map(u=>{const d=u.getBoundingClientRect();return{id:u.getAttribute("data-handleid"),position:u.getAttribute("data-handlepos"),x:(d.left-r.left-c.x)/n,y:(d.top-r.top-c.y)/n,...Ft(u)}})};function nt(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function Bt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:r,nodeInternals:c,onError:u}=t.getState(),d=c.get(e);if(!d){u==null||u("012",xe.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&r)&&(i({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var l;return(l=o==null?void 0:o.current)==null?void 0:l.blur()})):s([e])}function jr(){const e=ne();return v.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,c=n.touches?n.touches[0].clientY:n.clientY,u={x:(r-o[0])/o[2],y:(c-o[1])/o[2]};return{xSnapped:i?s[0]*Math.round(u.x/s[0]):u.x,ySnapped:i?s[1]*Math.round(u.y/s[1]):u.y,...u}},[])}function It(e){return(t,n,o)=>e==null?void 0:e(t,o)}function xo({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:i,selectNodesOnDrag:r}){const c=ne(),[u,d]=v.useState(!1),l=v.useRef([]),f=v.useRef({x:null,y:null}),m=v.useRef(0),g=v.useRef(null),E=v.useRef({x:0,y:0}),p=v.useRef(null),w=v.useRef(!1),h=v.useRef(!1),S=v.useRef(!1),M=jr();return v.useEffect(()=>{if(e!=null&&e.current){const I=ke(e.current),k=({x:B,y:$})=>{const{nodeInternals:H,onNodeDrag:P,onSelectionDrag:L,updateNodePositions:D,nodeExtent:a,snapGrid:b,snapToGrid:x,nodeOrigin:_,onError:z}=c.getState();f.current={x:B,y:$};let y=!1,A={x:0,y:0,x2:0,y2:0};if(l.current.length>1&&a){const T=Zt(l.current,_);A=rt(T)}if(l.current=l.current.map(T=>{const O={x:B-T.distance.x,y:$-T.distance.y};x&&(O.x=b[0]*Math.round(O.x/b[0]),O.y=b[1]*Math.round(O.y/b[1]));const F=[[a[0][0],a[0][1]],[a[1][0],a[1][1]]];l.current.length>1&&a&&!T.extent&&(F[0][0]=T.positionAbsolute.x-A.x+a[0][0],F[1][0]=T.positionAbsolute.x+(T.width??0)-A.x2+a[1][0],F[0][1]=T.positionAbsolute.y-A.y+a[0][1],F[1][1]=T.positionAbsolute.y+(T.height??0)-A.y2+a[1][1]);const W=yo(T,O,H,F,_,z);return y=y||T.position.x!==W.position.x||T.position.y!==W.position.y,T.position=W.position,T.positionAbsolute=W.positionAbsolute,T}),!y)return;D(l.current,!0,!0),d(!0);const C=s?P:It(L);if(C&&p.current){const[T,O]=Tt({nodeId:s,dragItems:l.current,nodeInternals:H});C(p.current,T,O)}},R=()=>{if(!g.current)return;const[B,$]=Hn(E.current,g.current);if(B!==0||$!==0){const{transform:H,panBy:P}=c.getState();f.current.x=(f.current.x??0)-B/H[2],f.current.y=(f.current.y??0)-$/H[2],P({x:B,y:$})&&k(f.current)}m.current=requestAnimationFrame(R)},V=B=>{var _;const{nodeInternals:$,multiSelectionActive:H,nodesDraggable:P,unselectNodesAndEdges:L,onNodeDragStart:D,onSelectionDragStart:a}=c.getState();h.current=!0;const b=s?D:It(a);(!r||!i)&&!H&&s&&((_=$.get(s))!=null&&_.selected||L()),s&&i&&r&&Bt({id:s,store:c,nodeRef:e});const x=M(B);if(f.current=x,l.current=Gr($,P,x,s),b&&l.current){const[z,y]=Tt({nodeId:s,dragItems:l.current,nodeInternals:$});b(B.sourceEvent,z,y)}};if(t)I.on(".drag",null);else{const B=gs().on("start",$=>{const{domNode:H,nodeDragThreshold:P}=c.getState();P===0&&V($),S.current=!1;const L=M($);f.current=L,g.current=(H==null?void 0:H.getBoundingClientRect())||null,E.current=Ne($.sourceEvent,g.current)}).on("drag",$=>{var D,a;const H=M($),{autoPanOnNodeDrag:P,nodeDragThreshold:L}=c.getState();if($.sourceEvent.type==="touchmove"&&$.sourceEvent.touches.length>1&&(S.current=!0),!S.current){if(!w.current&&h.current&&P&&(w.current=!0,R()),!h.current){const b=H.xSnapped-(((D=f==null?void 0:f.current)==null?void 0:D.x)??0),x=H.ySnapped-(((a=f==null?void 0:f.current)==null?void 0:a.y)??0);Math.sqrt(b*b+x*x)>L&&V($)}(f.current.x!==H.xSnapped||f.current.y!==H.ySnapped)&&l.current&&h.current&&(p.current=$.sourceEvent,E.current=Ne($.sourceEvent,g.current),k(H))}}).on("end",$=>{if(!(!h.current||S.current)&&(d(!1),w.current=!1,h.current=!1,cancelAnimationFrame(m.current),l.current)){const{updateNodePositions:H,nodeInternals:P,onNodeDragStop:L,onSelectionDragStop:D}=c.getState(),a=s?L:It(D);if(H(l.current,!1,!1),a){const[b,x]=Tt({nodeId:s,dragItems:l.current,nodeInternals:P});a($.sourceEvent,b,x)}}}).filter($=>{const H=$.target;return!$.button&&(!n||!Sn(H,`.${n}`,e))&&(!o||Sn(H,o,e))});return I.call(B),()=>{I.on(".drag",null)}}}},[e,t,n,o,i,c,s,r,M]),u}function wo(){const e=ne();return v.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:i,getNodes:r,snapToGrid:c,snapGrid:u,onError:d,nodesDraggable:l}=e.getState(),f=r().filter(S=>S.selected&&(S.draggable||l&&typeof S.draggable>"u")),m=c?u[0]:5,g=c?u[1]:5,E=n.isShiftPressed?4:1,p=n.x*m*E,w=n.y*g*E,h=f.map(S=>{if(S.positionAbsolute){const M={x:S.positionAbsolute.x+p,y:S.positionAbsolute.y+w};c&&(M.x=u[0]*Math.round(M.x/u[0]),M.y=u[1]*Math.round(M.y/u[1]));const{positionAbsolute:I,position:k}=yo(S,M,o,s,void 0,d);S.position=k,S.positionAbsolute=I}return S});i(h,!0,!1)},[])}const Ze={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var ot=e=>{const t=({id:n,type:o,data:s,xPos:i,yPos:r,xPosOrigin:c,yPosOrigin:u,selected:d,onClick:l,onMouseEnter:f,onMouseMove:m,onMouseLeave:g,onContextMenu:E,onDoubleClick:p,style:w,className:h,isDraggable:S,isSelectable:M,isConnectable:I,isFocusable:k,selectNodesOnDrag:R,sourcePosition:V,targetPosition:B,hidden:$,resizeObserver:H,dragHandle:P,zIndex:L,isParent:D,noDragClassName:a,noPanClassName:b,initialized:x,disableKeyboardA11y:_,ariaLabel:z,rfId:y,hasHandleBounds:A})=>{const C=ne(),T=v.useRef(null),O=v.useRef(null),F=v.useRef(V),W=v.useRef(B),Z=v.useRef(o),G=M||S||l||f||m||g,K=wo(),J=nt(n,C.getState,f),j=nt(n,C.getState,m),ue=nt(n,C.getState,g),ce=nt(n,C.getState,E),de=nt(n,C.getState,p),ae=q=>{const{nodeDragThreshold:U}=C.getState();if(M&&(!R||!S||U>0)&&Bt({id:n,store:C,nodeRef:T}),l){const ie=C.getState().nodeInternals.get(n);ie&&l(q,{...ie})}},te=q=>{if(!Dt(q)&&!_)if(Fn.includes(q.key)&&M){const U=q.key==="Escape";Bt({id:n,store:C,unselect:U,nodeRef:T})}else S&&d&&Object.prototype.hasOwnProperty.call(Ze,q.key)&&(C.setState({ariaLiveMessage:`Moved selected node ${q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~r}`}),K({x:Ze[q.key].x,y:Ze[q.key].y,isShiftPressed:q.shiftKey}))};v.useEffect(()=>()=>{O.current&&(H==null||H.unobserve(O.current),O.current=null)},[]),v.useEffect(()=>{if(T.current&&!$){const q=T.current;(!x||!A||O.current!==q)&&(O.current&&(H==null||H.unobserve(O.current)),H==null||H.observe(q),O.current=q)}},[$,x,A]),v.useEffect(()=>{const q=Z.current!==o,U=F.current!==V,ie=W.current!==B;T.current&&(q||U||ie)&&(q&&(Z.current=o),U&&(F.current=V),ie&&(W.current=B),C.getState().updateNodeDimensions([{id:n,nodeElement:T.current,forceUpdate:!0}]))},[n,o,V,B]);const ge=xo({nodeRef:T,disabled:$||!S,noDragClassName:a,handleSelector:P,nodeId:n,isSelectable:M,selectNodesOnDrag:R});return $?null:N.createElement("div",{className:re(["react-flow__node",`react-flow__node-${o}`,{[b]:S},h,{selected:d,selectable:M,parent:D,dragging:ge}]),ref:T,style:{zIndex:L,transform:`translate(${c}px,${u}px)`,pointerEvents:G?"all":"none",visibility:x?"visible":"hidden",...w},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:J,onMouseMove:j,onMouseLeave:ue,onContextMenu:ce,onClick:ae,onDoubleClick:de,onKeyDown:k?te:void 0,tabIndex:k?0:void 0,role:k?"button":void 0,"aria-describedby":_?void 0:`${co}-${y}`,"aria-label":z},N.createElement(ur,{value:n},N.createElement(e,{id:n,data:s,type:o,xPos:i,yPos:r,selected:d,isConnectable:I,sourcePosition:V,targetPosition:B,dragging:ge,dragHandle:P,zIndex:L})))};return t.displayName="NodeWrapper",v.memo(t)};const qr=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Zt(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Qr({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:s,height:i,x:r,y:c,transformString:u,userSelectionActive:d}=Q(qr,se),l=wo(),f=v.useRef(null);if(v.useEffect(()=>{var E;n||(E=f.current)==null||E.focus({preventScroll:!0})},[n]),xo({nodeRef:f}),d||!s||!i)return null;const m=e?E=>{const p=o.getState().getNodes().filter(w=>w.selected);e(E,p)}:void 0,g=E=>{Object.prototype.hasOwnProperty.call(Ze,E.key)&&l({x:Ze[E.key].x,y:Ze[E.key].y,isShiftPressed:E.shiftKey})};return N.createElement("div",{className:re(["react-flow__nodesselection","react-flow__container",t]),style:{transform:u}},N.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:g,style:{width:s,height:i,top:c,left:r}}))}var Jr=v.memo(Qr);const ei=e=>e.nodesSelectionActive,Eo=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,deleteKeyCode:c,onMove:u,onMoveStart:d,onMoveEnd:l,selectionKeyCode:f,selectionOnDrag:m,selectionMode:g,onSelectionStart:E,onSelectionEnd:p,multiSelectionKeyCode:w,panActivationKeyCode:h,zoomActivationKeyCode:S,elementsSelectable:M,zoomOnScroll:I,zoomOnPinch:k,panOnScroll:R,panOnScrollSpeed:V,panOnScrollMode:B,zoomOnDoubleClick:$,panOnDrag:H,defaultViewport:P,translateExtent:L,minZoom:D,maxZoom:a,preventScrolling:b,onSelectionContextMenu:x,noWheelClassName:_,noPanClassName:z,disableKeyboardA11y:y})=>{const A=Q(ei),C=ct(f),T=ct(h),O=T||H,F=T||R,W=C||m&&O!==!0;return Br({deleteKeyCode:c,multiSelectionKeyCode:w}),N.createElement(Yr,{onMove:u,onMoveStart:d,onMoveEnd:l,onPaneContextMenu:i,elementsSelectable:M,zoomOnScroll:I,zoomOnPinch:k,panOnScroll:F,panOnScrollSpeed:V,panOnScrollMode:B,zoomOnDoubleClick:$,panOnDrag:!C&&O,defaultViewport:P,translateExtent:L,minZoom:D,maxZoom:a,zoomActivationKeyCode:S,preventScrolling:b,noWheelClassName:_,noPanClassName:z},N.createElement(mo,{onSelectionStart:E,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,panOnDrag:O,isSelecting:!!W,selectionMode:g},e,A&&N.createElement(Jr,{onSelectionContextMenu:x,noPanClassName:z,disableKeyboardA11y:y})))};Eo.displayName="FlowRenderer";var ti=v.memo(Eo);function ni(e){return Q(v.useCallback(n=>e?Gn(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function oi(e){const t={input:ot(e.input||oo),default:ot(e.default||Vt),output:ot(e.output||ro),group:ot(e.group||Kt)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=ot(e[i]||Vt),s),n);return{...t,...o}}const si=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},ri=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),So=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:i,onError:r}=Q(ri,se),c=ni(e.onlyRenderVisibleElements),u=v.useRef(),d=v.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const l=new ResizeObserver(f=>{const m=f.map(g=>({id:g.target.getAttribute("data-id"),nodeElement:g.target,forceUpdate:!0}));i(m)});return u.current=l,l},[]);return v.useEffect(()=>()=>{var l;(l=u==null?void 0:u.current)==null||l.disconnect()},[]),N.createElement("div",{className:"react-flow__nodes",style:qt},c.map(l=>{var k,R,V;let f=l.type||"default";e.nodeTypes[f]||(r==null||r("003",xe.error003(f)),f="default");const m=e.nodeTypes[f]||e.nodeTypes.default,g=!!(l.draggable||t&&typeof l.draggable>"u"),E=!!(l.selectable||s&&typeof l.selectable>"u"),p=!!(l.connectable||n&&typeof l.connectable>"u"),w=!!(l.focusable||o&&typeof l.focusable>"u"),h=e.nodeExtent?Ot(l.positionAbsolute,e.nodeExtent):l.positionAbsolute,S=(h==null?void 0:h.x)??0,M=(h==null?void 0:h.y)??0,I=si({x:S,y:M,width:l.width??0,height:l.height??0,origin:e.nodeOrigin});return N.createElement(m,{key:l.id,id:l.id,className:l.className,style:l.style,type:f,data:l.data,sourcePosition:l.sourcePosition||Y.Bottom,targetPosition:l.targetPosition||Y.Top,hidden:l.hidden,xPos:S,yPos:M,xPosOrigin:I.x,yPosOrigin:I.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!l.selected,isDraggable:g,isSelectable:E,isConnectable:p,isFocusable:w,resizeObserver:d,dragHandle:l.dragHandle,zIndex:((k=l[ee])==null?void 0:k.z)??0,isParent:!!((R=l[ee])!=null&&R.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!l.width&&!!l.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:l.ariaLabel,hasHandleBounds:!!((V=l[ee])!=null&&V.handleBounds)})}))};So.displayName="NodeRenderer";var ii=v.memo(So);const ci=(e,t,n)=>n===Y.Left?e-t:n===Y.Right?e+t:e,ai=(e,t,n)=>n===Y.Top?e-t:n===Y.Bottom?e+t:e,vn="react-flow__edgeupdater",Nn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:i,onMouseOut:r,type:c})=>N.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:r,className:re([vn,`${vn}-${c}`]),cx:ci(t,o,e),cy:ai(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),li=()=>!0;var Ue=e=>{const t=({id:n,className:o,type:s,data:i,onClick:r,onEdgeDoubleClick:c,selected:u,animated:d,label:l,labelStyle:f,labelShowBg:m,labelBgStyle:g,labelBgPadding:E,labelBgBorderRadius:p,style:w,source:h,target:S,sourceX:M,sourceY:I,targetX:k,targetY:R,sourcePosition:V,targetPosition:B,elementsSelectable:$,hidden:H,sourceHandleId:P,targetHandleId:L,onContextMenu:D,onMouseEnter:a,onMouseMove:b,onMouseLeave:x,reconnectRadius:_,onReconnect:z,onReconnectStart:y,onReconnectEnd:A,markerEnd:C,markerStart:T,rfId:O,ariaLabel:F,isFocusable:W,isReconnectable:Z,pathOptions:G,interactionWidth:K,disableKeyboardA11y:J})=>{const j=v.useRef(null),[ue,ce]=v.useState(!1),[de,ae]=v.useState(!1),te=ne(),ge=v.useMemo(()=>`url('#${Pt(T,O)}')`,[T,O]),q=v.useMemo(()=>`url('#${Pt(C,O)}')`,[C,O]);if(H)return null;const U=oe=>{var me;const{edges:fe,addSelectedEdges:$e,unselectNodesAndEdges:Ce,multiSelectionActive:ze}=te.getState(),ye=fe.find(Qe=>Qe.id===n);ye&&($&&(te.setState({nodesSelectionActive:!1}),ye.selected&&ze?(Ce({nodes:[],edges:[ye]}),(me=j.current)==null||me.blur()):$e([n])),r&&r(oe,ye))},ie=tt(n,te.getState,c),Me=tt(n,te.getState,D),je=tt(n,te.getState,a),Pe=tt(n,te.getState,b),He=tt(n,te.getState,x),pe=(oe,fe)=>{if(oe.button!==0)return;const{edges:$e,isValidConnection:Ce}=te.getState(),ze=fe?S:h,ye=(fe?L:P)||null,me=fe?"target":"source",Qe=Ce||li,St=fe,Je=$e.find(Te=>Te.id===n);ae(!0),y==null||y(oe,Je,me);const bt=Te=>{ae(!1),A==null||A(Te,Je,me)};Jn({event:oe,handleId:ye,nodeId:ze,onConnect:Te=>z==null?void 0:z(Je,Te),isTarget:St,getState:te.getState,setState:te.setState,isValidConnection:Qe,edgeUpdaterType:me,onReconnectEnd:bt})},Ve=oe=>pe(oe,!0),_e=oe=>pe(oe,!1),Ae=()=>ce(!0),Be=()=>ce(!1),Le=!$&&!r,qe=oe=>{var fe;if(!J&&Fn.includes(oe.key)&&$){const{unselectNodesAndEdges:$e,addSelectedEdges:Ce,edges:ze}=te.getState();oe.key==="Escape"?((fe=j.current)==null||fe.blur(),$e({edges:[ze.find(me=>me.id===n)]})):Ce([n])}};return N.createElement("g",{className:re(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:u,animated:d,inactive:Le,updating:ue}]),onClick:U,onDoubleClick:ie,onContextMenu:Me,onMouseEnter:je,onMouseMove:Pe,onMouseLeave:He,onKeyDown:W?qe:void 0,tabIndex:W?0:void 0,role:W?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":F===null?void 0:F||`Edge from ${h} to ${S}`,"aria-describedby":W?`${ao}-${O}`:void 0,ref:j},!de&&N.createElement(e,{id:n,source:h,target:S,selected:u,animated:d,label:l,labelStyle:f,labelShowBg:m,labelBgStyle:g,labelBgPadding:E,labelBgBorderRadius:p,data:i,style:w,sourceX:M,sourceY:I,targetX:k,targetY:R,sourcePosition:V,targetPosition:B,sourceHandleId:P,targetHandleId:L,markerStart:ge,markerEnd:q,pathOptions:G,interactionWidth:K}),Z&&N.createElement(N.Fragment,null,(Z==="source"||Z===!0)&&N.createElement(Nn,{position:V,centerX:M,centerY:I,radius:_,onMouseDown:Ve,onMouseEnter:Ae,onMouseOut:Be,type:"source"}),(Z==="target"||Z===!0)&&N.createElement(Nn,{position:B,centerX:k,centerY:R,radius:_,onMouseDown:_e,onMouseEnter:Ae,onMouseOut:Be,type:"target"})))};return t.displayName="EdgeWrapper",v.memo(t)};function ui(e){const t={default:Ue(e.default||pt),straight:Ue(e.bezier||Wt),step:Ue(e.step||Ut),smoothstep:Ue(e.step||Et),simplebezier:Ue(e.simplebezier||Yt)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=Ue(e[i]||pt),s),n);return{...t,...o}}function Mn(e,t,n=null){const o=((n==null?void 0:n.x)||0)+t.x,s=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,r=(n==null?void 0:n.height)||t.height;switch(e){case Y.Top:return{x:o+i/2,y:s};case Y.Right:return{x:o+i,y:s+r/2};case Y.Bottom:return{x:o+i/2,y:s+r};case Y.Left:return{x:o,y:s+r/2}}}function _n(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const di=(e,t,n,o,s,i)=>{const r=Mn(n,e,t),c=Mn(i,o,s);return{sourceX:r.x,sourceY:r.y,targetX:c.x,targetY:c.y}};function fi({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:c,transform:u}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const l=rt({x:(0-u[0])/u[2],y:(0-u[1])/u[2],width:r/u[2],height:c/u[2]}),f=Math.max(0,Math.min(l.x2,d.x2)-Math.max(l.x,d.x)),m=Math.max(0,Math.min(l.y2,d.y2)-Math.max(l.y,d.y));return Math.ceil(f*m)>0}function An(e){var o,s,i,r,c;const t=((o=e==null?void 0:e[ee])==null?void 0:o.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((r=e==null?void 0:e.positionAbsolute)==null?void 0:r.x)||0,y:((c=e==null?void 0:e.positionAbsolute)==null?void 0:c.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const hi=[{level:0,isMaxLevel:!0,edges:[]}];function gi(e,t,n=!1){let o=-1;const s=e.reduce((r,c)=>{var l,f;const u=le(c.zIndex);let d=u?c.zIndex:0;if(n){const m=t.get(c.target),g=t.get(c.source),E=c.selected||(m==null?void 0:m.selected)||(g==null?void 0:g.selected),p=Math.max(((l=g==null?void 0:g[ee])==null?void 0:l.z)||0,((f=m==null?void 0:m[ee])==null?void 0:f.z)||0,1e3);d=(u?c.zIndex:0)+(E?p:0)}return r[d]?r[d].push(c):r[d]=[c],o=d>o?d:o,r},{}),i=Object.entries(s).map(([r,c])=>{const u=+r;return{edges:c,level:u,isMaxLevel:u===o}});return i.length===0?hi:i}function mi(e,t,n){const o=Q(v.useCallback(s=>e?s.edges.filter(i=>{const r=t.get(i.source),c=t.get(i.target);return(r==null?void 0:r.width)&&(r==null?void 0:r.height)&&(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&fi({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:c.width,targetHeight:c.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return gi(o,t,n)}const pi=({color:e="none",strokeWidth:t=1})=>N.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),yi=({color:e="none",strokeWidth:t=1})=>N.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),$n={[mt.Arrow]:pi,[mt.ArrowClosed]:yi};function xi(e){const t=ne();return v.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call($n,e)?$n[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",xe.error009(e)),null)},[e])}const wi=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:r,orient:c="auto-start-reverse"})=>{const u=xi(t);return u?N.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:c,refX:"0",refY:"0"},N.createElement(u,{color:n,strokeWidth:r})):null},Ei=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(r=>{if(r&&typeof r=="object"){const c=Pt(r,t);o.includes(c)||(s.push({id:c,color:r.color||e,...r}),o.push(c))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},bo=({defaultColor:e,rfId:t})=>{const n=Q(v.useCallback(Ei({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((i,r)=>i.id!==s[r].id)));return N.createElement("defs",null,n.map(o=>N.createElement(wi,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};bo.displayName="MarkerDefinitions";var Si=v.memo(bo);const bi=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),vo=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:r,onEdgeMouseEnter:c,onEdgeMouseMove:u,onEdgeMouseLeave:d,onEdgeClick:l,onEdgeDoubleClick:f,onReconnect:m,onReconnectStart:g,onReconnectEnd:E,reconnectRadius:p,children:w,disableKeyboardA11y:h})=>{const{edgesFocusable:S,edgesUpdatable:M,elementsSelectable:I,width:k,height:R,connectionMode:V,nodeInternals:B,onError:$}=Q(bi,se),H=mi(t,B,n);return k?N.createElement(N.Fragment,null,H.map(({level:P,edges:L,isMaxLevel:D})=>N.createElement("svg",{key:P,style:{zIndex:P},width:k,height:R,className:"react-flow__edges react-flow__container"},D&&N.createElement(Si,{defaultColor:e,rfId:o}),N.createElement("g",null,L.map(a=>{const[b,x,_]=An(B.get(a.source)),[z,y,A]=An(B.get(a.target));if(!_||!A)return null;let C=a.type||"default";s[C]||($==null||$("011",xe.error011(C)),C="default");const T=s[C]||s.default,O=V===Re.Strict?y.target:(y.target??[]).concat(y.source??[]),F=_n(x.source,a.sourceHandle),W=_n(O,a.targetHandle),Z=(F==null?void 0:F.position)||Y.Bottom,G=(W==null?void 0:W.position)||Y.Top,K=!!(a.focusable||S&&typeof a.focusable>"u"),J=a.reconnectable||a.updatable,j=typeof m<"u"&&(J||M&&typeof J>"u");if(!F||!W)return $==null||$("008",xe.error008(F,a)),null;const{sourceX:ue,sourceY:ce,targetX:de,targetY:ae}=di(b,F,Z,z,W,G);return N.createElement(T,{key:a.id,id:a.id,className:re([a.className,i]),type:C,data:a.data,selected:!!a.selected,animated:!!a.animated,hidden:!!a.hidden,label:a.label,labelStyle:a.labelStyle,labelShowBg:a.labelShowBg,labelBgStyle:a.labelBgStyle,labelBgPadding:a.labelBgPadding,labelBgBorderRadius:a.labelBgBorderRadius,style:a.style,source:a.source,target:a.target,sourceHandleId:a.sourceHandle,targetHandleId:a.targetHandle,markerEnd:a.markerEnd,markerStart:a.markerStart,sourceX:ue,sourceY:ce,targetX:de,targetY:ae,sourcePosition:Z,targetPosition:G,elementsSelectable:I,onContextMenu:r,onMouseEnter:c,onMouseMove:u,onMouseLeave:d,onClick:l,onEdgeDoubleClick:f,onReconnect:m,onReconnectStart:g,onReconnectEnd:E,reconnectRadius:p,rfId:o,ariaLabel:a.ariaLabel,isFocusable:K,isReconnectable:j,pathOptions:"pathOptions"in a?a.pathOptions:void 0,interactionWidth:a.interactionWidth,disableKeyboardA11y:h})})))),w):null};vo.displayName="EdgeRenderer";var vi=v.memo(vo);const Ni=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Mi({children:e}){const t=Q(Ni);return N.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function _i(e){const t=jt(),n=v.useRef(!1);v.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Ai={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top},No=({nodeId:e,handleType:t,style:n,type:o=be.Bezier,CustomComponent:s,connectionStatus:i})=>{var R,V,B;const{fromNode:r,handleId:c,toX:u,toY:d,connectionMode:l}=Q(v.useCallback($=>({fromNode:$.nodeInternals.get(e),handleId:$.connectionHandleId,toX:($.connectionPosition.x-$.transform[0])/$.transform[2],toY:($.connectionPosition.y-$.transform[1])/$.transform[2],connectionMode:$.connectionMode}),[e]),se),f=(R=r==null?void 0:r[ee])==null?void 0:R.handleBounds;let m=f==null?void 0:f[t];if(l===Re.Loose&&(m=m||(f==null?void 0:f[t==="source"?"target":"source"])),!r||!m)return null;const g=c?m.find($=>$.id===c):m[0],E=g?g.x+g.width/2:(r.width??0)/2,p=g?g.y+g.height/2:r.height??0,w=(((V=r.positionAbsolute)==null?void 0:V.x)??0)+E,h=(((B=r.positionAbsolute)==null?void 0:B.y)??0)+p,S=g==null?void 0:g.position,M=S?Ai[S]:null;if(!S||!M)return null;if(s)return N.createElement(s,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:g,fromX:w,fromY:h,toX:u,toY:d,fromPosition:S,toPosition:M,connectionStatus:i});let I="";const k={sourceX:w,sourceY:h,sourcePosition:S,targetX:u,targetY:d,targetPosition:M};return o===be.Bezier?[I]=Xn(k):o===be.Step?[I]=Rt({...k,borderRadius:0}):o===be.SmoothStep?[I]=Rt(k):o===be.SimpleBezier?[I]=Wn(k):I=`M${w},${h} ${u},${d}`,N.createElement("path",{d:I,fill:"none",className:"react-flow__connection-path",style:n})};No.displayName="ConnectionLine";const $i=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Ci({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:i,nodesConnectable:r,width:c,height:u,connectionStatus:d}=Q($i,se);return!(s&&i&&c&&r)?null:N.createElement("svg",{style:e,width:c,height:u,className:"react-flow__edges react-flow__connectionline react-flow__container"},N.createElement("g",{className:re(["react-flow__connection",d])},N.createElement(No,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:d})))}function Cn(e,t){return v.useRef(null),ne(),v.useMemo(()=>t(e),[e])}const Mo=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:i,onNodeClick:r,onEdgeClick:c,onNodeDoubleClick:u,onEdgeDoubleClick:d,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:m,onNodeContextMenu:g,onSelectionContextMenu:E,onSelectionStart:p,onSelectionEnd:w,connectionLineType:h,connectionLineStyle:S,connectionLineComponent:M,connectionLineContainerStyle:I,selectionKeyCode:k,selectionOnDrag:R,selectionMode:V,multiSelectionKeyCode:B,panActivationKeyCode:$,zoomActivationKeyCode:H,deleteKeyCode:P,onlyRenderVisibleElements:L,elementsSelectable:D,selectNodesOnDrag:a,defaultViewport:b,translateExtent:x,minZoom:_,maxZoom:z,preventScrolling:y,defaultMarkerColor:A,zoomOnScroll:C,zoomOnPinch:T,panOnScroll:O,panOnScrollSpeed:F,panOnScrollMode:W,zoomOnDoubleClick:Z,panOnDrag:G,onPaneClick:K,onPaneMouseEnter:J,onPaneMouseMove:j,onPaneMouseLeave:ue,onPaneScroll:ce,onPaneContextMenu:de,onEdgeContextMenu:ae,onEdgeMouseEnter:te,onEdgeMouseMove:ge,onEdgeMouseLeave:q,onReconnect:U,onReconnectStart:ie,onReconnectEnd:Me,reconnectRadius:je,noDragClassName:Pe,noWheelClassName:He,noPanClassName:pe,elevateEdgesOnSelect:Ve,disableKeyboardA11y:_e,nodeOrigin:Ae,nodeExtent:Be,rfId:Le})=>{const qe=Cn(e,oi),oe=Cn(t,ui);return _i(i),N.createElement(ti,{onPaneClick:K,onPaneMouseEnter:J,onPaneMouseMove:j,onPaneMouseLeave:ue,onPaneContextMenu:de,onPaneScroll:ce,deleteKeyCode:P,selectionKeyCode:k,selectionOnDrag:R,selectionMode:V,onSelectionStart:p,onSelectionEnd:w,multiSelectionKeyCode:B,panActivationKeyCode:$,zoomActivationKeyCode:H,elementsSelectable:D,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:C,zoomOnPinch:T,zoomOnDoubleClick:Z,panOnScroll:O,panOnScrollSpeed:F,panOnScrollMode:W,panOnDrag:G,defaultViewport:b,translateExtent:x,minZoom:_,maxZoom:z,onSelectionContextMenu:E,preventScrolling:y,noDragClassName:Pe,noWheelClassName:He,noPanClassName:pe,disableKeyboardA11y:_e},N.createElement(Mi,null,N.createElement(vi,{edgeTypes:oe,onEdgeClick:c,onEdgeDoubleClick:d,onlyRenderVisibleElements:L,onEdgeContextMenu:ae,onEdgeMouseEnter:te,onEdgeMouseMove:ge,onEdgeMouseLeave:q,onReconnect:U,onReconnectStart:ie,onReconnectEnd:Me,reconnectRadius:je,defaultMarkerColor:A,noPanClassName:pe,elevateEdgesOnSelect:!!Ve,disableKeyboardA11y:_e,rfId:Le},N.createElement(Ci,{style:S,type:h,component:M,containerStyle:I})),N.createElement("div",{className:"react-flow__edgelabel-renderer"}),N.createElement(ii,{nodeTypes:qe,onNodeClick:r,onNodeDoubleClick:u,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:m,onNodeContextMenu:g,selectNodesOnDrag:a,onlyRenderVisibleElements:L,noPanClassName:pe,noDragClassName:Pe,disableKeyboardA11y:_e,nodeOrigin:Ae,nodeExtent:Be,rfId:Le})))};Mo.displayName="GraphView";var zi=v.memo(Mo);const Lt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],we={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Lt,nodeExtent:Lt,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Re.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:sr,isValidConnection:void 0},Ti=()=>qs((e,t)=>({...we,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:Ct(n,o,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",i=typeof o<"u",r=s?Ct(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?o:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:c,domNode:u,nodeOrigin:d}=t(),l=u==null?void 0:u.querySelector(".react-flow__viewport");if(!l)return;const f=window.getComputedStyle(l),{m22:m}=new window.DOMMatrixReadOnly(f.transform),g=n.reduce((p,w)=>{const h=s.get(w.id);if(h!=null&&h.hidden)s.set(h.id,{...h,[ee]:{...h[ee],handleBounds:void 0}});else if(h){const S=Ft(w.nodeElement);!!(S.width&&S.height&&(h.width!==S.width||h.height!==S.height||w.forceUpdate))&&(s.set(h.id,{...h,[ee]:{...h[ee],handleBounds:{source:bn(".source",w.nodeElement,m,d),target:bn(".target",w.nodeElement,m,d)}},...S}),p.push({id:h.id,type:"dimensions",dimensions:S}))}return p},[]);uo(s,d);const E=r||i&&!r&&fo(t,{initial:!0,...c});e({nodeInternals:new Map(s),fitViewOnInitDone:E}),(g==null?void 0:g.length)>0&&(o==null||o(g))},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),r=n.map(c=>{const u={id:c.id,type:"position",dragging:s};return o&&(u.positionAbsolute=c.positionAbsolute,u.position=c.position),u});i(r)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:r,getNodes:c,elevateNodesOnSelect:u}=t();if(n!=null&&n.length){if(i){const d=go(n,c()),l=Ct(d,s,r,u);e({nodeInternals:l})}o==null||o(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(u=>Se(u,!0)):(r=We(i(),n),c=We(s,[])),ft({changedNodes:r,changedEdges:c,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(u=>Se(u,!0)):(r=We(s,n),c=We(i(),[])),ft({changedNodes:c,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:i}=t(),r=n||i(),c=o||s,u=r.map(l=>(l.selected=!1,Se(l.id,!1))),d=c.map(l=>Se(l.id,!1));ft({changedNodes:u,changedEdges:d,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o==null||o.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o==null||o.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{var o;(o=t().d3Zoom)==null||o.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(c=>c.selected).map(c=>Se(c.id,!1)),r=n.filter(c=>c.selected).map(c=>Se(c.id,!1));ft({changedNodes:i,changedEdges:r,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=Ot(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:i,d3Zoom:r,d3Selection:c,translateExtent:u}=t();if(!r||!c||!n.x&&!n.y)return!1;const d=ve.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),l=[[0,0],[s,i]],f=r==null?void 0:r.constrain()(d,l,u);return r.transform(c,f),o[0]!==f.x||o[1]!==f.y||o[2]!==f.k},cancelConnection:()=>e({connectionNodeId:we.connectionNodeId,connectionHandleId:we.connectionHandleId,connectionHandleType:we.connectionHandleType,connectionStatus:we.connectionStatus,connectionStartHandle:we.connectionStartHandle,connectionEndHandle:we.connectionEndHandle}),reset:()=>e({...we})}),Object.is),_o=({children:e})=>{const t=v.useRef(null);return t.current||(t.current=Ti()),N.createElement(Qs,{value:t.current},e)};_o.displayName="ReactFlowProvider";const Ao=({children:e})=>v.useContext(wt)?N.createElement(N.Fragment,null,e):N.createElement(_o,null,e);Ao.displayName="ReactFlowWrapper";const Ii={input:oo,default:Vt,output:ro,group:Kt},ki={default:pt,straight:Wt,step:Ut,smoothstep:Et,simplebezier:Yt},Di=[0,0],Ri=[15,15],Pi={x:0,y:0,zoom:1},Hi={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Vi=v.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:i=Ii,edgeTypes:r=ki,onNodeClick:c,onEdgeClick:u,onInit:d,onMove:l,onMoveStart:f,onMoveEnd:m,onConnect:g,onConnectStart:E,onConnectEnd:p,onClickConnectStart:w,onClickConnectEnd:h,onNodeMouseEnter:S,onNodeMouseMove:M,onNodeMouseLeave:I,onNodeContextMenu:k,onNodeDoubleClick:R,onNodeDragStart:V,onNodeDrag:B,onNodeDragStop:$,onNodesDelete:H,onEdgesDelete:P,onSelectionChange:L,onSelectionDragStart:D,onSelectionDrag:a,onSelectionDragStop:b,onSelectionContextMenu:x,onSelectionStart:_,onSelectionEnd:z,connectionMode:y=Re.Strict,connectionLineType:A=be.Bezier,connectionLineStyle:C,connectionLineComponent:T,connectionLineContainerStyle:O,deleteKeyCode:F="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:Z=!1,selectionMode:G=it.Full,panActivationKeyCode:K="Space",multiSelectionKeyCode:J=gt()?"Meta":"Control",zoomActivationKeyCode:j=gt()?"Meta":"Control",snapToGrid:ue=!1,snapGrid:ce=Ri,onlyRenderVisibleElements:de=!1,selectNodesOnDrag:ae=!0,nodesDraggable:te,nodesConnectable:ge,nodesFocusable:q,nodeOrigin:U=Di,edgesFocusable:ie,edgesUpdatable:Me,elementsSelectable:je,defaultViewport:Pe=Pi,minZoom:He=.5,maxZoom:pe=2,translateExtent:Ve=Lt,preventScrolling:_e=!0,nodeExtent:Ae,defaultMarkerColor:Be="#b1b1b7",zoomOnScroll:Le=!0,zoomOnPinch:qe=!0,panOnScroll:oe=!1,panOnScrollSpeed:fe=.5,panOnScrollMode:$e=De.Free,zoomOnDoubleClick:Ce=!0,panOnDrag:ze=!0,onPaneClick:ye,onPaneMouseEnter:me,onPaneMouseMove:Qe,onPaneMouseLeave:St,onPaneScroll:Je,onPaneContextMenu:bt,children:Qt,onEdgeContextMenu:Te,onEdgeDoubleClick:To,onEdgeMouseEnter:Io,onEdgeMouseMove:ko,onEdgeMouseLeave:Do,onEdgeUpdate:Ro,onEdgeUpdateStart:Po,onEdgeUpdateEnd:Ho,onReconnect:Vo,onReconnectStart:Bo,onReconnectEnd:Lo,reconnectRadius:Fo=10,edgeUpdaterRadius:Oo=10,onNodesChange:Yo,onEdgesChange:Uo,noDragClassName:Wo="nodrag",noWheelClassName:Xo="nowheel",noPanClassName:Jt="nopan",fitView:Zo=!1,fitViewOptions:Go,connectOnClick:Ko=!0,attributionPosition:jo,proOptions:qo,defaultEdgeOptions:Qo,elevateNodesOnSelect:Jo=!0,elevateEdgesOnSelect:es=!1,disableKeyboardA11y:en=!1,autoPanOnConnect:ts=!0,autoPanOnNodeDrag:ns=!0,connectionRadius:os=20,isValidConnection:ss,onError:rs,style:is,id:tn,nodeDragThreshold:cs,...as},ls)=>{const vt=tn||"1";return N.createElement("div",{...as,style:{...is,...Hi},ref:ls,className:re(["react-flow",s]),"data-testid":"rf__wrapper",id:tn},N.createElement(Ao,null,N.createElement(zi,{onInit:d,onMove:l,onMoveStart:f,onMoveEnd:m,onNodeClick:c,onEdgeClick:u,onNodeMouseEnter:S,onNodeMouseMove:M,onNodeMouseLeave:I,onNodeContextMenu:k,onNodeDoubleClick:R,nodeTypes:i,edgeTypes:r,connectionLineType:A,connectionLineStyle:C,connectionLineComponent:T,connectionLineContainerStyle:O,selectionKeyCode:W,selectionOnDrag:Z,selectionMode:G,deleteKeyCode:F,multiSelectionKeyCode:J,panActivationKeyCode:K,zoomActivationKeyCode:j,onlyRenderVisibleElements:de,selectNodesOnDrag:ae,defaultViewport:Pe,translateExtent:Ve,minZoom:He,maxZoom:pe,preventScrolling:_e,zoomOnScroll:Le,zoomOnPinch:qe,zoomOnDoubleClick:Ce,panOnScroll:oe,panOnScrollSpeed:fe,panOnScrollMode:$e,panOnDrag:ze,onPaneClick:ye,onPaneMouseEnter:me,onPaneMouseMove:Qe,onPaneMouseLeave:St,onPaneScroll:Je,onPaneContextMenu:bt,onSelectionContextMenu:x,onSelectionStart:_,onSelectionEnd:z,onEdgeContextMenu:Te,onEdgeDoubleClick:To,onEdgeMouseEnter:Io,onEdgeMouseMove:ko,onEdgeMouseLeave:Do,onReconnect:Vo??Ro,onReconnectStart:Bo??Po,onReconnectEnd:Lo??Ho,reconnectRadius:Fo??Oo,defaultMarkerColor:Be,noDragClassName:Wo,noWheelClassName:Xo,noPanClassName:Jt,elevateEdgesOnSelect:es,rfId:vt,disableKeyboardA11y:en,nodeOrigin:U,nodeExtent:Ae}),N.createElement(Ar,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:g,onConnectStart:E,onConnectEnd:p,onClickConnectStart:w,onClickConnectEnd:h,nodesDraggable:te,nodesConnectable:ge,nodesFocusable:q,edgesFocusable:ie,edgesUpdatable:Me,elementsSelectable:je,elevateNodesOnSelect:Jo,minZoom:He,maxZoom:pe,nodeExtent:Ae,onNodesChange:Yo,onEdgesChange:Uo,snapToGrid:ue,snapGrid:ce,connectionMode:y,translateExtent:Ve,connectOnClick:Ko,defaultEdgeOptions:Qo,fitView:Zo,fitViewOptions:Go,onNodesDelete:H,onEdgesDelete:P,onNodeDragStart:V,onNodeDrag:B,onNodeDragStop:$,onSelectionDrag:a,onSelectionDragStart:D,onSelectionDragStop:b,noPanClassName:Jt,nodeOrigin:U,rfId:vt,autoPanOnConnect:ts,autoPanOnNodeDrag:ns,onError:rs,connectionRadius:os,isValidConnection:ss,nodeDragThreshold:cs}),N.createElement(Mr,{onSelectionChange:L}),Qt,N.createElement(er,{proOptions:qo,position:jo}),N.createElement(Ir,{rfId:vt,disableKeyboardA11y:en})))});Vi.displayName="ReactFlow";function $o(e){return t=>{const[n,o]=v.useState(t),s=v.useCallback(i=>o(r=>e(i,r)),[]);return[n,o,s]}}const Ji=$o(go),ec=$o(Xr);function Bi(){return N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},N.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Li(){return N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},N.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Fi(){return N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},N.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Oi(){return N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},N.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Yi(){return N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},N.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const st=({children:e,className:t,...n})=>N.createElement("button",{type:"button",className:re(["react-flow__controls-button",t]),...n},e);st.displayName="ControlButton";const Ui=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Co=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:i,onZoomOut:r,onFitView:c,onInteractiveChange:u,className:d,children:l,position:f="bottom-left"})=>{const m=ne(),[g,E]=v.useState(!1),{isInteractive:p,minZoomReached:w,maxZoomReached:h}=Q(Ui,se),{zoomIn:S,zoomOut:M,fitView:I}=jt();if(v.useEffect(()=>{E(!0)},[]),!g)return null;const k=()=>{S(),i==null||i()},R=()=>{M(),r==null||r()},V=()=>{I(s),c==null||c()},B=()=>{m.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),u==null||u(!p)};return N.createElement(Pn,{className:re(["react-flow__controls",d]),position:f,style:e,"data-testid":"rf__controls"},t&&N.createElement(N.Fragment,null,N.createElement(st,{onClick:k,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:h},N.createElement(Bi,null)),N.createElement(st,{onClick:R,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:w},N.createElement(Li,null))),n&&N.createElement(st,{className:"react-flow__controls-fitview",onClick:V,title:"fit view","aria-label":"fit view"},N.createElement(Fi,null)),o&&N.createElement(st,{className:"react-flow__controls-interactive",onClick:B,title:"toggle interactivity","aria-label":"toggle interactivity"},p?N.createElement(Yi,null):N.createElement(Oi,null)),l)};Co.displayName="Controls";var tc=v.memo(Co),he;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(he||(he={}));function Wi({color:e,dimensions:t,lineWidth:n}){return N.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Xi({color:e,radius:t}){return N.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Zi={[he.Dots]:"#91919a",[he.Lines]:"#eee",[he.Cross]:"#e2e2e2"},Gi={[he.Dots]:1,[he.Lines]:1,[he.Cross]:6},Ki=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function zo({id:e,variant:t=he.Dots,gap:n=20,size:o,lineWidth:s=1,offset:i=2,color:r,style:c,className:u}){const d=v.useRef(null),{transform:l,patternId:f}=Q(Ki,se),m=r||Zi[t],g=o||Gi[t],E=t===he.Dots,p=t===he.Cross,w=Array.isArray(n)?n:[n,n],h=[w[0]*l[2]||1,w[1]*l[2]||1],S=g*l[2],M=p?[S,S]:h,I=E?[S/i,S/i]:[M[0]/i,M[1]/i];return N.createElement("svg",{className:re(["react-flow__background",u]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:d,"data-testid":"rf__background"},N.createElement("pattern",{id:f+e,x:l[0]%h[0],y:l[1]%h[1],width:h[0],height:h[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${I[0]},-${I[1]})`},E?N.createElement(Xi,{color:m,radius:S/i}):N.createElement(Wi,{dimensions:M,color:m,lineWidth:s})),N.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}zo.displayName="Background";var nc=v.memo(zo);export{nc as B,tc as C,Pn as P,Vi as R,ec as a,ne as b,Q as c,re as d,Qi as e,Zt as f,Xe as g,se as s,Ji as u,Rs as z};

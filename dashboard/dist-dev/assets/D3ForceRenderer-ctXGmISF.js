import{r as H,j as B}from"./index-CFNaiXDE.js";import{t as X,d as Y,s as k,c as G}from"./transform-CHVD-xw7.js";import{o as J}from"./ordinal-DILIJJjt.js";import{c as K}from"./colors-Cc3OSVma.js";import"./string-DhfnsSdB.js";import"./init-Dmth1JHB.js";function F(t,n){var e,f=1;t==null&&(t=0),n==null&&(n=0);function a(){var i,l=e.length,c,v=0,s=0;for(i=0;i<l;++i)c=e[i],v+=c.x,s+=c.y;for(v=(v/l-t)*f,s=(s/l-n)*f,i=0;i<l;++i)c=e[i],c.x-=v,c.y-=s}return a.initialize=function(i){e=i},a.x=function(i){return arguments.length?(t=+i,a):t},a.y=function(i){return arguments.length?(n=+i,a):n},a.strength=function(i){return arguments.length?(f=+i,a):f},a}function O(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return C(this.cover(n,e),n,e,t)}function C(t,n,e,f){if(isNaN(n)||isNaN(e))return t;var a,i=t._root,l={data:f},c=t._x0,v=t._y0,s=t._x1,g=t._y1,_,y,h,d,u,o,r,x;if(!i)return t._root=l,t;for(;i.length;)if((u=n>=(_=(c+s)/2))?c=_:s=_,(o=e>=(y=(v+g)/2))?v=y:g=y,a=i,!(i=i[r=o<<1|u]))return a[r]=l,t;if(h=+t._x.call(null,i.data),d=+t._y.call(null,i.data),n===h&&e===d)return l.next=i,a?a[r]=l:t._root=l,t;do a=a?a[r]=new Array(4):t._root=new Array(4),(u=n>=(_=(c+s)/2))?c=_:s=_,(o=e>=(y=(v+g)/2))?v=y:g=y;while((r=o<<1|u)===(x=(d>=y)<<1|h>=_));return a[x]=i,a[r]=l,t}function U(t){var n,e,f=t.length,a,i,l=new Array(f),c=new Array(f),v=1/0,s=1/0,g=-1/0,_=-1/0;for(e=0;e<f;++e)isNaN(a=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(l[e]=a,c[e]=i,a<v&&(v=a),a>g&&(g=a),i<s&&(s=i),i>_&&(_=i));if(v>g||s>_)return this;for(this.cover(v,s).cover(g,_),e=0;e<f;++e)C(this,l[e],c[e],t[e]);return this}function V(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,f=this._y0,a=this._x1,i=this._y1;if(isNaN(e))a=(e=Math.floor(t))+1,i=(f=Math.floor(n))+1;else{for(var l=a-e||1,c=this._root,v,s;e>t||t>=a||f>n||n>=i;)switch(s=(n<f)<<1|t<e,v=new Array(4),v[s]=c,c=v,l*=2,s){case 0:a=e+l,i=f+l;break;case 1:e=a-l,i=f+l;break;case 2:a=e+l,f=i-l;break;case 3:e=a-l,f=i-l;break}this._root&&this._root.length&&(this._root=c)}return this._x0=e,this._y0=f,this._x1=a,this._y1=i,this}function Z(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function q(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function b(t,n,e,f,a){this.node=t,this.x0=n,this.y0=e,this.x1=f,this.y1=a}function tt(t,n,e){var f,a=this._x0,i=this._y0,l,c,v,s,g=this._x1,_=this._y1,y=[],h=this._root,d,u;for(h&&y.push(new b(h,a,i,g,_)),e==null?e=1/0:(a=t-e,i=n-e,g=t+e,_=n+e,e*=e);d=y.pop();)if(!(!(h=d.node)||(l=d.x0)>g||(c=d.y0)>_||(v=d.x1)<a||(s=d.y1)<i))if(h.length){var o=(l+v)/2,r=(c+s)/2;y.push(new b(h[3],o,r,v,s),new b(h[2],l,r,o,s),new b(h[1],o,c,v,r),new b(h[0],l,c,o,r)),(u=(n>=r)<<1|t>=o)&&(d=y[y.length-1],y[y.length-1]=y[y.length-1-u],y[y.length-1-u]=d)}else{var x=t-+this._x.call(null,h.data),w=n-+this._y.call(null,h.data),p=x*x+w*w;if(p<e){var m=Math.sqrt(e=p);a=t-m,i=n-m,g=t+m,_=n+m,f=h.data}}return f}function nt(t){if(isNaN(g=+this._x.call(null,t))||isNaN(_=+this._y.call(null,t)))return this;var n,e=this._root,f,a,i,l=this._x0,c=this._y0,v=this._x1,s=this._y1,g,_,y,h,d,u,o,r;if(!e)return this;if(e.length)for(;;){if((d=g>=(y=(l+v)/2))?l=y:v=y,(u=_>=(h=(c+s)/2))?c=h:s=h,n=e,!(e=e[o=u<<1|d]))return this;if(!e.length)break;(n[o+1&3]||n[o+2&3]||n[o+3&3])&&(f=n,r=o)}for(;e.data!==t;)if(a=e,!(e=e.next))return this;return(i=e.next)&&delete e.next,a?(i?a.next=i:delete a.next,this):n?(i?n[o]=i:delete n[o],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(f?f[r]=e:this._root=e),this):(this._root=i,this)}function et(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function rt(){return this._root}function it(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function at(t){var n=[],e,f=this._root,a,i,l,c,v;for(f&&n.push(new b(f,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(f=e.node,i=e.x0,l=e.y0,c=e.x1,v=e.y1)&&f.length){var s=(i+c)/2,g=(l+v)/2;(a=f[3])&&n.push(new b(a,s,g,c,v)),(a=f[2])&&n.push(new b(a,i,g,s,v)),(a=f[1])&&n.push(new b(a,s,l,c,g)),(a=f[0])&&n.push(new b(a,i,l,s,g))}return this}function ot(t){var n=[],e=[],f;for(this._root&&n.push(new b(this._root,this._x0,this._y0,this._x1,this._y1));f=n.pop();){var a=f.node;if(a.length){var i,l=f.x0,c=f.y0,v=f.x1,s=f.y1,g=(l+v)/2,_=(c+s)/2;(i=a[0])&&n.push(new b(i,l,c,g,_)),(i=a[1])&&n.push(new b(i,g,c,v,_)),(i=a[2])&&n.push(new b(i,l,_,g,s)),(i=a[3])&&n.push(new b(i,g,_,v,s))}e.push(f)}for(;f=e.pop();)t(f.node,f.x0,f.y0,f.x1,f.y1);return this}function ft(t){return t[0]}function st(t){return arguments.length?(this._x=t,this):this._x}function ut(t){return t[1]}function lt(t){return arguments.length?(this._y=t,this):this._y}function T(t,n,e){var f=new W(n??ft,e??ut,NaN,NaN,NaN,NaN);return t==null?f:f.addAll(t)}function W(t,n,e,f,a,i){this._x=t,this._y=n,this._x0=e,this._y0=f,this._x1=a,this._y1=i,this._root=void 0}function L(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var j=T.prototype=W.prototype;j.copy=function(){var t=new W(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,f;if(!n)return t;if(!n.length)return t._root=L(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var a=0;a<4;++a)(f=n.source[a])&&(f.length?e.push({source:f,target:n.target[a]=new Array(4)}):n.target[a]=L(f));return t};j.add=O;j.addAll=U;j.cover=V;j.data=Z;j.extent=q;j.find=tt;j.remove=nt;j.removeAll=et;j.root=rt;j.size=it;j.visit=at;j.visitAfter=ot;j.x=st;j.y=lt;function S(t){return function(){return t}}function $(t){return(t()-.5)*1e-6}function ht(t){return t.x+t.vx}function ct(t){return t.y+t.vy}function gt(t){var n,e,f,a=1,i=1;typeof t!="function"&&(t=S(t==null?1:+t));function l(){for(var s,g=n.length,_,y,h,d,u,o,r=0;r<i;++r)for(_=T(n,ht,ct).visitAfter(c),s=0;s<g;++s)y=n[s],u=e[y.index],o=u*u,h=y.x+y.vx,d=y.y+y.vy,_.visit(x);function x(w,p,m,M,z){var N=w.data,E=w.r,A=u+E;if(N){if(N.index>y.index){var I=h-N.x-N.vx,R=d-N.y-N.vy,D=I*I+R*R;D<A*A&&(I===0&&(I=$(f),D+=I*I),R===0&&(R=$(f),D+=R*R),D=(A-(D=Math.sqrt(D)))/D*a,y.vx+=(I*=D)*(A=(E*=E)/(o+E)),y.vy+=(R*=D)*A,N.vx-=I*(A=1-A),N.vy-=R*A)}return}return p>h+A||M<h-A||m>d+A||z<d-A}}function c(s){if(s.data)return s.r=e[s.data.index];for(var g=s.r=0;g<4;++g)s[g]&&s[g].r>s.r&&(s.r=s[g].r)}function v(){if(n){var s,g=n.length,_;for(e=new Array(g),s=0;s<g;++s)_=n[s],e[_.index]=+t(_,s,n)}}return l.initialize=function(s,g){n=s,f=g,v()},l.iterations=function(s){return arguments.length?(i=+s,l):i},l.strength=function(s){return arguments.length?(a=+s,l):a},l.radius=function(s){return arguments.length?(t=typeof s=="function"?s:S(+s),v(),l):t},l}function xt(t){return t.index}function P(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function yt(t){var n=xt,e=_,f,a=S(30),i,l,c,v,s,g=1;t==null&&(t=[]);function _(o){return 1/Math.min(c[o.source.index],c[o.target.index])}function y(o){for(var r=0,x=t.length;r<g;++r)for(var w=0,p,m,M,z,N,E,A;w<x;++w)p=t[w],m=p.source,M=p.target,z=M.x+M.vx-m.x-m.vx||$(s),N=M.y+M.vy-m.y-m.vy||$(s),E=Math.sqrt(z*z+N*N),E=(E-i[w])/E*o*f[w],z*=E,N*=E,M.vx-=z*(A=v[w]),M.vy-=N*A,m.vx+=z*(A=1-A),m.vy+=N*A}function h(){if(l){var o,r=l.length,x=t.length,w=new Map(l.map((m,M)=>[n(m,M,l),m])),p;for(o=0,c=new Array(r);o<x;++o)p=t[o],p.index=o,typeof p.source!="object"&&(p.source=P(w,p.source)),typeof p.target!="object"&&(p.target=P(w,p.target)),c[p.source.index]=(c[p.source.index]||0)+1,c[p.target.index]=(c[p.target.index]||0)+1;for(o=0,v=new Array(x);o<x;++o)p=t[o],v[o]=c[p.source.index]/(c[p.source.index]+c[p.target.index]);f=new Array(x),d(),i=new Array(x),u()}}function d(){if(l)for(var o=0,r=t.length;o<r;++o)f[o]=+e(t[o],o,t)}function u(){if(l)for(var o=0,r=t.length;o<r;++o)i[o]=+a(t[o],o,t)}return y.initialize=function(o,r){l=o,s=r,h()},y.links=function(o){return arguments.length?(t=o,h(),y):t},y.id=function(o){return arguments.length?(n=o,y):n},y.iterations=function(o){return arguments.length?(g=+o,y):g},y.strength=function(o){return arguments.length?(e=typeof o=="function"?o:S(+o),d(),y):e},y.distance=function(o){return arguments.length?(a=typeof o=="function"?o:S(+o),u(),y):a},y}const vt=1664525,pt=1013904223,Q=4294967296;function dt(){let t=1;return()=>(t=(vt*t+pt)%Q)/Q}function _t(t){return t.x}function wt(t){return t.y}var mt=10,Nt=Math.PI*(3-Math.sqrt(5));function At(t){var n,e=1,f=.001,a=1-Math.pow(f,1/300),i=0,l=.6,c=new Map,v=X(_),s=Y("tick","end"),g=dt();t==null&&(t=[]);function _(){y(),s.call("tick",n),e<f&&(v.stop(),s.call("end",n))}function y(u){var o,r=t.length,x;u===void 0&&(u=1);for(var w=0;w<u;++w)for(e+=(i-e)*a,c.forEach(function(p){p(e)}),o=0;o<r;++o)x=t[o],x.fx==null?x.x+=x.vx*=l:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=l:(x.y=x.fy,x.vy=0);return n}function h(){for(var u=0,o=t.length,r;u<o;++u){if(r=t[u],r.index=u,r.fx!=null&&(r.x=r.fx),r.fy!=null&&(r.y=r.fy),isNaN(r.x)||isNaN(r.y)){var x=mt*Math.sqrt(.5+u),w=u*Nt;r.x=x*Math.cos(w),r.y=x*Math.sin(w)}(isNaN(r.vx)||isNaN(r.vy))&&(r.vx=r.vy=0)}}function d(u){return u.initialize&&u.initialize(t,g),u}return h(),n={tick:y,restart:function(){return v.restart(_),n},stop:function(){return v.stop(),n},nodes:function(u){return arguments.length?(t=u,h(),c.forEach(d),n):t},alpha:function(u){return arguments.length?(e=+u,n):e},alphaMin:function(u){return arguments.length?(f=+u,n):f},alphaDecay:function(u){return arguments.length?(a=+u,n):+a},alphaTarget:function(u){return arguments.length?(i=+u,n):i},velocityDecay:function(u){return arguments.length?(l=1-u,n):1-l},randomSource:function(u){return arguments.length?(g=u,c.forEach(d),n):g},force:function(u,o){return arguments.length>1?(o==null?c.delete(u):c.set(u,d(o)),n):c.get(u)},find:function(u,o,r){var x=0,w=t.length,p,m,M,z,N;for(r==null?r=1/0:r*=r,x=0;x<w;++x)z=t[x],p=u-z.x,m=o-z.y,M=p*p+m*m,M<r&&(N=z,r=M);return N},on:function(u,o){return arguments.length>1?(s.on(u,o),n):s.on(u)}}}function Mt(){var t,n,e,f,a=S(-30),i,l=1,c=1/0,v=.81;function s(h){var d,u=t.length,o=T(t,_t,wt).visitAfter(_);for(f=h,d=0;d<u;++d)n=t[d],o.visit(y)}function g(){if(t){var h,d=t.length,u;for(i=new Array(d),h=0;h<d;++h)u=t[h],i[u.index]=+a(u,h,t)}}function _(h){var d=0,u,o,r=0,x,w,p;if(h.length){for(x=w=p=0;p<4;++p)(u=h[p])&&(o=Math.abs(u.value))&&(d+=u.value,r+=o,x+=o*u.x,w+=o*u.y);h.x=x/r,h.y=w/r}else{u=h,u.x=u.data.x,u.y=u.data.y;do d+=i[u.data.index];while(u=u.next)}h.value=d}function y(h,d,u,o){if(!h.value)return!0;var r=h.x-n.x,x=h.y-n.y,w=o-d,p=r*r+x*x;if(w*w/v<p)return p<c&&(r===0&&(r=$(e),p+=r*r),x===0&&(x=$(e),p+=x*x),p<l&&(p=Math.sqrt(l*p)),n.vx+=r*h.value*f/p,n.vy+=x*h.value*f/p),!0;if(h.length||p>=c)return;(h.data!==n||h.next)&&(r===0&&(r=$(e),p+=r*r),x===0&&(x=$(e),p+=x*x),p<l&&(p=Math.sqrt(l*p)));do h.data!==n&&(w=i[h.data.index]*f/p,n.vx+=r*w,n.vy+=x*w);while(h=h.next)}return s.initialize=function(h,d){t=h,e=d,g()},s.strength=function(h){return arguments.length?(a=typeof h=="function"?h:S(+h),g(),s):a},s.distanceMin=function(h){return arguments.length?(l=h*h,s):Math.sqrt(l)},s.distanceMax=function(h){return arguments.length?(c=h*h,s):Math.sqrt(c)},s.theta=function(h){return arguments.length?(v=h*h,s):Math.sqrt(v)},s}const bt=K("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function $t({nodes:t,links:n}){const e=H.useRef(null),f=H.useRef(null);return H.useEffect(()=>{if(!e.current||!f.current)return;const a=k(e.current);try{a.selectAll("*").remove()}catch{}let i=f.current.clientWidth||800,l=f.current.clientHeight||600;a.attr("width",i).attr("height",l);const c=t.map(r=>({...r})),v=n.map(r=>({...r})),s=J(bt),g=At(c).force("link",yt(v).id(r=>r.id).distance(100)).force("charge",Mt().strength(-300)).force("center",F(i/2,l/2)).force("collision",gt().radius(30)),_=a.append("g").attr("class","links").selectAll("line").data(v).enter().append("line").attr("stroke","#64748b").attr("stroke-opacity",.6).attr("stroke-width",r=>Math.sqrt((r.value||1)*2)),y=a.append("g").attr("class","nodes").selectAll("g").data(c).enter().append("g").call(G().on("start",h).on("drag",d).on("end",u));y.append("circle").attr("r",10).attr("fill",r=>s(String(r.group||0))),y.append("text").text(r=>r.label).attr("x",15).attr("y",4).attr("font-size","12px").attr("fill","#f1f5f9"),g.on("tick",()=>{_.attr("x1",r=>r.source.x||0).attr("y1",r=>r.source.y||0).attr("x2",r=>r.target.x||0).attr("y2",r=>r.target.y||0),y.attr("transform",r=>`translate(${r.x||0},${r.y||0})`)});function h(r){r.active||g.alphaTarget(.3).restart(),r.subject.fx=r.subject.x,r.subject.fy=r.subject.y}function d(r){r.subject.fx=r.x,r.subject.fy=r.y}function u(r){r.active||g.alphaTarget(0),r.subject.fx=null,r.subject.fy=null}const o=()=>{if(!f.current)return;const r=f.current.clientWidth||800,x=f.current.clientHeight||600;(r!==i||x!==l)&&(i=r,l=x,a.attr("width",i).attr("height",l),g.force("center",F(i/2,l/2)),g.alpha(.3).restart())};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o),g.stop();try{a.selectAll("*").remove()}catch{}}},[t,n]),B.jsx("div",{ref:f,className:"w-full h-full",style:{minHeight:"400px",backgroundColor:"#0f172a"},children:B.jsx("svg",{ref:e,className:"w-full h-full"})})}export{$t as D3ForceRenderer,$t as default};

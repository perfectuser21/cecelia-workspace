import{r as d,d as f,j as e,a5 as g,s as h,al as N,am as k,R as b}from"./index-CFNaiXDE.js";import{D as u}from"./DynamicIcon-Cx6arfO6.js";import{b as v}from"./ai-employees.api-CcVkbhs4.js";function y({department:s,defaultExpanded:m=!1}){const[r,x]=d.useState(m),o=f(),n=s.employees.length,l=n>0;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>l&&x(!r),disabled:!l,className:`w-full flex items-center justify-between p-4 text-left transition-colors ${l?"hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer":"cursor-default opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(u,{name:s.icon,className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-slate-800 dark:text-white flex items-center gap-2",children:[s.name,e.jsxs("span",{className:"text-sm font-normal text-slate-500 dark:text-slate-400",children:["(",n,"人)"]})]}),s.description&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.todayTotal>0&&e.jsxs("span",{className:"text-sm text-blue-600 dark:text-blue-400",children:["今日 ",s.todayTotal," 次任务"]}),l&&(r?e.jsx(g,{className:"w-5 h-5 text-slate-400"}):e.jsx(h,{className:"w-5 h-5 text-slate-400"}))]})]}),r&&l&&e.jsx("div",{className:"border-t border-slate-100 dark:border-slate-700",children:s.employees.map((a,c)=>e.jsxs("button",{onClick:()=>o(`/ai-employees/${a.id}`),className:`w-full flex items-center justify-between p-4 text-left hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors ${c>0?"border-t border-slate-100 dark:border-slate-700":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-slate-100 dark:bg-slate-700 flex items-center justify-center",children:e.jsx(u,{name:a.icon,className:"w-4 h-4 text-slate-600 dark:text-slate-300"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800 dark:text-white",children:a.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:a.role})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.stats.todayRunning>0?e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-full",children:"工作中"}):a.stats.todayTotal>0?e.jsxs("span",{className:"text-xs px-2 py-1 bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 rounded-full",children:["今日 ",a.stats.todayTotal," 次"]}):e.jsx("span",{className:"text-xs px-2 py-1 bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 rounded-full",children:"空闲"}),e.jsx(h,{className:"w-4 h-4 text-slate-400"})]})]},a.id))}),!l&&e.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-700 p-6 text-center",children:[e.jsx(N,{className:"w-8 h-8 text-slate-300 dark:text-slate-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500",children:"部门待招聘"})]})]})}function D(){const[s,m]=d.useState([]),[r,x]=d.useState(!0),[o,n]=d.useState(null),[l,a]=d.useState(null),c=async()=>{x(!0),n(null);try{const t=await v();m(t),a(new Date)}catch(t){n("加载数据失败，请稍后重试"),console.error("Failed to load AI employees:",t)}finally{x(!1)}};d.useEffect(()=>{c();const t=setInterval(c,3e4);return()=>clearInterval(t)},[]);const j=s.reduce((t,i)=>t+i.employees.length,0),p=s.reduce((t,i)=>t+i.todayTotal,0);return e.jsxs("div",{className:"px-4 sm:px-0 pb-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-slate-800 dark:text-white mb-1 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(k,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),"AI 员工"]}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400 ml-13",children:["公司自动化团队 · ",j," 名员工 · 今日 ",p," 次任务"]})]}),e.jsxs("button",{onClick:c,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors disabled:opacity-50",children:[e.jsx(b,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"刷新"]})]}),l&&e.jsxs("p",{className:"text-xs text-slate-400 dark:text-slate-500 ml-13",children:["最后更新: ",l.toLocaleTimeString("zh-CN")]})]}),o&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl text-red-600 dark:text-red-400",children:o}),r&&s.length===0&&e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(b,{className:"w-8 h-8 text-blue-500 animate-spin"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"加载中..."})]})}),(!r||s.length>0)&&e.jsx("div",{className:"space-y-3",children:s.map((t,i)=>e.jsx(y,{department:t,defaultExpanded:i===0&&t.employees.length>0},t.id))})]})}export{D as default};

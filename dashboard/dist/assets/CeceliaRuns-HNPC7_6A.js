import{j as e,d as h,r as l,n as o,R as g,s as b}from"./index-B6elV0yr.js";import{b as p,g as j,L as u,E as y,c as N,f}from"./formatters-CphRD3H6.js";function k({status:a,className:t=""}){const d=p(a),c=j(a);return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d} ${t}`,children:c})}const v="";function _(){const a=h(),[t,d]=l.useState(null),[c,m]=l.useState(!0),[x,i]=l.useState(null),r=async()=>{try{const n=await(await fetch(`${v}/api/cecelia/overview`)).json();n.success?(d(n),i(null)):i(n.error)}catch(s){i(s instanceof Error?s.message:"Unknown error")}finally{m(!1)}};return l.useEffect(()=>{r();const s=setInterval(r,5e3);return()=>clearInterval(s)},[]),c?e.jsx(u,{height:"h-64"}):x?e.jsx(y,{message:`连接 Cecelia API 失败: ${x}`,onRetry:r,height:"h-64"}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(o,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Cecelia"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"AI 代码执行器任务追踪"})]})]}),e.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(g,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-gray-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:(t==null?void 0:t.total_runs)||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"总任务"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-blue-200 dark:border-blue-800",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:(t==null?void 0:t.running)||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"运行中"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-emerald-200 dark:border-emerald-800",children:[e.jsx("p",{className:"text-3xl font-bold text-emerald-600 dark:text-emerald-400",children:(t==null?void 0:t.completed)||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"已完成"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-red-200 dark:border-red-800",children:[e.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:(t==null?void 0:t.failed)||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"失败"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white",children:"最近任务"})}),t!=null&&t.recent_runs&&t.recent_runs.length>0?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:t.recent_runs.map(s=>e.jsxs("div",{onClick:()=>a(`/cecelia/runs/${s.id}`),className:"p-6 hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[N(s.status),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.project}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.feature_branch})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{status:s.status,size:"sm"}),e.jsx(b,{className:"w-5 h-5 text-gray-400"})]})]}),e.jsxs("div",{className:"ml-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full transition-all",style:{width:`${s.completed_checkpoints/s.total_checkpoints*100}%`}})}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap",children:[s.completed_checkpoints,"/",s.total_checkpoints]})]}),s.current_checkpoint&&e.jsxs("p",{className:"text-sm text-blue-600 dark:text-blue-400 mb-1",children:["当前: ",s.current_checkpoint]}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:f(s.updated_at)})]})]},s.id))}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(o,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"暂无任务"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"通过 N8N 工作流触发 Cecelia 执行 PRD"})]})]})]})}export{_ as default};

---
id: prd-frontend-perf-optimize
version: 1.0.0
created: 2026-02-07
updated: 2026-02-07
changelog:
  - 1.0.0: 初始版本
---

## PRD - 前端性能全面优化

**需求来源**: 用户要求优化前端架构，明天交付

**功能描述**:
1. Express 加 compression 中间件（gzip/brotli），减少传输体积（主 JS 852KB 裸传）
2. 静态资源 cache-control：带 hash 的文件 max-age=31536000（一年），非 hash 文件保持 no-cache
3. 飞书 OAuth redirect_uri 修复：localhost 不强转 https，解决 Error 4401
4. 版权年份更新 2025 → 2026

**涉及文件**:
- `apps/core/package.json` — 添加 compression 依赖
- `apps/core/src/dashboard/server.ts` — 加 compression 中间件 + 静态资源 cache-control
- `apps/dashboard/src/pages/FeishuLogin.tsx` — redirect_uri localhost 不转 https

**成功标准**:
1. 本地访问 localhost:5211 时 JS/CSS 响应有 Content-Encoding: gzip
2. /assets/*.js 响应 Cache-Control: public, max-age=31536000, immutable
3. index.html 响应 Cache-Control: no-cache
4. localhost 访问飞书二维码不再报 4401
5. 后端 build 通过

**非目标**:
- 不拆分 vendor bundle（架构已有 code splitting，不需要进一步拆）
- 不改 Vite 配置
- 不改 PWA Service Worker 策略

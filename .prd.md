---
id: prd-kr2-standardization
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

## PRD - PRD/TRD 验证与标准化

**需求来源**: KR2 目标 "PRD/TRD 自动生成（标准化）" — 模板引擎已实现但缺少验证层，自动生成的 PRD/TRD 无法保证字段完整性和内容质量。

**功能描述**: 在 `apps/core/src/brain/templates.js` 中添加 `validatePrd()` 和 `validateTrd()` 函数，对生成的 PRD/TRD 进行必填字段校验和内容质量检查。在 `planner.js` 的 `generateTaskPRD()` 中集成验证，确保写入磁盘的 PRD 文件符合标准。通过 Brain API 暴露验证端点。

**涉及文件**:
- `apps/core/src/brain/templates.js` — 添加 validatePrd(), validateTrd() 函数
- `apps/core/src/brain/planner.js` — generateTaskPRD() 集成验证
- `apps/core/src/brain/routes.js` — 添加 POST /api/brain/validate/prd 端点
- `apps/core/src/brain/__tests__/templates.test.js` — 验证函数测试

**成功标准**:
- validatePrd() 对缺少必填字段（需求来源、功能描述、成功标准）的 PRD 返回 { valid: false, errors: [...] }
- validatePrd() 对完整 PRD 返回 { valid: true, errors: [], warnings: [] }
- validateTrd() 对缺少必填节（技术背景、架构设计、API 设计、数据模型、测试策略）的 TRD 返回验证失败
- generateTaskPRD() 调用 validatePrd()，验证失败时在返回值中附带 warnings
- POST /api/brain/validate/prd 接受 PRD 文本并返回验证结果
- 所有现有测试继续通过

**非目标**:
- 不修改现有 PRD/TRD 生成逻辑
- 不实现 TRD→Feature PRD 分解流水线（属于后续迭代）
- 不做 PRD 内容的 AI 质量评分

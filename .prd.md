# PRD: 修复登录后循环跳转问题

## 问题描述
用户登录成功后，页面又跳回登录页，形成循环。

## 根本原因
1. `login()` 函数使用 `setState` 更新登录状态，是**异步**的
2. 但代码在调用 `login()` 后立即调用 `navigate(redirect)`
3. 跳转时登录状态还没更新完成，`isAuthenticated` 还是 `false`
4. App.tsx 检查发现未登录，再次跳转到登录页 → 循环

## 解决方案
改用 `window.location.href` 强制刷新页面跳转，确保新的登录状态被重新加载。

```typescript
// 之前
login(data.user, data.user.access_token);
navigate(redirect);  // ❌ 此时 state 还没更新

// 修改后  
login(data.user, data.user.access_token);
window.location.href = redirect;  // ✅ 强制刷新，重新加载登录状态
```

## 验收标准
1. 访问 `/features` 未登录 → 跳转到 `/login?redirect=/features`
2. 登录成功 → 跳转到 `/features` 并正常显示页面
3. 不会再次跳回登录页

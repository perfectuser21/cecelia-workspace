# PRD: 模仿 Notion Database 丝滑体验改进 TaskDatabase

## 背景

通过深度分析 Notion Task Manager 模板，发现了让其感觉"丝滑"的核心设计要素：
- 超快速过渡（20ms 而不是 200-300ms）
- 真正的分组折叠结构
- Notion 风格的配色和视觉设计

## 目标

将 Notion 的设计精髓应用到 TaskDatabase.tsx，提升用户体验。

## 功能需求

### 1. 超快速过渡动画（核心改进）

**当前问题**：过渡时间过长或使用 `transition: all`，感觉迟钝

**改进方案**：
- 所有交互元素：`transition: background 0.02s ease-in`（20ms）
- 移除宽泛的 `transition: all`
- 只过渡必要属性（background, transform）

**应用位置**：
- 表格行 hover
- 按钮 hover
- Tab/Select 切换器
- Priority 标签
- 折叠按钮

### 2. 真正的分组折叠结构

**当前实现**：GroupBy 只是过滤显示，所有任务仍在一个平铺列表中

**改进方案**：
- 按 `groupBy` 值对任务分组
- 每个分组包含：
  - **分组头部**：可折叠，带 chevron icon，显示分组名称和任务数量
  - **独立表头**：每个分组有自己的列头
  - **任务列表**：分组内的任务行
- 使用 `useState` 管理 `expandedGroups: Set<string>`
- 默认全部展开

**分组头部交互**：
- 点击切换折叠/展开状态
- Chevron icon 旋转动画（90度）
- Hover 背景色变化（20ms）

### 3. Notion 风格 Priority 标签

**配色方案**：
```css
P0 (High):
  background: rgba(212, 76, 71, 0.1)
  color: rgb(212, 76, 71)

P1 (Mid):
  background: rgba(233, 168, 0, 0.1)
  color: rgb(233, 168, 0)

P2 (Low):
  background: rgba(0, 135, 107, 0.1)
  color: rgb(0, 135, 107)
```

**样式**：
- padding: `2px 6px`
- borderRadius: `3px`
- fontSize: `14px`
- fontWeight: `400`
- display: `inline-flex`
- alignItems: `center`
- transition: `background 0.02s ease-in`

### 4. Status 标签优化

采用类似 Priority 的配色方案：
```css
pending (待办):
  background: rgba(206, 205, 202, 0.5)
  color: rgba(55, 53, 47, 0.6)

in_progress (进行中):
  background: rgba(35, 131, 226, 0.1)
  color: rgb(35, 131, 226)

completed (完成):
  background: rgba(0, 135, 107, 0.1)
  color: rgb(0, 135, 107)
```

### 5. 表格行 Hover 效果

- 默认背景：`transparent`
- Hover 背景：`rgba(0, 0, 0, 0.03)`（极浅灰色）
- transition: `background 0.02s ease-in`
- cursor: `pointer`

### 6. GroupBy 选择器样式

- padding: `6px 12px`
- fontWeight: `500`
- borderRadius: `4px`
- transition: `background 0.02s ease-in`
- Hover/Focus 背景色变化

## 非功能需求

### 性能
- 过渡动画使用 GPU 加速（transform, opacity）
- 避免触发 layout/repaint 的属性过渡

### 兼容性
- 保持所有现有功能正常工作
- 不影响 localStorage 持久化
- 不影响分页逻辑

## 成功标准

1. ✅ npm run build 通过
2. ✅ 所有交互感觉"即时但不生硬"（20ms 过渡）
3. ✅ GroupBy 切换后显示分组折叠结构
4. ✅ 点击分组头部可折叠/展开
5. ✅ Priority 标签使用 Notion 配色
6. ✅ Status 标签使用 Notion 配色
7. ✅ 表格行 hover 背景色快速变化
8. ✅ 原有功能（排序、分页、编辑）正常工作

## 实现文件

- `apps/core/features/planning/pages/TaskDatabase.tsx`

## 参考

- Notion Task Manager 模板实际分析
- CSS transition: `background 0.02s ease-in`
- 分组折叠模式

# PRD: Project QA System and Features Organization

## 项目概述

建立完整的项目质检体系，并组织整理所有 features，确保代码质量、类型安全和可维护性。

## 背景

用户需求: "把这个的这个项目的质检全部做起来，然后把所有的feature一个个里顺，全部能够用"

项目现状问题：
- 缺少质检体系（无 ESLint, Prettier, 测试框架）
- Features 架构不统一（Dashboard 不是标准 feature）
- TypeScript 类型错误（11+ errors）
- 构建依赖缺失
- 缺少开发文档

## 功能范围

### Phase A: 质检体系建立
1. 配置 Vitest 测试框架
2. 配置 ESLint + Prettier
3. 设置 pre-commit hooks (Husky)
4. 设置 GitHub Actions CI/CD
5. 修复所有代码质量问题

### Phase B: Features 组织
1. 审计所有 features（14 个）
2. 将 Dashboard 注册为标准 feature
3. 修复 features 功能问题
4. 统一 Core 和 Autopilot 架构

### Phase C: 文档化
1. 创建 Features 系统文档
2. 创建开发者贡献指南
3. 为关键 features 添加 README

## 技术实现

### 1. 质检基础设施
- **Vitest**: 单元测试框架
- **ESLint**: 代码规范检查
- **Prettier**: 代码格式化
- **Husky + lint-staged**: Pre-commit hooks
- **GitHub Actions**: CI/CD pipeline

### 2. Features 架构统一
- **FeatureManifest**: 标准 feature 定义格式
- **Instance Detection**: Core vs Autopilot 实例识别
- **Dynamic Loading**: 按需加载 features
- **Shared Components**: 共享工具和组件

### 3. 类型安全
- 修复 TypeScript 类型错误
- 统一类型定义
- 正确的 import/export 模式

## 成功标准

### 代码质量
- [x] ESLint errors: 0
- [x] TypeScript errors: 0
- [x] 代码 100% 格式化
- [x] Build 成功无 warnings

### Features 系统
- [x] 14 个 features 全部可用
- [x] Dashboard 注册为标准 feature
- [x] Instance detection 正确工作
- [x] 构建依赖完整

### 文档
- [x] Features README.md
- [x] CONTRIBUTING.md
- [x] FEATURES_AUDIT.md

### 测试
- [x] 测试框架就绪
- [x] 示例测试通过
- [ ] Features 测试覆盖 80%+ (后续)

## 不包含的范围

- ❌ 为所有 features 编写测试（工作量大，后续进行）
- ❌ TypeScript strict mode（需要大量类型修复）
- ❌ 性能优化（tree-shaking, code splitting）

## 验收标准

见 .dod.md

## 技术约束

- 使用现有技术栈（React, TypeScript, Vite）
- 保持向后兼容
- 不引入新的框架依赖
- 遵循语义化版本

## 时间估算

- Phase A: 1 天
- Phase B: 1 天
- Phase C: 0.5 天
- **总计**: 2.5 天

## 风险

- ✅ 已解决: 大量构建产物删除可能影响 git 性能
- ✅ 已解决: TypeScript 类型错误修复可能引入新问题
- ⚠️ 遗留: 测试覆盖不足（框架已就绪，逐步添加）

## 相关资源

- [Features Audit](./FEATURES_AUDIT.md)
- [Quality System](./QUALITY_SYSTEM.md)
- [Features README](./features/README.md)
- [Contributing Guide](./features/CONTRIBUTING.md)

---
id: prd-test-project-architecture
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

# PRD - 测试项目架构设计 (test-project)

## 需求来源

Nightly Planner 自动生成任务（task: ef9cc6fe）。当前项目 `tests/` 目录仅包含 quality API 测试，缺少统一的测试基础设施和项目级测试配置。

## 功能描述

为 cecelia-workspace monorepo 建立统一的测试架构：

1. **根级测试配置**: 在 monorepo 根目录添加 vitest 配置，支持 workspace 模式
2. **测试工具模块**: 创建 `tests/helpers/` 目录，提供通用测试工具（API client helper、mock factory）
3. **测试脚本**: 在根 package.json 添加 `test`、`test:api`、`test:unit` 脚本

## 涉及文件

- `vitest.config.ts` (新建) - 根级 vitest 配置
- `tests/helpers/api-client.ts` (新建) - API 测试 HTTP client helper
- `tests/helpers/index.ts` (新建) - helpers 导出
- `package.json` (修改) - 添加测试脚本和 vitest 依赖

## 成功标准

- [ ] `npm test` 在项目根目录可运行，能发现并执行 `tests/` 下的所有 `.test.ts` 文件
- [ ] `tests/helpers/api-client.ts` 导出 `createTestClient()` 函数，返回配置好 base URL 的 HTTP client
- [ ] 现有 `tests/api/*.test.ts` 文件在新配置下仍然能正常运行（无回归）

## 非目标

- 不重写现有测试用例
- 不添加 E2E 测试框架
- 不修改 apps/ 内部的测试配置

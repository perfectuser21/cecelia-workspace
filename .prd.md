---
id: quality-monitor-integration
version: 1.0.0
created: 2026-01-27
---

# PRD: Quality Monitor Integration to Core Dashboard

## 目标

将 Cecelia Quality 监控集成到 Core Dashboard，提供实时质量状态可视化。

## 背景

Cecelia Quality 系统已完成 API 开发（cecelia-quality 仓库），现需在 Core Dashboard 中集成前端页面。

## 需求

### 功能需求

1. **Core Feature 注册**
   - 创建 `apps/core/features/quality/` feature
   - 注册路由 `/quality`
   - 添加导航项（Activity 图标，"质量监控"）

2. **API 代理**
   - Core backend 代理 `/api/quality/*` 到 `http://localhost:5220/api/*`
   - 修复 pathRewrite 逻辑（Express 会 strip mount path）

3. **前端页面**
   - 显示 4 个健康卡片：System Health, Total, Succeeded, Failed
   - Recent Runs 表格：Run ID, Intent, Status, Duration, Completed
   - 自动刷新（10秒间隔）

4. **实例识别**
   - 修复 `detectInstance()` 识别 `dev-core.zenjoymedia.media`
   - 确保 Quality Monitor 只显示在 Core 实例

### 非功能需求

- 页面加载时间 < 1s
- API 响应时间 < 200ms
- 自动刷新不阻塞 UI

## 技术实现

### 文件改动

1. **apps/core/features/quality/index.ts** - Feature manifest
2. **apps/core/features/quality/pages/QualityMonitorPage.tsx** - 前端页面
3. **apps/core/features/index.ts** - 注册 quality feature
4. **apps/core/features/registry.ts** - 修复 dev-core 识别
5. **apps/core/src/dashboard/server.ts** - 添加 API proxy

### API Endpoints

- `GET /api/quality/state` → 返回带 `derivedHealth` 的状态
- `GET /api/quality/runs?limit=N` → 返回最近 N 个 runs

## 验收标准

见 .dod.md

## 里程碑

- [x] 创建 Quality feature
- [x] 配置 API proxy
- [ ] 创建前端页面
- [ ] 测试在 Core 实例显示
- [ ] CI 通过

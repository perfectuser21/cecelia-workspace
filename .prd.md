---
id: prd-kr2-prd-trd-validation
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

# PRD - PRD/TRD 验证层：标准化自动生成的文档质量

## 需求来源

KR2: PRD/TRD 自动生成（标准化）(progress: 0%)。
当前 templates.js 能生成 PRD/TRD，但生成后无验证，可能包含 TBD 占位符、缺失必填字段、内容过短等问题。需要验证层确保生成质量。

## 功能描述

为 Brain 系统添加 PRD/TRD 验证模块（validation.js），包含：
1. `validatePrd(content)` - 验证 PRD 必填字段完整性、内容质量
2. `validateTrd(content)` - 验证 TRD 必填字段完整性、内容质量
3. 在生成 API 中集成验证，返回 validation_status
4. 独立验证 API 端点供外部调用

## 涉及文件

- 新建: `apps/core/src/brain/validation.js` - 验证逻辑
- 修改: `apps/core/src/brain/routes.js` - 添加验证端点 + 集成到生成端点
- 新建: `apps/core/tests/brain/validation.test.js` - 验证测试

## 成功标准

- [ ] validatePrd 检查：必填 section 存在（背景/目标/功能需求/验收标准）、无 TBD 占位符、内容长度 >= 50 字符
- [ ] validateTrd 检查：必填 section 存在（技术背景/架构设计/API 设计/数据模型/测试策略）、无 TBD 占位符
- [ ] POST /api/brain/validate/prd 端点返回 { valid, errors, warnings }
- [ ] POST /api/brain/validate/trd 端点返回 { valid, errors, warnings }
- [ ] 生成端点（generate/prd, generate/trd）返回中包含 validation 字段
- [ ] 测试覆盖所有验证规则

## 非目标

- 不修改现有模板结构
- 不修改 decomposer.js
- 不添加 PRD 持久化存储（后续任务）

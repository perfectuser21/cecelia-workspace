---
id: prd-widget-dashboard-architecture
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

## PRD - Widget Dashboard 架构

**需求来源**: Nightly Planner 自动生成任务 (plan_daily_20260131) — 当前各 dashboard 页面（CommandCenter 1024行、ProjectPanorama 1641行）都是硬编码布局，无法自定义展示哪些 widget。需要统一的 widget 注册 + 渲染架构。

**功能描述**: 创建 widget-dashboard 架构基础设施：
1. **Widget 类型定义** — WidgetManifest（id, title, description, defaultSize, component, category）
2. **Widget 注册系统** — WidgetRegistry 单例，支持 register / getAll / getById / getByCategory
3. **WidgetGrid 布局组件** — CSS Grid 响应式 widget 容器
4. **WidgetCard 容器** — 单个 widget 外壳（标题栏 + 错误边界 + 内容区）
5. **3 个示例 widget** — StatsOverview、RecentTasks、SystemHealth
6. **WidgetDashboardPage** — 新页面 `/widgets`，展示所有已注册 widget

**涉及文件**:
- `apps/core/features/shared/widgets/types.ts` — 类型定义
- `apps/core/features/shared/widgets/registry.ts` — WidgetRegistry
- `apps/core/features/shared/widgets/WidgetGrid.tsx` — 布局组件
- `apps/core/features/shared/widgets/WidgetCard.tsx` — 单个 widget 容器
- `apps/core/features/shared/widgets/index.ts` — 导出
- `apps/core/features/dashboard/widgets/StatsOverviewWidget.tsx` — 示例 1
- `apps/core/features/dashboard/widgets/RecentTasksWidget.tsx` — 示例 2
- `apps/core/features/dashboard/widgets/SystemHealthWidget.tsx` — 示例 3
- `apps/core/features/dashboard/pages/WidgetDashboardPage.tsx` — 新页面
- `apps/core/features/dashboard/manifest.ts` — 注册路由

**成功标准**:
- 访问 `/widgets` 页面能看到 3 个示例 widget 以 grid 布局渲染
- WidgetRegistry.register() 可注册新 widget，getAll() 返回所有已注册 widget
- 每个 widget 有独立错误边界，单个 widget 崩溃不影响其他
- TypeScript 编译无错误
- 现有页面和功能无回归

**非目标**:
- 不做拖拽排序（后续迭代）
- 不做持久化用户布局偏好
- 不做 widget 配置面板
- 不改造现有 dashboard 页面

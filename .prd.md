# PRD - KR1: 意图识别 API 集成与质量修复

## 需求来源
Brain 自动调度任务 - 推进 KR1 (意图识别 - 自然语言→OKR/Project/Task)

## 功能描述
验证 Intent Recognition Service 的 API 集成状态，并修复代码审计发现的问题。

发现：
- ✅ Intent Recognition Service 已实现 (`apps/core/src/services/intent-recognition.service.ts`)
- ✅ Controller 已实现 (`apps/core/src/controllers/intent.controller.ts`)
- ✅ Types 已定义 (`apps/core/src/types/intent.types.ts`)
- ✅ NLP Parser 已实现 (`apps/core/src/utils/nlp-parser.ts`)
- ✅ Routes 已创建 (`apps/core/src/intent/routes.ts`)
- ✅ **API 路由已集成** - 已在 `apps/core/src/dashboard/server.ts` line 172 注册

审计发现的问题：
- ❌ **L1**: 缺少 node_modules 依赖（vitest）导致构建失败
- ❌ **L2**: Controller 中 context 验证允许 null 值通过

目标：
1. 修复 L1 问题：安装缺失依赖
2. 修复 L2 问题：修正 context 验证逻辑，正确拒绝 null
3. 验证 API 端点可访问

## 涉及文件
- `apps/core/src/controllers/intent.controller.ts` - 修复 context 验证 bug (line 61)
- `package.json` / `node_modules` - 安装缺失依赖
- `apps/core/src/__tests__/intent-recognition.test.ts` - 验证测试通过

## 成功标准
1. Intent API 端点可访问：
   - `POST /api/intent/recognize` 返回 200 状态码
   - `GET /api/intent/health` 返回 healthy 状态
2. 端点验证：
   - curl 测试成功返回 JSON 响应
   - 响应时间 < 500ms
3. 现有测试通过：
   - `npm run test -- intent-recognition.test.ts` 全部通过
4. 集成测试验证：
   - 能识别 "创建目标：完成 KR1" 并返回 create-goal action
   - 能识别 "查看所有待办任务" 并返回 query-tasks action

## 非目标
- 不修改 Intent Recognition Service 核心逻辑
- 不添加新的 Intent 类型
- 不改动 NLP Parser 规则
- 不创建前端 UI（仅 API 集成）

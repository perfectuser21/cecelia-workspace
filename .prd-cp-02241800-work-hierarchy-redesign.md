---
id: prd-work-hierarchy-redesign
version: 1.0.0
created: 2026-02-24
updated: 2026-02-24
changelog:
  - 1.0.0: 初始版本
---

# PRD: Work 页面层级视图重设计

## 目标
重写 Work 的 OKR/Projects/Tasks 三个 Tab，使每个 Tab 都按正确的 Area 层级分组展示数据。同时修复 `/api/tasks/goals` 的 500 错误（businesses 表不存在）。

## 数据模型
- goals(type=area_okr) → goals(type=kr) → projects(type=project) → projects(type=initiative) → tasks

## Tab 1: OKR
- 数据源：/api/tasks/goals（修复后不再依赖 businesses 表）
- 视图：area_okr 卡片可展开，显示其下所有 KR
- 每个 KR 显示 priority/status/progress/project 数量

## Tab 2: Projects
- 数据源：/api/tasks/goals + /api/tasks/projects + /api/tasks/tasks
- 视图：按 Area → KR → Project → Initiative 层级展示
- 只展示 non-archived 的 project/initiative
- Initiative 行显示任务数量

## Tab 3: Tasks
- 在现有基础上，新增顶部分组视图（按 Area → Initiative 分组）
- 保留原有列表视图作为切换选项

## 后端修复
- goals.js: 移除 LEFT JOIN businesses 和 departments（这两个表不存在），直接查 goals 表

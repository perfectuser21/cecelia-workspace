import{a7 as f,r as d,j as e,R as h,ab as j,G as N,A as g,a1 as v,a0 as y,o as w,aA as _}from"./index-D0DF2d61.js";function R(){const{name:s}=f(),[t,r]=d.useState([]),[i,n]=d.useState(!0),l=async()=>{try{const m=await(await fetch("/api/cecelia/overview?limit=50")).json();if(m.success){const u=m.recent_runs.filter(b=>b.project===s);r(u)}}catch(a){console.error(a)}finally{n(!1)}};if(d.useEffect(()=>{l();const a=setInterval(l,1e4);return()=>clearInterval(a)},[s]),i)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(h,{className:"w-6 h-6 text-violet-400 animate-spin"})});const c=t.filter(a=>a.status==="running"),p=t.filter(a=>a.status==="completed"),x=t.filter(a=>a.status==="failed");return e.jsxs("div",{className:"space-y-6 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(j,{to:"/cecelia",className:"p-2 text-gray-400 hover:text-white hover:bg-slate-700 rounded",children:e.jsx(N,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-white",children:s}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.length," 个任务"]})]})]}),e.jsx(o,{title:"正在执行",icon:e.jsx(g,{className:"w-4 h-4 text-blue-400"}),items:c,emptyText:"暂无运行中的任务",color:"blue"}),e.jsx(o,{title:"过去完成",icon:e.jsx(v,{className:"w-4 h-4 text-emerald-400"}),items:p,emptyText:"暂无已完成的任务",color:"emerald"}),x.length>0&&e.jsx(o,{title:"失败",icon:e.jsx(y,{className:"w-4 h-4 text-red-400"}),items:x,emptyText:"",color:"red"}),e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-amber-500/20 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(w,{className:"w-4 h-4 text-amber-400"}),e.jsx("h2",{className:"font-medium text-white",children:"将来规划"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"暂无规划（后续对接 Notion）"})]})]})}function o({title:s,icon:t,items:r,emptyText:i,color:n}){const l={blue:"border-blue-500/20",emerald:"border-emerald-500/20",red:"border-red-500/20"}[n];return e.jsxs("div",{className:`bg-slate-800 rounded-lg border ${l}`,children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t,e.jsx("h2",{className:"font-medium text-white",children:s})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[r.length," 项"]})]}),e.jsx("div",{className:"p-3",children:r.length===0?e.jsx("p",{className:"text-center text-gray-500 py-4",children:i}):e.jsx("div",{className:"space-y-2",children:r.map(c=>e.jsx(k,{run:c},c.id))})})]})}function k({run:s}){const t=s.status==="running",r=s.total_checkpoints>0?Math.round(s.completed_checkpoints/s.total_checkpoints*100):0;return e.jsxs(j,{to:`/cecelia/run/${s.id}`,className:`block p-3 rounded border transition-colors ${t?"bg-blue-900/20 border-blue-500/30 hover:border-blue-500/50":s.status==="completed"?"bg-slate-700/30 border-slate-600 hover:border-slate-500":"bg-red-900/10 border-red-500/20 hover:border-red-500/40"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsx(h,{className:"w-3 h-3 text-blue-400 animate-spin"}),e.jsx("span",{className:"font-medium text-white",children:s.prd_title||s.feature_branch})]}),s.prd_summary&&e.jsx("p",{className:"text-xs text-gray-400 mt-1 line-clamp-1",children:s.prd_summary})]}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[s.completed_checkpoints,"/",s.total_checkpoints," CP"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"}),s.feature_branch]}),e.jsx("span",{children:new Date(s.updated_at).toLocaleDateString("zh-CN",{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),t&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsxs("span",{className:"text-gray-400",children:["Step ",s.current_step||0,"/9",s.current_action&&` - ${s.current_action}`]}),e.jsxs("span",{className:"text-blue-400",children:[r,"%"]})]}),e.jsx("div",{className:"h-1 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${(s.current_step||0)/9*100}%`}})})]})]})}export{R as default};

import{a7 as w,r as d,j as e,R as N,ab as o,G as p,a0 as f,bb as C,W as _,A as k,a1 as g,o as R,aA as v,C as b}from"./index-sd6rvxIJ.js";import{a as $}from"./agents.api-59sW8kJ7.js";function L(){const{name:a}=w(),[s,r]=d.useState(null),[n,l]=d.useState(!0),[i,c]=d.useState(null),m=async()=>{try{const j=(await $()).projects.find(y=>y.name===a);j?(r(j),c(null)):c(`项目 "${a}" 不存在`)}catch(t){c(t.message)}finally{l(!1)}};if(d.useEffect(()=>{l(!0),m();const t=setInterval(m,3e4);return()=>clearInterval(t)},[a]),n)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(N,{className:"w-8 h-8 text-violet-500 animate-spin"})});if(i||!s)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(o,{to:"/cecelia",className:"inline-flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx(p,{className:"w-4 h-4"}),"返回"]}),e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-xl p-6 text-center",children:[e.jsx(f,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),e.jsx("p",{className:"text-red-400",children:i||"加载失败"})]})]});const h=s.features.filter(t=>t.current),u=s.features.filter(t=>!t.current);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{to:"/cecelia",className:"p-2 text-gray-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(p,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(C,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:s.name}),s.repoUrl&&e.jsx("a",{href:s.repoUrl,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-blue-400 transition-colors",children:e.jsx(_,{className:"w-5 h-5"})})]}),e.jsxs("p",{className:"text-gray-400",children:[s.features.length," Features · ",s.totalRuns," Runs"]})]})]})]}),e.jsx(x,{title:"正在执行",icon:e.jsx(k,{className:"w-5 h-5 text-blue-400"}),count:h.length,emptyText:"暂无运行中的任务",accentColor:"blue",children:h.map(t=>e.jsx(S,{feature:t},t.name))}),e.jsx(x,{title:"过去完成",icon:e.jsx(g,{className:"w-5 h-5 text-emerald-400"}),count:u.length,emptyText:"暂无已完成的任务",accentColor:"emerald",children:u.map(t=>e.jsx(F,{feature:t},t.name))}),e.jsx(x,{title:"将来规划",icon:e.jsx(R,{className:"w-5 h-5 text-amber-400"}),count:0,emptyText:"暂无规划（后续对接 Notion）",accentColor:"amber"})]})}function x({title:a,icon:s,count:r,emptyText:n,accentColor:l,children:i}){const c={blue:"border-blue-500/30",emerald:"border-emerald-500/30",amber:"border-amber-500/30"};return e.jsxs("div",{className:`bg-slate-800 rounded-xl border ${c[l]} overflow-hidden`,children:[e.jsxs("div",{className:"px-5 py-3 border-b border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s,e.jsx("h2",{className:"font-semibold text-white",children:a})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[r," 项"]})]}),e.jsx("div",{className:"p-4",children:r===0?e.jsx("p",{className:"text-center text-gray-500 py-6",children:n}):e.jsx("div",{className:"space-y-3",children:i})})]})}function S({feature:a}){const s=a.current,r=s.current_step?s.current_step/9*100:0;return e.jsxs(o,{to:`/cecelia/runs/${s.id}`,className:"block p-4 bg-blue-900/20 rounded-lg border border-blue-500/30 hover:border-blue-500/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-blue-400 animate-spin"}),e.jsx("span",{className:"font-medium text-white",children:a.displayName})]}),e.jsxs("span",{className:"text-xs text-blue-400 bg-blue-500/20 px-2 py-1 rounded",children:["v",a.history.length]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-3",children:[e.jsx(v,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:s.feature_branch})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-400",children:["Step ",s.current_step||0,"/9",s.current_action&&` · ${s.current_action}`]}),e.jsxs("span",{className:"text-blue-400",children:[Math.round(r),"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full transition-all",style:{width:`${r}%`}})})]})]})}function F({feature:a}){const s=a.latestRun,r=s.status==="completed",n=s.status==="failed";return e.jsxs(o,{to:`/cecelia/runs/${s.id}`,className:`block p-4 rounded-lg border transition-colors ${r?"bg-emerald-900/10 border-emerald-500/20 hover:border-emerald-500/40":n?"bg-red-900/10 border-red-500/20 hover:border-red-500/40":"bg-slate-700/30 border-slate-600/30 hover:border-slate-500/50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r?e.jsx(g,{className:"w-4 h-4 text-emerald-400"}):n?e.jsx(f,{className:"w-4 h-4 text-red-400"}):e.jsx(b,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-white",children:a.displayName})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"flex gap-1",children:a.history.slice(-3).map(l=>e.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${l.status==="completed"?"bg-emerald-500/20 text-emerald-400":l.status==="failed"?"bg-red-500/20 text-red-400":"bg-slate-700 text-gray-400"}`,children:["v",l.version]},l.id))})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate max-w-[200px]",children:s.feature_branch})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"}),e.jsx("span",{children:new Date(s.updated_at).toLocaleDateString("zh-CN",{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})}export{L as default};

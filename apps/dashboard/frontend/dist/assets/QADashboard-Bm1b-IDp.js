import{r as f,j as e,R as K,aa as W,x as X,bh as z,aX as F,ab as G,bi as H}from"./index-ChgcL0jp.js";import{f as I}from"./qa-report.api-wEreUZo6.js";import{R as J,n as L}from"./generateCategoricalChart-D9DEDoZK.js";import{P as V,a as Y}from"./PieChart-B3KXOFJA.js";import"./index-B9ygI19o.js";import"./tiny-invariant-BaFNuDhB.js";const u=s=>s>=80?"text-emerald-500":s>=60?"text-amber-500":"text-red-500",j=s=>s>=80?"bg-emerald-500":s>=60?"bg-amber-500":"bg-red-500";function o({score:s,label:d,size:i=100}){const n=[{value:s},{value:100-s}];return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{style:{width:i,height:i},className:"relative",children:[e.jsx(J,{children:e.jsx(V,{children:e.jsxs(Y,{data:n,innerRadius:"70%",outerRadius:"100%",startAngle:90,endAngle:-270,dataKey:"value",strokeWidth:0,children:[e.jsx(L,{fill:s>=80?"#10b981":s>=60?"#f59e0b":"#ef4444"}),e.jsx(L,{fill:"rgba(255,255,255,0.1)"})]})})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:`text-2xl font-bold ${u(s)}`,children:s})})]}),e.jsx("span",{className:"text-sm text-white/50 mt-2",children:d})]})}function Z({report:s}){var l,c,h,x,r,g,v,N,b,w,p,y,R,$,C,E,S,A,M,P,k,D,Q,T,U,O,q,B;const d=W(),i={total:(((c=(l=s.tests)==null?void 0:l.meta)==null?void 0:c.length)||0)+(((x=(h=s.tests)==null?void 0:h.unit)==null?void 0:x.length)||0)+(((g=(r=s.tests)==null?void 0:r.e2e)==null?void 0:g.length)||0),pass:[...((v=s.tests)==null?void 0:v.meta)||[],...((N=s.tests)==null?void 0:N.unit)||[],...((b=s.tests)==null?void 0:b.e2e)||[]].filter(a=>a.status==="pass").length,fail:[...((w=s.tests)==null?void 0:w.meta)||[],...((p=s.tests)==null?void 0:p.unit)||[],...((y=s.tests)==null?void 0:y.e2e)||[]].filter(a=>a.status==="fail").length},n={total:(($=(R=s.rcis)==null?void 0:R.items)==null?void 0:$.length)||0,open:((E=(C=s.rcis)==null?void 0:C.items)==null?void 0:E.filter(a=>a.status==="open").length)||0,p0:((A=(S=s.rcis)==null?void 0:S.items)==null?void 0:A.filter(a=>a.priority==="p0").length)||0},m={total:(((P=(M=s.gates)==null?void 0:M.pr)==null?void 0:P.length)||0)+(((D=(k=s.gates)==null?void 0:k.release)==null?void 0:D.length)||0),pass:(((T=(Q=s.gates)==null?void 0:Q.pr)==null?void 0:T.filter(a=>a.status==="pass").length)||0)+(((O=(U=s.gates)==null?void 0:U.release)==null?void 0:O.filter(a=>a.status==="pass").length)||0)},t={total:((q=s.goldenPaths)==null?void 0:q.length)||0,verified:((B=s.goldenPaths)==null?void 0:B.filter(a=>a.verified).length)||0};return e.jsxs("button",{onClick:()=>d(`/qa/${s.repo}`),className:"w-full bg-white/5 rounded-xl p-5 border border-white/10 hover:border-white/20 hover:bg-white/10 transition-all text-left group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.repo}),e.jsxs("p",{className:"text-sm text-white/40",children:["v",s.version]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`text-3xl font-bold ${u(s.summary.overall)}`,children:s.summary.overall}),e.jsx(X,{className:"w-5 h-5 text-white/30 group-hover:text-white/60 transition-colors"})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-white/40",children:"Meta"}),e.jsx("span",{className:u(s.summary.meta),children:s.summary.meta})]}),e.jsx("div",{className:"h-1.5 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${j(s.summary.meta)}`,style:{width:`${s.summary.meta}%`}})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-white/40",children:"Unit"}),e.jsx("span",{className:u(s.summary.unit),children:s.summary.unit})]}),e.jsx("div",{className:"h-1.5 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${j(s.summary.unit)}`,style:{width:`${s.summary.unit}%`}})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-white/40",children:"E2E"}),e.jsx("span",{className:u(s.summary.e2e),children:s.summary.e2e})]}),e.jsx("div",{className:"h-1.5 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${j(s.summary.e2e)}`,style:{width:`${s.summary.e2e}%`}})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 pt-3 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-blue-400"}),e.jsx("div",{className:"text-sm",children:e.jsxs("span",{className:i.fail>0?"text-amber-500":"text-emerald-500",children:[i.pass,"/",i.total]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-amber-400"}),e.jsx("div",{className:"text-sm",children:e.jsxs("span",{className:n.p0>0?"text-red-500":n.open>0?"text-amber-500":"text-white/50",children:[n.open,"/",n.total]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-emerald-400"}),e.jsx("div",{className:"text-sm",children:e.jsxs("span",{className:"text-white/50",children:[m.pass,"/",m.total]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-purple-400"}),e.jsx("div",{className:"text-sm",children:e.jsxs("span",{className:t.verified===t.total?"text-emerald-500":"text-amber-500",children:[t.verified,"/",t.total]})})]})]})]})}function ie(){const[s,d]=f.useState([]),[i,n]=f.useState(!0),m=()=>{n(!0),I().then(l=>{l.success&&l.data&&d(l.data),n(!1)})};f.useEffect(()=>{m()},[]);const t={overall:0,meta:0,unit:0,e2e:0};if(s.length>0){let l=0,c=0,h=0,x=0;s.forEach(r=>{l+=r.summary.overall,c+=r.summary.meta,h+=r.summary.unit,x+=r.summary.e2e}),t.overall=Math.round(l/s.length),t.meta=Math.round(c/s.length),t.unit=Math.round(h/s.length),t.e2e=Math.round(x/s.length)}return i?e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] text-white flex items-center justify-center",children:e.jsx(K,{className:"w-6 h-6 animate-spin text-white/50"})}):e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] text-white p-6",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"QA Dashboard"}),e.jsxs("p",{className:"text-white/50",children:[s.length," repositories"]})]}),e.jsx("button",{onClick:m,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(K,{className:`w-5 h-5 ${i?"animate-spin":""}`})})]}),e.jsx("div",{className:"bg-white/5 rounded-xl p-6 border border-white/10",children:e.jsxs("div",{className:"grid grid-cols-4 gap-8 place-items-center",children:[e.jsx(o,{score:t.overall,label:"Overall",size:120}),e.jsx(o,{score:t.meta,label:"Meta"}),e.jsx(o,{score:t.unit,label:"Unit"}),e.jsx(o,{score:t.e2e,label:"E2E"})]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Repositories"}),e.jsxs("div",{className:"grid gap-4",children:[s.map(l=>e.jsx(Z,{report:l},l.repo)),s.length===0&&e.jsx("div",{className:"text-center py-12 text-white/40 bg-white/5 rounded-xl border border-white/10",children:"No QA reports received yet"})]})]})]})})}export{ie as default};

import{r as d,j as e,R as c,_ as n,aJ as i,C as j,$ as k}from"./index-DO5GSdQ6.js";const N="";function f(){const[r,o]=d.useState(null),[m,g]=d.useState(!0),[x,l]=d.useState(null),s=async()=>{try{const a=await(await fetch(`${N}/api/cecilia/overview`)).json();a.success?(o(a),l(null)):l(a.error)}catch(t){l(t.message)}finally{g(!1)}};d.useEffect(()=>{s();const t=setInterval(s,5e3);return()=>clearInterval(t)},[]);const h=t=>{switch(t){case"completed":return e.jsx(k,{className:"w-5 h-5 text-emerald-500"});case"running":return e.jsx(c,{className:"w-5 h-5 text-blue-500 animate-spin"});case"failed":return e.jsx(n,{className:"w-5 h-5 text-red-500"});default:return e.jsx(j,{className:"w-5 h-5 text-gray-400"})}},b=t=>{const a={completed:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",running:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",failed:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",pending:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"},u={completed:"已完成",running:"运行中",failed:"失败",pending:"等待中"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${a[t]||a.pending}`,children:u[t]||t})},p=t=>new Date(t).toLocaleString("zh-CN");return m?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(c,{className:"w-8 h-8 text-blue-500 animate-spin"})}):x?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center",children:[e.jsx(n,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),e.jsxs("p",{className:"text-red-700 dark:text-red-400",children:["连接 Cecilia API 失败: ",x]}),e.jsx("button",{onClick:s,className:"mt-4 px-4 py-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",children:"重试"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(i,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Cecilia"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"AI 代码执行器任务追踪"})]})]}),e.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(c,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-gray-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:(r==null?void 0:r.total_runs)||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"总任务"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-blue-200 dark:border-blue-800",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:(r==null?void 0:r.running)||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"运行中"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-emerald-200 dark:border-emerald-800",children:[e.jsx("p",{className:"text-3xl font-bold text-emerald-600 dark:text-emerald-400",children:(r==null?void 0:r.completed)||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"已完成"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-red-200 dark:border-red-800",children:[e.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:(r==null?void 0:r.failed)||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"失败"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white",children:"最近任务"})}),r!=null&&r.recent_runs&&r.recent_runs.length>0?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:r.recent_runs.map(t=>e.jsxs("div",{className:"p-6 hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[h(t.status),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.project}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.feature_branch})]})]}),b(t.status)]}),e.jsxs("div",{className:"ml-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full transition-all",style:{width:`${t.completed_checkpoints/t.total_checkpoints*100}%`}})}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap",children:[t.completed_checkpoints,"/",t.total_checkpoints]})]}),t.current_checkpoint&&e.jsxs("p",{className:"text-sm text-blue-600 dark:text-blue-400 mb-1",children:["当前: ",t.current_checkpoint]}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:p(t.updated_at)})]})]},t.id))}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(i,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"暂无任务"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"通过 N8N 工作流触发 Cecilia 执行 PRD"})]})]})]})}export{f as default};

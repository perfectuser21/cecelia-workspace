import{j as e,ab as R,bb as k,W as T,z as E,aA as P,A as h,a1 as f,a0 as u,r as i,R as N,B as b,Z as L,l as U}from"./index-sd6rvxIJ.js";import{f as $,a as D}from"./agents.api-59sW8kJ7.js";const F=[{value:"24h",label:"24时"},{value:"72h",label:"72时"},{value:"7d",label:"7天"}];function I({value:s,onChange:c}){return e.jsx("div",{className:"flex bg-slate-700 rounded-lg p-1",children:F.map(t=>e.jsx("button",{onClick:()=>c(t.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-all ${s===t.value?"bg-blue-600 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-slate-600"}`,children:t.label},t.value))})}function O({project:s}){const c=s.features.reduce((r,n)=>r+n.history.filter(d=>d.status==="completed").length,0),t=s.features.reduce((r,n)=>r+n.history.filter(d=>d.status==="failed").length,0);return e.jsxs(R,{to:`/cecelia/project/${encodeURIComponent(s.name)}`,className:"block bg-slate-800 rounded-xl border border-slate-700 p-5 hover:border-violet-500/50 hover:bg-slate-800/80 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(k,{className:"w-5 h-5 text-white"})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),s.repoUrl&&e.jsx("a",{href:s.repoUrl,target:"_blank",rel:"noopener noreferrer",onClick:r=>r.stopPropagation(),className:"text-gray-500 hover:text-blue-400 transition-colors",children:e.jsx(T,{className:"w-4 h-4"})})]})})]}),e.jsx(E,{className:"w-5 h-5 text-gray-500 group-hover:text-violet-400 transition-colors"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(P,{className:"w-4 h-4 text-cyan-400"}),e.jsxs("span",{className:"text-gray-400",children:[s.features.length," Features"]})]}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:s.runningCount>0?e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-4 h-4 text-blue-400 animate-pulse"}),e.jsxs("span",{className:"text-blue-400",children:[s.runningCount," 运行中"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-500",children:"0 运行中"})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(f,{className:"w-4 h-4 text-emerald-400"}),e.jsxs("span",{className:"text-gray-400",children:[c," 已完成"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(u,{className:"w-4 h-4 text-red-400"}),e.jsxs("span",{className:"text-gray-400",children:[t," 失败"]})]})]}),s.runningCount>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full w-1/3 bg-blue-500 rounded-full animate-pulse"})}),e.jsx("span",{className:"text-xs text-blue-400",children:"执行中..."})]})})]})}function _(){const[s,c]=i.useState(null),[t,r]=i.useState(null),[n,d]=i.useState(!0),[g,j]=i.useState(null),[v,p]=i.useState(null),[o,w]=i.useState("24h"),m=async()=>{try{const[l,C]=await Promise.all([$(o),D()]);c(l),r(C),j(null),p(new Date)}catch(l){j(l.message)}finally{d(!1)}};i.useEffect(()=>{d(!0),m();const l=setInterval(m,3e4);return()=>clearInterval(l)},[o]);const y=l=>{switch(l){case"24h":return"过去 24 小时";case"72h":return"过去 72 小时";case"7d":return"过去 7 天"}};if(n&&!s)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(N,{className:"w-8 h-8 text-blue-500 animate-spin"})});if(g&&!s)return e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-xl p-6 text-center",children:[e.jsx(u,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),e.jsxs("p",{className:"text-red-400",children:["加载失败: ",g]}),e.jsx("button",{onClick:m,className:"mt-4 px-4 py-2 bg-red-900/30 text-red-400 rounded-lg hover:bg-red-900/50 transition-colors",children:"重试"})]});const a=s==null?void 0:s.periodStats;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(b,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Cecelia"}),e.jsxs("p",{className:"text-gray-400",children:["无头 Claude Code · ",(t==null?void 0:t.totalProjects)||0," 项目 · ",(t==null?void 0:t.totalFeatures)||0," Features · ",y(o)," ",(a==null?void 0:a.total)||0," 次任务"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{value:o,onChange:w}),v&&e.jsx("span",{className:"text-sm text-gray-500",children:v.toLocaleTimeString("zh-CN")}),e.jsx("button",{onClick:m,disabled:n,className:"p-2 text-gray-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(N,{className:`w-5 h-5 ${n?"animate-spin":""}`})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(x,{icon:e.jsx(h,{className:"w-4 h-4 text-white"}),label:"运行中",value:(a==null?void 0:a.running)||0,color:"from-blue-500 to-cyan-600",animate:a&&a.running>0}),e.jsx(x,{icon:e.jsx(f,{className:"w-4 h-4 text-white"}),label:"成功",value:(a==null?void 0:a.success)||0,color:"from-green-500 to-emerald-600"}),e.jsx(x,{icon:e.jsx(u,{className:"w-4 h-4 text-white"}),label:"失败",value:(a==null?void 0:a.error)||0,color:"from-red-500 to-rose-600"}),e.jsx(x,{icon:e.jsx(L,{className:"w-4 h-4 text-white"}),label:"总数",value:(a==null?void 0:a.total)||0,color:"from-purple-500 to-violet-600"}),e.jsx(x,{icon:e.jsx(U,{className:"w-4 h-4 text-white"}),label:"成功率",value:`${(a==null?void 0:a.successRate)||0}%`,color:"from-emerald-500 to-teal-600"})]}),t&&t.projects.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.projects.map(l=>e.jsx(O,{project:l},l.name))}):e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-12 text-center",children:[e.jsx(b,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"暂无项目数据"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"运行 Cecelia 任务后将显示项目"})]})]})}function x({icon:s,label:c,value:t,color:r,animate:n}){return e.jsx("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 bg-gradient-to-br ${r} rounded-xl flex items-center justify-center shadow-lg ${n?"animate-pulse":""}`,children:s}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400",children:c}),e.jsx("div",{className:"text-xl font-bold text-white",children:t})]})]})})}export{_ as default};

const c=[{id:"media",name:"新媒体部",icon:"Monitor",description:"负责社交媒体账号运营和内容发布",employees:[{id:"xiaoyun",name:"小运",icon:"Video",role:"内容运营专员",description:"负责各平台账号的登录管理和内容发布",abilities:[{id:"login",name:"账号登录",description:"管理平台账号登录状态",workflowKeywords:["登录","login","Login","VNC","vnc"]},{id:"publish",name:"内容发布",description:"执行内容发布任务",workflowKeywords:["发布","publish","Publish","post","Post"]}]},{id:"xiaoxi",name:"小析",icon:"BarChart3",role:"数据分析师",description:"负责数据采集和分析任务",abilities:[{id:"scrape",name:"数据采集",description:"从各平台采集数据",workflowKeywords:["爬取","scrape","Scrape","scraping","Scraping","采集"]},{id:"analytics",name:"数据分析",description:"分析数据并生成报告",workflowKeywords:["分析","analytics","Analytics","统计","stats","Stats"]}]}]},{id:"tech",name:"技术部",icon:"Code",description:"负责技术支持和系统维护",employees:[{id:"xiaowei",name:"小维",icon:"Wrench",role:"技术运维专员",description:"负责 AI 任务调度和系统维护",abilities:[{id:"claude",name:"AI 任务",description:"执行 Claude AI 相关任务",workflowKeywords:["claude","Claude","AI","ai","GPT","gpt"]},{id:"maintenance",name:"系统维护",description:"定时维护和清理任务",workflowKeywords:["maintenance","Maintenance","nightly","Nightly","维护","清理","cleanup","Cleanup"]}]}]},{id:"finance",name:"财务部",icon:"Wallet",description:"预留部门",employees:[]}];function y(e){for(const t of c)for(const a of t.employees)for(const s of a.abilities)if(s.workflowKeywords.some(n=>e.toLowerCase().includes(n.toLowerCase())))return{employee:a,ability:s};return null}function h(e){for(const t of c){const a=t.employees.find(s=>s.id===e);if(a)return a}return null}function g(e){for(const t of c)if(t.employees.some(a=>a.id===e))return t;return null}const m="";async function w(e){const t=await fetch(`${m}${e}`);if(!t.ok)throw new Error(`API error: ${t.status}`);return t.json()}async function d(e="local"){return w(`/api/v1/n8n-live-status/instances/${e}/overview`)}function u(e){const t=e.workflowName||"",a=y(t);return a?{id:e.id,workflowId:e.workflowId,workflowName:t,abilityId:a.ability.id,abilityName:a.ability.name,status:e.status==="crashed"?"error":e.status,startedAt:e.startedAt,stoppedAt:e.stoppedAt}:null}function f(){return{todayTotal:0,todaySuccess:0,todayError:0,todayRunning:0,successRate:0,recentTasks:[]}}function k(){return c.map(e=>({...e,employees:e.employees.map(t=>({...t,stats:f()})),todayTotal:0}))}async function A(){try{const e=await d("local"),t=new Map,a=[...e.runningExecutions.map(s=>({id:s.id,workflowId:s.workflowId,workflowName:s.workflowName,status:"running",startedAt:s.startedAt})),...e.recentCompleted];for(const s of c)for(const n of s.employees){const o={todayTotal:0,todaySuccess:0,todayError:0,todayRunning:0,successRate:0,recentTasks:[]};for(const l of a){const r=u(l);r&&n.abilities.some(p=>p.id===r.abilityId)&&(o.recentTasks.push(r),o.todayTotal++,r.status==="success"?o.todaySuccess++:r.status==="error"?o.todayError++:(r.status==="running"||r.status==="waiting")&&o.todayRunning++)}const i=o.todaySuccess+o.todayError;o.successRate=i>0?Math.round(o.todaySuccess/i*100):0,t.set(n.id,o)}return c.map(s=>({...s,employees:s.employees.map(n=>({...n,stats:t.get(n.id)||f()})),todayTotal:s.employees.reduce((n,o)=>{var i;return n+(((i=t.get(o.id))==null?void 0:i.todayTotal)||0)},0)}))}catch(e){return console.error("Failed to fetch AI employees stats:",e),k()}}async function I(e){try{const t=await d("local"),a=[...t.runningExecutions.map(o=>({id:o.id,workflowId:o.workflowId,workflowName:o.workflowName,status:"running",startedAt:o.startedAt})),...t.recentCompleted],s=c.flatMap(o=>o.employees).find(o=>o.id===e);if(!s)return[];const n=[];for(const o of a){const i=u(o);i&&s.abilities.some(l=>l.id===i.abilityId)&&n.push(i)}return n}catch(t){return console.error("Failed to fetch employee tasks:",t),[]}}export{g as a,I as b,A as f,h as g};

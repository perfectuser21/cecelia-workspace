import{c as y,f as w,h as v,r as l,j as e,Z as C,A as b}from"./index-BQtg0fkK.js";import{n as A}from"./n8n-live-status.api-CpQNSwcV.js";import{L as S}from"./loader-2-DfbJxey3.js";import{A as o}from"./alert-circle-BRfJM3Za.js";import{C as L}from"./chevron-left-3LNKg1P9.js";import{C as x}from"./clock-DD56_fSP.js";import{X as $}from"./x-circle-bE1nUZoH.js";import{C as D}from"./check-circle-2-D5Q86_bP.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=y("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function B(){const{instance:a,executionId:s}=w(),d=v(),[r,f]=l.useState(null),[j,u]=l.useState(!0),[m,c]=l.useState(null);l.useEffect(()=>{if(!a||!s){c("无效的参数"),u(!1);return}(async()=>{try{const n=await A.getExecutionDetail(a,s);f(n),c(null)}catch(n){c(n instanceof Error?n.message:"获取数据失败")}finally{u(!1)}})()},[a,s]);const g=t=>t<60?`${t}秒`:t<3600?`${Math.floor(t/60)}分${t%60}秒`:`${Math.floor(t/3600)}时${Math.floor(t%3600/60)}分`,h=t=>new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),k=t=>{switch(t){case"success":return"text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-400";case"error":case"crashed":return"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400";case"running":case"waiting":return"text-blue-600 bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400";default:return"text-gray-600 bg-gray-100 dark:bg-gray-900/30 dark:text-gray-400"}},p=t=>{switch(t){case"success":return e.jsx(D,{className:"w-5 h-5"});case"error":case"crashed":return e.jsx($,{className:"w-5 h-5"});case"running":case"waiting":return e.jsx(b,{className:"w-5 h-5 animate-pulse"});default:return e.jsx(o,{className:"w-5 h-5"})}},N=t=>{switch(t){case"success":return"成功";case"error":return"失败";case"crashed":return"崩溃";case"running":return"运行中";case"waiting":return"等待中";default:return t}};return j?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(S,{className:"w-8 h-8 animate-spin text-blue-500"})}):m||!r?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96",children:[e.jsx(o,{className:"w-12 h-12 text-red-500 dark:text-red-400 mb-4"}),e.jsx("p",{className:"text-red-600 dark:text-red-400 mb-3",children:m||"未找到执行记录"}),e.jsx("button",{onClick:()=>d("/n8n/live-status"),className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 shadow-lg shadow-blue-500/25",children:"返回列表"})]}):e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("button",{onClick:()=>d("/n8n/live-status"),className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition",children:[e.jsx(L,{className:"w-4 h-4"}),"返回列表"]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:r.workflowName||r.workflowId}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["执行 ID: ",r.id]})]}),e.jsxs("span",{className:`px-4 py-2 rounded-xl text-sm font-medium flex items-center gap-2 ${k(r.status)}`,children:[p(r.status),N(r.status)]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:[e.jsx(i,{icon:e.jsx(C,{className:"w-4 h-4"}),label:"触发方式",value:r.mode}),e.jsx(i,{icon:e.jsx(x,{className:"w-4 h-4"}),label:"耗时",value:r.duration?g(r.duration):"-"}),e.jsx(i,{icon:e.jsx(x,{className:"w-4 h-4"}),label:"开始时间",value:h(r.startedAt)}),e.jsx(i,{icon:e.jsx(x,{className:"w-4 h-4"}),label:"结束时间",value:r.stoppedAt?h(r.stoppedAt):"-"})]})]}),r.errorMessage&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 dark:text-red-300 mb-2",children:"错误信息"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-400 font-mono",children:r.errorMessage})]})]})}),r.nodes&&r.nodes.length>0&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-slate-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5"}),"节点执行时间线"]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-3",children:r.nodes.map((t,n)=>e.jsx(M,{node:t,formatDuration:g},n))})})]}),(!r.nodes||r.nodes.length===0)&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-12 text-center",children:[e.jsx(o,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"暂无节点执行信息"})]})]})}function i({icon:a,label:s,value:d}){return e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 text-xs mb-2",children:[a,s]}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",title:d,children:d})]})}function M({node:a,formatDuration:s}){const d=r=>{switch(r){case"success":return"border-green-300 dark:border-green-600 bg-green-50/50 dark:bg-green-900/20";case"error":return"border-red-300 dark:border-red-600 bg-red-50/50 dark:bg-red-900/20";case"running":case"waiting":return"border-blue-300 dark:border-blue-600 bg-blue-50/50 dark:bg-blue-900/20";default:return"border-gray-200 dark:border-slate-600 bg-white dark:bg-slate-700/50"}};return e.jsx("div",{className:`border rounded-xl p-4 ${d(a.status)}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white text-sm",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a.type})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.status&&e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${a.status==="success"?"bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400":a.status==="error"?"bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400":"bg-gray-100 dark:bg-slate-600 text-gray-600 dark:text-gray-400"}`,children:a.status==="success"?"成功":a.status==="error"?"失败":a.status}),a.duration!==void 0&&e.jsx("span",{className:"text-xs font-mono text-gray-600 dark:text-gray-400",children:s(a.duration)})]})]})})}export{B as default};

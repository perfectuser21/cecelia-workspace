import{c as q,l as oe,r as n,D as ie,f as xe,j as e,b as ge,A as T,T as me,B as J,Z as he}from"./index-BB_xL2oq.js";import{n as K,P as ue}from"./n8n-workflows.api-BvDP5B65.js";import{a as be,C as fe}from"./cog-Diz_8nHK.js";import{F as ye}from"./folder-open-BzrxmfpC.js";import{L as pe}from"./loader-2-y7WmYvfg.js";import{A as V}from"./alert-circle-D0-fng3e.js";import{W as S}from"./workflow-CmbGt7g1.js";import{E as je}from"./external-link-m-kMaUOs.js";import{S as ke}from"./server-DF3e7nGf.js";import{C as we}from"./cloud-DxK2ZnGR.js";import{P as z}from"./play-CVflZJZv.js";import{C as P}from"./check-circle-2-B13cdjeY.js";import{X as O}from"./x-circle-Cj_xC1Bc.js";import{C as Ne}from"./chevron-left-BoWdTv-a.js";import{C as ve}from"./chevron-right-B2VkwUV4.js";import{T as Ce}from"./timer-CEMUuBnG.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=q("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=q("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),j=[{key:"login",label:"登录管理",icon:Ee,color:"from-blue-500 to-cyan-500",keywords:["登录","login","VNC"]},{key:"scrape",label:"数据采集",icon:ie,color:"from-green-500 to-emerald-500",keywords:["爬取","数据","scrape","scraping"]},{key:"claude",label:"Claude 相关",icon:xe,color:"from-purple-500 to-violet-500",keywords:["claude","Claude"]},{key:"maintenance",label:"运维任务",icon:be,color:"from-orange-500 to-amber-500",keywords:["maintenance","nightly","维护","scheduler"]},{key:"other",label:"其他",icon:ye,color:"from-gray-500 to-slate-500",keywords:[]}];function Ze(){const u=oe(),[b,$]=n.useState("local"),[l,E]=n.useState(null),[r,i]=n.useState(null),[k,g]=n.useState(!0),[c,F]=n.useState(null),[Q,Y]=n.useState(""),[w,ee]=n.useState("all"),[A,W]=n.useState(new Set(["all"])),[m,M]=n.useState(1),[f,te]=n.useState(10);n.useEffect(()=>{K.getInstancesStatus().then(E).catch(()=>{E({cloud:{available:!0,name:"Cloud"},local:{available:!1,name:"Local"}})})},[]);const D=async()=>{try{const t=await K.getOverviewByInstance(b);i(t),Y(new Date().toLocaleTimeString("zh-CN")),F(null)}catch(t){F(t instanceof Error?t.message:"获取数据失败")}finally{g(!1)}},U=()=>{g(!0),D()};n.useEffect(()=>{g(!0),i(null),D();const t=setInterval(D,3e4);return()=>clearInterval(t)},[b]);const se=t=>{u(`/settings/n8n-workflows/${b}/${t}`)},ae=t=>{const s=t.name.toLowerCase();for(const a of j)if(a.key!=="other"&&a.keywords.some(o=>s.includes(o.toLowerCase())))return a.key;return"other"},R=n.useMemo(()=>{if(!(r!=null&&r.workflows.workflows))return{};const t={};return j.forEach(s=>{t[s.key]=[]}),r.workflows.workflows.forEach(s=>{const a=ae(s);t[a].push(s)}),t},[r==null?void 0:r.workflows.workflows]),re=n.useMemo(()=>{const t={};return j.forEach(s=>{const a=R[s.key]||[],o=a.filter(p=>p.active).length,d=a.reduce((p,C)=>{var H;return p+(((H=C.runStats)==null?void 0:H.runningCount)||0)},0),x=a.filter(p=>{var C;return((C=p.runStats)==null?void 0:C.recentStats.total)>0}),I=x.length>0?Math.round(x.reduce((p,C)=>p+C.runStats.recentStats.successRate,0)/x.length):0;t[s.key]={total:a.length,active:o,running:d,successRate:I}}),t},[R]),N=n.useMemo(()=>{const t=(r==null?void 0:r.recentExecutions.executions)||[];return w==="all"?t:w==="error"?t.filter(s=>s.status==="error"||s.status==="crashed"):t.filter(s=>s.status===w)},[r==null?void 0:r.recentExecutions.executions,w]),B=n.useMemo(()=>{const t=(m-1)*f;return N.slice(t,t+f)},[N,m,f]),y=Math.ceil(N.length/f);n.useEffect(()=>{M(1)},[w,f]);const le=t=>{W(s=>{const a=new Set(s);return a.has(t)?a.delete(t):a.add(t),a})},de=()=>{A.size===j.length?W(new Set):W(new Set(j.map(t=>t.key)))},_=t=>{switch(t){case"success":return"text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-400";case"error":case"crashed":return"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400";case"running":case"waiting":return"text-blue-600 bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400";default:return"text-gray-600 bg-gray-100 dark:bg-gray-900/30 dark:text-gray-400"}},X=t=>{switch(t){case"success":return e.jsx(P,{className:"w-4 h-4"});case"error":case"crashed":return e.jsx(O,{className:"w-4 h-4"});case"running":case"waiting":return e.jsx(T,{className:"w-4 h-4 animate-pulse"});default:return e.jsx(V,{className:"w-4 h-4"})}},Z=t=>{switch(t){case"success":return"成功";case"error":return"失败";case"crashed":return"崩溃";case"running":return"运行中";case"waiting":return"等待中";default:return t}},G=t=>new Date(t).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),ne=t=>{const s=new Date(t),o=new Date().getTime()-s.getTime(),d=Math.floor(o/6e4),x=Math.floor(d/60),I=Math.floor(x/24);return d<1?"刚刚":d<60?`${d}分钟前`:x<24?`${x}小时前`:I<7?`${I}天前`:G(t)},ce=(t,s)=>{if(!s)return"-";const a=new Date(t).getTime(),o=new Date(s).getTime(),d=Math.round((o-a)/1e3);return d<60?`${d}秒`:d<3600?`${Math.floor(d/60)}分${d%60}秒`:`${Math.floor(d/3600)}时${Math.floor(d%3600/60)}分`};if(k&&!r)return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(pe,{className:"w-8 h-8 animate-spin text-blue-500"})});if(c&&!r)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-96",children:[e.jsx(V,{className:"w-12 h-12 text-red-500 dark:text-red-400 mb-4"}),e.jsx("p",{className:"text-red-600 dark:text-red-400 mb-3",children:c}),e.jsx("button",{onClick:U,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 shadow-lg shadow-blue-500/25 magnetic-btn",children:"重试"})]});const v=r==null?void 0:r.workflows,h=r==null?void 0:r.recentExecutions,L=(r==null?void 0:r.workflows.workflows.reduce((t,s)=>{var a;return t+(((a=s.runStats)==null?void 0:a.runningCount)||0)},0))||0;return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl flex items-center justify-center shadow-lg shadow-orange-500/25",children:e.jsx(S,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"N8n 工作流"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["自动化工作流监控 · 更新于 ",Q]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("a",{href:b==="local"?"http://localhost:5679":"#",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 border border-gray-200 dark:border-slate-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-50 dark:hover:bg-slate-700 transition",children:[e.jsx(je,{className:"w-4 h-4"}),"打开 n8n"]}),e.jsxs("button",{onClick:U,disabled:k,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 shadow-lg shadow-blue-500/25 magnetic-btn",children:[e.jsx(ge,{className:`w-4 h-4 ${k?"animate-spin":""}`}),"刷新"]})]})]}),e.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-700 rounded-xl p-1 w-fit",children:[e.jsxs("button",{onClick:()=>$("local"),disabled:!(l!=null&&l.local.available),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${b==="local"?"bg-white dark:bg-slate-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"} ${l!=null&&l.local.available?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(ke,{className:"w-4 h-4"}),"Local",!(l!=null&&l.local.available)&&e.jsx("span",{className:"text-xs text-red-500",children:"(未配置)"})]}),e.jsxs("button",{onClick:()=>$("cloud"),disabled:!(l!=null&&l.cloud.available),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${b==="cloud"?"bg-white dark:bg-slate-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"} ${l!=null&&l.cloud.available?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(we,{className:"w-4 h-4"}),"Cloud",!(l!=null&&l.cloud.available)&&e.jsx("span",{className:"text-xs text-red-500",children:"(未配置)"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-4 tilt-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/25",children:e.jsx(S,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"工作流"}),e.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-white",children:(v==null?void 0:v.totalWorkflows)||0})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-4 tilt-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg shadow-green-500/25",children:e.jsx(z,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"已启用"}),e.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:(v==null?void 0:v.activeWorkflows)||0})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-4 tilt-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 rounded-xl flex items-center justify-center shadow-lg ${L>0?"bg-gradient-to-br from-blue-500 to-cyan-600 shadow-blue-500/25":"bg-gradient-to-br from-gray-400 to-gray-500 shadow-gray-500/25"}`,children:e.jsx(T,{className:`w-4 h-4 text-white ${L>0?"animate-pulse":""}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"运行中"}),e.jsx("div",{className:`text-xl font-bold ${L>0?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"}`,children:L})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-4 tilt-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-500/25",children:e.jsx(me,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"成功率"}),e.jsxs("div",{className:"text-xl font-bold text-emerald-600 dark:text-emerald-400",children:[(h==null?void 0:h.successRate)||0,"%"]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-4 tilt-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg shadow-green-500/25",children:e.jsx(P,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"成功"}),e.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:(h==null?void 0:h.success)||0})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-4 tilt-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-red-500 to-rose-600 rounded-xl flex items-center justify-center shadow-lg shadow-red-500/25",children:e.jsx(O,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"失败"}),e.jsx("div",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:(h==null?void 0:h.error)||0})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),"工作流分组"]}),e.jsx("button",{onClick:de,className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:A.size===j.length?"全部折叠":"全部展开"})]}),j.filter(t=>{var s;return(((s=R[t.key])==null?void 0:s.length)||0)>0}).map(t=>{const s=t.icon,a=R[t.key]||[],o=re[t.key],d=A.has(t.key);return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>le(t.key),className:"w-full px-5 py-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 bg-gradient-to-br ${t.color} rounded-xl flex items-center justify-center shadow-lg`,children:e.jsx(s,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[t.label,e.jsxs("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:["(",o.total," 个)"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-3 mt-0.5",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-3 h-3 text-green-500"}),o.active," 启用"]}),o.running>0&&e.jsxs("span",{className:"flex items-center gap-1 text-blue-600 dark:text-blue-400",children:[e.jsx(T,{className:"w-3 h-3 animate-pulse"}),o.running," 运行中"]}),o.successRate>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),o.successRate,"% 成功率"]})]})]})]}),d?e.jsx($e,{className:"w-5 h-5 text-gray-400"}):e.jsx(fe,{className:"w-5 h-5 text-gray-400"})]}),d&&e.jsx("div",{className:"px-5 pb-5 pt-2",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.map(x=>e.jsx(Me,{workflow:x,formatRelativeTime:ne,getStatusColor:_,getStatusIcon:X,getStatusLabel:Z,onClick:()=>se(x.id)},x.id))})})]},t.key)})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-gray-700 dark:text-gray-300"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"执行历史"}),e.jsxs("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:["(共 ",N.length," 条)"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"每页"}),e.jsxs("select",{value:f,onChange:t=>te(Number(t.target.value)),className:"px-2 py-1 text-sm border border-gray-200 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"条"})]}),e.jsx("div",{className:"flex bg-gray-100 dark:bg-slate-700 rounded-xl p-1",children:[{value:"all",label:"全部"},{value:"success",label:"成功"},{value:"error",label:"失败"},{value:"running",label:"运行中"}].map(t=>e.jsx("button",{onClick:()=>ee(t.value),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-all ${w===t.value?"bg-white dark:bg-slate-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:t.label},t.value))})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"工作流"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"触发方式"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"开始时间"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"耗时"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:B.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500 dark:text-gray-400",children:"暂无执行记录"})}):B.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.workflowName||t.workflowId})]})}),e.jsx("td",{className:"px-6 py-3",children:e.jsxs("span",{className:`px-2.5 py-1 rounded-lg text-xs font-medium flex items-center gap-1 w-fit ${_(t.status)}`,children:[X(t.status),Z(t.status)]})}),e.jsx("td",{className:"px-6 py-3 text-sm text-gray-500 dark:text-gray-400",children:t.mode}),e.jsx("td",{className:"px-6 py-3 text-sm text-gray-500 dark:text-gray-400",children:G(t.startedAt)}),e.jsx("td",{className:"px-6 py-3 text-sm text-gray-500 dark:text-gray-400 font-mono",children:ce(t.startedAt,t.stoppedAt)})]},t.id))})]})}),y>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["显示 ",(m-1)*f+1," - ",Math.min(m*f,N.length)," 条，共 ",N.length," 条"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>M(t=>Math.max(1,t-1)),disabled:m===1,className:"p-2 rounded-lg border border-gray-200 dark:border-slate-600 hover:bg-gray-50 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition text-gray-600 dark:text-gray-400",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,y)},(t,s)=>{let a;return y<=5||m<=3?a=s+1:m>=y-2?a=y-4+s:a=m-2+s,e.jsx("button",{onClick:()=>M(a),className:`w-8 h-8 rounded-lg text-sm font-medium transition ${m===a?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-md shadow-blue-500/25":"hover:bg-gray-100 dark:hover:bg-slate-700 text-gray-600 dark:text-gray-400"}`,children:a},a)})}),e.jsx("button",{onClick:()=>M(t=>Math.min(y,t+1)),disabled:m===y,className:"p-2 rounded-lg border border-gray-200 dark:border-slate-600 hover:bg-gray-50 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition text-gray-600 dark:text-gray-400",children:e.jsx(ve,{className:"w-4 h-4"})})]})]})]})]})}function Me({workflow:u,formatRelativeTime:b,getStatusColor:$,getStatusIcon:l,getStatusLabel:E,onClick:r}){const{runStats:i}=u,k=(i==null?void 0:i.runningCount)>0,g=i==null?void 0:i.lastExecution,c=i==null?void 0:i.recentStats;return e.jsxs("div",{onClick:r,className:`border rounded-xl p-4 transition-all cursor-pointer ${k?"border-blue-300 dark:border-blue-600 bg-blue-50/50 dark:bg-blue-900/20 shadow-md shadow-blue-500/10":"border-gray-200 dark:border-slate-600 bg-white dark:bg-slate-700/50 hover:shadow-md dark:hover:shadow-slate-900/50 hover:border-gray-300 dark:hover:border-slate-500"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate flex-1 text-sm",title:u.name,children:u.name}),e.jsxs("div",{className:"flex items-center gap-1.5 ml-2",children:[k&&e.jsxs("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3 animate-pulse"}),i.runningCount]}),e.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex items-center gap-1 ${u.active?"text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30":"text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-slate-600"}`,children:[u.active?e.jsx(z,{className:"w-2.5 h-2.5"}):e.jsx(ue,{className:"w-2.5 h-2.5"}),u.active?"启用":"停用"]})]})]}),g&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium flex items-center gap-1 ${$(g.status)}`,children:[l(g.status),E(g.status)]}),e.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1",children:[e.jsx(Ce,{className:"w-3 h-3"}),b(g.startedAt)]})]}),c&&c.total>0&&e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),"近 ",c.total," 次"]}),e.jsxs("span",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[e.jsx(P,{className:"w-3 h-3"}),c.success]}),c.error>0&&e.jsxs("span",{className:"flex items-center gap-1 text-red-600 dark:text-red-400",children:[e.jsx(O,{className:"w-3 h-3"}),c.error]}),e.jsxs("span",{className:`font-medium ${c.successRate>=90?"text-green-600 dark:text-green-400":c.successRate>=70?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,children:[c.successRate,"%"]})]}),(!c||c.total===0)&&!g&&e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:"暂无执行记录"})]})}export{Ze as default};

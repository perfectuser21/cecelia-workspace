import{c as P,r as c,j as e,R as Q,l as $,S as z,A as b,L as v,C as q,n as B,Z as T}from"./index-Gd54YMLH.js";import{g as Y}from"./dev-tracker.api-B-Qkt3NI.js";import{g as F}from"./engine.api-BZRqc5ht.js";import{C as U}from"./cloud-D-HIhyJn.js";import{C as Z,a as J,P as V,Q as X}from"./quote-B1qbQESt.js";import{T as K}from"./timer-BaUPCcHn.js";import{C as y}from"./check-circle-2-B988GgI8.js";import{A}from"./alert-circle-D0G6t6L2.js";import{G as w}from"./client-CNLZCY_i.js";import{C as ee}from"./clock-B66mrLXY.js";import{T as te}from"./terminal-CRgmNFNX.js";import"./index-B9ygI19o.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=P("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),ae=()=>({user:{name:"Developer"}}),E=[{text:"把每一件简单的事做好就是不简单。",author:"稻盛和夫"},{text:"不要等待机会，而要创造机会。",author:"林肯"},{text:"成功不是终点，失败也不是终结，唯有勇气才是永恒。",author:"丘吉尔"},{text:"今天的努力是明天的礼物。",author:"佚名"},{text:"专注于当下，未来自然清晰。",author:"佚名"},{text:"Code is poetry.",author:"WordPress"},{text:"Talk is cheap. Show me the code.",author:"Linus Torvalds"},{text:"代码写得好，BUG 少不了。",author:"程序员"},{text:"今天的 TODO，就是明天的 DONE。",author:"乐观开发者"},{text:"Stay hungry, stay foolish.",author:"Steve Jobs"}],re={"01-01":{name:"元旦",greeting:"新年快乐"},"02-14":{name:"情人节",greeting:"愿你被爱包围"},"05-01":{name:"劳动节",greeting:"休息一下吧"},"10-01":{name:"国庆节",greeting:"祖国生日快乐"},"12-25":{name:"圣诞节",greeting:"Merry Christmas"}},ne=()=>{const s=new Date,a=`${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`;return re[a]||null},le=()=>{const s=new Date,a=s.getFullYear()*1e4+(s.getMonth()+1)*100+s.getDate();return E[a%E.length]},M=()=>{const s=new Date,a=s.getDay();if(a===0||a===6)return null;const o=s.getHours()+s.getMinutes()/60;if(o<8.5||o>=18)return null;const d=new Date(s);d.setHours(18,0,0,0);const g=d.getTime()-s.getTime();return{hours:Math.floor(g/36e5),minutes:Math.floor(g%36e5/6e4)}},ie=()=>{const s=new Date().getDay();return s===0||s===6?null:6-s},ce=s=>{const a=parseInt(s);return a>=600&&a<700?"snow":a>=200&&a<600?"rain":a===800?"sun":"cloud"},oe=s=>{const a=new Date().getHours(),o=new Date().getDay();return s?{greeting:`${s.name}快乐`,subtitle:s.greeting}:o===0||o===6?{greeting:"周末好",subtitle:"享受你的时光"}:a<9?{greeting:"早上好",subtitle:"新的一天，新的可能"}:a<12?{greeting:"上午好",subtitle:"保持专注，效率拉满"}:a<14?{greeting:"中午好",subtitle:"记得吃饭休息"}:a<18?{greeting:"下午好",subtitle:"继续加油"}:a<21?{greeting:"晚上好",subtitle:"辛苦了，注意休息"}:{greeting:"夜深了",subtitle:"早点休息吧"}},h=({children:s,className:a="",glow:o=!1})=>e.jsx("div",{className:`
    relative overflow-hidden rounded-2xl
    bg-white dark:bg-[#2c2c2e]
    border border-black/5 dark:border-white/10
    shadow-sm dark:shadow-none
    ${o?"ring-1 ring-teal-500/20":""}
    ${a}
  `,children:s});function ve(){var I;const{user:s}=ae(),[a,o]=c.useState([]),[d,g]=c.useState(null),[_,W]=c.useState(!0),[x,L]=c.useState(null),[j,R]=c.useState(M()),O=c.useMemo(()=>ne(),[]),C=c.useMemo(()=>le(),[]),D=oe(O),k=ie();c.useEffect(()=>{const t=async()=>{try{const[n,l]=await Promise.all([Y(),F()]);n.success&&n.data&&o(n.data),l.success&&l.engine&&g(l.engine)}catch(n){console.error("Failed to fetch:",n)}finally{W(!1)}};t();const r=setInterval(t,3e4);return()=>clearInterval(r)},[]),c.useEffect(()=>{const t=setInterval(()=>R(M()),6e4);return()=>clearInterval(t)},[]),c.useEffect(()=>{const t=async()=>{var n,l,f,m,i;try{const N=await fetch("https://wttr.in/Xi'an?format=j1");if(N.ok){const u=(n=(await N.json()).current_condition)==null?void 0:n[0];u&&L({temp:u.temp_C,desc:((f=(l=u.lang_zh)==null?void 0:l[0])==null?void 0:f.value)||((i=(m=u.weatherDesc)==null?void 0:m[0])==null?void 0:i.value)||"未知",icon:ce(u.weatherCode),city:"西安"})}}catch{console.log("天气获取失败")}};t();const r=setInterval(t,30*60*1e3);return()=>clearInterval(r)},[]);const S=a.flatMap(t=>{const r=[],{repo:n,task:l,steps:f,quality:m}=t;return l.createdAt&&r.push({id:`${n.name}-start`,type:"task_start",title:`开始: ${l.name||t.branches.current}`,project:n.name,time:l.createdAt,branch:t.branches.current}),f.items.filter(i=>i.status==="done"&&i.completedAt).forEach(i=>{r.push({id:`${n.name}-step-${i.id}`,type:"task_complete",title:`Step ${i.id}: ${i.name}`,project:n.name,time:i.completedAt,branch:t.branches.current})}),m.ci==="passed"?r.push({id:`${n.name}-ci`,type:"ci_pass",title:"CI 通过",project:n.name,time:m.lastCheck,branch:t.branches.current}):m.ci==="failed"&&r.push({id:`${n.name}-ci`,type:"ci_fail",title:"CI 失败",project:n.name,time:m.lastCheck,branch:t.branches.current}),r}).sort((t,r)=>new Date(r.time).getTime()-new Date(t.time).getTime()).slice(0,8),p={active:a.filter(t=>t.steps.current>0&&t.steps.current<10).length,completed:a.filter(t=>t.steps.items.every(r=>r.status==="done"||r.status==="skipped")).length,failed:a.filter(t=>t.quality.ci==="failed").length,repos:new Set(a.map(t=>t.repo.name)).size},H=t=>({commit:e.jsx(w,{className:"w-4 h-4 text-blue-400"}),pr:e.jsx(w,{className:"w-4 h-4 text-purple-400"}),task_start:e.jsx(T,{className:"w-4 h-4 text-amber-400"}),task_complete:e.jsx(y,{className:"w-4 h-4 text-emerald-400"}),ci_pass:e.jsx(y,{className:"w-4 h-4 text-green-400"}),ci_fail:e.jsx(A,{className:"w-4 h-4 text-red-400"})})[t]||e.jsx(b,{className:"w-4 h-4 text-gray-400"}),G=t=>{const r=Math.floor((Date.now()-new Date(t).getTime())/6e4);return r<1?"刚刚":r<60?`${r}分钟前`:r<1440?`${Math.floor(r/60)}小时前`:new Date(t).toLocaleDateString("zh-CN",{month:"short",day:"numeric"})};return _?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Q,{className:"w-8 h-8 text-violet-600 animate-spin"})}):e.jsx("div",{className:"min-h-screen -m-8 -mt-8 p-8",children:e.jsxs("div",{className:"relative space-y-6 p-2",children:[e.jsx(h,{className:"p-6",glow:!0,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-[#1d1d1f] dark:text-white mb-2",children:[D.greeting,"，",s==null?void 0:s.name]}),e.jsx("p",{className:"text-[#86868b] dark:text-white/60",children:D.subtitle})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[d&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-[#86868b] dark:text-[#98989d]",children:"Engine"}),e.jsxs("p",{className:"text-xl font-mono text-teal-600 dark:text-teal-400",children:["v",d.version]})]}),e.jsx("div",{className:"p-4 bg-gradient-to-br from-teal-500 to-teal-600 rounded-2xl shadow-lg",children:e.jsx($,{className:"w-10 h-10 text-white"})})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[x&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-[#2c2c2e] rounded-lg border border-black/5 dark:border-white/10 shadow-sm",children:[x.icon==="sun"&&e.jsx(z,{className:"w-4 h-4 text-amber-500"}),x.icon==="cloud"&&e.jsx(U,{className:"w-4 h-4 text-[#86868b]"}),x.icon==="rain"&&e.jsx(Z,{className:"w-4 h-4 text-blue-500"}),x.icon==="snow"&&e.jsx(J,{className:"w-4 h-4 text-cyan-500"}),e.jsxs("span",{className:"text-sm text-[#1d1d1f] dark:text-white/80",children:[x.city," ",e.jsxs("span",{className:"font-semibold",children:[x.temp,"°"]})," ",x.desc]})]}),j&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-[#2c2c2e] rounded-lg border border-black/5 dark:border-white/10 shadow-sm",children:[e.jsx(K,{className:"w-4 h-4 text-teal-600 dark:text-teal-400"}),e.jsxs("span",{className:"text-sm text-[#1d1d1f] dark:text-white/80",children:["下班倒计时 ",e.jsxs("span",{className:"font-semibold",children:[j.hours,"h ",j.minutes,"m"]})]})]}),k!==null&&k>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-[#2c2c2e] rounded-lg border border-black/5 dark:border-white/10 shadow-sm",children:[e.jsx(V,{className:"w-4 h-4 text-teal-600 dark:text-teal-400"}),e.jsxs("span",{className:"text-sm text-[#1d1d1f] dark:text-white/80",children:["周末还有 ",e.jsxs("span",{className:"font-semibold",children:[k,"天"]})]})]}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-[#2c2c2e] rounded-lg border border-black/5 dark:border-white/10 shadow-sm",children:[e.jsx(X,{className:"w-4 h-4 text-teal-600 dark:text-teal-400"}),e.jsxs("span",{className:"text-sm text-[#86868b] dark:text-white/70 italic",children:['"',C.text,'" ',e.jsxs("span",{className:"text-[#86868b]/60 dark:text-white/50",children:["— ",C.author]})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"进行中",value:p.active,icon:b,iconColor:"text-teal-600 dark:text-teal-400",bgColor:"bg-teal-500/10"},{label:"已完成",value:p.completed,icon:y,iconColor:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-500/10"},{label:"需关注",value:p.failed,icon:A,iconColor:"text-amber-600 dark:text-amber-400",bgColor:"bg-amber-500/10"},{label:"活跃仓库",value:p.repos,icon:w,iconColor:"text-teal-600 dark:text-teal-400",bgColor:"bg-teal-500/10"}].map(t=>e.jsx(h,{className:"p-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${t.bgColor}`,children:e.jsx(t.icon,{className:`w-5 h-5 ${t.iconColor}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-[#86868b] dark:text-[#98989d]",children:t.label}),e.jsx("p",{className:"text-2xl font-semibold text-[#1d1d1f] dark:text-white",children:t.value})]})]})},t.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(h,{className:"lg:col-span-2",children:[e.jsxs("div",{className:"p-4 border-b border-black/5 dark:border-white/10 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-[#1d1d1f] dark:text-white flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"}),"最近活动"]}),e.jsxs(v,{to:"/engine/dev",className:"text-sm text-teal-600 dark:text-teal-400 hover:text-teal-700 dark:hover:text-teal-300 flex items-center gap-1 transition-colors",children:["查看全部 ",e.jsx(se,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"divide-y divide-black/5 dark:divide-white/5",children:S.length===0?e.jsxs("div",{className:"p-8 text-center text-[#86868b] dark:text-white/40",children:[e.jsx(b,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"暂无最近活动"})]}):S.map(t=>e.jsx("div",{className:"p-4 hover:bg-black/[0.02] dark:hover:bg-white/5 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:H(t.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-[#1d1d1f] dark:text-white/90 truncate",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-[#86868b] dark:text-white/40",children:[e.jsx("span",{className:"font-mono bg-black/5 dark:bg-white/10 px-1.5 py-0.5 rounded",children:t.project}),t.branch&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-3 h-3"}),t.branch]})]})]}),e.jsx("span",{className:"text-xs text-[#86868b]/60 dark:text-white/30",children:G(t.time)})]})},t.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(h,{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-[#1d1d1f] dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-teal-600 dark:text-teal-400"}),"进行中"]}),a.filter(t=>t.steps.current>0&&t.steps.current<10).length===0?e.jsx("p",{className:"text-sm text-[#86868b] dark:text-white/40 py-4 text-center",children:"暂无进行中的任务"}):e.jsx("div",{className:"space-y-2",children:a.filter(t=>t.steps.current>0&&t.steps.current<10).slice(0,3).map(t=>e.jsxs(v,{to:"/engine/dev",className:"block p-3 bg-black/[0.02] dark:bg-white/5 hover:bg-black/[0.04] dark:hover:bg-white/10 rounded-xl transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-[#1d1d1f] dark:text-white/90 truncate",children:t.task.name||t.branches.current}),e.jsxs("span",{className:"text-xs text-[#86868b] dark:text-white/50",children:[t.steps.current,"/10"]})]}),e.jsx("div",{className:"w-full h-1.5 bg-black/5 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-teal-500 to-teal-600 rounded-full transition-all",style:{width:`${t.steps.current/10*100}%`}})})]},t.repo.name))})]}),e.jsxs(h,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-[#86868b] dark:text-[#98989d] mb-3",children:"快捷入口"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{to:"/engine",icon:$,label:"能力概览"},{to:"/engine/tasks",icon:b,label:"任务监控"},{to:"/engine/dev",icon:q,label:"开发任务"},{to:"/cecilia",icon:B,label:"Cecilia"}].map(t=>e.jsxs(v,{to:t.to,className:"flex items-center gap-2 p-3 bg-black/[0.02] dark:bg-white/5 hover:bg-black/[0.04] dark:hover:bg-white/10 rounded-lg transition-colors group border border-black/5 dark:border-white/10",children:[e.jsx(t.icon,{className:"w-4 h-4 text-teal-600 dark:text-teal-400 group-hover:text-teal-700 dark:group-hover:text-teal-300 transition-colors"}),e.jsx("span",{className:"text-sm text-[#1d1d1f] dark:text-[#98989d] group-hover:text-[#1d1d1f] dark:group-hover:text-white transition-colors",children:t.label})]},t.to))})]}),d&&e.jsxs(h,{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-[#1d1d1f] dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-teal-600 dark:text-teal-400"}),"Engine 能力"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-[#86868b] dark:text-white/60",children:[e.jsx("span",{children:"Skills"}),e.jsxs("span",{className:"font-medium text-[#1d1d1f] dark:text-white",children:[d.skills.length," 个"]})]}),e.jsxs("div",{className:"flex justify-between text-[#86868b] dark:text-white/60",children:[e.jsx("span",{children:"Hooks"}),e.jsxs("span",{className:"font-medium text-[#1d1d1f] dark:text-white",children:[d.hooks.length," 个"]})]}),e.jsxs("div",{className:"flex justify-between text-[#86868b] dark:text-white/60",children:[e.jsx("span",{children:"更新"}),e.jsx("span",{className:"font-medium text-[#1d1d1f] dark:text-white",children:((I=d.changelog[0])==null?void 0:I.date)||"-"})]})]})]})]})]})]})})}export{ve as default};

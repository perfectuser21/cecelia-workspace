import{r as a,j as e}from"./index-BldjrbfF.js";const x="";function y(){const[t,l]=a.useState(null),[g,h]=a.useState(!0),[n,c]=a.useState(!1),d=async()=>{try{const r=await(await fetch(`${x}/api/session/status`)).json();l(r)}catch(s){console.error("Failed to fetch session status:",s)}finally{h(!1)}},i=async()=>{c(!0);try{const r=await(await fetch(`${x}/api/session/check`,{method:"POST"})).json();r.success&&l(o=>o?{...o,last_check:r.last_check,platforms:r.platforms}:null)}catch(s){console.error("Failed to trigger check:",s)}finally{c(!1)}};a.useEffect(()=>{d();const s=setInterval(d,5*60*1e3);return()=>clearInterval(s)},[]);const u=s=>{switch(s){case"online":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"offline":return"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}},m=s=>{switch(s){case"online":return"✅";case"offline":return"❌";default:return"❓"}},b=s=>{switch(s){case"online":return"已登录";case"offline":return"已掉线";default:return"未知"}},f=t!=null&&t.platforms?Object.keys(t.platforms).length:0,j=t!=null&&t.platforms?Object.values(t.platforms).filter(s=>s.status==="online").length:0,k=t!=null&&t.platforms?Object.values(t.platforms).filter(s=>s.status==="offline").length:0;return g&&!t?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"animate-pulse",children:"Loading session status..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Session 监控"}),e.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 text-sm ${(t==null?void 0:t.runner_status)==="online"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${(t==null?void 0:t.runner_status)==="online"?"bg-green-500":"bg-red-500"}`}),"Windows Runner ",(t==null?void 0:t.runner_status)==="online"?"在线":"离线"]}),(t==null?void 0:t.last_check)&&e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["上次检查: ",new Date(t.last_check).toLocaleString("zh-CN")]})]})]}),e.jsx("button",{onClick:i,disabled:n,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 shadow-lg shadow-blue-500/25 magnetic-btn",children:n?"检查中...":"检查所有平台"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-gray-200 dark:border-slate-700 shimmer-card",children:[e.jsx("h2",{className:"font-semibold mb-4 text-gray-900 dark:text-white",children:"状态汇总"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-xl",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:j}),e.jsx("div",{className:"text-sm text-green-600/70 dark:text-green-400/70 mt-1",children:"已登录"})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-xl",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:k}),e.jsx("div",{className:"text-sm text-red-600/70 dark:text-red-400/70 mt-1",children:"已掉线"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-slate-700/50 rounded-xl",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-600 dark:text-gray-300",children:f}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"总平台数"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(t==null?void 0:t.platforms)&&Object.entries(t.platforms).map(([s,r])=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 border border-gray-200 dark:border-slate-700 tilt-card",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:r.name}),e.jsxs("span",{className:`px-2.5 py-1 rounded-lg text-sm font-medium ${u(r.status)}`,children:[m(r.status)," ",b(r.status)]})]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[r.currentUrl&&e.jsxs("p",{className:"truncate",title:r.currentUrl,children:["URL: ",e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:new URL(r.currentUrl).hostname})]}),r.error&&e.jsx("p",{className:"text-red-500 dark:text-red-400",children:r.error}),e.jsxs("p",{children:["检查时间: ",new Date(r.lastCheck).toLocaleString("zh-CN")]})]})]},s))}),(!(t!=null&&t.platforms)||Object.keys(t.platforms).length===0)&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-12 border border-gray-200 dark:border-slate-700 text-center",children:[e.jsx("div",{className:"text-gray-400 dark:text-gray-500 text-lg mb-4",children:"暂无平台状态数据"}),e.jsx("button",{onClick:i,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"点击检查所有平台"})]})]})}export{y as default};

const l=[{id:"spark",name:"Spark",codename:"点燃执行",icon:"Zap",role:"执行者",description:"解析 PRD 文档，拆解 Checkpoints，调用 Claude Code 执行代码任务",workflowKeywords:["PRD Executor","prd-executor","Execute","Cecilia"],status:"active",gradient:{from:"from-blue-500",to:"to-cyan-500",border:"border-blue-500/30"}},{id:"echo",name:"Echo",codename:"协调反馈",icon:"RefreshCw",role:"协调者",description:"监控执行状态，处理多阶段任务，分析结果并创建下一阶段",workflowKeywords:["Coordinator","coordinator","Multi-stage","Callback"],status:"active",gradient:{from:"from-emerald-500",to:"to-teal-500",border:"border-emerald-500/30"}},{id:"prism",name:"Prism",codename:"多维分析",icon:"Diamond",role:"分析者",description:"多维度分析执行结果，提供智能决策建议",workflowKeywords:["Analyzer","Analysis","Report"],status:"planned",gradient:{from:"from-violet-500",to:"to-purple-500",border:"border-violet-500/30"}}];function f(e){for(const s of l)for(const t of s.workflowKeywords)if(e.toLowerCase().includes(t.toLowerCase()))return s;return null}const g="";async function w(){try{const e=await fetch(`${g}/api/v1/n8n-live-status/instances/local/overview`);return e.ok?e.json():null}catch{return null}}function m(e){const s=new Map;for(const t of l)s.set(t.id,[]);for(const t of e||[]){const a=f(t.workflowName||t.name||"");if(a){const r=s.get(a.id)||[];r.push({id:t.id,workflowId:t.workflowId,workflowName:t.workflowName||t.name,status:t.status==="success"?"success":t.status==="error"?"error":t.status==="running"?"running":"waiting",startedAt:t.startedAt,stoppedAt:t.stoppedAt,duration:t.duration}),s.set(a.id,r)}}return s}function y(e){const s=new Date().toDateString(),t=e.filter(n=>new Date(n.startedAt).toDateString()===s),a=t.filter(n=>n.status==="success").length,r=t.filter(n=>n.status==="error").length,i=t.filter(n=>n.status==="running").length,c=t.length;return{todayTotal:c,todaySuccess:a,todayError:r,todayRunning:i,successRate:c>0&&Math.round(a/(c-i)*100)||0}}async function k(){const e=await w(),s=[...(e==null?void 0:e.runningExecutions)||[],...(e==null?void 0:e.recentCompleted)||[]],t=m(s),a=l.map(o=>{const d=t.get(o.id)||[],u=y(d);return{...o,stats:u,recentTasks:d.slice(0,5)}});let r=0,i=0,c=0;for(const o of a)r+=o.stats.todayTotal,i+=o.stats.todaySuccess,c+=o.stats.todayTotal-o.stats.todayRunning;const n=a.flatMap(o=>o.recentTasks).sort((o,d)=>new Date(d.startedAt).getTime()-new Date(o.startedAt).getTime()).slice(0,10);return{totalAgents:l.length,activeAgents:l.filter(o=>o.status==="active").length,todayTotalTasks:r,todaySuccessRate:c>0?Math.round(i/c*100):0,agents:a,recentTasks:n}}async function p(e){return(await k()).agents.find(t=>t.id===e)||null}export{p as a,k as f,f as m};

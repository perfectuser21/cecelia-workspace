import{c as y,r as x,j as e,U as k,R as f}from"./index-CNUM3QeA.js";import{C as j}from"./chevron-up-Bq2mdrxm.js";import{C as w}from"./chevron-down-BjX3Yp8T.js";import{L as g}from"./loader-2-DADMGmM9.js";import{C as b}from"./check-circle-dCxYY-hi.js";import{C as N}from"./clock-CGhI95RY.js";import{X as v}from"./x-circle-DmhysLUy.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=y("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);function S({employee:t,onViewTasks:a}){const[r,l]=x.useState(!1),{stats:s}=t,o=()=>s.todayRunning>0?"border-blue-400":s.todayError>0&&s.todaySuccess===0?"border-red-400":s.todayTotal>0?"border-green-400":"border-slate-200 dark:border-slate-700",d=()=>s.todayRunning>0?e.jsxs("span",{className:"flex items-center gap-1 text-xs font-medium px-2 py-0.5 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-full",children:[e.jsx(g,{className:"w-3 h-3 animate-spin"}),"å·¥ä½œä¸­"]}):s.todayTotal===0?e.jsx("span",{className:"text-xs font-medium px-2 py-0.5 bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 rounded-full",children:"ç©ºé—²"}):e.jsxs("span",{className:"flex items-center gap-1 text-xs font-medium px-2 py-0.5 bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 rounded-full",children:[e.jsx(b,{className:"w-3 h-3"}),"ä»Šæ—¥ ",s.todayTotal," æ¬¡"]});return e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border-2 ${o()} shadow-sm hover:shadow-md transition-all duration-300 overflow-hidden`,children:[e.jsxs("div",{className:"p-5 cursor-pointer",onClick:()=>l(!r),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 flex items-center justify-center text-2xl shadow-inner",children:t.avatar}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:t.role})]})]}),d()]}),s.todayTotal>0&&e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"text-center p-2 rounded-lg bg-green-50 dark:bg-green-900/20",children:[e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:s.todaySuccess}),e.jsx("div",{className:"text-xs text-green-600/70 dark:text-green-400/70",children:"æˆåŠŸ"})]}),e.jsxs("div",{className:"text-center p-2 rounded-lg bg-red-50 dark:bg-red-900/20",children:[e.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:s.todayError}),e.jsx("div",{className:"text-xs text-red-600/70 dark:text-red-400/70",children:"å¤±è´¥"})]}),e.jsxs("div",{className:"text-center p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:[s.successRate,"%"]}),e.jsx("div",{className:"text-xs text-blue-600/70 dark:text-blue-400/70",children:"æˆåŠŸçŽ‡"})]})]}),e.jsx("div",{className:"flex items-center justify-center text-slate-400 dark:text-slate-500 pt-1",children:r?e.jsx(j,{className:"w-5 h-5"}):e.jsx(w,{className:"w-5 h-5"})})]}),r&&e.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-700 px-5 py-4 bg-slate-50 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"èŒèƒ½èŒƒå›´"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.abilities.map(n=>e.jsx("span",{className:"text-xs px-2.5 py-1 bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-slate-600 dark:text-slate-300",title:n.description,children:n.name},n.id))})]}),s.recentTasks.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"æœ€è¿‘ä»»åŠ¡"}),e.jsx("div",{className:"space-y-2",children:s.recentTasks.map(n=>e.jsx(A,{task:n},n.id))})]}),s.recentTasks.length===0&&e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 text-center py-2",children:"ä»Šæ—¥æš‚æ— ä»»åŠ¡è®°å½•"}),a&&s.todayTotal>5&&e.jsxs("button",{onClick:n=>{n.stopPropagation(),a(t.id)},className:"w-full mt-3 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors",children:["æŸ¥çœ‹å…¨éƒ¨ ",s.todayTotal," æ¡è®°å½•"]})]})]})}function A({task:t}){const a=()=>{switch(t.status){case"success":return e.jsx(b,{className:"w-4 h-4 text-green-500"});case"error":return e.jsx(v,{className:"w-4 h-4 text-red-500"});case"running":case"waiting":return e.jsx(g,{className:"w-4 h-4 text-blue-500 animate-spin"});default:return e.jsx(N,{className:"w-4 h-4 text-slate-400"})}},r=l=>new Date(l).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-slate-700 rounded-lg",children:[a(),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200 truncate",children:t.workflowName||t.abilityName}),e.jsxs("p",{className:"text-xs text-slate-400 dark:text-slate-500",children:[t.abilityName," Â· ",r(t.startedAt)]})]})]})}const h=[{id:"media",name:"æ–°åª’ä½“éƒ¨",icon:"ðŸ“º",description:"è´Ÿè´£ç¤¾äº¤åª’ä½“è´¦å·è¿è¥å’Œå†…å®¹å‘å¸ƒ",employees:[{id:"xiaoyun",name:"å°è¿",avatar:"ðŸŽ¬",role:"å†…å®¹è¿è¥ä¸“å‘˜",description:"è´Ÿè´£å„å¹³å°è´¦å·çš„ç™»å½•ç®¡ç†å’Œå†…å®¹å‘å¸ƒ",abilities:[{id:"login",name:"è´¦å·ç™»å½•",description:"ç®¡ç†å¹³å°è´¦å·ç™»å½•çŠ¶æ€",workflowKeywords:["ç™»å½•","login","Login","VNC","vnc"]},{id:"publish",name:"å†…å®¹å‘å¸ƒ",description:"æ‰§è¡Œå†…å®¹å‘å¸ƒä»»åŠ¡",workflowKeywords:["å‘å¸ƒ","publish","Publish","post","Post"]}]},{id:"xiaoxi",name:"å°æž",avatar:"ðŸ“Š",role:"æ•°æ®åˆ†æžå¸ˆ",description:"è´Ÿè´£æ•°æ®é‡‡é›†å’Œåˆ†æžä»»åŠ¡",abilities:[{id:"scrape",name:"æ•°æ®é‡‡é›†",description:"ä»Žå„å¹³å°é‡‡é›†æ•°æ®",workflowKeywords:["çˆ¬å–","scrape","Scrape","scraping","Scraping","é‡‡é›†"]},{id:"analytics",name:"æ•°æ®åˆ†æž",description:"åˆ†æžæ•°æ®å¹¶ç”ŸæˆæŠ¥å‘Š",workflowKeywords:["åˆ†æž","analytics","Analytics","ç»Ÿè®¡","stats","Stats"]}]}]},{id:"tech",name:"æŠ€æœ¯éƒ¨",icon:"ðŸ’»",description:"è´Ÿè´£æŠ€æœ¯æ”¯æŒå’Œç³»ç»Ÿç»´æŠ¤",employees:[{id:"xiaowei",name:"å°ç»´",avatar:"ðŸ”§",role:"æŠ€æœ¯è¿ç»´ä¸“å‘˜",description:"è´Ÿè´£ AI ä»»åŠ¡è°ƒåº¦å’Œç³»ç»Ÿç»´æŠ¤",abilities:[{id:"claude",name:"AI ä»»åŠ¡",description:"æ‰§è¡Œ Claude AI ç›¸å…³ä»»åŠ¡",workflowKeywords:["claude","Claude","AI","ai","GPT","gpt"]},{id:"maintenance",name:"ç³»ç»Ÿç»´æŠ¤",description:"å®šæ—¶ç»´æŠ¤å’Œæ¸…ç†ä»»åŠ¡",workflowKeywords:["maintenance","Maintenance","nightly","Nightly","ç»´æŠ¤","æ¸…ç†","cleanup","Cleanup"]}]}]},{id:"finance",name:"è´¢åŠ¡éƒ¨",icon:"ðŸ’°",description:"é¢„ç•™éƒ¨é—¨",employees:[]}];function C(t){for(const a of h)for(const r of a.employees)for(const l of r.abilities)if(l.workflowKeywords.some(s=>t.toLowerCase().includes(s.toLowerCase())))return{employee:r,ability:l};return null}const E="";async function I(t){const a=await fetch(`${E}${t}`);if(!a.ok)throw new Error(`API error: ${a.status}`);return a.json()}async function R(t="local"){return I(`/api/v1/n8n-live-status/instances/${t}/overview`)}function L(t){const a=t.workflowName||"",r=C(a);return r?{id:t.id,workflowId:t.workflowId,workflowName:a,abilityId:r.ability.id,abilityName:r.ability.name,status:t.status==="crashed"?"error":t.status,startedAt:t.startedAt,stoppedAt:t.stoppedAt}:null}function M(t,a){const r=[];let l=0,s=0,o=0;for(const m of a){const c=L(m);c&&t.abilities.some(i=>i.id===c.abilityId)&&(r.push(c),c.status==="success"?l++:c.status==="error"?s++:(c.status==="running"||c.status==="waiting")&&o++)}const d=r.length,n=d>0?Math.round(l/d*100):0;return{todayTotal:d,todaySuccess:l,todayError:s,todayRunning:o,successRate:n,recentTasks:r.slice(0,5)}}async function P(){try{const t=await R("local"),a=[...t.runningExecutions.map(l=>({id:l.id,workflowId:l.workflowId,workflowName:l.workflowName,status:"running",startedAt:l.startedAt})),...t.recentCompleted];return h.map(l=>{const s=l.employees.map(d=>({...d,stats:M(d,a)})),o=s.reduce((d,n)=>d+n.stats.todayTotal,0);return{...l,employees:s,todayTotal:o}})}catch(t){return console.error("Failed to fetch AI employees stats:",t),h.map(a=>({...a,employees:a.employees.map(r=>({...r,stats:{todayTotal:0,todaySuccess:0,todayError:0,todayRunning:0,successRate:0,recentTasks:[]}})),todayTotal:0}))}}function F(){const[t,a]=x.useState([]),[r,l]=x.useState(!0),[s,o]=x.useState(null),[d,n]=x.useState(null),m=async()=>{l(!0),o(null);try{const i=await P();a(i),n(new Date)}catch(i){o("åŠ è½½æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•"),console.error("Failed to load AI employees:",i)}finally{l(!1)}};x.useEffect(()=>{m();const i=setInterval(m,3e4);return()=>clearInterval(i)},[]);const c=t.reduce((i,u)=>i+u.employees.length,0),p=t.reduce((i,u)=>i+u.todayTotal,0);return e.jsxs("div",{className:"px-4 sm:px-0 pb-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-semibold text-slate-800 dark:text-white mb-2 flex items-center gap-3",children:[e.jsx(k,{className:"w-8 h-8 text-blue-500"}),"AI å‘˜å·¥"]}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400",children:["å…¬å¸è‡ªåŠ¨åŒ–å›¢é˜Ÿ Â· ",c," åå‘˜å·¥ Â· ä»Šæ—¥ ",p," æ¬¡ä»»åŠ¡"]})]}),e.jsxs("button",{onClick:m,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors disabled:opacity-50",children:[e.jsx(f,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"åˆ·æ–°"]})]}),d&&e.jsxs("p",{className:"text-xs text-slate-400 dark:text-slate-500",children:["æœ€åŽæ›´æ–°: ",d.toLocaleTimeString("zh-CN")]})]}),s&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl text-red-600 dark:text-red-400",children:s}),r&&t.length===0&&e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(f,{className:"w-8 h-8 text-blue-500 animate-spin"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"åŠ è½½ä¸­..."})]})}),!r||t.length>0?e.jsx("div",{className:"space-y-8",children:t.map(i=>e.jsx(D,{department:i},i.id))}):null]})}function D({department:t}){return t.employees.length===0?e.jsxs("div",{className:"opacity-50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500",children:t.description||"æš‚æ— å‘˜å·¥"})]})]}),e.jsxs("div",{className:"p-8 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(T,{className:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400 dark:text-slate-500",children:"éƒ¨é—¨å¾…æ‹›è˜"})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[t.description,t.todayTotal>0&&e.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["Â· ä»Šæ—¥ ",t.todayTotal," æ¬¡ä»»åŠ¡"]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.employees.map(a=>e.jsx(S,{employee:a},a.id))})]})}export{F as default};

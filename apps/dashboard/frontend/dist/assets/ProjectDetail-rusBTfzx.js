import{a7 as w,r as m,j as e,R as j,ab as o,G as y,aN as _,Y as p,z as u}from"./index-D9scRkLz.js";function L(){const{name:x}=w(),[r,b]=m.useState([]),[t,f]=m.useState(null),[N,v]=m.useState(!0),h=async()=>{try{const[s,i]=await Promise.all([fetch("/api/cecelia/overview?limit=50"),fetch("/api/cecelia/projects")]),d=await s.json(),a=await i.json();d.success&&b(d.recent_runs.filter(g=>g.project===x)),a.success&&f(a.projects.find(g=>g.name===x)||null)}catch(s){console.error(s)}finally{v(!1)}};if(m.useEffect(()=>{h();const s=setInterval(h,1e4);return()=>clearInterval(s)},[x]),N)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(j,{className:"w-6 h-6 text-blue-400 animate-spin"})});const n=r.filter(s=>s.status==="running"),l=r.filter(s=>s.status==="completed"),c=r.filter(s=>s.status==="failed");return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(o,{to:"/cecelia",className:"text-gray-400 hover:text-white flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"})," 返回"]}),e.jsx("button",{onClick:h,className:"p-2 text-gray-400 hover:text-white rounded-lg hover:bg-gray-800",children:e.jsx(j,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(_,{className:"w-6 h-6 text-gray-400"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:x})]}),(t==null?void 0:t.description)&&e.jsx("p",{className:"text-gray-400 ml-9 mb-4",children:t.description}),e.jsxs("div",{className:"flex items-center gap-6 ml-9 text-sm",children:[t&&e.jsxs("span",{className:"text-gray-400",children:[t.features.length," Features"]}),n.length>0&&e.jsxs("span",{className:"flex items-center gap-2 text-blue-400",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),n.length," 运行中"]}),l.length>0&&e.jsxs("span",{className:"text-green-400",children:[l.length," 完成"]}),c.length>0&&e.jsxs("span",{className:"text-red-400",children:[c.length," 失败"]})]})]}),t&&t.features.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4",children:["Features (",t.features.length,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.features.slice(0,12).map(s=>{const i=r.some(a=>a.status==="running"&&a.feature_branch.toLowerCase().includes(s.id.toLowerCase())),d=r.some(a=>a.status==="completed"&&a.feature_branch.toLowerCase().includes(s.id.toLowerCase()));return e.jsxs("span",{className:`px-3 py-1.5 rounded-lg text-sm ${i?"bg-blue-500/20 text-blue-300 border border-blue-500/30":d?"bg-green-500/10 text-green-300 border border-green-500/20":"bg-gray-800 text-gray-400 border border-gray-700"}`,children:[i&&e.jsx("span",{className:"inline-block w-1.5 h-1.5 bg-blue-400 rounded-full mr-2 animate-pulse"}),d&&!i&&e.jsx(p,{className:"inline w-3 h-3 mr-1"}),s.name]},s.id)}),t.features.length>12&&e.jsxs("span",{className:"px-3 py-1.5 text-sm text-gray-500",children:["+",t.features.length-12," 更多"]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"任务"}),n.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-sm text-blue-400 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"运行中 (",n.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.map(s=>e.jsxs(o,{to:`/cecelia/runs/${s.id}`,className:"flex items-center justify-between p-4 bg-blue-500/10 border border-blue-500/30 rounded-xl hover:border-blue-500/50 transition",children:[e.jsx("span",{className:"text-white font-medium",children:s.prd_title||s.feature_branch}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-blue-400 font-mono text-sm",children:["Step ",s.current_step||1,"/9"]}),e.jsx(u,{className:"w-5 h-5 text-gray-500"})]})]},s.id))})]}),l.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-sm text-green-400 mb-3",children:["已完成 (",l.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[l.slice(0,5).map(s=>e.jsxs(o,{to:`/cecelia/runs/${s.id}`,className:"flex items-center justify-between p-4 bg-gray-800/50 border border-gray-700 rounded-xl hover:border-green-500/30 transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-gray-300",children:s.prd_title||s.feature_branch})]}),e.jsx(u,{className:"w-5 h-5 text-gray-600"})]},s.id)),l.length>5&&e.jsxs("p",{className:"text-sm text-gray-500 text-center py-2",children:["还有 ",l.length-5," 个"]})]})]}),c.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-sm text-red-400 mb-3",children:["失败 (",c.length,")"]}),e.jsx("div",{className:"space-y-2",children:c.map(s=>e.jsxs(o,{to:`/cecelia/runs/${s.id}`,className:"flex items-center justify-between p-4 bg-red-500/5 border border-red-500/20 rounded-xl hover:border-red-500/40 transition",children:[e.jsx("span",{className:"text-gray-400",children:s.prd_title||s.feature_branch}),e.jsx(u,{className:"w-5 h-5 text-gray-600"})]},s.id))})]}),r.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"暂无任务"})]})]})}export{L as default};

import{r as St,a3 as e1,a2 as kt,j as Jt,x as a1,L as n1,bp as i1,bq as l1}from"./index-BTTUiRJR.js";const s1=Math.PI/180;function r1(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const nn=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},k={_global:nn,version:"10.2.0",isBrowser:r1(),isUnminified:/param/.test((function(u){}).toString()),dblClickWindow:400,getAngle(u){return k.angleDeg?u*s1:u},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return k.DD.isDragging},isTransforming(){var u,e;return(e=(u=k.Transformer)===null||u===void 0?void 0:u.isTransforming())!==null&&e!==void 0?e:!1},isDragReady(){return!!k.DD.node},releaseCanvasOnDestroy:!0,document:nn.document,_injectGlobal(u){typeof nn.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),nn.Konva=u}},Yt=u=>{k[u.prototype.getClassName()]=u};k._injectGlobal(k);const u1=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,mh=()=>{if(typeof document>"u")throw new Error(u1)};class xe{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new xe(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){const n=this.m;return{x:n[0]*e.x+n[2]*e.y+n[4],y:n[1]*e.x+n[3]*e.y+n[5]}}translate(e,n){return this.m[4]+=this.m[0]*e+this.m[2]*n,this.m[5]+=this.m[1]*e+this.m[3]*n,this}scale(e,n){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=n,this.m[3]*=n,this}rotate(e){const n=Math.cos(e),l=Math.sin(e),s=this.m[0]*n+this.m[2]*l,o=this.m[1]*n+this.m[3]*l,c=this.m[0]*-l+this.m[2]*n,f=this.m[1]*-l+this.m[3]*n;return this.m[0]=s,this.m[1]=o,this.m[2]=c,this.m[3]=f,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,n){const l=this.m[0]+this.m[2]*n,s=this.m[1]+this.m[3]*n,o=this.m[2]+this.m[0]*e,c=this.m[3]+this.m[1]*e;return this.m[0]=l,this.m[1]=s,this.m[2]=o,this.m[3]=c,this}multiply(e){const n=this.m[0]*e.m[0]+this.m[2]*e.m[1],l=this.m[1]*e.m[0]+this.m[3]*e.m[1],s=this.m[0]*e.m[2]+this.m[2]*e.m[3],o=this.m[1]*e.m[2]+this.m[3]*e.m[3],c=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],f=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=n,this.m[1]=l,this.m[2]=s,this.m[3]=o,this.m[4]=c,this.m[5]=f,this}invert(){const e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*e,l=-this.m[1]*e,s=-this.m[2]*e,o=this.m[0]*e,c=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),f=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=l,this.m[2]=s,this.m[3]=o,this.m[4]=c,this.m[5]=f,this}getMatrix(){return this.m}decompose(){const e=this.m[0],n=this.m[1],l=this.m[2],s=this.m[3],o=this.m[4],c=this.m[5],f=e*s-n*l,g={x:o,y:c,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||n!=0){const m=Math.sqrt(e*e+n*n);g.rotation=n>0?Math.acos(e/m):-Math.acos(e/m),g.scaleX=m,g.scaleY=f/m,g.skewX=(e*l+n*s)/f,g.skewY=0}else if(l!=0||s!=0){const m=Math.sqrt(l*l+s*s);g.rotation=Math.PI/2-(s>0?Math.acos(-l/m):-Math.acos(l/m)),g.scaleX=f/m,g.scaleY=m,g.skewX=0,g.skewY=(e*l+n*s)/f}return g.rotation=x._getRotation(g.rotation),g}}const o1="[object Array]",c1="[object Number]",h1="[object String]",f1="[object Boolean]",d1=Math.PI/180,g1=180/Math.PI,_i="#",m1="",p1="0",y1="Konva warning: ",ph="Konva error: ",v1="rgb(",jr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S1=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let Ll=[],bi=null;const _1=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(u){setTimeout(u,16)},x={_isElement(u){return!!(u&&u.nodeType==1)},_isFunction(u){return!!(u&&u.constructor&&u.call&&u.apply)},_isPlainObject(u){return!!u&&u.constructor===Object},_isArray(u){return Object.prototype.toString.call(u)===o1},_isNumber(u){return Object.prototype.toString.call(u)===c1&&!isNaN(u)&&isFinite(u)},_isString(u){return Object.prototype.toString.call(u)===h1},_isBoolean(u){return Object.prototype.toString.call(u)===f1},isObject(u){return u instanceof Object},isValidSelector(u){if(typeof u!="string")return!1;const e=u[0];return e==="#"||e==="."||e===e.toUpperCase()},_sign(u){return u===0||u>0?1:-1},requestAnimFrame(u){Ll.push(u),Ll.length===1&&_1(function(){const e=Ll;Ll=[],e.forEach(function(n){n()})})},createCanvasElement(){mh();const u=document.createElement("canvas");try{u.style=u.style||{}}catch{}return u},createImageElement(){return mh(),document.createElement("img")},_isInDocument(u){for(;u=u.parentNode;)if(u==document)return!0;return!1},_urlToImage(u,e){const n=x.createImageElement();n.onload=function(){e(n)},n.src=u},_rgbToHex(u,e,n){return((1<<24)+(u<<16)+(e<<8)+n).toString(16).slice(1)},_hexToRgb(u){u=u.replace(_i,m1);const e=parseInt(u,16);return{r:e>>16&255,g:e>>8&255,b:e&255}},getRandomColor(){let u=(Math.random()*16777215<<0).toString(16);for(;u.length<6;)u=p1+u;return _i+u},isCanvasFarblingActive(){if(bi!==null)return bi;if(typeof document>"u")return bi=!1,!1;const u=this.createCanvasElement();u.width=10,u.height=10;const e=u.getContext("2d",{willReadFrequently:!0});e.clearRect(0,0,10,10),e.fillStyle="#282828",e.fillRect(0,0,10,10);const n=e.getImageData(0,0,10,10).data;let l=!1;for(let s=0;s<100;s++)if(n[s*4]!==40||n[s*4+1]!==40||n[s*4+2]!==40||n[s*4+3]!==255){l=!0;break}return bi=l,this.releaseCanvas(u),bi},getHitColor(){const u=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(u):u},getHitColorKey(u,e,n){return this.isCanvasFarblingActive()&&(u=Math.round(u/5)*5,e=Math.round(e/5)*5,n=Math.round(n/5)*5),_i+this._rgbToHex(u,e,n)},getSnappedHexColor(u){const e=this._hexToRgb(u);return _i+this._rgbToHex(Math.round(e.r/5)*5,Math.round(e.g/5)*5,Math.round(e.b/5)*5)},getRGB(u){let e;return u in jr?(e=jr[u],{r:e[0],g:e[1],b:e[2]}):u[0]===_i?this._hexToRgb(u.substring(1)):u.substr(0,4)===v1?(e=S1.exec(u.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(u){return u=u||"black",x._namedColorToRBA(u)||x._hex3ColorToRGBA(u)||x._hex4ColorToRGBA(u)||x._hex6ColorToRGBA(u)||x._hex8ColorToRGBA(u)||x._rgbColorToRGBA(u)||x._rgbaColorToRGBA(u)||x._hslColorToRGBA(u)},_namedColorToRBA(u){const e=jr[u.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(u){if(u.indexOf("rgb(")===0){u=u.match(/rgb\(([^)]+)\)/)[1];const e=u.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(u){if(u.indexOf("rgba(")===0){u=u.match(/rgba\(([^)]+)\)/)[1];const e=u.split(/ *, */).map((n,l)=>n.slice(-1)==="%"?l===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(u){if(u[0]==="#"&&u.length===9)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:parseInt(u.slice(7,9),16)/255}},_hex6ColorToRGBA(u){if(u[0]==="#"&&u.length===7)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:1}},_hex4ColorToRGBA(u){if(u[0]==="#"&&u.length===5)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:parseInt(u[4]+u[4],16)/255}},_hex3ColorToRGBA(u){if(u[0]==="#"&&u.length===4)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:1}},_hslColorToRGBA(u){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(u)){const[e,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(u),l=Number(n[0])/360,s=Number(n[1])/100,o=Number(n[2])/100;let c,f,g;if(s===0)return g=o*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};o<.5?c=o*(1+s):c=o+s-o*s;const m=2*o-c,y=[0,0,0];for(let S=0;S<3;S++)f=l+1/3*-(S-1),f<0&&f++,f>1&&f--,6*f<1?g=m+(c-m)*6*f:2*f<1?g=c:3*f<2?g=m+(c-m)*(2/3-f)*6:g=m,y[S]=g*255;return{r:Math.round(y[0]),g:Math.round(y[1]),b:Math.round(y[2]),a:1}}},haveIntersection(u,e){return!(e.x>u.x+u.width||e.x+e.width<u.x||e.y>u.y+u.height||e.y+e.height<u.y)},cloneObject(u){const e={};for(const n in u)this._isPlainObject(u[n])?e[n]=this.cloneObject(u[n]):this._isArray(u[n])?e[n]=this.cloneArray(u[n]):e[n]=u[n];return e},cloneArray(u){return u.slice(0)},degToRad(u){return u*d1},radToDeg(u){return u*g1},_degToRad(u){return x.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),x.degToRad(u)},_radToDeg(u){return x.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),x.radToDeg(u)},_getRotation(u){return k.angleDeg?x.radToDeg(u):u},_capitalize(u){return u.charAt(0).toUpperCase()+u.slice(1)},throw(u){throw new Error(ph+u)},error(u){console.error(ph+u)},warn(u){k.showWarnings&&console.warn(y1+u)},each(u,e){for(const n in u)e(n,u[n])},_inRange(u,e,n){return e<=u&&u<n},_getProjectionToSegment(u,e,n,l,s,o){let c,f,g;const m=(u-n)*(u-n)+(e-l)*(e-l);if(m==0)c=u,f=e,g=(s-n)*(s-n)+(o-l)*(o-l);else{const y=((s-u)*(n-u)+(o-e)*(l-e))/m;y<0?(c=u,f=e,g=(u-s)*(u-s)+(e-o)*(e-o)):y>1?(c=n,f=l,g=(n-s)*(n-s)+(l-o)*(l-o)):(c=u+y*(n-u),f=e+y*(l-e),g=(c-s)*(c-s)+(f-o)*(f-o))}return[c,f,g]},_getProjectionToLine(u,e,n){const l=x.cloneObject(u);let s=Number.MAX_VALUE;return e.forEach(function(o,c){if(!n&&c===e.length-1)return;const f=e[(c+1)%e.length],g=x._getProjectionToSegment(o.x,o.y,f.x,f.y,u.x,u.y),m=g[0],y=g[1],S=g[2];S<s&&(l.x=m,l.y=y,s=S)}),l},_prepareArrayForTween(u,e,n){const l=[],s=[];if(u.length>e.length){const c=e;e=u,u=c}for(let c=0;c<u.length;c+=2)l.push({x:u[c],y:u[c+1]});for(let c=0;c<e.length;c+=2)s.push({x:e[c],y:e[c+1]});const o=[];return s.forEach(function(c){const f=x._getProjectionToLine(c,l,n);o.push(f.x),o.push(f.y)}),o},_prepareToStringify(u){let e;u.visitedByCircularReferenceRemoval=!0;for(const n in u)if(u.hasOwnProperty(n)&&u[n]&&typeof u[n]=="object"){if(e=Object.getOwnPropertyDescriptor(u,n),u[n].visitedByCircularReferenceRemoval||x._isElement(u[n]))if(e.configurable)delete u[n];else return null;else if(x._prepareToStringify(u[n])===null)if(e.configurable)delete u[n];else return null}return delete u.visitedByCircularReferenceRemoval,u},_assign(u,e){for(const n in e)u[n]=e[n];return u},_getFirstPointerId(u){return u.touches?u.changedTouches[0].identifier:u.pointerId||999},releaseCanvas(...u){k.releaseCanvasOnDestroy&&u.forEach(e=>{e.width=0,e.height=0})},drawRoundedRectPath(u,e,n,l){let s=e<0?e:0,o=n<0?n:0;e=Math.abs(e),n=Math.abs(n);let c=0,f=0,g=0,m=0;typeof l=="number"?c=f=g=m=Math.min(l,e/2,n/2):(c=Math.min(l[0]||0,e/2,n/2),f=Math.min(l[1]||0,e/2,n/2),m=Math.min(l[2]||0,e/2,n/2),g=Math.min(l[3]||0,e/2,n/2)),u.moveTo(s+c,o),u.lineTo(s+e-f,o),u.arc(s+e-f,o+f,f,Math.PI*3/2,0,!1),u.lineTo(s+e,o+n-m),u.arc(s+e-m,o+n-m,m,0,Math.PI/2,!1),u.lineTo(s+g,o+n),u.arc(s+g,o+n-g,g,Math.PI/2,Math.PI,!1),u.lineTo(s,o+c),u.arc(s+c,o+c,c,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(u,e,n,l,s){l=Math.abs(l);for(let o=0;o<n;o++){const c=e[(o-1+n)%n],f=e[o],g=e[(o+1)%n],m={x:f.x-c.x,y:f.y-c.y},y={x:g.x-f.x,y:g.y-f.y},S=Math.hypot(m.x,m.y),p=Math.hypot(y.x,y.y);let C;typeof s=="number"?C=s:C=o<s.length?s[o]:0,C=l*Math.cos(Math.PI/n)*Math.min(1,C/l*2);const R={x:m.x/S,y:m.y/S},N={x:y.x/p,y:y.y/p},A={x:f.x-R.x*C,y:f.y-R.y*C},z={x:f.x+N.x*C,y:f.y+N.y*C};o===0?u.moveTo(A.x,A.y):u.lineTo(A.x,A.y),u.arcTo(f.x,f.y,z.x,z.y,C)}}};function b1(u){const e=[],n=u.length,l=x;for(let s=0;s<n;s++){let o=u[s];l._isNumber(o)?o=Math.round(o*1e3)/1e3:l._isString(o)||(o=o+""),e.push(o)}return e}const yh=",",C1="(",E1=")",T1="([",x1="])",A1=";",M1="()",R1="=",vh=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],N1=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],z1=100;let Yl=null;function Sh(){if(Yl!==null)return Yl;try{const e=x.createCanvasElement().getContext("2d");return e?!!e&&"filter"in e:(Yl=!1,!1)}catch{return Yl=!1,!1}}class Il{constructor(e){this.canvas=e,k.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){let l=this.traceArr,s=l.length,o="",c,f,g,m;for(c=0;c<s;c++)f=l[c],g=f.method,g?(m=f.args,o+=g,e?o+=M1:x._isArray(m[0])?o+=T1+m.join(yh)+x1:(n&&(m=m.map(y=>typeof y=="number"?Math.floor(y):y)),o+=C1+m.join(yh)+E1)):(o+=f.property,e||(o+=R1+f.val)),o+=A1;return o}clearTrace(){this.traceArr=[]}_trace(e){let n=this.traceArr,l;n.push(e),l=n.length,l>=z1&&n.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){const n=e.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(e){const n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){const n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(e){const n=e.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(e,n){this._context[e]=n}arc(e,n,l,s,o,c){this._context.arc(e,n,l,s,o,c)}arcTo(e,n,l,s,o){this._context.arcTo(e,n,l,s,o)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,l,s,o,c){this._context.bezierCurveTo(e,n,l,s,o,c)}clearRect(e,n,l,s){this._context.clearRect(e,n,l,s)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,n){const l=arguments;if(l.length===2)return this._context.createImageData(e,n);if(l.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,l,s){return this._context.createLinearGradient(e,n,l,s)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,l,s,o,c){return this._context.createRadialGradient(e,n,l,s,o,c)}drawImage(e,n,l,s,o,c,f,g,m){const y=arguments,S=this._context;y.length===3?S.drawImage(e,n,l):y.length===5?S.drawImage(e,n,l,s,o):y.length===9&&S.drawImage(e,n,l,s,o,c,f,g,m)}ellipse(e,n,l,s,o,c,f,g){this._context.ellipse(e,n,l,s,o,c,f,g)}isPointInPath(e,n,l,s){return l?this._context.isPointInPath(l,e,n,s):this._context.isPointInPath(e,n,s)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,n,l,s){this._context.fillRect(e,n,l,s)}strokeRect(e,n,l,s){this._context.strokeRect(e,n,l,s)}fillText(e,n,l,s){s?this._context.fillText(e,n,l,s):this._context.fillText(e,n,l)}measureText(e){return this._context.measureText(e)}getImageData(e,n,l,s){return this._context.getImageData(e,n,l,s)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,l,s){this._context.rect(e,n,l,s)}roundRect(e,n,l,s,o){this._context.roundRect(e,n,l,s,o)}putImageData(e,n,l){this._context.putImageData(e,n,l)}quadraticCurveTo(e,n,l,s){this._context.quadraticCurveTo(e,n,l,s)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,l,s,o,c){this._context.setTransform(e,n,l,s,o,c)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,l,s){this._context.strokeText(e,n,l,s)}transform(e,n,l,s,o,c){this._context.transform(e,n,l,s,o,c)}translate(e,n){this._context.translate(e,n)}_enableTrace(){let e=this,n=vh.length,l=this.setAttr,s,o;const c=function(f){let g=e[f],m;e[f]=function(){return o=b1(Array.prototype.slice.call(arguments,0)),m=g.apply(e,arguments),e._trace({method:f,args:o}),m}};for(s=0;s<n;s++)c(vh[s]);e.setAttr=function(){l.apply(e,arguments);const f=arguments[0];let g=arguments[1];(f==="shadowOffsetX"||f==="shadowOffsetY"||f==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),e._trace({property:f,val:g})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}N1.forEach(function(u){Object.defineProperty(Il.prototype,u,{get(){return this._context[u]},set(e){this._context[u]=e}})});class O1 extends Il{constructor(e,{willReadFrequently:n=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(e){const n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){const n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){const n=e.fill(),l=e.getFillPriority();if(n&&l==="color"){this._fillColor(e);return}const s=e.getFillPatternImage();if(s&&l==="pattern"){this._fillPattern(e);return}const o=e.getFillLinearGradientColorStops();if(o&&l==="linear-gradient"){this._fillLinearGradient(e);return}const c=e.getFillRadialGradientColorStops();if(c&&l==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):s?this._fillPattern(e):o?this._fillLinearGradient(e):c&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const n=e.getStrokeLinearGradientStartPoint(),l=e.getStrokeLinearGradientEndPoint(),s=e.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(n.x,n.y,l.x,l.y);if(s){for(let c=0;c<s.length;c+=2)o.addColorStop(s[c],s[c+1]);this.setAttr("strokeStyle",o)}}_stroke(e){const n=e.dash(),l=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!l){this.save();const o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),l||this.restore()}}_applyShadow(e){var n,l,s;const o=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",c=(l=e.getShadowBlur())!==null&&l!==void 0?l:5,f=(s=e.getShadowOffset())!==null&&s!==void 0?s:{x:0,y:0},g=e.getAbsoluteScale(),m=this.canvas.getPixelRatio(),y=g.x*m,S=g.y*m;this.setAttr("shadowColor",o),this.setAttr("shadowBlur",c*Math.min(Math.abs(y),Math.abs(S))),this.setAttr("shadowOffsetX",f.x*y),this.setAttr("shadowOffsetY",f.y*S)}}class D1 extends Il{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const n=e.getStrokeScaleEnabled();if(!n){this.save();const o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(e);const l=e.hitStrokeWidth(),s=l==="auto"?e.strokeWidth():l;this.setAttr("lineWidth",s),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),n||this.restore()}}}let Xl;function G1(){if(Xl)return Xl;const u=x.createCanvasElement(),e=u.getContext("2d");return Xl=function(){const n=k._global.devicePixelRatio||1,l=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/l}(),x.releaseCanvas(u),Xl}class cu{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const l=(e||{}).pixelRatio||k.pixelRatio||G1();this.pixelRatio=l,this._canvas=x.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const n=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,n){this.setWidth(e||0),this.setHeight(n||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(s){return x.error("Unable to get data URL. "+s.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class Oa extends cu{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new O1(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}class hu extends cu{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new D1(this),this.setSize(e.width,e.height)}}const Tt={get isDragging(){let u=!1;return Tt._dragElements.forEach(e=>{e.dragStatus==="dragging"&&(u=!0)}),u},justDragged:!1,get node(){let u;return Tt._dragElements.forEach(e=>{u=e.node}),u},_dragElements:new Map,_drag(u){const e=[];Tt._dragElements.forEach((n,l)=>{const{node:s}=n,o=s.getStage();o.setPointersPositions(u),n.pointerId===void 0&&(n.pointerId=x._getFirstPointerId(u));const c=o._changedPointerPositions.find(f=>f.id===n.pointerId);if(c){if(n.dragStatus!=="dragging"){const f=s.dragDistance();if(Math.max(Math.abs(c.x-n.startPointerPos.x),Math.abs(c.y-n.startPointerPos.y))<f||(s.startDrag({evt:u}),!s.isDragging()))return}s._setDragPosition(u,n),e.push(s)}}),e.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:u},!0)})},_endDragBefore(u){const e=[];Tt._dragElements.forEach(n=>{const{node:l}=n,s=l.getStage();if(u&&s.setPointersPositions(u),!s._changedPointerPositions.find(f=>f.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(Tt.justDragged=!0,k._mouseListenClick=!1,k._touchListenClick=!1,k._pointerListenClick=!1,n.dragStatus="stopped");const c=n.node.getLayer()||n.node instanceof k.Stage&&n.node;c&&e.indexOf(c)===-1&&e.push(c)}),e.forEach(n=>{n.draw()})},_endDragAfter(u){Tt._dragElements.forEach((e,n)=>{e.dragStatus==="stopped"&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:u},!0),e.dragStatus!=="dragging"&&Tt._dragElements.delete(n)})}};k.isBrowser&&(window.addEventListener("mouseup",Tt._endDragBefore,!0),window.addEventListener("touchend",Tt._endDragBefore,!0),window.addEventListener("touchcancel",Tt._endDragBefore,!0),window.addEventListener("mousemove",Tt._drag),window.addEventListener("touchmove",Tt._drag),window.addEventListener("mouseup",Tt._endDragAfter,!1),window.addEventListener("touchend",Tt._endDragAfter,!1),window.addEventListener("touchcancel",Tt._endDragAfter,!1));function Da(u){return x._isString(u)?'"'+u+'"':Object.prototype.toString.call(u)==="[object Number]"||x._isBoolean(u)?u:Object.prototype.toString.call(u)}function Jh(u){return u>255?255:u<0?0:Math.round(u)}function P(){if(k.isUnminified)return function(u,e){return x._isNumber(u)||x.warn(Da(u)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),u}}function $l(u){if(k.isUnminified)return function(e,n){let l=x._isNumber(e),s=x._isArray(e)&&e.length==u;return!l&&!s&&x.warn(Da(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+u+")"),e}}function fu(){if(k.isUnminified)return function(u,e){return x._isNumber(u)||u==="auto"||x.warn(Da(u)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),u}}function ln(){if(k.isUnminified)return function(u,e){return x._isString(u)||x.warn(Da(u)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),u}}function Ph(){if(k.isUnminified)return function(u,e){const n=x._isString(u),l=Object.prototype.toString.call(u)==="[object CanvasGradient]"||u&&u.addColorStop;return n||l||x.warn(Da(u)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),u}}function H1(){if(k.isUnminified)return function(u,e){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&u instanceof n||(x._isArray(u)?u.forEach(function(l){x._isNumber(l)||x.warn('"'+e+'" attribute has non numeric element '+l+". Make sure that all elements are numbers.")}):x.warn(Da(u)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),u}}function Xe(){if(k.isUnminified)return function(u,e){return u===!0||u===!1||x.warn(Da(u)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),u}}function B1(u){if(k.isUnminified)return function(e,n){return e==null||x.isObject(e)||x.warn(Da(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+u),e}}const Ci="get",Ei="set",b={addGetterSetter(u,e,n,l,s){b.addGetter(u,e,n),b.addSetter(u,e,l,s),b.addOverloadedGetterSetter(u,e)},addGetter(u,e,n){const l=Ci+x._capitalize(e);u.prototype[l]=u.prototype[l]||function(){const s=this.attrs[e];return s===void 0?n:s}},addSetter(u,e,n,l){const s=Ei+x._capitalize(e);u.prototype[s]||b.overWriteSetter(u,e,n,l)},overWriteSetter(u,e,n,l){const s=Ei+x._capitalize(e);u.prototype[s]=function(o){return n&&o!==void 0&&o!==null&&(o=n.call(this,o,e)),this._setAttr(e,o),l&&l.call(this),this}},addComponentsGetterSetter(u,e,n,l,s){const o=n.length,c=x._capitalize,f=Ci+c(e),g=Ei+c(e);u.prototype[f]=function(){const y={};for(let S=0;S<o;S++){const p=n[S];y[p]=this.getAttr(e+c(p))}return y};const m=B1(n);u.prototype[g]=function(y){const S=this.attrs[e];l&&(y=l.call(this,y,e)),m&&m.call(this,y,e);for(const p in y)y.hasOwnProperty(p)&&this._setAttr(e+c(p),y[p]);return y||n.forEach(p=>{this._setAttr(e+c(p),void 0)}),this._fireChangeEvent(e,S,y),s&&s.call(this),this},b.addOverloadedGetterSetter(u,e)},addOverloadedGetterSetter(u,e){const n=x._capitalize(e),l=Ei+n,s=Ci+n;u.prototype[e]=function(){return arguments.length?(this[l](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter(u,e,n,l){x.error("Adding deprecated "+e);const s=Ci+x._capitalize(e),o=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";u.prototype[s]=function(){x.error(o);const c=this.attrs[e];return c===void 0?n:c},b.addSetter(u,e,l,function(){x.error(o)}),b.addOverloadedGetterSetter(u,e)},backCompat(u,e){x.each(e,function(n,l){const s=u.prototype[l],o=Ci+x._capitalize(n),c=Ei+x._capitalize(n);function f(){s.apply(this,arguments),x.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}u.prototype[n]=f,u.prototype[o]=f,u.prototype[c]=f})},afterSetFilter(){this._filterUpToDate=!1}};function U1(u){const e=/(\w+)\(([^)]+)\)/g;let n;for(;(n=e.exec(u))!==null;){const[,l,s]=n;switch(l){case"blur":{const o=parseFloat(s.replace("px",""));return function(c){this.blurRadius(o*.5);const f=k.Filters;f&&f.Blur&&f.Blur.call(this,c)}}case"brightness":{const o=s.includes("%")?parseFloat(s)/100:parseFloat(s);return function(c){this.brightness(o);const f=k.Filters;f&&f.Brightness&&f.Brightness.call(this,c)}}case"contrast":{const o=parseFloat(s);return function(c){const f=100*(Math.sqrt(o)-1);this.contrast(f);const g=k.Filters;g&&g.Contrast&&g.Contrast.call(this,c)}}case"grayscale":return function(o){const c=k.Filters;c&&c.Grayscale&&c.Grayscale.call(this,o)};case"sepia":return function(o){const c=k.Filters;c&&c.Sepia&&c.Sepia.call(this,o)};case"invert":return function(o){const c=k.Filters;c&&c.Invert&&c.Invert.call(this,o)};default:x.warn(`CSS filter "${l}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const Pl="absoluteOpacity",_h="allEventListeners",sa="absoluteTransform",bh="absoluteScale",an="canvas",L1="Change",Y1="children",X1="konva",$r="listening",w1="mouseenter",q1="mouseleave",j1="pointerenter",V1="pointerleave",K1="touchenter",Q1="touchleave",Ch="set",Eh="Shape",Fl=" ",Th="stage",Na="transform",Z1="Stage",tu="visible",J1=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Fl);let P1=1;class Q{constructor(e){this._id=P1++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Na||e===sa)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){let l=this._cache.get(e);return(l===void 0||(e===Na||e===sa)&&l.dirty===!0)&&(l=n.call(this),this._cache.set(e,l)),l}_calculate(e,n,l){if(!this._attachedDepsListeners.get(e)){const s=n.map(o=>o+"Change.konva").join(Fl);this.on(s,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,l)}_getCanvasCache(){return this._cache.get(an)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===sa&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(an)){const{scene:e,filter:n,hit:l}=this._cache.get(an);x.releaseCanvas(e._canvas,n._canvas,l._canvas),this._cache.delete(an)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const n=e||{};let l={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(l=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let s=Math.ceil(n.width||l.width),o=Math.ceil(n.height||l.height),c=n.pixelRatio,f=n.x===void 0?Math.floor(l.x):n.x,g=n.y===void 0?Math.floor(l.y):n.y,m=n.offset||0,y=n.drawBorder||!1,S=n.hitCanvasPixelRatio||1;if(!s||!o){x.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const p=Math.abs(Math.round(l.x)-f)>.5?1:0,C=Math.abs(Math.round(l.y)-g)>.5?1:0;s+=m*2+p,o+=m*2+C,f-=m,g-=m;const _=new Oa({pixelRatio:c,width:s,height:o}),R=new Oa({pixelRatio:c,width:0,height:0,willReadFrequently:!0}),N=new hu({pixelRatio:S,width:s,height:o}),A=_.getContext(),z=N.getContext(),L=new Oa({width:_.width/_.pixelRatio+Math.abs(f),height:_.height/_.pixelRatio+Math.abs(g),pixelRatio:_.pixelRatio}),U=L.getContext();return N.isCache=!0,_.isCache=!0,this._cache.delete(an),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(_.getContext()._context.imageSmoothingEnabled=!1,R.getContext()._context.imageSmoothingEnabled=!1),A.save(),z.save(),U.save(),A.translate(-f,-g),z.translate(-f,-g),U.translate(-f,-g),L.x=f,L.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Pl),this._clearSelfAndDescendantCache(bh),this.drawScene(_,this,L),this.drawHit(N,this),this._isUnderCache=!1,A.restore(),z.restore(),y&&(A.save(),A.beginPath(),A.rect(0,0,s,o),A.closePath(),A.setAttr("strokeStyle","red"),A.setAttr("lineWidth",5),A.stroke(),A.restore()),x.releaseCanvas(L._canvas),this._cache.set(an,{scene:_,filter:R,hit:N,x:f,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(an)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){const l=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let s=1/0,o=1/0,c=-1/0,f=-1/0;const g=this.getAbsoluteTransform(n);return l.forEach(function(m){const y=g.point(m);s===void 0&&(s=c=y.x,o=f=y.y),s=Math.min(s,y.x),o=Math.min(o,y.y),c=Math.max(c,y.x),f=Math.max(f,y.y)}),{x:s,y:o,width:c-s,height:f-o}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);const l=this._getCachedSceneCanvas(),s=l.pixelRatio;e.drawImage(l._canvas,0,0,l.width/s,l.height/s),e.restore()}_drawCachedHitCanvas(e){const n=this._getCanvasCache(),l=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(l._canvas,0,0,l.width/l.pixelRatio,l.height/l.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),n=this._getCanvasCache(),l=n.scene,s=n.filter,o=s.getContext(),c,f,g,m;if(!e||e.length===0)return l;if(this._filterUpToDate)return s;let y=!0;for(let p=0;p<e.length;p++)if(typeof e[p]=="string"&&Sh(),typeof e[p]!="string"||!Sh()){y=!1;break}const S=l.pixelRatio;if(s.setSize(l.width/l.pixelRatio,l.height/l.pixelRatio),y){const p=e.join(" ");return o.save(),o.setAttr("filter",p),o.drawImage(l._canvas,0,0,l.getWidth()/S,l.getHeight()/S),o.restore(),this._filterUpToDate=!0,s}try{for(c=e.length,o.clear(),o.drawImage(l._canvas,0,0,l.getWidth()/S,l.getHeight()/S),f=o.getImageData(0,0,s.getWidth(),s.getHeight()),g=0;g<c;g++)m=e[g],typeof m=="string"&&(m=U1(m)),m.call(this,f),o.putImageData(f,0,0)}catch(p){x.error("Unable to apply filter. "+p.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,s}on(e,n){if(this._cache&&this._cache.delete(_h),arguments.length===3)return this._delegate.apply(this,arguments);const l=e.split(Fl);for(let s=0;s<l.length;s++){const c=l[s].split("."),f=c[0],g=c[1]||"";this.eventListeners[f]||(this.eventListeners[f]=[]),this.eventListeners[f].push({name:g,handler:n})}return this}off(e,n){let l=(e||"").split(Fl),s=l.length,o,c,f,g,m,y;if(this._cache&&this._cache.delete(_h),!e)for(c in this.eventListeners)this._off(c);for(o=0;o<s;o++)if(f=l[o],g=f.split("."),m=g[0],y=g[1],m)this.eventListeners[m]&&this._off(m,y,n);else for(c in this.eventListeners)this._off(c,y,n);return this}dispatchEvent(e){const n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(l){n.call(this,l.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,l){const s=this;this.on(e,function(o){const c=o.target.findAncestors(n,!0,s);for(let f=0;f<c.length;f++)o=x.cloneObject(o),o.currentTarget=c[f],l.call(c[f],o)})}remove(){return this.isDragging()&&this.stopDrag(),Tt._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(sa),this._clearSelfAndDescendantCache(Pl),this._clearSelfAndDescendantCache(bh),this._clearSelfAndDescendantCache(Th),this._clearSelfAndDescendantCache(tu),this._clearSelfAndDescendantCache($r)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const n="get"+x._capitalize(e);return x._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){let e=this.getParent(),n=[];for(;e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let n,l;if(!e)return this;for(n in e)n!==Y1&&(l=Ch+x._capitalize(n),x._isFunction(this[l])?this[l](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache($r,this._isListening)}_isListening(e){if(!this.listening())return!1;const l=this.getParent();return l&&l!==e&&this!==e?l._isListening(e):!0}isVisible(){return this._getCache(tu,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const l=this.getParent();return l&&l!==e&&this!==e?l._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);const l=this.getLayer();let s=!1;Tt._dragElements.forEach(c=>{c.dragStatus==="dragging"&&(c.node.nodeType==="Stage"||c.node.getLayer()===l)&&(s=!0)});const o=!n&&!k.hitOnDragEnabled&&(s||k.isTransforming());return this.isListening()&&this.isVisible()&&!o}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),n=this,l=0,s,o,c,f;function g(y){for(s=[],o=y.length,c=0;c<o;c++)f=y[c],l++,f.nodeType!==Eh&&(s=s.concat(f.getChildren().slice())),f._id===n._id&&(c=o);s.length>0&&s[0].getDepth()<=e&&g(s)}const m=this.getStage();return n.nodeType!==Z1&&m&&g(m.getChildren()),l}getDepth(){let e=0,n=this.parent;for(;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Na),this._clearSelfAndDescendantCache(sa)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const n=e.getPointerPosition();if(!n)return null;const l=this.getAbsoluteTransform().copy();return l.invert(),l.point(n)}getAbsolutePosition(e){let n=!1,l=this.parent;for(;l;){if(l.isCached()){n=!0;break}l=l.parent}n&&!e&&(e=!0);const s=this.getAbsoluteTransform(e).getMatrix(),o=new xe,c=this.offset();return o.m=s.slice(),o.translate(c.x,c.y),o.getTranslation()}setAbsolutePosition(e){const{x:n,y:l,...s}=this._clearTransform();this.attrs.x=n,this.attrs.y=l,this._clearCache(Na);const o=this._getAbsoluteTransform().copy();return o.invert(),o.translate(e.x,e.y),e={x:this.attrs.x+o.getTranslation().x,y:this.attrs.y+o.getTranslation().y},this._setTransform(s),this.setPosition({x:e.x,y:e.y}),this._clearCache(Na),this._clearSelfAndDescendantCache(sa),this}_setTransform(e){let n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let n=e.x,l=e.y,s=this.x(),o=this.y();return n!==void 0&&(s+=n),l!==void 0&&(o+=l),this.setPosition({x:s,y:o}),this}_eachAncestorReverse(e,n){let l=[],s=this.getParent(),o,c;if(!(n&&n._id===this._id)){for(l.unshift(this);s&&(!n||s._id!==n._id);)l.unshift(s),s=s.parent;for(o=l.length,c=0;c<o;c++)e(l[c])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return x.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return x.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return x.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return x.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return x.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&x.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Pl,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),n,l,s,o,c;const f={attrs:{},className:this.getClassName()};for(n in e)l=e[n],c=x.isObject(l)&&!x._isPlainObject(l)&&!x._isArray(l),!c&&(s=typeof this[n]=="function"&&this[n],delete e[n],o=s?s.call(this):null,e[n]=l,o!==l&&(f.attrs[n]=l));return x._prepareToStringify(f)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,l){const s=[];n&&this._isMatch(e)&&s.push(this);let o=this.parent;for(;o;){if(o===l)return s;o._isMatch(e)&&s.push(o),o=o.parent}return s}isAncestorOf(e){return!1}findAncestor(e,n,l){return this.findAncestors(e,n,l)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let n=e.replace(/ /g,"").split(","),l=n.length,s,o;for(s=0;s<l;s++)if(o=n[s],x.isValidSelector(o)||(x.warn('Selector "'+o+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),x.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),x.warn("Konva is awesome, right?")),o.charAt(0)==="#"){if(this.id()===o.slice(1))return!0}else if(o.charAt(0)==="."){if(this.hasName(o.slice(1)))return!0}else if(this.className===o||this.nodeType===o)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(Th,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,n={},l){return n.target=n.target||this,l?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(sa,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let n;if(e)return n=new xe,this._eachAncestorReverse(function(l){const s=l.transformsEnabled();s==="all"?n.multiply(l.getTransform()):s==="position"&&n.translate(l.x()-l.offsetX(),l.y()-l.offsetY())},e),n;{n=this._cache.get(sa)||new xe,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const l=this.transformsEnabled();if(l==="all")n.multiply(this.getTransform());else if(l==="position"){const s=this.attrs.x||0,o=this.attrs.y||0,c=this.attrs.offsetX||0,f=this.attrs.offsetY||0;n.translate(s-c,o-f)}return n.dirty=!1,n}}getAbsoluteScale(e){let n=this;for(;n;)n._isUnderCache&&(e=n),n=n.getParent();const s=this.getAbsoluteTransform(e).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Na,this._getTransform)}_getTransform(){var e,n;const l=this._cache.get(Na)||new xe;l.reset();const s=this.x(),o=this.y(),c=k.getAngle(this.rotation()),f=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,y=this.attrs.skewY||0,S=this.attrs.offsetX||0,p=this.attrs.offsetY||0;return(s!==0||o!==0)&&l.translate(s,o),c!==0&&l.rotate(c),(m!==0||y!==0)&&l.skew(m,y),(f!==1||g!==1)&&l.scale(f,g),(S!==0||p!==0)&&l.translate(-1*S,-1*p),l.dirty=!1,l}clone(e){let n=x.cloneObject(this.attrs),l,s,o,c,f;for(l in e)n[l]=e[l];const g=new this.constructor(n);for(l in this.eventListeners)for(s=this.eventListeners[l],o=s.length,c=0;c<o;c++)f=s[c],f.name.indexOf(X1)<0&&(g.eventListeners[l]||(g.eventListeners[l]=[]),g.eventListeners[l].push(f));return g}_toKonvaCanvas(e){e=e||{};const n=this.getClientRect(),l=this.getStage(),s=e.x!==void 0?e.x:Math.floor(n.x),o=e.y!==void 0?e.y:Math.floor(n.y),c=e.pixelRatio||1,f=new Oa({width:e.width||Math.ceil(n.width)||(l?l.width():0),height:e.height||Math.ceil(n.height)||(l?l.height():0),pixelRatio:c}),g=f.getContext(),m=new Oa({width:f.width/f.pixelRatio+Math.abs(s),height:f.height/f.pixelRatio+Math.abs(o),pixelRatio:f.pixelRatio});return e.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(s||o)&&g.translate(-1*s,-1*o),this.drawScene(f,void 0,m),g.restore(),f}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const n=e.mimeType||null,l=e.quality||null,s=this._toKonvaCanvas(e).toDataURL(n,l);return e.callback&&e.callback(s),s}toImage(e){return new Promise((n,l)=>{try{const s=e==null?void 0:e.callback;s&&delete e.callback,x._urlToImage(this.toDataURL(e),function(o){n(o),s==null||s(o)})}catch(s){l(s)}})}toBlob(e){return new Promise((n,l)=>{try{const s=e==null?void 0:e.callback;s&&delete e.callback,this.toCanvas(e).toBlob(o=>{n(o),s==null||s(o)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(s){l(s)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():k.dragDistance}_off(e,n,l){let s=this.eventListeners[e],o,c,f;for(o=0;o<s.length;o++)if(c=s[o].name,f=s[o].handler,(c!=="konva"||n==="konva")&&(!n||c===n)&&(!l||l===f)){if(s.splice(o,1),s.length===0){delete this.eventListeners[e];break}o--}}_fireChangeEvent(e,n,l){this._fire(e+L1,{oldVal:n,newVal:l})}addName(e){if(!this.hasName(e)){const n=this.name(),l=n?n+" "+e:e;this.name(l)}return this}hasName(e){if(!e)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const n=(this.name()||"").split(/\s/g),l=n.indexOf(e);return l!==-1&&(n.splice(l,1),this.name(n.join(" "))),this}setAttr(e,n){const l=this[Ch+x._capitalize(e)];return x._isFunction(l)?l.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(k.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,n){const l=this.attrs[e];l===n&&!x.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,l,n),this._requestDraw())}_setComponentAttr(e,n,l){let s;l!==void 0&&(s=this.attrs[e],s||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=l,this._fireChangeEvent(e,s,l))}_fireAndBubble(e,n,l){n&&this.nodeType===Eh&&(n.target=this);const s=[w1,q1,j1,V1,K1,Q1];if(!(s.indexOf(e)!==-1&&(l&&(this===l||this.isAncestorOf&&this.isAncestorOf(l))||this.nodeType==="Stage"&&!l))){this._fire(e,n);const c=s.indexOf(e)!==-1&&l&&l.isAncestorOf&&l.isAncestorOf(this)&&!l.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!c&&(l&&l.parent?this._fireAndBubble.call(this.parent,e,n,l):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){var n,l;const{nodeType:s}=this,o=Q.protoListenerMap.get(s)||{};let c=o==null?void 0:o[e];if(c===void 0){c=[];let f=Object.getPrototypeOf(this);for(;f;){const g=(l=(n=f.eventListeners)===null||n===void 0?void 0:n[e])!==null&&l!==void 0?l:[];c.push(...g),f=Object.getPrototypeOf(f)}o[e]=c,Q.protoListenerMap.set(s,o)}return c}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const l=this._getProtoListeners(e);if(l)for(let o=0;o<l.length;o++)l[o].handler.call(this,n);const s=this.eventListeners[e];if(s)for(let o=0;o<s.length;o++)s[o].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const n=e?e.pointerId:void 0,l=this.getStage(),s=this.getAbsolutePosition();if(!l)return;const o=l._getPointerById(n)||l._changedPointerPositions[0]||s;Tt._dragElements.set(this._id,{node:this,startPointerPos:o,offset:{x:o.x-s.x,y:o.y-s.y},dragStatus:"ready",pointerId:n})}startDrag(e,n=!0){Tt._dragElements.has(this._id)||this._createDragElement(e);const l=Tt._dragElements.get(this._id);l.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const l=this.getStage()._getPointerById(n.pointerId);if(!l)return;let s={x:l.x-n.offset.x,y:l.y-n.offset.y};const o=this.dragBoundFunc();if(o!==void 0){const c=o.call(this,s,e);c?s=c:x.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==s.x||this._lastPos.y!==s.y)&&(this.setAbsolutePosition(s),this._requestDraw()),this._lastPos=s}stopDrag(e){const n=Tt._dragElements.get(this._id);n&&(n.dragStatus="stopped"),Tt._endDragBefore(e),Tt._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Tt._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||k.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let s=!1;Tt._dragElements.forEach(o=>{this.isAncestorOf(o.node)&&(s=!0)}),s||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=Tt._dragElements.get(this._id),l=n&&n.dragStatus==="dragging",s=n&&n.dragStatus==="ready";l?this.stopDrag():s&&Tt._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const l={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return x.haveIntersection(l,this.getClientRect())}static create(e,n){return x._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){let l=Q.prototype.getClassName.call(e),s=e.children,o,c,f;n&&(e.attrs.container=n),k[l]||(x.warn('Can not find a node with class name "'+l+'". Fallback to "Shape".'),l="Shape");const g=k[l];if(o=new g(e.attrs),s)for(c=s.length,f=0;f<c;f++)o.add(Q._createNode(s[f]));return o}}Q.protoListenerMap=new Map;Q.prototype.nodeType="Node";Q.prototype._attrsAffectingSize=[];Q.prototype.eventListeners={};Q.prototype.on.call(Q.prototype,J1,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Na),this._clearSelfAndDescendantCache(sa)});Q.prototype.on.call(Q.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(tu)});Q.prototype.on.call(Q.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache($r)});Q.prototype.on.call(Q.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Pl)});const Nt=b.addGetterSetter;Nt(Q,"zIndex");Nt(Q,"absolutePosition");Nt(Q,"position");Nt(Q,"x",0,P());Nt(Q,"y",0,P());Nt(Q,"globalCompositeOperation","source-over",ln());Nt(Q,"opacity",1,P());Nt(Q,"name","",ln());Nt(Q,"id","",ln());Nt(Q,"rotation",0,P());b.addComponentsGetterSetter(Q,"scale",["x","y"]);Nt(Q,"scaleX",1,P());Nt(Q,"scaleY",1,P());b.addComponentsGetterSetter(Q,"skew",["x","y"]);Nt(Q,"skewX",0,P());Nt(Q,"skewY",0,P());b.addComponentsGetterSetter(Q,"offset",["x","y"]);Nt(Q,"offsetX",0,P());Nt(Q,"offsetY",0,P());Nt(Q,"dragDistance",void 0,P());Nt(Q,"width",0,P());Nt(Q,"height",0,P());Nt(Q,"listening",!0,Xe());Nt(Q,"preventDefault",!0,Xe());Nt(Q,"filters",void 0,function(u){return this._filterUpToDate=!1,u});Nt(Q,"visible",!0,Xe());Nt(Q,"transformsEnabled","all",ln());Nt(Q,"size");Nt(Q,"dragBoundFunc");Nt(Q,"draggable",!1,Xe());b.backCompat(Q,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Ae extends Q{constructor(){super(...arguments),this.children=[]}getChildren(e){const n=this.children||[];return e?n.filter(e):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let l=0;l<e.length;l++)this.add(e[l]);return this}const n=e[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){const l=[];return this._descendants(s=>{const o=s._isMatch(e);return o&&l.push(s),!!(o&&n)}),l}_descendants(e){let n=!1;const l=this.getChildren();for(const s of l){if(n=e(s),n)return!0;if(s.hasChildren()&&(n=s._descendants(e),n))return!0}return!1}toObject(){const e=Q.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){let n=e.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){const n=Q.prototype.clone.call(this,e);return this.getChildren().forEach(function(l){n.add(l.clone())}),n}getAllIntersections(e){const n=[];return this.find("Shape").forEach(l=>{l.isVisible()&&l.intersects(e)&&n.push(l)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(l){l._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,l){n.index=l}),this._requestDraw()}drawScene(e,n,l){const s=this.getLayer(),o=e||s&&s.getCanvas(),c=o&&o.getContext(),f=this._getCanvasCache(),g=f&&f.scene,m=o&&o.isCache;if(!this.isVisible()&&!m)return this;if(g){c.save();const y=this.getAbsoluteTransform(n).getMatrix();c.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",o,n,l);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;const l=this.getLayer(),s=e||l&&l.hitCanvas,o=s&&s.getContext(),c=this._getCanvasCache();if(c&&c.hit){o.save();const g=this.getAbsoluteTransform(n).getMatrix();o.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(o),o.restore()}else this._drawChildren("drawHit",s,n);return this}_drawChildren(e,n,l,s){var o;const c=n&&n.getContext(),f=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),y=typeof f=="number"&&typeof g=="number"||m,S=l===this;if(y){c.save();const C=this.getAbsoluteTransform(l);let _=C.getMatrix();c.transform(_[0],_[1],_[2],_[3],_[4],_[5]),c.beginPath();let R;if(m)R=m.call(this,c,this);else{const N=this.clipX(),A=this.clipY();c.rect(N||0,A||0,f,g)}c.clip.apply(c,R),_=C.copy().invert().getMatrix(),c.transform(_[0],_[1],_[2],_[3],_[4],_[5])}const p=!S&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";p&&(c.save(),c._applyGlobalCompositeOperation(this)),(o=this.children)===null||o===void 0||o.forEach(function(C){C[e](n,l,s)}),p&&c.restore(),y&&c.restore()}getClientRect(e={}){var n;const l=e.skipTransform,s=e.relativeTo;let o,c,f,g,m={x:1/0,y:1/0,width:0,height:0};const y=this;(n=this.children)===null||n===void 0||n.forEach(function(C){if(!C.visible())return;const _=C.getClientRect({relativeTo:y,skipShadow:e.skipShadow,skipStroke:e.skipStroke});_.width===0&&_.height===0||(o===void 0?(o=_.x,c=_.y,f=_.x+_.width,g=_.y+_.height):(o=Math.min(o,_.x),c=Math.min(c,_.y),f=Math.max(f,_.x+_.width),g=Math.max(g,_.y+_.height)))});const S=this.find("Shape");let p=!1;for(let C=0;C<S.length;C++)if(S[C]._isVisible(this)){p=!0;break}return p&&o!==void 0?m={x:o,y:c,width:f-o,height:g-c}:m={x:0,y:0,width:0,height:0},l?m:this._transformedRect(m,s)}}b.addComponentsGetterSetter(Ae,"clip",["x","y","width","height"]);b.addGetterSetter(Ae,"clipX",void 0,P());b.addGetterSetter(Ae,"clipY",void 0,P());b.addGetterSetter(Ae,"clipWidth",void 0,P());b.addGetterSetter(Ae,"clipHeight",void 0,P());b.addGetterSetter(Ae,"clipFunc");const Bi=new Map,Fh=k._global.PointerEvent!==void 0;function Vr(u){return Bi.get(u)}function du(u){return{evt:u,pointerId:u.pointerId}}function kh(u,e){return Bi.get(u)===e}function Wh(u,e){Oi(u),e.getStage()&&(Bi.set(u,e),Fh&&e._fire("gotpointercapture",du(new PointerEvent("gotpointercapture"))))}function Oi(u,e){const n=Bi.get(u);if(!n)return;const l=n.getStage();l&&l.content,Bi.delete(u),Fh&&n._fire("lostpointercapture",du(new PointerEvent("lostpointercapture")))}const F1="Stage",k1="string",xh="px",W1="mouseout",Ih="mouseleave",$h="mouseover",t0="mouseenter",e0="mousemove",a0="mousedown",n0="mouseup",Ai="pointermove",Mi="pointerdown",wn="pointerup",Ri="pointercancel",I1="lostpointercapture",wl="pointerout",Ni="pointerleave",ql="pointerover",jl="pointerenter",eu="contextmenu",i0="touchstart",l0="touchend",s0="touchmove",r0="touchcancel",au="wheel",$1=5,t2=[[t0,"_pointerenter"],[a0,"_pointerdown"],[e0,"_pointermove"],[n0,"_pointerup"],[Ih,"_pointerleave"],[i0,"_pointerdown"],[s0,"_pointermove"],[l0,"_pointerup"],[r0,"_pointercancel"],[$h,"_pointerover"],[au,"_wheel"],[eu,"_contextmenu"],[Mi,"_pointerdown"],[Ai,"_pointermove"],[wn,"_pointerup"],[Ri,"_pointercancel"],[Ni,"_pointerleave"],[I1,"_lostpointercapture"]],Kr={mouse:{[wl]:W1,[Ni]:Ih,[ql]:$h,[jl]:t0,[Ai]:e0,[Mi]:a0,[wn]:n0,[Ri]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[wl]:"touchout",[Ni]:"touchleave",[ql]:"touchover",[jl]:"touchenter",[Ai]:s0,[Mi]:i0,[wn]:l0,[Ri]:r0,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[wl]:wl,[Ni]:Ni,[ql]:ql,[jl]:jl,[Ai]:Ai,[Mi]:Mi,[wn]:wn,[Ri]:Ri,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},zi=u=>u.indexOf("pointer")>=0?"pointer":u.indexOf("touch")>=0?"touch":"mouse",Yn=u=>{const e=zi(u);if(e==="pointer")return k.pointerEventsEnabled&&Kr.pointer;if(e==="touch")return Kr.touch;if(e==="mouse")return Kr.mouse};function Ah(u={}){return(u.clipFunc||u.clipWidth||u.clipHeight)&&x.warn("Stage does not support clipping. Please use clip for Layers or Groups."),u}const e2="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",Di=[];let ts=class extends Ae{constructor(e){super(Ah(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Di.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Ah(this.attrs)}),this._checkVisibility()}_validateAdd(e){const n=e.getType()==="Layer",l=e.getType()==="FastLayer";n||l||x.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if(typeof e===k1){let n;if(e.charAt(0)==="."){const l=e.slice(1);e=document.getElementsByClassName(l)[0]}else e.charAt(0)!=="#"?n=e:n=e.slice(1),e=document.getElementById(n);if(!e)throw"Can not find container in document with id "+n}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const e=this.children,n=e.length;for(let l=0;l<n;l++)e[l].clear();return this}clone(e){return e||(e={}),e.container=typeof document<"u"&&document.createElement("div"),Ae.prototype.clone.call(this,e)}destroy(){super.destroy();const e=this.content;e&&x._isInDocument(e)&&this.container().removeChild(e);const n=Di.indexOf(this);return n>-1&&Di.splice(n,1),x.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(x.warn(e2),null)}_getPointerById(e){return this._pointerPositions.find(n=>n.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){e={...e},e.x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();const n=new Oa({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),l=n.getContext()._context,s=this.children;return(e.x||e.y)&&l.translate(-1*e.x,-1*e.y),s.forEach(function(o){if(!o.isVisible())return;const c=o._toKonvaCanvas(e);l.drawImage(c._canvas,e.x,e.y,c.getWidth()/c.getPixelRatio(),c.getHeight()/c.getPixelRatio())}),n}getIntersection(e){if(!e)return null;const n=this.children,l=n.length,s=l-1;for(let o=s;o>=0;o--){const c=n[o].getIntersection(e);if(c)return c}return null}_resizeDOM(){const e=this.width(),n=this.height();this.content&&(this.content.style.width=e+xh,this.content.style.height=n+xh),this.bufferCanvas.setSize(e,n),this.bufferHitCanvas.setSize(e,n),this.children.forEach(l=>{l.setSize({width:e,height:n}),l.draw()})}add(e,...n){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}super.add(e);const l=this.children.length;return l>$1&&x.warn("The stage has "+l+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),k.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return kh(e,this)}setPointerCapture(e){Wh(e,this)}releaseCapture(e){Oi(e)}getLayers(){return this.children}_bindContentEvents(){k.isBrowser&&t2.forEach(([e,n])=>{this.content.addEventListener(e,l=>{this[n](l)},{passive:!1})})}_pointerenter(e){this.setPointersPositions(e);const n=Yn(e.type);n&&this._fire(n.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);const n=Yn(e.type);n&&this._fire(n.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let n=this[e+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(e){const n=Yn(e.type),l=zi(e.type);if(!n)return;this.setPointersPositions(e);const s=this._getTargetShape(l),o=!(k.isDragging()||k.isTransforming())||k.hitOnDragEnabled;s&&o?(s._fireAndBubble(n.pointerout,{evt:e}),s._fireAndBubble(n.pointerleave,{evt:e}),this._fire(n.pointerleave,{evt:e,target:this,currentTarget:this}),this[l+"targetShape"]=null):o&&(this._fire(n.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(e){const n=Yn(e.type),l=zi(e.type);if(!n)return;this.setPointersPositions(e);let s=!1;this._changedPointerPositions.forEach(o=>{const c=this.getIntersection(o);if(Tt.justDragged=!1,k["_"+l+"ListenClick"]=!0,!c||!c.isListening()){this[l+"ClickStartShape"]=void 0;return}k.capturePointerEventsEnabled&&c.setPointerCapture(o.id),this[l+"ClickStartShape"]=c,c._fireAndBubble(n.pointerdown,{evt:e,pointerId:o.id}),s=!0;const f=e.type.indexOf("touch")>=0;c.preventDefault()&&e.cancelable&&f&&e.preventDefault()}),s||this._fire(n.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(e){const n=Yn(e.type),l=zi(e.type);if(!n)return;const s=e.type.indexOf("touch")>=0||e.pointerType==="touch";if(k.isDragging()&&Tt.node.preventDefault()&&e.cancelable&&s&&e.preventDefault(),this.setPointersPositions(e),!(!(k.isDragging()||k.isTransforming())||k.hitOnDragEnabled))return;const c={};let f=!1;const g=this._getTargetShape(l);this._changedPointerPositions.forEach(m=>{const y=Vr(m.id)||this.getIntersection(m),S=m.id,p={evt:e,pointerId:S},C=g!==y;if(C&&g&&(g._fireAndBubble(n.pointerout,{...p},y),g._fireAndBubble(n.pointerleave,{...p},y)),y){if(c[y._id])return;c[y._id]=!0}y&&y.isListening()?(f=!0,C&&(y._fireAndBubble(n.pointerover,{...p},g),y._fireAndBubble(n.pointerenter,{...p},g),this[l+"targetShape"]=y),y._fireAndBubble(n.pointermove,{...p})):g&&(this._fire(n.pointerover,{evt:e,target:this,currentTarget:this,pointerId:S}),this[l+"targetShape"]=null)}),f||this._fire(n.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){const n=Yn(e.type),l=zi(e.type);if(!n)return;this.setPointersPositions(e);const s=this[l+"ClickStartShape"],o=this[l+"ClickEndShape"],c={};let f=!1;this._changedPointerPositions.forEach(g=>{const m=Vr(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),c[m._id])return;c[m._id]=!0}const y=g.id,S={evt:e,pointerId:y};let p=!1;k["_"+l+"InDblClickWindow"]?(p=!0,clearTimeout(this[l+"DblTimeout"])):Tt.justDragged||(k["_"+l+"InDblClickWindow"]=!0,clearTimeout(this[l+"DblTimeout"])),this[l+"DblTimeout"]=setTimeout(function(){k["_"+l+"InDblClickWindow"]=!1},k.dblClickWindow),m&&m.isListening()?(f=!0,this[l+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...S}),k["_"+l+"ListenClick"]&&s&&s===m&&(m._fireAndBubble(n.pointerclick,{...S}),p&&o&&o===m&&m._fireAndBubble(n.pointerdblclick,{...S}))):(this[l+"ClickEndShape"]=null,f||(this._fire(n.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),f=!0),k["_"+l+"ListenClick"]&&this._fire(n.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:y}),p&&this._fire(n.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:y}))}),f||this._fire(n.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),k["_"+l+"ListenClick"]=!1,e.cancelable&&l!=="touch"&&l!=="pointer"&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(eu,{evt:e}):this._fire(eu,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(au,{evt:e}):this._fire(au,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);const n=Vr(e.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(wn,du(e)),Oi(e.pointerId)}_lostpointercapture(e){Oi(e.pointerId)}setPointersPositions(e){const n=this._getContentPosition();let l=null,s=null;e=e||window.event,e.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,o=>{this._pointerPositions.push({id:o.identifier,x:(o.clientX-n.left)/n.scaleX,y:(o.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,o=>{this._changedPointerPositions.push({id:o.identifier,x:(o.clientX-n.left)/n.scaleX,y:(o.clientY-n.top)/n.scaleY})})):(l=(e.clientX-n.left)/n.scaleX,s=(e.clientY-n.top)/n.scaleY,this.pointerPos={x:l,y:s},this._pointerPositions=[{x:l,y:s,id:x._getFirstPointerId(e)}],this._changedPointerPositions=[{x:l,y:s,id:x._getFirstPointerId(e)}])}_setPointerPosition(e){x.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Oa({width:this.width(),height:this.height()}),this.bufferHitCanvas=new hu({pixelRatio:1,width:this.width(),height:this.height()}),!k.isBrowser)return;const e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}cache(){return x.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}};ts.prototype.nodeType=F1;Yt(ts);b.addGetterSetter(ts,"container");k.isBrowser&&document.addEventListener("visibilitychange",()=>{Di.forEach(u=>{u.batchDraw()})});const u0="hasShadow",o0="shadowRGBA",c0="patternImage",h0="linearGradient",f0="radialGradient";let Vl;function Qr(){return Vl||(Vl=x.createCanvasElement().getContext("2d"),Vl)}const Gi={};function a2(u){const e=this.attrs.fillRule;e?u.fill(e):u.fill()}function n2(u){u.stroke()}function i2(u){const e=this.attrs.fillRule;e?u.fill(e):u.fill()}function l2(u){u.stroke()}function s2(){this._clearCache(u0)}function r2(){this._clearCache(o0)}function u2(){this._clearCache(c0)}function o2(){this._clearCache(h0)}function c2(){this._clearCache(f0)}class j extends Q{constructor(e){super(e);let n,l=0;for(;n=x.getHitColor(),!(n&&!(n in Gi));)if(l++,l>=1e4){x.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),n=x.getRandomColor();break}this.colorKey=n,Gi[n]=this}getContext(){return x.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return x.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u0,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(c0,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Qr().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const l=new xe;l.translate(this.fillPatternX(),this.fillPatternY()),l.rotate(k.getAngle(this.fillPatternRotation())),l.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),l.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const s=l.getMatrix(),o=typeof DOMMatrix>"u"?{a:s[0],b:s[1],c:s[2],d:s[3],e:s[4],f:s[5]}:new DOMMatrix(s);n.setTransform(o)}return n}}_getLinearGradient(){return this._getCache(h0,this.__getLinearGradient)}__getLinearGradient(){const e=this.fillLinearGradientColorStops();if(e){const n=Qr(),l=this.fillLinearGradientStartPoint(),s=this.fillLinearGradientEndPoint(),o=n.createLinearGradient(l.x,l.y,s.x,s.y);for(let c=0;c<e.length;c+=2)o.addColorStop(e[c],e[c+1]);return o}}_getRadialGradient(){return this._getCache(f0,this.__getRadialGradient)}__getRadialGradient(){const e=this.fillRadialGradientColorStops();if(e){const n=Qr(),l=this.fillRadialGradientStartPoint(),s=this.fillRadialGradientEndPoint(),o=n.createRadialGradient(l.x,l.y,this.fillRadialGradientStartRadius(),s.x,s.y,this.fillRadialGradientEndRadius());for(let c=0;c<e.length;c+=2)o.addColorStop(e[c],e[c+1]);return o}}getShadowRGBA(){return this._getCache(o0,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const e=x.colorToRGBA(this.shadowColor());if(e)return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const e=this.hitStrokeWidth();return e==="auto"?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){const n=this.getStage();if(!n)return!1;const l=n.bufferHitCanvas;return l.getContext().clear(),this.drawHit(l,void 0,!0),l.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data[3]>0}destroy(){return Q.prototype.destroy.call(this),delete Gi[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const s=e||this.hasFill(),o=this.hasStroke(),c=this.getAbsoluteOpacity()!==1;if(s&&o&&c)return!0;const f=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(s&&o&&f&&g)}setStrokeHitEnabled(e){x.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){let n=!1,l=this.getParent();for(;l;){if(l.isCached()){n=!0;break}l=l.getParent()}const s=e.skipTransform,o=e.relativeTo||n&&this.getStage()||void 0,c=this.getSelfRect(),g=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=c.width+g,y=c.height+g,S=!e.skipShadow&&this.hasShadow(),p=S?this.shadowOffsetX():0,C=S?this.shadowOffsetY():0,_=m+Math.abs(p),R=y+Math.abs(C),N=S&&this.shadowBlur()||0,A=_+N*2,z=R+N*2,L={width:A,height:z,x:-(g/2+N)+Math.min(p,0)+c.x,y:-(g/2+N)+Math.min(C,0)+c.y};return s?L:this._transformedRect(L,o)}drawScene(e,n,l){const s=this.getLayer(),o=e||s.getCanvas(),c=o.getContext(),f=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let y;const S=n===this;if(!this.isVisible()&&!S)return this;if(f){c.save();const p=this.getAbsoluteTransform(n).getMatrix();return c.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(c),c.restore(),this}if(!g)return this;if(c.save(),this._useBufferCanvas()){y=this.getStage();const p=l||y.bufferCanvas,C=p.getContext();l?(C.save(),C.setTransform(1,0,0,1,0,0),C.clearRect(0,0,p.width,p.height),C.restore()):C.clear(),C.save(),C._applyLineJoin(this),C._applyMiterLimit(this);const _=this.getAbsoluteTransform(n).getMatrix();C.transform(_[0],_[1],_[2],_[3],_[4],_[5]),g.call(this,C,this),C.restore();const R=p.pixelRatio;m&&c._applyShadow(this),S||(c._applyOpacity(this),c._applyGlobalCompositeOperation(this)),c.drawImage(p._canvas,p.x||0,p.y||0,p.width/R,p.height/R)}else{if(c._applyLineJoin(this),c._applyMiterLimit(this),!S){const p=this.getAbsoluteTransform(n).getMatrix();c.transform(p[0],p[1],p[2],p[3],p[4],p[5]),c._applyOpacity(this),c._applyGlobalCompositeOperation(this)}m&&c._applyShadow(this),g.call(this,c,this)}return c.restore(),this}drawHit(e,n,l=!1){if(!this.shouldDrawHit(n,l))return this;const s=this.getLayer(),o=e||s.hitCanvas,c=o&&o.getContext(),f=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||x.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){c.save();const S=this.getAbsoluteTransform(n).getMatrix();return c.transform(S[0],S[1],S[2],S[3],S[4],S[5]),this._drawCachedHitCanvas(c),c.restore(),this}if(!f)return this;if(c.save(),c._applyLineJoin(this),c._applyMiterLimit(this),!(this===n)){const S=this.getAbsoluteTransform(n).getMatrix();c.transform(S[0],S[1],S[2],S[3],S[4],S[5])}return f.call(this,c,this),c.restore(),this}drawHitFromCache(e=0){const n=this._getCanvasCache(),l=this._getCachedSceneCanvas(),s=n.hit,o=s.getContext(),c=s.getWidth(),f=s.getHeight();o.clear(),o.drawImage(l._canvas,0,0,c,f);try{const g=o.getImageData(0,0,c,f),m=g.data,y=m.length,S=x._hexToRgb(this.colorKey);for(let p=0;p<y;p+=4)m[p+3]>e?(m[p]=S.r,m[p+1]=S.g,m[p+2]=S.b,m[p+3]=255):m[p+3]=0;o.putImageData(g,0,0)}catch(g){x.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(e){return kh(e,this)}setPointerCapture(e){Wh(e,this)}releaseCapture(e){Oi(e)}}j.prototype._fillFunc=a2;j.prototype._strokeFunc=n2;j.prototype._fillFuncHit=i2;j.prototype._strokeFuncHit=l2;j.prototype._centroid=!1;j.prototype.nodeType="Shape";Yt(j);j.prototype.eventListeners={};j.prototype.on.call(j.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",s2);j.prototype.on.call(j.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",r2);j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",u2);j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",o2);j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",c2);b.addGetterSetter(j,"stroke",void 0,Ph());b.addGetterSetter(j,"strokeWidth",2,P());b.addGetterSetter(j,"fillAfterStrokeEnabled",!1);b.addGetterSetter(j,"hitStrokeWidth","auto",fu());b.addGetterSetter(j,"strokeHitEnabled",!0,Xe());b.addGetterSetter(j,"perfectDrawEnabled",!0,Xe());b.addGetterSetter(j,"shadowForStrokeEnabled",!0,Xe());b.addGetterSetter(j,"lineJoin");b.addGetterSetter(j,"lineCap");b.addGetterSetter(j,"miterLimit");b.addGetterSetter(j,"sceneFunc");b.addGetterSetter(j,"hitFunc");b.addGetterSetter(j,"dash");b.addGetterSetter(j,"dashOffset",0,P());b.addGetterSetter(j,"shadowColor",void 0,ln());b.addGetterSetter(j,"shadowBlur",0,P());b.addGetterSetter(j,"shadowOpacity",1,P());b.addComponentsGetterSetter(j,"shadowOffset",["x","y"]);b.addGetterSetter(j,"shadowOffsetX",0,P());b.addGetterSetter(j,"shadowOffsetY",0,P());b.addGetterSetter(j,"fillPatternImage");b.addGetterSetter(j,"fill",void 0,Ph());b.addGetterSetter(j,"fillPatternX",0,P());b.addGetterSetter(j,"fillPatternY",0,P());b.addGetterSetter(j,"fillLinearGradientColorStops");b.addGetterSetter(j,"strokeLinearGradientColorStops");b.addGetterSetter(j,"fillRadialGradientStartRadius",0);b.addGetterSetter(j,"fillRadialGradientEndRadius",0);b.addGetterSetter(j,"fillRadialGradientColorStops");b.addGetterSetter(j,"fillPatternRepeat","repeat");b.addGetterSetter(j,"fillEnabled",!0);b.addGetterSetter(j,"strokeEnabled",!0);b.addGetterSetter(j,"shadowEnabled",!0);b.addGetterSetter(j,"dashEnabled",!0);b.addGetterSetter(j,"strokeScaleEnabled",!0);b.addGetterSetter(j,"fillPriority","color");b.addComponentsGetterSetter(j,"fillPatternOffset",["x","y"]);b.addGetterSetter(j,"fillPatternOffsetX",0,P());b.addGetterSetter(j,"fillPatternOffsetY",0,P());b.addComponentsGetterSetter(j,"fillPatternScale",["x","y"]);b.addGetterSetter(j,"fillPatternScaleX",1,P());b.addGetterSetter(j,"fillPatternScaleY",1,P());b.addComponentsGetterSetter(j,"fillLinearGradientStartPoint",["x","y"]);b.addComponentsGetterSetter(j,"strokeLinearGradientStartPoint",["x","y"]);b.addGetterSetter(j,"fillLinearGradientStartPointX",0);b.addGetterSetter(j,"strokeLinearGradientStartPointX",0);b.addGetterSetter(j,"fillLinearGradientStartPointY",0);b.addGetterSetter(j,"strokeLinearGradientStartPointY",0);b.addComponentsGetterSetter(j,"fillLinearGradientEndPoint",["x","y"]);b.addComponentsGetterSetter(j,"strokeLinearGradientEndPoint",["x","y"]);b.addGetterSetter(j,"fillLinearGradientEndPointX",0);b.addGetterSetter(j,"strokeLinearGradientEndPointX",0);b.addGetterSetter(j,"fillLinearGradientEndPointY",0);b.addGetterSetter(j,"strokeLinearGradientEndPointY",0);b.addComponentsGetterSetter(j,"fillRadialGradientStartPoint",["x","y"]);b.addGetterSetter(j,"fillRadialGradientStartPointX",0);b.addGetterSetter(j,"fillRadialGradientStartPointY",0);b.addComponentsGetterSetter(j,"fillRadialGradientEndPoint",["x","y"]);b.addGetterSetter(j,"fillRadialGradientEndPointX",0);b.addGetterSetter(j,"fillRadialGradientEndPointY",0);b.addGetterSetter(j,"fillPatternRotation",0);b.addGetterSetter(j,"fillRule",void 0,ln());b.backCompat(j,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const h2="beforeDraw",f2="draw",d0=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],d2=d0.length;let sn=class extends Ae{constructor(e){super(e),this.canvas=new Oa,this.hitCanvas=new hu({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),e<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[e+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Q.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Q.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Q.prototype.moveDown.call(this)){const e=this.getStage();if(e){const n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Q.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return Q.prototype.remove.call(this),e&&e.parentNode&&x._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:n}){return this.canvas.setSize(e,n),this.hitCanvas.setSize(e,n),this._setSmoothEnabled(),this}_validateAdd(e){const n=e.getType();n!=="Group"&&n!=="Shape"&&x.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e={...e},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),Q.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){x.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){x.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,x.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let n=1,l=!1;for(;;){for(let s=0;s<d2;s++){const o=d0[s],c=this._getIntersection({x:e.x+o.x*n,y:e.y+o.y*n}),f=c.shape;if(f)return f;if(l=!!c.antialiased,!c.antialiased)break}if(l)n+=1;else return null}}_getIntersection(e){const n=this.hitCanvas.pixelRatio,l=this.hitCanvas.context.getImageData(Math.round(e.x*n),Math.round(e.y*n),1,1).data,s=l[3];if(s===255){const o=x.getHitColorKey(l[0],l[1],l[2]),c=Gi[o];return c?{shape:c}:{antialiased:!0}}else if(s>0)return{antialiased:!0};return{}}drawScene(e,n,l){const s=this.getLayer(),o=e||s&&s.getCanvas();return this._fire(h2,{node:this}),this.clearBeforeDraw()&&o.getContext().clear(),Ae.prototype.drawScene.call(this,o,n,l),this._fire(f2,{node:this}),this}drawHit(e,n){const l=this.getLayer(),s=e||l&&l.hitCanvas;return l&&l.clearBeforeDraw()&&l.getHitCanvas().getContext().clear(),Ae.prototype.drawHit.call(this,s,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){x.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return x.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return x.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};sn.prototype.nodeType="Layer";Yt(sn);b.addGetterSetter(sn,"imageSmoothingEnabled",!0);b.addGetterSetter(sn,"clearBeforeDraw",!0);b.addGetterSetter(sn,"hitGraphEnabled",!0,Xe());class gu extends sn{constructor(e){super(e),this.listening(!1),x.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}gu.prototype.nodeType="FastLayer";Yt(gu);class qn extends Ae{_validateAdd(e){const n=e.getType();n!=="Group"&&n!=="Shape"&&x.throw("You may only add groups and shapes to groups.")}}qn.prototype.nodeType="Group";Yt(qn);const Zr=function(){return nn.performance&&nn.performance.now?function(){return nn.performance.now()}:function(){return new Date().getTime()}}();class Ge{constructor(e,n){this.id=Ge.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Zr(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){let n=[];return e&&(n=Array.isArray(e)?e:[e]),this.layers=n,this}getLayers(){return this.layers}addLayer(e){const n=this.layers,l=n.length;for(let s=0;s<l;s++)if(n[s]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const n=Ge.animations,l=n.length;for(let s=0;s<l;s++)if(n[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Zr(),Ge._addAnimation(this),this}stop(){return Ge._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const n=e.id,l=this.animations,s=l.length;for(let o=0;o<s;o++)if(l[o].id===n){this.animations.splice(o,1);break}}static _runFrames(){const e={},n=this.animations;for(let l=0;l<n.length;l++){const s=n[l],o=s.layers,c=s.func;s._updateFrameObject(Zr());const f=o.length;let g;if(c?g=c.call(s,s.frame)!==!1:g=!0,!!g)for(let m=0;m<f;m++){const y=o[m];y._id!==void 0&&(e[y._id]=y)}}for(const l in e)e.hasOwnProperty(l)&&e[l].batchDraw()}static _animationLoop(){const e=Ge;e.animations.length?(e._runFrames(),x.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,x.requestAnimFrame(this._animationLoop))}}Ge.animations=[];Ge.animIdCounter=0;Ge.animRunning=!1;const g2={node:1,duration:1,easing:1,onFinish:1,yoyo:1},m2=1,Mh=2,Rh=3,Nh=["fill","stroke","shadowColor"];let p2=0;class y2{constructor(e,n,l,s,o,c,f){this.prop=e,this.propFunc=n,this.begin=s,this._pos=s,this.duration=c,this._change=0,this.prevPos=0,this.yoyo=f,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=l,this._change=o-this.begin,this.pause()}fire(e){const n=this[e];n&&n()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return e===void 0&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=Mh,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Rh,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const e=this.getTimer()-this._startTime;this.state===Mh?this.setTime(e):this.state===Rh&&this.setTime(this.duration-e)}pause(){this.state=m2,this.fire("onPause")}getTimer(){return new Date().getTime()}}class zt{constructor(e){const n=this,l=e.node,s=l._id,o=e.easing||Hi.Linear,c=!!e.yoyo;let f,g;typeof e.duration>"u"?f=.3:e.duration===0?f=.001:f=e.duration,this.node=l,this._id=p2++;const m=l.getLayer()||(l instanceof k.Stage?l.getLayers():null);m||x.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Ge(function(){n.tween.onEnterFrame()},m),this.tween=new y2(g,function(y){n._tweenFunc(y)},o,0,1,f*1e3,c),this._addListeners(),zt.attrs[s]||(zt.attrs[s]={}),zt.attrs[s][this._id]||(zt.attrs[s][this._id]={}),zt.tweens[s]||(zt.tweens[s]={});for(g in e)g2[g]===void 0&&this._addAttr(g,e[g]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,n){const l=this.node,s=l._id;let o,c,f,g,m;const y=zt.tweens[s][e];y&&delete zt.attrs[s][y][e];let S=l.getAttr(e);if(x._isArray(n))if(o=[],c=Math.max(n.length,S.length),e==="points"&&n.length!==S.length&&(n.length>S.length?(g=S,S=x._prepareArrayForTween(S,n,l.closed())):(f=n,n=x._prepareArrayForTween(n,S,l.closed()))),e.indexOf("fill")===0)for(let p=0;p<c;p++)if(p%2===0)o.push(n[p]-S[p]);else{const C=x.colorToRGBA(S[p]);m=x.colorToRGBA(n[p]),S[p]=C,o.push({r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a})}else for(let p=0;p<c;p++)o.push(n[p]-S[p]);else Nh.indexOf(e)!==-1?(S=x.colorToRGBA(S),m=x.colorToRGBA(n),o={r:m.r-S.r,g:m.g-S.g,b:m.b-S.b,a:m.a-S.a}):o=n-S;zt.attrs[s][this._id][e]={start:S,diff:o,end:n,trueEnd:f,trueStart:g},zt.tweens[s][e]=this._id}_tweenFunc(e){const n=this.node,l=zt.attrs[n._id][this._id];let s,o,c,f,g,m,y,S;for(s in l){if(o=l[s],c=o.start,f=o.diff,S=o.end,x._isArray(c))if(g=[],y=Math.max(c.length,S.length),s.indexOf("fill")===0)for(m=0;m<y;m++)m%2===0?g.push((c[m]||0)+f[m]*e):g.push("rgba("+Math.round(c[m].r+f[m].r*e)+","+Math.round(c[m].g+f[m].g*e)+","+Math.round(c[m].b+f[m].b*e)+","+(c[m].a+f[m].a*e)+")");else for(m=0;m<y;m++)g.push((c[m]||0)+f[m]*e);else Nh.indexOf(s)!==-1?g="rgba("+Math.round(c.r+f.r*e)+","+Math.round(c.g+f.g*e)+","+Math.round(c.b+f.b*e)+","+(c.a+f.a*e)+")":g=c+f*e;n.setAttr(s,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const e=this.node,n=zt.attrs[e._id][this._id];n.points&&n.points.trueEnd&&e.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const e=this.node,n=zt.attrs[e._id][this._id];n.points&&n.points.trueStart&&e.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(e*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const e=this.node._id,n=this._id,l=zt.tweens[e];this.pause(),this.anim&&this.anim.stop();for(const s in l)delete zt.tweens[e][s];delete zt.attrs[e][n],zt.tweens[e]&&(Object.keys(zt.tweens[e]).length===0&&delete zt.tweens[e],Object.keys(zt.attrs[e]).length===0&&delete zt.attrs[e])}}zt.attrs={};zt.tweens={};Q.prototype.to=function(u){const e=u.onFinish;u.node=this,u.onFinish=function(){this.destroy(),e&&e()},new zt(u).play()};const Hi={BackEaseIn(u,e,n,l){return n*(u/=l)*u*((1.70158+1)*u-1.70158)+e},BackEaseOut(u,e,n,l){return n*((u=u/l-1)*u*((1.70158+1)*u+1.70158)+1)+e},BackEaseInOut(u,e,n,l){let s=1.70158;return(u/=l/2)<1?n/2*(u*u*(((s*=1.525)+1)*u-s))+e:n/2*((u-=2)*u*(((s*=1.525)+1)*u+s)+2)+e},ElasticEaseIn(u,e,n,l,s,o){let c=0;return u===0?e:(u/=l)===1?e+n:(o||(o=l*.3),!s||s<Math.abs(n)?(s=n,c=o/4):c=o/(2*Math.PI)*Math.asin(n/s),-(s*Math.pow(2,10*(u-=1))*Math.sin((u*l-c)*(2*Math.PI)/o))+e)},ElasticEaseOut(u,e,n,l,s,o){let c=0;return u===0?e:(u/=l)===1?e+n:(o||(o=l*.3),!s||s<Math.abs(n)?(s=n,c=o/4):c=o/(2*Math.PI)*Math.asin(n/s),s*Math.pow(2,-10*u)*Math.sin((u*l-c)*(2*Math.PI)/o)+n+e)},ElasticEaseInOut(u,e,n,l,s,o){let c=0;return u===0?e:(u/=l/2)===2?e+n:(o||(o=l*(.3*1.5)),!s||s<Math.abs(n)?(s=n,c=o/4):c=o/(2*Math.PI)*Math.asin(n/s),u<1?-.5*(s*Math.pow(2,10*(u-=1))*Math.sin((u*l-c)*(2*Math.PI)/o))+e:s*Math.pow(2,-10*(u-=1))*Math.sin((u*l-c)*(2*Math.PI)/o)*.5+n+e)},BounceEaseOut(u,e,n,l){return(u/=l)<1/2.75?n*(7.5625*u*u)+e:u<2/2.75?n*(7.5625*(u-=1.5/2.75)*u+.75)+e:u<2.5/2.75?n*(7.5625*(u-=2.25/2.75)*u+.9375)+e:n*(7.5625*(u-=2.625/2.75)*u+.984375)+e},BounceEaseIn(u,e,n,l){return n-Hi.BounceEaseOut(l-u,0,n,l)+e},BounceEaseInOut(u,e,n,l){return u<l/2?Hi.BounceEaseIn(u*2,0,n,l)*.5+e:Hi.BounceEaseOut(u*2-l,0,n,l)*.5+n*.5+e},EaseIn(u,e,n,l){return n*(u/=l)*u+e},EaseOut(u,e,n,l){return-n*(u/=l)*(u-2)+e},EaseInOut(u,e,n,l){return(u/=l/2)<1?n/2*u*u+e:-n/2*(--u*(u-2)-1)+e},StrongEaseIn(u,e,n,l){return n*(u/=l)*u*u*u*u+e},StrongEaseOut(u,e,n,l){return n*((u=u/l-1)*u*u*u*u+1)+e},StrongEaseInOut(u,e,n,l){return(u/=l/2)<1?n/2*u*u*u*u*u+e:n/2*((u-=2)*u*u*u*u+2)+e},Linear(u,e,n,l){return n*u/l+e}},jn=x._assign(k,{Util:x,Transform:xe,Node:Q,Container:Ae,Stage:ts,stages:Di,Layer:sn,FastLayer:gu,Group:qn,DD:Tt,Shape:j,shapes:Gi,Animation:Ge,Tween:zt,Easings:Hi,Context:Il,Canvas:cu});class ra extends j{_sceneFunc(e){const n=k.getAngle(this.angle()),l=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,l),e.arc(0,0,this.innerRadius(),n,0,!l),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),l=this.clockwise(),s=k.getAngle(l?360-this.angle():this.angle()),o=Math.cos(Math.min(s,Math.PI)),c=1,f=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),g=Math.sin(Math.min(s,Math.PI/2)),m=o*(o>0?e:n),y=c*n,S=f*(f>0?e:n),p=g*(g>0?n:e);return{x:m,y:l?-1*p:S,width:y-m,height:p-S}}}ra.prototype._centroid=!0;ra.prototype.className="Arc";ra.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];Yt(ra);b.addGetterSetter(ra,"innerRadius",0,P());b.addGetterSetter(ra,"outerRadius",0,P());b.addGetterSetter(ra,"angle",0,P());b.addGetterSetter(ra,"clockwise",!1,Xe());function nu(u,e,n,l,s,o,c){const f=Math.sqrt(Math.pow(n-u,2)+Math.pow(l-e,2)),g=Math.sqrt(Math.pow(s-n,2)+Math.pow(o-l,2)),m=c*f/(f+g),y=c*g/(f+g),S=n-m*(s-u),p=l-m*(o-e),C=n+y*(s-u),_=l+y*(o-e);return[S,p,C,_]}function zh(u,e){const n=u.length,l=[];for(let s=2;s<n-2;s+=2){const o=nu(u[s-2],u[s-1],u[s],u[s+1],u[s+2],u[s+3],e);isNaN(o[0])||(l.push(o[0]),l.push(o[1]),l.push(u[s]),l.push(u[s+1]),l.push(o[2]),l.push(o[3]))}return l}function v2(u){const e=[[u[0],u[2],u[4],u[6]],[u[1],u[3],u[5],u[7]]],n=[];for(const l of e){const s=-3*l[0]+9*l[1]-9*l[2]+3*l[3];if(s!==0){const o=6*l[0]-12*l[1]+6*l[2],c=-3*l[0]+3*l[1],f=o*o-4*s*c;if(f>=0){const g=Math.sqrt(f);n.push((-o+g)/(2*s)),n.push((-o-g)/(2*s))}}}return n.filter(l=>l>0&&l<1).flatMap(l=>e.map(s=>{const o=1-l;return o*o*o*s[0]+3*o*o*l*s[1]+3*o*l*l*s[2]+l*l*l*s[3]}))}let ua=class extends j{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const n=this.points(),l=n.length,s=this.tension(),o=this.closed(),c=this.bezier();if(!l)return;let f=0;if(e.beginPath(),e.moveTo(n[0],n[1]),s!==0&&l>4){const g=this.getTensionPoints(),m=g.length;for(f=o?0:4,o||e.quadraticCurveTo(g[0],g[1],g[2],g[3]);f<m-2;)e.bezierCurveTo(g[f++],g[f++],g[f++],g[f++],g[f++],g[f++]);o||e.quadraticCurveTo(g[m-2],g[m-1],n[l-2],n[l-1])}else if(c)for(f=2;f<l;)e.bezierCurveTo(n[f++],n[f++],n[f++],n[f++],n[f++],n[f++]);else for(f=2;f<l;f+=2)e.lineTo(n[f],n[f+1]);o?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():zh(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),n=e.length,l=this.tension(),s=nu(e[n-2],e[n-1],e[0],e[1],e[2],e[3],l),o=nu(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],l),c=zh(e,l);return[s[2],s[3]].concat(c).concat([o[0],o[1],e[n-2],e[n-1],o[2],o[3],s[0],s[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:this.bezier()?e=[e[0],e[1],...v2(this.points()),e[e.length-2],e[e.length-1]]:e=this.points();let n=e[0],l=e[0],s=e[1],o=e[1],c,f;for(let g=0;g<e.length/2;g++)c=e[g*2],f=e[g*2+1],n=Math.min(n,c),l=Math.max(l,c),s=Math.min(s,f),o=Math.max(o,f);return{x:n,y:s,width:l-n,height:o-s}}};ua.prototype.className="Line";ua.prototype._attrsAffectingSize=["points","bezier","tension"];Yt(ua);b.addGetterSetter(ua,"closed",!1);b.addGetterSetter(ua,"bezier",!1);b.addGetterSetter(ua,"tension",0,P());b.addGetterSetter(ua,"points",[],H1());const S2=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],_2=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],b2=[[1],[1,1],[1,2,1],[1,3,3,1]],Oh=(u,e,n)=>{let l,s;const c=n/2;l=0;for(let f=0;f<20;f++)s=c*S2[20][f]+c,l+=_2[20][f]*C2(u,e,s);return c*l},Dh=(u,e,n)=>{n===void 0&&(n=1);const l=u[0]-2*u[1]+u[2],s=e[0]-2*e[1]+e[2],o=2*u[1]-2*u[0],c=2*e[1]-2*e[0],f=4*(l*l+s*s),g=4*(l*o+s*c),m=o*o+c*c;if(f===0)return n*Math.sqrt(Math.pow(u[2]-u[0],2)+Math.pow(e[2]-e[0],2));const y=g/(2*f),S=m/f,p=n+y,C=S-y*y,_=p*p+C>0?Math.sqrt(p*p+C):0,R=y*y+C>0?Math.sqrt(y*y+C):0,N=y+Math.sqrt(y*y+C)!==0?C*Math.log(Math.abs((p+_)/(y+R))):0;return Math.sqrt(f)/2*(p*_-y*R+N)};function C2(u,e,n){const l=iu(1,n,u),s=iu(1,n,e),o=l*l+s*s;return Math.sqrt(o)}const iu=(u,e,n)=>{const l=n.length-1;let s,o;if(l===0)return 0;if(u===0){o=0;for(let c=0;c<=l;c++)o+=b2[l][c]*Math.pow(1-e,l-c)*Math.pow(e,c)*n[c];return o}else{s=new Array(l);for(let c=0;c<l;c++)s[c]=l*(n[c+1]-n[c]);return iu(u-1,e,s)}},Gh=(u,e,n)=>{let l=1,s=u/e,o=(u-n(s))/e,c=0;for(;l>.001;){const f=n(s+o),g=Math.abs(u-f)/e;if(g<l)l=g,s+=o;else{const m=n(s-o),y=Math.abs(u-m)/e;y<l?(l=y,s-=o):o/=2}if(c++,c>500)break}return s};class Ot extends j{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ot.parsePathData(this.data()),this.pathLength=Ot.getPathLength(this.dataArray)}_sceneFunc(e){const n=this.dataArray;e.beginPath();let l=!1;for(let s=0;s<n.length;s++){const o=n[s].command,c=n[s].points;switch(o){case"L":e.lineTo(c[0],c[1]);break;case"M":e.moveTo(c[0],c[1]);break;case"C":e.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":e.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":const f=c[0],g=c[1],m=c[2],y=c[3],S=c[4],p=c[5],C=c[6],_=c[7],R=m>y?m:y,N=m>y?1:m/y,A=m>y?y/m:1;e.translate(f,g),e.rotate(C),e.scale(N,A),e.arc(0,0,R,S,S+p,1-_),e.scale(1/N,1/A),e.rotate(-C),e.translate(-f,-g);break;case"z":l=!0,e.closePath();break}}!l&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],y=g.points[5],S=g.points[4]+y;let p=Math.PI/180;if(Math.abs(m-S)<p&&(p=Math.abs(m-S)),y<0)for(let C=m-p;C>S;C-=p){const _=Ot.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],C,0);e.push(_.x,_.y)}else for(let C=m+p;C<S;C+=p){const _=Ot.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],C,0);e.push(_.x,_.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const y=Ot.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);e.push(y.x,y.y)}else e=e.concat(g.points)});let n=e[0],l=e[0],s=e[1],o=e[1],c,f;for(let g=0;g<e.length/2;g++)c=e[g*2],f=e[g*2+1],isNaN(c)||(n=Math.min(n,c),l=Math.max(l,c)),isNaN(f)||(s=Math.min(s,f),o=Math.max(o,f));return{x:n,y:s,width:l-n,height:o-s}}getLength(){return this.pathLength}getPointAtLength(e){return Ot.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,n,l,s){return Math.sqrt((l-e)*(l-e)+(s-n)*(s-n))}static getPathLength(e){let n=0;for(let l=0;l<e.length;++l)n+=e[l].pathLength;return n}static getPointAtLengthOfDataArray(e,n){let l,s=0,o=n.length;if(!o)return null;for(;s<o&&e>n[s].pathLength;)e-=n[s].pathLength,++s;if(s===o)return l=n[s-1].points.slice(-2),{x:l[0],y:l[1]};if(e<.01)return n[s].command==="M"?(l=n[s].points.slice(0,2),{x:l[0],y:l[1]}):{x:n[s].start.x,y:n[s].start.y};const c=n[s],f=c.points;switch(c.command){case"L":return Ot.getPointOnLine(e,c.start.x,c.start.y,f[0],f[1]);case"C":return Ot.getPointOnCubicBezier(Gh(e,Ot.getPathLength(n),R=>Oh([c.start.x,f[0],f[2],f[4]],[c.start.y,f[1],f[3],f[5]],R)),c.start.x,c.start.y,f[0],f[1],f[2],f[3],f[4],f[5]);case"Q":return Ot.getPointOnQuadraticBezier(Gh(e,Ot.getPathLength(n),R=>Dh([c.start.x,f[0],f[2]],[c.start.y,f[1],f[3]],R)),c.start.x,c.start.y,f[0],f[1],f[2],f[3]);case"A":const g=f[0],m=f[1],y=f[2],S=f[3],p=f[5],C=f[6];let _=f[4];return _+=p*e/c.pathLength,Ot.getPointOnEllipticalArc(g,m,y,S,_,C)}return null}static getPointOnLine(e,n,l,s,o,c,f){c=c??n,f=f??l;const g=this.getLineLength(n,l,s,o);if(g<1e-10)return{x:n,y:l};if(s===n)return{x:c,y:f+(o>l?e:-e)};const m=(o-l)/(s-n),y=Math.sqrt(e*e/(1+m*m))*(s<n?-1:1),S=m*y;if(Math.abs(f-l-m*(c-n))<1e-10)return{x:c+y,y:f+S};const p=((c-n)*(s-n)+(f-l)*(o-l))/(g*g),C=n+p*(s-n),_=l+p*(o-l),R=this.getLineLength(c,f,C,_),N=Math.sqrt(e*e-R*R),A=Math.sqrt(N*N/(1+m*m))*(s<n?-1:1),z=m*A;return{x:C+A,y:_+z}}static getPointOnCubicBezier(e,n,l,s,o,c,f,g,m){function y(N){return N*N*N}function S(N){return 3*N*N*(1-N)}function p(N){return 3*N*(1-N)*(1-N)}function C(N){return(1-N)*(1-N)*(1-N)}const _=g*y(e)+c*S(e)+s*p(e)+n*C(e),R=m*y(e)+f*S(e)+o*p(e)+l*C(e);return{x:_,y:R}}static getPointOnQuadraticBezier(e,n,l,s,o,c,f){function g(C){return C*C}function m(C){return 2*C*(1-C)}function y(C){return(1-C)*(1-C)}const S=c*g(e)+s*m(e)+n*y(e),p=f*g(e)+o*m(e)+l*y(e);return{x:S,y:p}}static getPointOnEllipticalArc(e,n,l,s,o,c){const f=Math.cos(c),g=Math.sin(c),m={x:l*Math.cos(o),y:s*Math.sin(o)};return{x:e+(m.x*f-m.y*g),y:n+(m.x*g+m.y*f)}}static parsePathData(e){if(!e)return[];let n=e;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let S=0;S<l.length;S++)n=n.replace(new RegExp(l[S],"g"),"|"+l[S]);const s=n.split("|"),o=[],c=[];let f=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let y;for(let S=1;S<s.length;S++){let p=s[S],C=p.charAt(0);for(p=p.slice(1),c.length=0;y=m.exec(p);)c.push(y[0]);let _=[],R=C==="A"||C==="a"?0:-1;for(let N=0,A=c.length;N<A;N++){const z=c[N];if(z==="00"){_.push(0,0),R>=0&&(R+=2,R>=7&&(R-=7));continue}if(R>=0){if(R===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(z)){_.push(parseInt(z[0],10)),_.push(parseInt(z[1],10)),_.push(parseFloat(z.slice(2))),R+=3,R>=7&&(R-=7);continue}if(z==="11"||z==="10"||z==="01"){_.push(parseInt(z[0],10)),_.push(parseInt(z[1],10)),R+=2,R>=7&&(R-=7);continue}if(z==="0"||z==="1"){_.push(parseInt(z,10)),R+=1,R>=7&&(R-=7);continue}}else if(R===4){if(/^[01]\d+(?:\.\d+)?$/.test(z)){_.push(parseInt(z[0],10)),_.push(parseFloat(z.slice(1))),R+=2,R>=7&&(R-=7);continue}if(z==="0"||z==="1"){_.push(parseInt(z,10)),R+=1,R>=7&&(R-=7);continue}}const L=parseFloat(z);isNaN(L)?_.push(0):_.push(L),R+=1,R>=7&&(R-=7)}else{const L=parseFloat(z);isNaN(L)?_.push(0):_.push(L)}}for(;_.length>0&&!isNaN(_[0]);){let N="",A=[];const z=f,L=g;let U,W,X,tt,I,nt,lt,ct,B,V;switch(C){case"l":f+=_.shift(),g+=_.shift(),N="L",A.push(f,g);break;case"L":f=_.shift(),g=_.shift(),A.push(f,g);break;case"m":const at=_.shift(),K=_.shift();if(f+=at,g+=K,N="M",o.length>2&&o[o.length-1].command==="z"){for(let E=o.length-2;E>=0;E--)if(o[E].command==="M"){f=o[E].points[0]+at,g=o[E].points[1]+K;break}}A.push(f,g),C="l";break;case"M":f=_.shift(),g=_.shift(),N="M",A.push(f,g),C="L";break;case"h":f+=_.shift(),N="L",A.push(f,g);break;case"H":f=_.shift(),N="L",A.push(f,g);break;case"v":g+=_.shift(),N="L",A.push(f,g);break;case"V":g=_.shift(),N="L",A.push(f,g);break;case"C":A.push(_.shift(),_.shift(),_.shift(),_.shift()),f=_.shift(),g=_.shift(),A.push(f,g);break;case"c":A.push(f+_.shift(),g+_.shift(),f+_.shift(),g+_.shift()),f+=_.shift(),g+=_.shift(),N="C",A.push(f,g);break;case"S":W=f,X=g,U=o[o.length-1],U.command==="C"&&(W=f+(f-U.points[2]),X=g+(g-U.points[3])),A.push(W,X,_.shift(),_.shift()),f=_.shift(),g=_.shift(),N="C",A.push(f,g);break;case"s":W=f,X=g,U=o[o.length-1],U.command==="C"&&(W=f+(f-U.points[2]),X=g+(g-U.points[3])),A.push(W,X,f+_.shift(),g+_.shift()),f+=_.shift(),g+=_.shift(),N="C",A.push(f,g);break;case"Q":A.push(_.shift(),_.shift()),f=_.shift(),g=_.shift(),A.push(f,g);break;case"q":A.push(f+_.shift(),g+_.shift()),f+=_.shift(),g+=_.shift(),N="Q",A.push(f,g);break;case"T":W=f,X=g,U=o[o.length-1],U.command==="Q"&&(W=f+(f-U.points[0]),X=g+(g-U.points[1])),f=_.shift(),g=_.shift(),N="Q",A.push(W,X,f,g);break;case"t":W=f,X=g,U=o[o.length-1],U.command==="Q"&&(W=f+(f-U.points[0]),X=g+(g-U.points[1])),f+=_.shift(),g+=_.shift(),N="Q",A.push(W,X,f,g);break;case"A":tt=_.shift(),I=_.shift(),nt=_.shift(),lt=_.shift(),ct=_.shift(),B=f,V=g,f=_.shift(),g=_.shift(),N="A",A=this.convertEndpointToCenterParameterization(B,V,f,g,lt,ct,tt,I,nt);break;case"a":tt=_.shift(),I=_.shift(),nt=_.shift(),lt=_.shift(),ct=_.shift(),B=f,V=g,f+=_.shift(),g+=_.shift(),N="A",A=this.convertEndpointToCenterParameterization(B,V,f,g,lt,ct,tt,I,nt);break}o.push({command:N||C,points:A,start:{x:z,y:L},pathLength:this.calcLength(z,L,N||C,A)})}(C==="z"||C==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(e,n,l,s){let o,c,f,g;const m=Ot;switch(l){case"L":return m.getLineLength(e,n,s[0],s[1]);case"C":return Oh([e,s[0],s[2],s[4]],[n,s[1],s[3],s[5]],1);case"Q":return Dh([e,s[0],s[2]],[n,s[1],s[3]],1);case"A":o=0;const y=s[4],S=s[5],p=s[4]+S;let C=Math.PI/180;if(Math.abs(y-p)<C&&(C=Math.abs(y-p)),c=m.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],y,0),S<0)for(g=y-C;g>p;g-=C)f=m.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],g,0),o+=m.getLineLength(c.x,c.y,f.x,f.y),c=f;else for(g=y+C;g<p;g+=C)f=m.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],g,0),o+=m.getLineLength(c.x,c.y,f.x,f.y),c=f;return f=m.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],p,0),o+=m.getLineLength(c.x,c.y,f.x,f.y),o}return 0}static convertEndpointToCenterParameterization(e,n,l,s,o,c,f,g,m){const y=m*(Math.PI/180),S=Math.cos(y)*(e-l)/2+Math.sin(y)*(n-s)/2,p=-1*Math.sin(y)*(e-l)/2+Math.cos(y)*(n-s)/2,C=S*S/(f*f)+p*p/(g*g);C>1&&(f*=Math.sqrt(C),g*=Math.sqrt(C));let _=Math.sqrt((f*f*(g*g)-f*f*(p*p)-g*g*(S*S))/(f*f*(p*p)+g*g*(S*S)));o===c&&(_*=-1),isNaN(_)&&(_=0);const R=_*f*p/g,N=_*-g*S/f,A=(e+l)/2+Math.cos(y)*R-Math.sin(y)*N,z=(n+s)/2+Math.sin(y)*R+Math.cos(y)*N,L=function(lt){return Math.sqrt(lt[0]*lt[0]+lt[1]*lt[1])},U=function(lt,ct){return(lt[0]*ct[0]+lt[1]*ct[1])/(L(lt)*L(ct))},W=function(lt,ct){return(lt[0]*ct[1]<lt[1]*ct[0]?-1:1)*Math.acos(U(lt,ct))},X=W([1,0],[(S-R)/f,(p-N)/g]),tt=[(S-R)/f,(p-N)/g],I=[(-1*S-R)/f,(-1*p-N)/g];let nt=W(tt,I);return U(tt,I)<=-1&&(nt=Math.PI),U(tt,I)>=1&&(nt=0),c===0&&nt>0&&(nt=nt-2*Math.PI),c===1&&nt<0&&(nt=nt+2*Math.PI),[A,z,f,g,X,nt,y,c]}}Ot.prototype.className="Path";Ot.prototype._attrsAffectingSize=["data"];Yt(Ot);b.addGetterSetter(Ot,"data");let rn=class extends ua{_sceneFunc(e){super._sceneFunc(e);const n=Math.PI*2,l=this.points();let s=l;const o=this.tension()!==0&&l.length>4;o&&(s=this.getTensionPoints());const c=this.pointerLength(),f=l.length;let g,m;if(o){const p=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],l[f-2],l[f-1]],C=Ot.calcLength(s[s.length-4],s[s.length-3],"C",p),_=Ot.getPointOnQuadraticBezier(Math.min(1,1-c/C),p[0],p[1],p[2],p[3],p[4],p[5]);g=l[f-2]-_.x,m=l[f-1]-_.y}else g=l[f-2]-l[f-4],m=l[f-1]-l[f-3];const y=(Math.atan2(m,g)+n)%n,S=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(l[f-2],l[f-1]),e.rotate(y),e.moveTo(0,0),e.lineTo(-c,S/2),e.lineTo(-c,-S/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(l[0],l[1]),o?(g=(s[0]+s[2])/2-l[0],m=(s[1]+s[3])/2-l[1]):(g=l[2]-l[0],m=l[3]-l[1]),e.rotate((Math.atan2(-m,-g)+n)%n),e.moveTo(0,0),e.lineTo(-c,S/2),e.lineTo(-c,-S/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x,y:e.y-n,width:e.width,height:e.height+n*2}}};rn.prototype.className="Arrow";Yt(rn);b.addGetterSetter(rn,"pointerLength",10,P());b.addGetterSetter(rn,"pointerWidth",10,P());b.addGetterSetter(rn,"pointerAtBeginning",!1);b.addGetterSetter(rn,"pointerAtEnding",!0);class Vn extends j{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}Vn.prototype._centroid=!0;Vn.prototype.className="Circle";Vn.prototype._attrsAffectingSize=["radius"];Yt(Vn);b.addGetterSetter(Vn,"radius",0,P());let Ga=class extends j{_sceneFunc(e){const n=this.radiusX(),l=this.radiusY();e.beginPath(),e.save(),n!==l&&e.scale(1,l/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}};Ga.prototype.className="Ellipse";Ga.prototype._centroid=!0;Ga.prototype._attrsAffectingSize=["radiusX","radiusY"];Yt(Ga);b.addComponentsGetterSetter(Ga,"radius",["x","y"]);b.addGetterSetter(Ga,"radiusX",0,P());b.addGetterSetter(Ga,"radiusY",0,P());class Me extends j{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),n=this.hasShadow();return e&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),l=this.getHeight(),s=this.cornerRadius(),o=this.attrs.image;let c;if(o){const f=this.attrs.cropWidth,g=this.attrs.cropHeight;f&&g?c=[o,this.cropX(),this.cropY(),f,g,0,0,n,l]:c=[o,0,0,n,l]}(this.hasFill()||this.hasStroke()||s)&&(e.beginPath(),s?x.drawRoundedRectPath(e,n,l,s):e.rect(0,0,n,l),e.closePath(),e.fillStrokeShape(this)),o&&(s&&e.clip(),e.drawImage.apply(e,c))}_hitFunc(e){const n=this.width(),l=this.height(),s=this.cornerRadius();e.beginPath(),s?x.drawRoundedRectPath(e,n,l,s):e.rect(0,0,n,l),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n,l;return(l=(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&l!==void 0?l:0}getHeight(){var e,n,l;return(l=(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&l!==void 0?l:0}static fromURL(e,n,l=null){const s=x.createImageElement();s.onload=function(){const o=new Me({image:s});n(o)},s.onerror=l,s.crossOrigin="Anonymous",s.src=e}}Me.prototype.className="Image";Me.prototype._attrsAffectingSize=["image"];Yt(Me);b.addGetterSetter(Me,"cornerRadius",0,$l(4));b.addGetterSetter(Me,"image");b.addComponentsGetterSetter(Me,"crop",["x","y","width","height"]);b.addGetterSetter(Me,"cropX",0,P());b.addGetterSetter(Me,"cropY",0,P());b.addGetterSetter(Me,"cropWidth",0,P());b.addGetterSetter(Me,"cropHeight",0,P());const g0=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],E2="Change.konva",T2="none",lu="up",su="right",ru="down",uu="left",x2=g0.length;class mu extends qn{constructor(e){super(e),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let n=this,l;const s=function(){n._sync()};for(l=0;l<x2;l++)e.on(g0[l]+E2,s)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),n=this.getTag(),l,s,o,c,f,g,m;if(e&&n){switch(l=e.width(),s=e.height(),o=n.pointerDirection(),c=n.pointerWidth(),m=n.pointerHeight(),f=0,g=0,o){case lu:f=l/2,g=-1*m;break;case su:f=l+c,g=s/2;break;case ru:f=l/2,g=s+m;break;case uu:f=-1*c,g=s/2;break}n.setAttrs({x:-1*f,y:-1*g,width:l,height:s}),e.setAttrs({x:-1*f,y:-1*g})}}}mu.prototype.className="Label";Yt(mu);class un extends j{_sceneFunc(e){const n=this.width(),l=this.height(),s=this.pointerDirection(),o=this.pointerWidth(),c=this.pointerHeight(),f=this.cornerRadius();let g=0,m=0,y=0,S=0;typeof f=="number"?g=m=y=S=Math.min(f,n/2,l/2):(g=Math.min(f[0]||0,n/2,l/2),m=Math.min(f[1]||0,n/2,l/2),S=Math.min(f[2]||0,n/2,l/2),y=Math.min(f[3]||0,n/2,l/2)),e.beginPath(),e.moveTo(g,0),s===lu&&(e.lineTo((n-o)/2,0),e.lineTo(n/2,-1*c),e.lineTo((n+o)/2,0)),e.lineTo(n-m,0),e.arc(n-m,m,m,Math.PI*3/2,0,!1),s===su&&(e.lineTo(n,(l-c)/2),e.lineTo(n+o,l/2),e.lineTo(n,(l+c)/2)),e.lineTo(n,l-S),e.arc(n-S,l-S,S,0,Math.PI/2,!1),s===ru&&(e.lineTo((n+o)/2,l),e.lineTo(n/2,l+c),e.lineTo((n-o)/2,l)),e.lineTo(y,l),e.arc(y,l-y,y,Math.PI/2,Math.PI,!1),s===uu&&(e.lineTo(0,(l+c)/2),e.lineTo(-1*o,l/2),e.lineTo(0,(l-c)/2)),e.lineTo(0,g),e.arc(g,g,g,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,n=0,l=this.pointerWidth(),s=this.pointerHeight(),o=this.pointerDirection(),c=this.width(),f=this.height();return o===lu?(n-=s,f+=s):o===ru?f+=s:o===uu?(e-=l*1.5,c+=l):o===su&&(c+=l*1.5),{x:e,y:n,width:c,height:f}}}un.prototype.className="Tag";Yt(un);b.addGetterSetter(un,"pointerDirection",T2);b.addGetterSetter(un,"pointerWidth",0,P());b.addGetterSetter(un,"pointerHeight",0,P());b.addGetterSetter(un,"cornerRadius",0,$l(4));let Ui=class extends j{_sceneFunc(e){const n=this.cornerRadius(),l=this.width(),s=this.height();e.beginPath(),n?x.drawRoundedRectPath(e,l,s,n):e.rect(0,0,l,s),e.closePath(),e.fillStrokeShape(this)}};Ui.prototype.className="Rect";Yt(Ui);b.addGetterSetter(Ui,"cornerRadius",0,$l(4));class Ha extends j{_sceneFunc(e){const n=this._getPoints(),l=this.radius(),s=this.sides(),o=this.cornerRadius();if(e.beginPath(),o)x.drawRoundedPolygonPath(e,n,s,l,o);else{e.moveTo(n[0].x,n[0].y);for(let c=1;c<n.length;c++)e.lineTo(n[c].x,n[c].y)}e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,l=[];for(let s=0;s<e;s++)l.push({x:n*Math.sin(s*2*Math.PI/e),y:-1*n*Math.cos(s*2*Math.PI/e)});return l}getSelfRect(){const e=this._getPoints();let n=e[0].x,l=e[0].x,s=e[0].y,o=e[0].y;return e.forEach(c=>{n=Math.min(n,c.x),l=Math.max(l,c.x),s=Math.min(s,c.y),o=Math.max(o,c.y)}),{x:n,y:s,width:l-n,height:o-s}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Ha.prototype.className="RegularPolygon";Ha.prototype._centroid=!0;Ha.prototype._attrsAffectingSize=["radius"];Yt(Ha);b.addGetterSetter(Ha,"radius",0,P());b.addGetterSetter(Ha,"sides",0,P());b.addGetterSetter(Ha,"cornerRadius",0,$l(4));const Hh=Math.PI*2;class on extends j{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,Hh,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),Hh,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}on.prototype.className="Ring";on.prototype._centroid=!0;on.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Yt(on);b.addGetterSetter(on,"innerRadius",0,P());b.addGetterSetter(on,"outerRadius",0,P());class Qe extends j{constructor(e){super(e),this._updated=!0,this.anim=new Ge(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const n=this.animation(),l=this.frameIndex(),s=l*4,o=this.animations()[n],c=this.frameOffsets(),f=o[s+0],g=o[s+1],m=o[s+2],y=o[s+3],S=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,m,y),e.closePath(),e.fillStrokeShape(this)),S)if(c){const p=c[n],C=l*2;e.drawImage(S,f,g,m,y,p[C+0],p[C+1],m,y)}else e.drawImage(S,f,g,m,y,0,0,m,y)}_hitFunc(e){const n=this.animation(),l=this.frameIndex(),s=l*4,o=this.animations()[n],c=this.frameOffsets(),f=o[s+2],g=o[s+3];if(e.beginPath(),c){const m=c[n],y=l*2;e.rect(m[y+0],m[y+1],f,g)}else e.rect(0,0,f,g);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),n=this.animation(),l=this.animations(),s=l[n],o=s.length/4;e<o-1?this.frameIndex(e+1):this.frameIndex(0)}}Qe.prototype.className="Sprite";Yt(Qe);b.addGetterSetter(Qe,"animation");b.addGetterSetter(Qe,"animations");b.addGetterSetter(Qe,"frameOffsets");b.addGetterSetter(Qe,"image");b.addGetterSetter(Qe,"frameIndex",0,P());b.addGetterSetter(Qe,"frameRate",17,P());b.backCompat(Qe,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Ba extends j{_sceneFunc(e){const n=this.innerRadius(),l=this.outerRadius(),s=this.numPoints();e.beginPath(),e.moveTo(0,0-l);for(let o=1;o<s*2;o++){const c=o%2===0?l:n,f=c*Math.sin(o*Math.PI/s),g=-1*c*Math.cos(o*Math.PI/s);e.lineTo(f,g)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Ba.prototype.className="Star";Ba.prototype._centroid=!0;Ba.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Yt(Ba);b.addGetterSetter(Ba,"numPoints",5,P());b.addGetterSetter(Ba,"innerRadius",0,P());b.addGetterSetter(Ba,"outerRadius",0,P());function za(u){return[...u].reduce((e,n,l,s)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const o=s[l+1];o&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(o)?(e.push(n+o),s[l+1]=""):e.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(s[l+1]||""))?e.push(n+s[l+1]):l>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?e[e.length-1]+=n:n&&e.push(n);return e},[])}const Xn="auto",A2="center",m0="inherit",Ti="justify",M2="Change.konva",R2="2d",Bh="-",p0="left",N2="text",z2="Text",O2="top",D2="bottom",Uh="middle",y0="normal",G2="px ",Kl=" ",H2="right",Lh="rtl",B2="word",U2="char",Yh="none",Jr="",v0=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],L2=v0.length;function Y2(u){return u.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,l=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!l&&(e=`"${e}"`),e}).join(", ")}let Ql;function Pr(){return Ql||(Ql=x.createCanvasElement().getContext(R2),Ql)}function X2(u){u.fillText(this._partialText,this._partialTextX,this._partialTextY)}function w2(u){u.setAttr("miterLimit",2),u.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function q2(u){return u=u||{},!u.fillLinearGradientColorStops&&!u.fillRadialGradientColorStops&&!u.fillPatternImage&&(u.fill=u.fill||"black"),u}let Dt=class extends j{constructor(e){super(q2(e)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<L2;n++)this.on(v0[n]+M2,this._setTextData);this._setTextData()}_sceneFunc(e){var n,l;const s=this.textArr,o=s.length;if(!this.text())return;let c=this.padding(),f=this.fontSize(),g=this.lineHeight()*f,m=this.verticalAlign(),y=this.direction(),S=0,p=this.align(),C=this.getWidth(),_=this.letterSpacing(),R=this.charRenderFunc(),N=this.fill(),A=this.textDecoration(),z=this.underlineOffset(),L=A.indexOf("underline")!==-1,U=A.indexOf("line-through")!==-1,W;y=y===m0?e.direction:y;let X=g/2,tt=Uh;if(!k.legacyTextRendering){const I=this.measureSize("M");tt="alphabetic";const nt=(n=I.fontBoundingBoxAscent)!==null&&n!==void 0?n:I.actualBoundingBoxAscent,lt=(l=I.fontBoundingBoxDescent)!==null&&l!==void 0?l:I.actualBoundingBoxDescent;X=(nt-lt)/2+g/2}for(y===Lh&&e.setAttr("direction",y),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",tt),e.setAttr("textAlign",p0),m===Uh?S=(this.getHeight()-o*g-c*2)/2:m===D2&&(S=this.getHeight()-o*g-c*2),e.translate(c,S+c),W=0;W<o;W++){let I=0,nt=0;const lt=s[W],ct=lt.text,B=lt.width,V=lt.lastInParagraph;if(e.save(),p===H2?I+=C-B-c*2:p===A2&&(I+=(C-B-c*2)/2),L){e.save(),e.beginPath();const K=z??(k.legacyTextRendering?Math.round(f/2):Math.round(f/4)),E=I,Y=X+nt+K;e.moveTo(E,Y);const D=p===Ti&&!V?C-c*2:B;e.lineTo(E+Math.round(D),Y),e.lineWidth=f/15;const q=this._getLinearGradient();e.strokeStyle=q||N,e.stroke(),e.restore()}const at=I;if(y!==Lh&&(_!==0||p===Ti||R)){const K=ct.split(" ").length-1,E=za(ct);for(let Y=0;Y<E.length;Y++){const D=E[Y];if(D===" "&&!V&&p===Ti&&(I+=(C-c*2-B)/K),this._partialTextX=I,this._partialTextY=X+nt,this._partialText=D,R){e.save();const F=s.slice(0,W).reduce((it,Et)=>it+za(Et.text).length,0),st=Y+F;R({char:D,index:st,x:I,y:X+nt,lineIndex:W,column:Y,isLastInLine:V,width:this.measureSize(D).width,context:e})}e.fillStrokeShape(this),R&&e.restore(),I+=this.measureSize(D).width+_}}else _!==0&&e.setAttr("letterSpacing",`${_}px`),this._partialTextX=I,this._partialTextY=X+nt,this._partialText=ct,e.fillStrokeShape(this);if(U){e.save(),e.beginPath();const K=k.legacyTextRendering?0:-Math.round(f/4),E=at;e.moveTo(E,X+nt+K);const Y=p===Ti&&!V?C-c*2:B;e.lineTo(E+Math.round(Y),X+nt+K),e.lineWidth=f/15;const D=this._getLinearGradient();e.strokeStyle=D||N,e.stroke(),e.restore()}e.restore(),o>1&&(X+=g)}}_hitFunc(e){const n=this.getWidth(),l=this.getHeight();e.beginPath(),e.rect(0,0,n,l),e.closePath(),e.fillStrokeShape(this)}setText(e){const n=x._isString(e)?e:e==null?"":e+"";return this._setAttr(N2,n),this}getWidth(){return this.attrs.width===Xn||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Xn||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return x.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n,l,s,o,c,f,g,m,y,S,p;let C=Pr(),_=this.fontSize(),R;C.save(),C.font=this._getContextFont(),R=C.measureText(e),C.restore();const N=_/100;return{actualBoundingBoxAscent:(n=R.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*N,actualBoundingBoxDescent:(l=R.actualBoundingBoxDescent)!==null&&l!==void 0?l:0,actualBoundingBoxLeft:(s=R.actualBoundingBoxLeft)!==null&&s!==void 0?s:-7.421875*N,actualBoundingBoxRight:(o=R.actualBoundingBoxRight)!==null&&o!==void 0?o:75.732421875*N,alphabeticBaseline:(c=R.alphabeticBaseline)!==null&&c!==void 0?c:0,emHeightAscent:(f=R.emHeightAscent)!==null&&f!==void 0?f:100*N,emHeightDescent:(g=R.emHeightDescent)!==null&&g!==void 0?g:-20*N,fontBoundingBoxAscent:(m=R.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*N,fontBoundingBoxDescent:(y=R.fontBoundingBoxDescent)!==null&&y!==void 0?y:21*N,hangingBaseline:(S=R.hangingBaseline)!==null&&S!==void 0?S:72.80000305175781*N,ideographicBaseline:(p=R.ideographicBaseline)!==null&&p!==void 0?p:-21*N,width:R.width,height:_}}_getContextFont(){return this.fontStyle()+Kl+this.fontVariant()+Kl+(this.fontSize()+G2)+Y2(this.fontFamily())}_addTextLine(e){this.align()===Ti&&(e=e.trim());const l=this._getTextWidth(e);return this.textArr.push({text:e,width:l,lastInParagraph:!1})}_getTextWidth(e){const n=this.letterSpacing(),l=e.length;return Pr().measureText(e).width+n*l}_setTextData(){let e=this.text().split(`
`),n=+this.fontSize(),l=0,s=this.lineHeight()*n,o=this.attrs.width,c=this.attrs.height,f=o!==Xn&&o!==void 0,g=c!==Xn&&c!==void 0,m=this.padding(),y=o-m*2,S=c-m*2,p=0,C=this.wrap(),_=C!==Yh,R=C!==U2&&_,N=this.ellipsis();this.textArr=[],Pr().font=this._getContextFont();const A=N?this._getTextWidth(Jr):0;for(let z=0,L=e.length;z<L;++z){let U=e[z],W=this._getTextWidth(U);if(f&&W>y)for(;U.length>0;){let X=0,tt=za(U).length,I="",nt=0;for(;X<tt;){const lt=X+tt>>>1,ct=za(U),B=ct.slice(0,lt+1).join(""),V=this._getTextWidth(B);(N&&g&&p+s>S?V+A:V)<=y?(X=lt+1,I=B,nt=V):tt=lt}if(I){if(R){const B=za(U),V=za(I),at=B[V.length],K=at===Kl||at===Bh;let E;if(K&&nt<=y)E=V.length;else{const Y=V.lastIndexOf(Kl),D=V.lastIndexOf(Bh);E=Math.max(Y,D)+1}E>0&&(X=E,I=B.slice(0,X).join(""),nt=this._getTextWidth(I))}if(I=I.trimRight(),this._addTextLine(I),l=Math.max(l,nt),p+=s,this._shouldHandleEllipsis(p)){this._tryToAddEllipsisToLastLine();break}if(U=za(U).slice(X).join("").trimLeft(),U.length>0&&(W=this._getTextWidth(U),W<=y)){this._addTextLine(U),p+=s,l=Math.max(l,W);break}}else break}else this._addTextLine(U),p+=s,l=Math.max(l,W),this._shouldHandleEllipsis(p)&&z<L-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&p+s>S)break}this.textHeight=n,this.textWidth=l}_shouldHandleEllipsis(e){const n=+this.fontSize(),l=this.lineHeight()*n,s=this.attrs.height,o=s!==Xn&&s!==void 0,c=this.padding(),f=s-c*2;return!(this.wrap()!==Yh)||o&&e+l>f}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,n=e!==Xn&&e!==void 0,l=this.padding(),s=e-l*2,o=this.ellipsis(),c=this.textArr[this.textArr.length-1];!c||!o||(n&&(this._getTextWidth(c.text+Jr)<s||(c.text=c.text.slice(0,c.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(c.text+Jr))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return e&&n?!0:super._useBufferCanvas()}};Dt.prototype._fillFunc=X2;Dt.prototype._strokeFunc=w2;Dt.prototype.className=z2;Dt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Yt(Dt);b.overWriteSetter(Dt,"width",fu());b.overWriteSetter(Dt,"height",fu());b.addGetterSetter(Dt,"direction",m0);b.addGetterSetter(Dt,"fontFamily","Arial");b.addGetterSetter(Dt,"fontSize",12,P());b.addGetterSetter(Dt,"fontStyle",y0);b.addGetterSetter(Dt,"fontVariant",y0);b.addGetterSetter(Dt,"padding",0,P());b.addGetterSetter(Dt,"align",p0);b.addGetterSetter(Dt,"verticalAlign",O2);b.addGetterSetter(Dt,"lineHeight",1,P());b.addGetterSetter(Dt,"wrap",B2);b.addGetterSetter(Dt,"ellipsis",!1,Xe());b.addGetterSetter(Dt,"letterSpacing",0,P());b.addGetterSetter(Dt,"text","",ln());b.addGetterSetter(Dt,"textDecoration","");b.addGetterSetter(Dt,"underlineOffset",void 0,P());b.addGetterSetter(Dt,"charRenderFunc",void 0);const j2="",S0="normal";function _0(u){u.fillText(this.partialText,0,0)}function b0(u){u.strokeText(this.partialText,0,0)}class Wt extends j{constructor(e){super(e),this.dummyCanvas=x.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Ot.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const n=this.pathLength;return e>n?null:Ot.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Ot.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const n=this.textDecoration(),l=this.fill(),s=this.fontSize(),o=this.glyphInfo,c=n.indexOf("underline")!==-1,f=n.indexOf("line-through")!==-1;c&&e.beginPath();for(let g=0;g<o.length;g++){e.save();const m=o[g].p0;e.translate(m.x,m.y),e.rotate(o[g].rotation),this.partialText=o[g].text,e.fillStrokeShape(this),c&&(g===0&&e.moveTo(0,s/2+1),e.lineTo(o[g].width,s/2+1)),e.restore()}if(c&&(e.strokeStyle=l,e.lineWidth=s/20,e.stroke()),f){e.beginPath();for(let g=0;g<o.length;g++){e.save();const m=o[g].p0;e.translate(m.x,m.y),e.rotate(o[g].rotation),g===0&&e.moveTo(0,0),e.lineTo(o[g].width,0),e.restore()}e.strokeStyle=l,e.lineWidth=s/20,e.stroke()}e.restore()}_hitFunc(e){e.beginPath();const n=this.glyphInfo;if(n.length>=1){const l=n[0].p0;e.moveTo(l.x,l.y)}for(let l=0;l<n.length;l++){const s=n[l].p1;e.lineTo(s.x,s.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return x.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Dt.prototype.setText.call(this,e)}_getContextFont(){return Dt.prototype._getContextFont.call(this)}_getTextSize(e){const l=this.dummyCanvas.getContext("2d");l.save(),l.font=this._getContextFont();const s=l.measureText(e);return l.restore(),{width:s.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const e=za(this.text()),n=[];let l=0;for(let S=0;S<e.length;S++)n.push({char:e[S],width:this._getTextSize(e[S]).width}),l+=n[S].width;const{height:s}=this._getTextSize(this.attrs.text);if(this.textWidth=l,this.textHeight=s,this.glyphInfo=[],!this.attrs.data)return null;const o=this.letterSpacing(),c=this.align(),f=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*o,0);let m=0;c==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),c==="right"&&(m=Math.max(0,this.pathLength-g));let y=m;for(let S=0;S<n.length;S++){const p=this._getPointAtLength(y);if(!p)return;const C=n[S].char;let _=n[S].width+o;if(C===" "&&c==="justify"){const U=this.text().split(" ").length-1;_+=(this.pathLength-g)/U}const R=this._getPointAtLength(y+_);if(!R)return;const N=Ot.getLineLength(p.x,p.y,R.x,R.y);let A=0;if(f)try{A=f(n[S-1].char,C)*this.fontSize()}catch{A=0}p.x+=A,R.x+=A,this.textWidth+=A;const z=Ot.getPointOnLine(A+N/2,p.x,p.y,R.x,R.y),L=Math.atan2(R.y-p.y,R.x-p.x);this.glyphInfo.push({transposeX:z.x,transposeY:z.y,text:e[S],rotation:L,p0:p,p1:R,width:N}),y+=_}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(m){e.push(m.p0.x),e.push(m.p0.y),e.push(m.p1.x),e.push(m.p1.y)});let n=e[0]||0,l=e[0]||0,s=e[1]||0,o=e[1]||0,c,f;for(let m=0;m<e.length/2;m++)c=e[m*2],f=e[m*2+1],n=Math.min(n,c),l=Math.max(l,c),s=Math.min(s,f),o=Math.max(o,f);const g=this.fontSize();return{x:n-g/2,y:s-g/2,width:l-n+g,height:o-s+g}}destroy(){return x.releaseCanvas(this.dummyCanvas),super.destroy()}}Wt.prototype._fillFunc=_0;Wt.prototype._strokeFunc=b0;Wt.prototype._fillFuncHit=_0;Wt.prototype._strokeFuncHit=b0;Wt.prototype.className="TextPath";Wt.prototype._attrsAffectingSize=["text","fontSize","data"];Yt(Wt);b.addGetterSetter(Wt,"data");b.addGetterSetter(Wt,"fontFamily","Arial");b.addGetterSetter(Wt,"fontSize",12,P());b.addGetterSetter(Wt,"fontStyle",S0);b.addGetterSetter(Wt,"align","left");b.addGetterSetter(Wt,"letterSpacing",0,P());b.addGetterSetter(Wt,"textBaseline","middle");b.addGetterSetter(Wt,"fontVariant",S0);b.addGetterSetter(Wt,"text",j2);b.addGetterSetter(Wt,"textDecoration","");b.addGetterSetter(Wt,"kerningFunc",void 0);const C0="tr-konva",V2=["resizeEnabledChange","rotateAnchorOffsetChange","rotateAnchorAngleChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(u=>u+`.${C0}`).join(" "),Xh="nodesRect",K2=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],Q2={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Z2="ontouchstart"in k._global;function J2(u,e,n){if(u==="rotater")return n;e+=x.degToRad(Q2[u]||0);const l=(x.radToDeg(e)%360+360)%360;return x._inRange(l,315+22.5,360)||x._inRange(l,0,22.5)?"ns-resize":x._inRange(l,45-22.5,45+22.5)?"nesw-resize":x._inRange(l,90-22.5,90+22.5)?"ew-resize":x._inRange(l,135-22.5,135+22.5)?"nwse-resize":x._inRange(l,180-22.5,180+22.5)?"ns-resize":x._inRange(l,225-22.5,225+22.5)?"nesw-resize":x._inRange(l,270-22.5,270+22.5)?"ew-resize":x._inRange(l,315-22.5,315+22.5)?"nwse-resize":(x.error("Transformer has unknown angle for cursor detection: "+l),"pointer")}const kl=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function P2(u){return{x:u.x+u.width/2*Math.cos(u.rotation)+u.height/2*Math.sin(-u.rotation),y:u.y+u.height/2*Math.cos(u.rotation)+u.width/2*Math.sin(u.rotation)}}function E0(u,e,n){const l=n.x+(u.x-n.x)*Math.cos(e)-(u.y-n.y)*Math.sin(e),s=n.y+(u.x-n.x)*Math.sin(e)+(u.y-n.y)*Math.cos(e);return{...u,rotation:u.rotation+e,x:l,y:s}}function F2(u,e){const n=P2(u);return E0(u,e,n)}function k2(u,e,n){let l=e;for(let s=0;s<u.length;s++){const o=k.getAngle(u[s]),c=Math.abs(o-e)%(Math.PI*2);Math.min(c,Math.PI*2-c)<n&&(l=o)}return l}let ou=0;class yt extends qn{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(V2,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return x.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return C0+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const n=e.filter(s=>s.isAncestorOf(this)?(x.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=n,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(s=>{const o=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(s._attrsAffectingSize.length){const c=s._attrsAffectingSize.map(f=>f+"Change."+this._getEventNamespace()).join(" ");s.on(c,o)}s.on(K2.map(c=>c+`.${this._getEventNamespace()}`).join(" "),o),s.on(`absoluteTransformChange.${this._getEventNamespace()}`,o),this._proxyDrag(s)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let n;e.on(`dragstart.${this._getEventNamespace()}`,l=>{n=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(l,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,l=>{if(!n)return;const s=e.getAbsolutePosition(),o=s.x-n.x,c=s.y-n.y;this.nodes().forEach(f=>{if(f===e||f.isDragging())return;const g=f.getAbsolutePosition();f.setAbsolutePosition({x:g.x+o,y:g.y+c}),f.startDrag(l)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Xh),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Xh,this.__getNodeRect)}__getNodeShape(e,n=this.rotation(),l){const s=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=e.getAbsoluteScale(l),c=e.getAbsolutePosition(l),f=s.x*o.x-e.offsetX()*o.x,g=s.y*o.y-e.offsetY()*o.y,m=(k.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),y={x:c.x+f*Math.cos(m)+g*Math.sin(-m),y:c.y+g*Math.cos(m)+f*Math.sin(m),width:s.width*o.x,height:s.height*o.y,rotation:m};return E0(y,-k.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const y=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),S=[{x:y.x,y:y.y},{x:y.x+y.width,y:y.y},{x:y.x+y.width,y:y.y+y.height},{x:y.x,y:y.y+y.height}],p=m.getAbsoluteTransform();S.forEach(function(C){const _=p.point(C);n.push(_)})});const l=new xe;l.rotate(-k.getAngle(this.rotation()));let s=1/0,o=1/0,c=-1/0,f=-1/0;n.forEach(function(m){const y=l.point(m);s===void 0&&(s=c=y.x,o=f=y.y),s=Math.min(s,y.x),o=Math.min(o,y.y),c=Math.max(c,y.x),f=Math.max(f,y.y)}),l.invert();const g=l.point({x:s,y:o});return{x:g.x,y:g.y,width:c-s,height:f-o,rotation:k.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),kl.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const n=new Ui({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Z2?10:"auto"}),l=this;n.on("mousedown touchstart",function(s){l._handleMouseDown(s)}),n.on("dragstart",s=>{n.stopDrag(),s.cancelBubble=!0}),n.on("dragend",s=>{s.cancelBubble=!0}),n.on("mouseenter",()=>{const s=k.getAngle(this.rotation()),o=this.rotateAnchorCursor(),c=J2(e,s,o);n.getStage().content&&(n.getStage().content.style.cursor=c),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const e=new j({name:"back",width:0,height:0,sceneFunc(n,l){const s=l.getParent(),o=s.padding(),c=l.width(),f=l.height();if(n.beginPath(),n.rect(-o,-o,c+o*2,f+o*2),s.rotateEnabled()&&s.rotateLineVisible()){const g=s.rotateAnchorAngle(),m=s.rotateAnchorOffset(),y=x.degToRad(g),S=Math.sin(y),p=-Math.cos(y),C=c/2,_=f/2;let R=1/0;p<0?R=Math.min(R,-_/p):p>0&&(R=Math.min(R,(f-_)/p)),S<0?R=Math.min(R,-C/S):S>0&&(R=Math.min(R,(c-C)/S));const N=C+S*R,A=_+p*R,z=x._sign(f),L=N+S*m*z,U=A+p*m*z;n.moveTo(N,A),n.lineTo(L,U)}n.fillStrokeShape(l)},hitFunc:(n,l)=>{if(!this.shouldOverdrawWholeArea())return;const s=this.padding();n.beginPath(),n.rect(-s,-s,l.width()+s*2,l.height()+s*2),n.fillStrokeShape(l)}});this.add(e),this._proxyDrag(e),e.on("dragstart",n=>{n.cancelBubble=!0}),e.on("dragmove",n=>{n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const n=this._getNodeRect(),l=n.width,s=n.height,o=Math.sqrt(Math.pow(l,2)+Math.pow(s,2));this.sin=Math.abs(s/o),this.cos=Math.abs(l/o),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const c=e.target.getAbsolutePosition(),f=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:f.x-c.x,y:f.y-c.y},ou++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:e.evt,target:g})})}_handleMouseMove(e){let n,l,s;const o=this.findOne("."+this._movingAnchorName),c=o.getStage();c.setPointersPositions(e);const f=c.getPointerPosition();let g={x:f.x-this._anchorDragOffset.x,y:f.y-this._anchorDragOffset.y};const m=o.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,e)),o.setAbsolutePosition(g);const y=o.getAbsolutePosition();if(m.x===y.x&&m.y===y.y)return;if(this._movingAnchorName==="rotater"){const z=this._getNodeRect();n=o.x()-z.width/2,l=-o.y()+z.height/2;const L=k.getAngle(this.rotateAnchorAngle());let U=Math.atan2(-l,n)+Math.PI/2-L;z.height<0&&(U-=Math.PI);const X=k.getAngle(this.rotation())+U,tt=k.getAngle(this.rotationSnapTolerance()),nt=k2(this.rotationSnaps(),X,tt)-z.rotation,lt=F2(z,nt);this._fitNodesInto(lt,e);return}const S=this.shiftBehavior();let p;S==="inverted"?p=this.keepRatio()&&!e.shiftKey:S==="none"?p=this.keepRatio():p=this.keepRatio()||e.shiftKey;let C=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(p){const z=C?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};s=Math.sqrt(Math.pow(z.x-o.x(),2)+Math.pow(z.y-o.y(),2));const L=this.findOne(".top-left").x()>z.x?-1:1,U=this.findOne(".top-left").y()>z.y?-1:1;n=s*this.cos*L,l=s*this.sin*U,this.findOne(".top-left").x(z.x-n),this.findOne(".top-left").y(z.y-l)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(o.y());else if(this._movingAnchorName==="top-right"){if(p){const z=C?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};s=Math.sqrt(Math.pow(o.x()-z.x,2)+Math.pow(z.y-o.y(),2));const L=this.findOne(".top-right").x()<z.x?-1:1,U=this.findOne(".top-right").y()>z.y?-1:1;n=s*this.cos*L,l=s*this.sin*U,this.findOne(".top-right").x(z.x+n),this.findOne(".top-right").y(z.y-l)}var _=o.position();this.findOne(".top-left").y(_.y),this.findOne(".bottom-right").x(_.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(o.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(o.x());else if(this._movingAnchorName==="bottom-left"){if(p){const z=C?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};s=Math.sqrt(Math.pow(z.x-o.x(),2)+Math.pow(o.y()-z.y,2));const L=z.x<o.x()?-1:1,U=o.y()<z.y?-1:1;n=s*this.cos*L,l=s*this.sin*U,o.x(z.x-n),o.y(z.y+l)}_=o.position(),this.findOne(".top-left").x(_.x),this.findOne(".bottom-right").y(_.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(o.y());else if(this._movingAnchorName==="bottom-right"){if(p){const z=C?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};s=Math.sqrt(Math.pow(o.x()-z.x,2)+Math.pow(o.y()-z.y,2));const L=this.findOne(".bottom-right").x()<z.x?-1:1,U=this.findOne(".bottom-right").y()<z.y?-1:1;n=s*this.cos*L,l=s*this.sin*U,this.findOne(".bottom-right").x(z.x+n),this.findOne(".bottom-right").y(z.y+l)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(C=this.centeredScaling()||e.altKey,C){const z=this.findOne(".top-left"),L=this.findOne(".bottom-right"),U=z.x(),W=z.y(),X=this.getWidth()-L.x(),tt=this.getHeight()-L.y();L.move({x:-U,y:-W}),z.move({x:X,y:tt})}const R=this.findOne(".top-left").getAbsolutePosition();n=R.x,l=R.y;const N=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),A=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:l,width:N,height:A,rotation:k.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const l=this.getNode();ou--,this._fire("transformend",{evt:e,target:l}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),l&&this._nodes.forEach(s=>{var o;s._fire("transformend",{evt:e,target:s}),(o=s.getLayer())===null||o===void 0||o.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,n){const l=this._getNodeRect(),s=1;if(x._inRange(e.width,-this.padding()*2-s,s)){this.update();return}if(x._inRange(e.height,-this.padding()*2-s,s)){this.update();return}const o=new xe;if(o.rotate(k.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const p=o.point({x:-this.padding()*2,y:0});e.x+=p.x,e.y+=p.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=p.x,this._anchorDragOffset.y-=p.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const p=o.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=p.x,this._anchorDragOffset.y-=p.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const p=o.point({x:0,y:-this.padding()*2});e.x+=p.x,e.y+=p.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=p.x,this._anchorDragOffset.y-=p.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const p=o.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=p.x,this._anchorDragOffset.y-=p.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const p=this.boundBoxFunc()(l,e);p?e=p:x.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const c=1e7,f=new xe;f.translate(l.x,l.y),f.rotate(l.rotation),f.scale(l.width/c,l.height/c);const g=new xe,m=e.width/c,y=e.height/c;this.flipEnabled()===!1?(g.translate(e.x,e.y),g.rotate(e.rotation),g.translate(e.width<0?e.width:0,e.height<0?e.height:0),g.scale(Math.abs(m),Math.abs(y))):(g.translate(e.x,e.y),g.rotate(e.rotation),g.scale(m,y));const S=g.multiply(f.invert());this._nodes.forEach(p=>{var C;if(!p.getStage())return;const _=p.getParent().getAbsoluteTransform(),R=p.getTransform().copy();R.translate(p.offsetX(),p.offsetY());const N=new xe;N.multiply(_.copy().invert()).multiply(S).multiply(_).multiply(R);const A=N.decompose();p.setAttrs(A),(C=p.getLayer())===null||C===void 0||C.batchDraw()}),this.rotation(x._getRotation(e.rotation)),this._nodes.forEach(p=>{this._fire("transform",{evt:n,target:p}),p._fire("transform",{evt:n,target:p})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,n){this.findOne(e).setAttrs(n)}update(){var e;const n=this._getNodeRect();this.rotation(x._getRotation(n.rotation));const l=n.width,s=n.height,o=this.enabledAnchors(),c=this.resizeEnabled(),f=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(X=>{X.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+f,offsetY:g/2+f,visible:c&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:l/2,y:0,offsetY:g/2+f,visible:c&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:l,y:0,offsetX:g/2-f,offsetY:g/2+f,visible:c&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:s/2,offsetX:g/2+f,visible:c&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:l,y:s/2,offsetX:g/2-f,visible:c&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:s,offsetX:g/2+f,offsetY:g/2-f,visible:c&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:l/2,y:s,offsetY:g/2-f,visible:c&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:l,y:s,offsetX:g/2-f,offsetY:g/2-f,visible:c&&o.indexOf("bottom-right")>=0});const y=this.rotateAnchorAngle(),S=this.rotateAnchorOffset(),p=x.degToRad(y),C=Math.sin(p),_=-Math.cos(p),R=l/2,N=s/2;let A=1/0;_<0?A=Math.min(A,-N/_):_>0&&(A=Math.min(A,(s-N)/_)),C<0?A=Math.min(A,-R/C):C>0&&(A=Math.min(A,(l-R)/C));const z=R+C*A,L=N+_*A,U=x._sign(s);this._batchChangeChild(".rotater",{x:z+C*S*U,y:L+_*S*U-f*_,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:l,height:s,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(X=>X.draggable()),x:0,y:0});const W=this.anchorStyleFunc();W&&m.forEach(X=>{W(X)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),qn.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Q.prototype.toObject.call(this)}clone(e){return Q.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}yt.isTransforming=()=>ou>0;function W2(u){return u instanceof Array||x.warn("enabledAnchors value should be an array"),u instanceof Array&&u.forEach(function(e){kl.indexOf(e)===-1&&x.warn("Unknown anchor name: "+e+". Available names are: "+kl.join(", "))}),u||[]}yt.prototype.className="Transformer";Yt(yt);b.addGetterSetter(yt,"enabledAnchors",kl,W2);b.addGetterSetter(yt,"flipEnabled",!0,Xe());b.addGetterSetter(yt,"resizeEnabled",!0);b.addGetterSetter(yt,"anchorSize",10,P());b.addGetterSetter(yt,"rotateEnabled",!0);b.addGetterSetter(yt,"rotateLineVisible",!0);b.addGetterSetter(yt,"rotationSnaps",[]);b.addGetterSetter(yt,"rotateAnchorOffset",50,P());b.addGetterSetter(yt,"rotateAnchorAngle",0,P());b.addGetterSetter(yt,"rotateAnchorCursor","crosshair");b.addGetterSetter(yt,"rotationSnapTolerance",5,P());b.addGetterSetter(yt,"borderEnabled",!0);b.addGetterSetter(yt,"anchorStroke","rgb(0, 161, 255)");b.addGetterSetter(yt,"anchorStrokeWidth",1,P());b.addGetterSetter(yt,"anchorFill","white");b.addGetterSetter(yt,"anchorCornerRadius",0,P());b.addGetterSetter(yt,"borderStroke","rgb(0, 161, 255)");b.addGetterSetter(yt,"borderStrokeWidth",1,P());b.addGetterSetter(yt,"borderDash");b.addGetterSetter(yt,"keepRatio",!0);b.addGetterSetter(yt,"shiftBehavior","default");b.addGetterSetter(yt,"centeredScaling",!1);b.addGetterSetter(yt,"ignoreStroke",!1);b.addGetterSetter(yt,"padding",0,P());b.addGetterSetter(yt,"nodes");b.addGetterSetter(yt,"node");b.addGetterSetter(yt,"boundBoxFunc");b.addGetterSetter(yt,"anchorDragBoundFunc");b.addGetterSetter(yt,"anchorStyleFunc");b.addGetterSetter(yt,"shouldOverdrawWholeArea",!1);b.addGetterSetter(yt,"useSingleNodeRotation",!0);b.backCompat(yt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class oa extends j{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,k.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}oa.prototype.className="Wedge";oa.prototype._centroid=!0;oa.prototype._attrsAffectingSize=["radius"];Yt(oa);b.addGetterSetter(oa,"radius",0,P());b.addGetterSetter(oa,"angle",0,P());b.addGetterSetter(oa,"clockwise",!1);b.backCompat(oa,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function wh(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const I2=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],$2=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function t3(u,e){const n=u.data,l=u.width,s=u.height;let o,c,f,g,m,y,S,p,C,_,R,N,A,z,L,U,W,X,tt,I;const nt=e+e+1,lt=l-1,ct=s-1,B=e+1,V=B*(B+1)/2,at=new wh,K=I2[e],E=$2[e];let Y=null,D=at,q=null,F=null;for(let st=1;st<nt;st++)D=D.next=new wh,st===B&&(Y=D);D.next=at,f=c=0;for(let st=0;st<s;st++){N=A=z=L=g=m=y=S=0,p=B*(U=n[c]),C=B*(W=n[c+1]),_=B*(X=n[c+2]),R=B*(tt=n[c+3]),g+=V*U,m+=V*W,y+=V*X,S+=V*tt,D=at;for(let it=0;it<B;it++)D.r=U,D.g=W,D.b=X,D.a=tt,D=D.next;for(let it=1;it<B;it++)o=c+((lt<it?lt:it)<<2),g+=(D.r=U=n[o])*(I=B-it),m+=(D.g=W=n[o+1])*I,y+=(D.b=X=n[o+2])*I,S+=(D.a=tt=n[o+3])*I,N+=U,A+=W,z+=X,L+=tt,D=D.next;q=at,F=Y;for(let it=0;it<l;it++)n[c+3]=tt=S*K>>E,tt!==0?(tt=255/tt,n[c]=(g*K>>E)*tt,n[c+1]=(m*K>>E)*tt,n[c+2]=(y*K>>E)*tt):n[c]=n[c+1]=n[c+2]=0,g-=p,m-=C,y-=_,S-=R,p-=q.r,C-=q.g,_-=q.b,R-=q.a,o=f+((o=it+e+1)<lt?o:lt)<<2,N+=q.r=n[o],A+=q.g=n[o+1],z+=q.b=n[o+2],L+=q.a=n[o+3],g+=N,m+=A,y+=z,S+=L,q=q.next,p+=U=F.r,C+=W=F.g,_+=X=F.b,R+=tt=F.a,N-=U,A-=W,z-=X,L-=tt,F=F.next,c+=4;f+=l}for(let st=0;st<l;st++){A=z=L=N=m=y=S=g=0,c=st<<2,p=B*(U=n[c]),C=B*(W=n[c+1]),_=B*(X=n[c+2]),R=B*(tt=n[c+3]),g+=V*U,m+=V*W,y+=V*X,S+=V*tt,D=at;for(let Et=0;Et<B;Et++)D.r=U,D.g=W,D.b=X,D.a=tt,D=D.next;let it=l;for(let Et=1;Et<=e;Et++)c=it+st<<2,g+=(D.r=U=n[c])*(I=B-Et),m+=(D.g=W=n[c+1])*I,y+=(D.b=X=n[c+2])*I,S+=(D.a=tt=n[c+3])*I,N+=U,A+=W,z+=X,L+=tt,D=D.next,Et<ct&&(it+=l);c=st,q=at,F=Y;for(let Et=0;Et<s;Et++)o=c<<2,n[o+3]=tt=S*K>>E,tt>0?(tt=255/tt,n[o]=(g*K>>E)*tt,n[o+1]=(m*K>>E)*tt,n[o+2]=(y*K>>E)*tt):n[o]=n[o+1]=n[o+2]=0,g-=p,m-=C,y-=_,S-=R,p-=q.r,C-=q.g,_-=q.b,R-=q.a,o=st+((o=Et+B)<ct?o:ct)*l<<2,g+=N+=q.r=n[o],m+=A+=q.g=n[o+1],y+=z+=q.b=n[o+2],S+=L+=q.a=n[o+3],q=q.next,p+=U=F.r,C+=W=F.g,_+=X=F.b,R+=tt=F.a,N-=U,A-=W,z-=X,L-=tt,F=F.next,c+=l}}const e3=function(e){const n=Math.round(this.blurRadius());n>0&&t3(e,n)};b.addGetterSetter(Q,"blurRadius",0,P(),b.afterSetFilter);const a3=function(u){const e=this.brightness()*255,n=u.data,l=n.length;for(let s=0;s<l;s+=4)n[s]+=e,n[s+1]+=e,n[s+2]+=e};b.addGetterSetter(Q,"brightness",0,P(),b.afterSetFilter);const n3=function(u){const e=this.brightness(),n=u.data,l=n.length;for(let s=0;s<l;s+=4)n[s]=Math.min(255,n[s]*e),n[s+1]=Math.min(255,n[s+1]*e),n[s+2]=Math.min(255,n[s+2]*e)},i3=function(u){const e=Math.pow((this.contrast()+100)/100,2),n=u.data,l=n.length;let s=150,o=150,c=150;for(let f=0;f<l;f+=4)s=n[f],o=n[f+1],c=n[f+2],s/=255,s-=.5,s*=e,s+=.5,s*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,c/=255,c-=.5,c*=e,c+=.5,c*=255,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,c=c<0?0:c>255?255:c,n[f]=s,n[f+1]=o,n[f+2]=c};b.addGetterSetter(Q,"contrast",0,P(),b.afterSetFilter);const l3=function(u){var e,n,l,s,o,c,f,g,m;const y=u.data,S=u.width,p=u.height,C=Math.min(1,Math.max(0,(n=(e=this.embossStrength)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:.5)),_=Math.min(1,Math.max(0,(s=(l=this.embossWhiteLevel)===null||l===void 0?void 0:l.call(this))!==null&&s!==void 0?s:.5)),N=(f={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(c=(o=this.embossDirection)===null||o===void 0?void 0:o.call(this))!==null&&c!==void 0?c:"top-left"])!==null&&f!==void 0?f:315,A=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),z=C*10,L=_*255,U=N*Math.PI/180,W=Math.cos(U),X=Math.sin(U),tt=128/1020*z,I=new Uint8ClampedArray(y),nt=new Float32Array(S*p);for(let at=0,K=0;K<y.length;K+=4,at++)nt[at]=.2126*I[K]+.7152*I[K+1]+.0722*I[K+2];const lt=[-1,0,1,-2,0,2,-1,0,1],ct=[-1,-2,-1,0,0,0,1,2,1],B=[-S-1,-S,-S+1,-1,0,1,S-1,S,S+1],V=at=>at<0?0:at>255?255:at;for(let at=1;at<p-1;at++)for(let K=1;K<S-1;K++){const E=at*S+K;let Y=0,D=0;Y+=nt[E+B[0]]*lt[0],D+=nt[E+B[0]]*ct[0],Y+=nt[E+B[1]]*lt[1],D+=nt[E+B[1]]*ct[1],Y+=nt[E+B[2]]*lt[2],D+=nt[E+B[2]]*ct[2],Y+=nt[E+B[3]]*lt[3],D+=nt[E+B[3]]*ct[3],Y+=nt[E+B[5]]*lt[5],D+=nt[E+B[5]]*ct[5],Y+=nt[E+B[6]]*lt[6],D+=nt[E+B[6]]*ct[6],Y+=nt[E+B[7]]*lt[7],D+=nt[E+B[7]]*ct[7],Y+=nt[E+B[8]]*lt[8],D+=nt[E+B[8]]*ct[8];const q=W*Y+X*D,F=V(L+q*tt),st=E*4;if(A){const it=F-L;y[st]=V(I[st]+it),y[st+1]=V(I[st+1]+it),y[st+2]=V(I[st+2]+it),y[st+3]=I[st+3]}else y[st]=y[st+1]=y[st+2]=F,y[st+3]=I[st+3]}for(let at=0;at<S;at++){let K=at*4,E=((p-1)*S+at)*4;y[K]=I[K],y[K+1]=I[K+1],y[K+2]=I[K+2],y[K+3]=I[K+3],y[E]=I[E],y[E+1]=I[E+1],y[E+2]=I[E+2],y[E+3]=I[E+3]}for(let at=1;at<p-1;at++){let K=at*S*4,E=(at*S+(S-1))*4;y[K]=I[K],y[K+1]=I[K+1],y[K+2]=I[K+2],y[K+3]=I[K+3],y[E]=I[E],y[E+1]=I[E+1],y[E+2]=I[E+2],y[E+3]=I[E+3]}return u};b.addGetterSetter(Q,"embossStrength",.5,P(),b.afterSetFilter);b.addGetterSetter(Q,"embossWhiteLevel",.5,P(),b.afterSetFilter);b.addGetterSetter(Q,"embossDirection","top-left",void 0,b.afterSetFilter);b.addGetterSetter(Q,"embossBlend",!1,void 0,b.afterSetFilter);function Fr(u,e,n,l,s){const o=n-e,c=s-l;if(o===0)return l+c/2;if(c===0)return l;let f=(u-e)/o;return f=c*f+l,f}const s3=function(u){const e=u.data,n=e.length;let l=e[0],s=l,o,c=e[1],f=c,g,m=e[2],y=m,S;const p=this.enhance();if(p===0)return;for(let L=0;L<n;L+=4)o=e[L+0],o<l?l=o:o>s&&(s=o),g=e[L+1],g<c?c=g:g>f&&(f=g),S=e[L+2],S<m?m=S:S>y&&(y=S);s===l&&(s=255,l=0),f===c&&(f=255,c=0),y===m&&(y=255,m=0);let C,_,R,N,A,z;if(p>0)C=s+p*(255-s),_=l-p*(l-0),R=f+p*(255-f),N=c-p*(c-0),A=y+p*(255-y),z=m-p*(m-0);else{const L=(s+l)*.5;C=s+p*(s-L),_=l+p*(l-L);const U=(f+c)*.5;R=f+p*(f-U),N=c+p*(c-U);const W=(y+m)*.5;A=y+p*(y-W),z=m+p*(m-W)}for(let L=0;L<n;L+=4)e[L+0]=Fr(e[L+0],l,s,_,C),e[L+1]=Fr(e[L+1],c,f,N,R),e[L+2]=Fr(e[L+2],m,y,z,A)};b.addGetterSetter(Q,"enhance",0,P(),b.afterSetFilter);const r3=function(u){const e=u.data,n=e.length;for(let l=0;l<n;l+=4){const s=.34*e[l]+.5*e[l+1]+.16*e[l+2];e[l]=s,e[l+1]=s,e[l+2]=s}};b.addGetterSetter(Q,"hue",0,P(),b.afterSetFilter);b.addGetterSetter(Q,"saturation",0,P(),b.afterSetFilter);b.addGetterSetter(Q,"luminance",0,P(),b.afterSetFilter);const u3=function(u){const e=u.data,n=e.length,l=1,s=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,c=this.luminance()*127,f=l*s*Math.cos(o*Math.PI/180),g=l*s*Math.sin(o*Math.PI/180),m=.299*l+.701*f+.167*g,y=.587*l-.587*f+.33*g,S=.114*l-.114*f-.497*g,p=.299*l-.299*f-.328*g,C=.587*l+.413*f+.035*g,_=.114*l-.114*f+.293*g,R=.299*l-.3*f+1.25*g,N=.587*l-.586*f-1.05*g,A=.114*l+.886*f-.2*g;let z,L,U,W;for(let X=0;X<n;X+=4)z=e[X+0],L=e[X+1],U=e[X+2],W=e[X+3],e[X+0]=m*z+y*L+S*U+c,e[X+1]=p*z+C*L+_*U+c,e[X+2]=R*z+N*L+A*U+c,e[X+3]=W},o3=function(u){const e=u.data,n=e.length,l=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,c=l*s*Math.cos(o*Math.PI/180),f=l*s*Math.sin(o*Math.PI/180),g=.299*l+.701*c+.167*f,m=.587*l-.587*c+.33*f,y=.114*l-.114*c-.497*f,S=.299*l-.299*c-.328*f,p=.587*l+.413*c+.035*f,C=.114*l-.114*c+.293*f,_=.299*l-.3*c+1.25*f,R=.587*l-.586*c-1.05*f,N=.114*l+.886*c-.2*f;for(let A=0;A<n;A+=4){const z=e[A+0],L=e[A+1],U=e[A+2],W=e[A+3];e[A+0]=g*z+m*L+y*U,e[A+1]=S*z+p*L+C*U,e[A+2]=_*z+R*L+N*U,e[A+3]=W}};b.addGetterSetter(Q,"hue",0,P(),b.afterSetFilter);b.addGetterSetter(Q,"saturation",0,P(),b.afterSetFilter);b.addGetterSetter(Q,"value",0,P(),b.afterSetFilter);const c3=function(u){const e=u.data,n=e.length;for(let l=0;l<n;l+=4)e[l]=255-e[l],e[l+1]=255-e[l+1],e[l+2]=255-e[l+2]},h3=function(u,e,n){const l=u.data,s=e.data,o=u.width,c=u.height,f=n.polarCenterX||o/2,g=n.polarCenterY||c/2;let m=Math.sqrt(f*f+g*g),y=o-f,S=c-g;const p=Math.sqrt(y*y+S*S);m=p>m?p:m;const C=c,_=o,R=360/_*Math.PI/180;for(let N=0;N<_;N+=1){const A=Math.sin(N*R),z=Math.cos(N*R);for(let L=0;L<C;L+=1){y=Math.floor(f+m*L/C*z),S=Math.floor(g+m*L/C*A);let U=(S*o+y)*4;const W=l[U+0],X=l[U+1],tt=l[U+2],I=l[U+3];U=(N+L*o)*4,s[U+0]=W,s[U+1]=X,s[U+2]=tt,s[U+3]=I}}},f3=function(u,e,n){const l=u.data,s=e.data,o=u.width,c=u.height,f=n.polarCenterX||o/2,g=n.polarCenterY||c/2;let m=Math.sqrt(f*f+g*g),y=o-f,S=c-g;const p=Math.sqrt(y*y+S*S);m=p>m?p:m;const C=c,_=o,R=0;let N,A;for(y=0;y<o;y+=1)for(S=0;S<c;S+=1){const z=y-f,L=S-g,U=Math.sqrt(z*z+L*L)*C/m;let W=(Math.atan2(L,z)*180/Math.PI+360+R)%360;W=W*_/360,N=Math.floor(W),A=Math.floor(U);let X=(A*o+N)*4;const tt=l[X+0],I=l[X+1],nt=l[X+2],lt=l[X+3];X=(S*o+y)*4,s[X+0]=tt,s[X+1]=I,s[X+2]=nt,s[X+3]=lt}},d3=function(u){const e=u.width,n=u.height;let l,s,o,c,f,g,m,y,S,p,C=Math.round(this.kaleidoscopePower());const _=Math.round(this.kaleidoscopeAngle()),R=Math.floor(e*(_%360)/360);if(C<1)return;const N=x.createCanvasElement();N.width=e,N.height=n;const A=N.getContext("2d").getImageData(0,0,e,n);x.releaseCanvas(N),h3(u,A,{polarCenterX:e/2,polarCenterY:n/2});let z=e/Math.pow(2,C);for(;z<=8;)z=z*2,C-=1;z=Math.ceil(z);let L=z,U=0,W=L,X=1;for(R+z>e&&(U=L,W=0,X=-1),s=0;s<n;s+=1)for(l=U;l!==W;l+=X)o=Math.round(l+R)%e,S=(e*s+o)*4,f=A.data[S+0],g=A.data[S+1],m=A.data[S+2],y=A.data[S+3],p=(e*s+l)*4,A.data[p+0]=f,A.data[p+1]=g,A.data[p+2]=m,A.data[p+3]=y;for(s=0;s<n;s+=1)for(L=Math.floor(z),c=0;c<C;c+=1){for(l=0;l<L+1;l+=1)S=(e*s+l)*4,f=A.data[S+0],g=A.data[S+1],m=A.data[S+2],y=A.data[S+3],p=(e*s+L*2-l-1)*4,A.data[p+0]=f,A.data[p+1]=g,A.data[p+2]=m,A.data[p+3]=y;L*=2}f3(A,u,{})};b.addGetterSetter(Q,"kaleidoscopePower",2,P(),b.afterSetFilter);b.addGetterSetter(Q,"kaleidoscopeAngle",0,P(),b.afterSetFilter);function Zl(u,e,n){let l=(n*u.width+e)*4;const s=[];return s.push(u.data[l++],u.data[l++],u.data[l++],u.data[l++]),s}function xi(u,e){return Math.sqrt(Math.pow(u[0]-e[0],2)+Math.pow(u[1]-e[1],2)+Math.pow(u[2]-e[2],2))}function g3(u){const e=[0,0,0];for(let n=0;n<u.length;n++)e[0]+=u[n][0],e[1]+=u[n][1],e[2]+=u[n][2];return e[0]/=u.length,e[1]/=u.length,e[2]/=u.length,e}function m3(u,e){const n=Zl(u,0,0),l=Zl(u,u.width-1,0),s=Zl(u,0,u.height-1),o=Zl(u,u.width-1,u.height-1),c=e||10;if(xi(n,l)<c&&xi(l,o)<c&&xi(o,s)<c&&xi(s,n)<c){const f=g3([l,n,o,s]),g=[];for(let m=0;m<u.width*u.height;m++){const y=xi(f,[u.data[m*4],u.data[m*4+1],u.data[m*4+2]]);g[m]=y<c?0:255}return g}}function p3(u,e){for(let n=0;n<u.width*u.height;n++)u.data[4*n+3]=e[n]}function y3(u,e,n){const l=[1,1,1,1,0,1,1,1,1],s=Math.round(Math.sqrt(l.length)),o=Math.floor(s/2),c=[];for(let f=0;f<n;f++)for(let g=0;g<e;g++){const m=f*e+g;let y=0;for(let S=0;S<s;S++)for(let p=0;p<s;p++){const C=f+S-o,_=g+p-o;if(C>=0&&C<n&&_>=0&&_<e){const R=C*e+_,N=l[S*s+p];y+=u[R]*N}}c[m]=y===255*8?255:0}return c}function v3(u,e,n){const l=[1,1,1,1,1,1,1,1,1],s=Math.round(Math.sqrt(l.length)),o=Math.floor(s/2),c=[];for(let f=0;f<n;f++)for(let g=0;g<e;g++){const m=f*e+g;let y=0;for(let S=0;S<s;S++)for(let p=0;p<s;p++){const C=f+S-o,_=g+p-o;if(C>=0&&C<n&&_>=0&&_<e){const R=C*e+_,N=l[S*s+p];y+=u[R]*N}}c[m]=y>=255*4?255:0}return c}function S3(u,e,n){const l=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],s=Math.round(Math.sqrt(l.length)),o=Math.floor(s/2),c=[];for(let f=0;f<n;f++)for(let g=0;g<e;g++){const m=f*e+g;let y=0;for(let S=0;S<s;S++)for(let p=0;p<s;p++){const C=f+S-o,_=g+p-o;if(C>=0&&C<n&&_>=0&&_<e){const R=C*e+_,N=l[S*s+p];y+=u[R]*N}}c[m]=y}return c}const _3=function(u){const e=this.threshold();let n=m3(u,e);return n&&(n=y3(n,u.width,u.height),n=v3(n,u.width,u.height),n=S3(n,u.width,u.height),p3(u,n)),u};b.addGetterSetter(Q,"threshold",0,P(),b.afterSetFilter);const b3=function(u){const e=this.noise()*255,n=u.data,l=n.length,s=e/2;for(let o=0;o<l;o+=4)n[o+0]+=s-2*s*Math.random(),n[o+1]+=s-2*s*Math.random(),n[o+2]+=s-2*s*Math.random()};b.addGetterSetter(Q,"noise",.2,P(),b.afterSetFilter);const C3=function(u){let e=Math.ceil(this.pixelSize()),n=u.width,l=u.height,s=Math.ceil(n/e),o=Math.ceil(l/e),c=u.data;if(e<=0){x.error("pixelSize value can not be <= 0");return}for(let f=0;f<s;f+=1)for(let g=0;g<o;g+=1){let m=0,y=0,S=0,p=0;const C=f*e,_=C+e,R=g*e,N=R+e;let A=0;for(let z=C;z<_;z+=1)if(!(z>=n))for(let L=R;L<N;L+=1){if(L>=l)continue;const U=(n*L+z)*4;m+=c[U+0],y+=c[U+1],S+=c[U+2],p+=c[U+3],A+=1}m=m/A,y=y/A,S=S/A,p=p/A;for(let z=C;z<_;z+=1)if(!(z>=n))for(let L=R;L<N;L+=1){if(L>=l)continue;const U=(n*L+z)*4;c[U+0]=m,c[U+1]=y,c[U+2]=S,c[U+3]=p}}};b.addGetterSetter(Q,"pixelSize",8,P(),b.afterSetFilter);const E3=function(u){const e=Math.round(this.levels()*254)+1,n=u.data,l=n.length,s=255/e;for(let o=0;o<l;o+=1)n[o]=Math.floor(n[o]/s)*s};b.addGetterSetter(Q,"levels",.5,P(),b.afterSetFilter);const T3=function(u){const e=u.data,n=e.length,l=this.red(),s=this.green(),o=this.blue();for(let c=0;c<n;c+=4){const f=(.34*e[c]+.5*e[c+1]+.16*e[c+2])/255;e[c]=f*l,e[c+1]=f*s,e[c+2]=f*o,e[c+3]=e[c+3]}};b.addGetterSetter(Q,"red",0,function(u){return this._filterUpToDate=!1,u>255?255:u<0?0:Math.round(u)});b.addGetterSetter(Q,"green",0,function(u){return this._filterUpToDate=!1,u>255?255:u<0?0:Math.round(u)});b.addGetterSetter(Q,"blue",0,Jh,b.afterSetFilter);const x3=function(u){const e=u.data,n=e.length,l=this.red(),s=this.green(),o=this.blue(),c=this.alpha();for(let f=0;f<n;f+=4){const g=1-c;e[f]=l*c+e[f]*g,e[f+1]=s*c+e[f+1]*g,e[f+2]=o*c+e[f+2]*g}};b.addGetterSetter(Q,"red",0,function(u){return this._filterUpToDate=!1,u>255?255:u<0?0:Math.round(u)});b.addGetterSetter(Q,"green",0,function(u){return this._filterUpToDate=!1,u>255?255:u<0?0:Math.round(u)});b.addGetterSetter(Q,"blue",0,Jh,b.afterSetFilter);b.addGetterSetter(Q,"alpha",1,function(u){return this._filterUpToDate=!1,u>1?1:u<0?0:u});const A3=function(u){const e=u.data,n=e.length;for(let l=0;l<n;l+=4){const s=e[l+0],o=e[l+1],c=e[l+2];e[l+0]=Math.min(255,s*.393+o*.769+c*.189),e[l+1]=Math.min(255,s*.349+o*.686+c*.168),e[l+2]=Math.min(255,s*.272+o*.534+c*.131)}},M3=function(u){const n=u.data;for(let l=0;l<n.length;l+=4){const s=n[l],o=n[l+1],c=n[l+2];.2126*s+.7152*o+.0722*c>=128&&(n[l]=255-s,n[l+1]=255-o,n[l+2]=255-c)}return u},R3=function(u){const e=this.threshold()*255,n=u.data,l=n.length;for(let s=0;s<l;s+=1)n[s]=n[s]<e?0:255};b.addGetterSetter(Q,"threshold",.5,P(),b.afterSetFilter);jn.Util._assign(jn,{Arc:ra,Arrow:rn,Circle:Vn,Ellipse:Ga,Image:Me,Label:mu,Tag:un,Line:ua,Path:Ot,Rect:Ui,RegularPolygon:Ha,Ring:on,Sprite:Qe,Star:Ba,Text:Dt,TextPath:Wt,Transformer:yt,Wedge:oa,Filters:{Blur:e3,Brightness:n3,Brighten:a3,Contrast:i3,Emboss:l3,Enhance:s3,Grayscale:r3,HSL:u3,HSV:o3,Invert:c3,Kaleidoscope:d3,Mask:_3,Noise:b3,Pixelate:C3,Posterize:E3,RGB:T3,RGBA:x3,Sepia:A3,Solarize:M3,Threshold:R3}});var T0={exports:{}},x0={exports:{}},kr={exports:{}},Wr={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qh;function N3(){return qh||(qh=1,function(u){function e(E,Y){var D=E.length;E.push(Y);t:for(;0<D;){var q=D-1>>>1,F=E[q];if(0<s(F,Y))E[q]=Y,E[D]=F,D=q;else break t}}function n(E){return E.length===0?null:E[0]}function l(E){if(E.length===0)return null;var Y=E[0],D=E.pop();if(D!==Y){E[0]=D;t:for(var q=0,F=E.length,st=F>>>1;q<st;){var it=2*(q+1)-1,Et=E[it],xt=it+1,Gt=E[xt];if(0>s(Et,D))xt<F&&0>s(Gt,Et)?(E[q]=Gt,E[xt]=D,q=xt):(E[q]=Et,E[it]=D,q=it);else if(xt<F&&0>s(Gt,D))E[q]=Gt,E[xt]=D,q=xt;else break t}}return Y}function s(E,Y){var D=E.sortIndex-Y.sortIndex;return D!==0?D:E.id-Y.id}if(u.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;u.unstable_now=function(){return o.now()}}else{var c=Date,f=c.now();u.unstable_now=function(){return c.now()-f}}var g=[],m=[],y=1,S=null,p=3,C=!1,_=!1,R=!1,N=!1,A=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function U(E){for(var Y=n(m);Y!==null;){if(Y.callback===null)l(m);else if(Y.startTime<=E)l(m),Y.sortIndex=Y.expirationTime,e(g,Y);else break;Y=n(m)}}function W(E){if(R=!1,U(E),!_)if(n(g)!==null)_=!0,X||(X=!0,B());else{var Y=n(m);Y!==null&&K(W,Y.startTime-E)}}var X=!1,tt=-1,I=5,nt=-1;function lt(){return N?!0:!(u.unstable_now()-nt<I)}function ct(){if(N=!1,X){var E=u.unstable_now();nt=E;var Y=!0;try{t:{_=!1,R&&(R=!1,z(tt),tt=-1),C=!0;var D=p;try{e:{for(U(E),S=n(g);S!==null&&!(S.expirationTime>E&&lt());){var q=S.callback;if(typeof q=="function"){S.callback=null,p=S.priorityLevel;var F=q(S.expirationTime<=E);if(E=u.unstable_now(),typeof F=="function"){S.callback=F,U(E),Y=!0;break e}S===n(g)&&l(g),U(E)}else l(g);S=n(g)}if(S!==null)Y=!0;else{var st=n(m);st!==null&&K(W,st.startTime-E),Y=!1}}break t}finally{S=null,p=D,C=!1}Y=void 0}}finally{Y?B():X=!1}}}var B;if(typeof L=="function")B=function(){L(ct)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,at=V.port2;V.port1.onmessage=ct,B=function(){at.postMessage(null)}}else B=function(){A(ct,0)};function K(E,Y){tt=A(function(){E(u.unstable_now())},Y)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(E){E.callback=null},u.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<E?Math.floor(1e3/E):5},u.unstable_getCurrentPriorityLevel=function(){return p},u.unstable_next=function(E){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var D=p;p=Y;try{return E()}finally{p=D}},u.unstable_requestPaint=function(){N=!0},u.unstable_runWithPriority=function(E,Y){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var D=p;p=E;try{return Y()}finally{p=D}},u.unstable_scheduleCallback=function(E,Y,D){var q=u.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?q+D:q):D=q,E){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=D+F,E={id:y++,callback:Y,priorityLevel:E,startTime:D,expirationTime:F,sortIndex:-1},D>q?(E.sortIndex=D,e(m,E),n(g)===null&&E===n(m)&&(R?(z(tt),tt=-1):R=!0,K(W,D-q))):(E.sortIndex=F,e(g,E),_||C||(_=!0,X||(X=!0,B()))),E},u.unstable_shouldYield=lt,u.unstable_wrapCallback=function(E){var Y=p;return function(){var D=p;p=Y;try{return E.apply(this,arguments)}finally{p=D}}}}(Wr)),Wr}var jh;function z3(){return jh||(jh=1,kr.exports=N3()),kr.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(u){u.exports=function(e){function n(t,a,i,r){return new sf(t,a,i,r)}function l(){}function s(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)a+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){var a=t,i=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,a.flags&4098&&(i=a.return),t=a.return;while(t)}return a.tag===3?i:null}function c(t){if(o(t)!==t)throw Error(s(188))}function f(t){var a=t.alternate;if(!a){if(a=o(t),a===null)throw Error(s(188));return a!==t?null:t}for(var i=t,r=a;;){var h=i.return;if(h===null)break;var d=h.alternate;if(d===null){if(r=h.return,r!==null){i=r;continue}break}if(h.child===d.child){for(d=h.child;d;){if(d===i)return c(h),t;if(d===r)return c(h),a;d=d.sibling}throw Error(s(188))}if(i.return!==r.return)i=h,r=d;else{for(var v=!1,T=h.child;T;){if(T===i){v=!0,i=h,r=d;break}if(T===r){v=!0,r=h,i=d;break}T=T.sibling}if(!v){for(T=d.child;T;){if(T===i){v=!0,i=d,r=h;break}if(T===r){v=!0,r=d,i=h;break}T=T.sibling}if(!v)throw Error(s(189))}}if(i.alternate!==r)throw Error(s(190))}if(i.tag!==3)throw Error(s(188));return i.stateNode.current===i?t:a}function g(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=g(t),a!==null)return a;t=t.sibling}return null}function m(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(t.tag!==4&&(a=m(t),a!==null))return a;t=t.sibling}return null}function y(t){return t===null||typeof t!="object"?null:(t=Hc&&t[Hc]||t["@@iterator"],typeof t=="function"?t:null)}function S(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===hf?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vn:return"Fragment";case ur:return"Profiler";case Dc:return"StrictMode";case cr:return"Suspense";case hr:return"SuspenseList";case dr:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case yn:return"Portal";case va:return t.displayName||"Context";case Gc:return(t._context.displayName||"Context")+".Consumer";case or:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case fr:return a=t.displayName||null,a!==null?a:S(t.type)||"Memo";case Sa:a=t._payload,t=t._init;try{return S(t(a))}catch{}}return null}function p(t){return{current:t}}function C(t){0>bn||(t.current=Sr[bn],Sr[bn]=null,bn--)}function _(t,a){bn++,Sr[bn]=t.current,t.current=a}function R(t){return t>>>=0,t===0?32:31-(Xd(t)/wd|0)|0}function N(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function A(t,a,i){var r=t.pendingLanes;if(r===0)return 0;var h=0,d=t.suspendedLanes,v=t.pingedLanes;t=t.warmLanes;var T=r&134217727;return T!==0?(r=T&~d,r!==0?h=N(r):(v&=T,v!==0?h=N(v):i||(i=T&~t,i!==0&&(h=N(i))))):(T=r&~d,T!==0?h=N(T):v!==0?h=N(v):i||(i=r&~t,i!==0&&(h=N(i)))),h===0?0:a!==0&&a!==h&&!(a&d)&&(d=h&-h,i=a&-a,d>=i||d===32&&(i&4194048)!==0)?a:h}function z(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function L(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U(){var t=vl;return vl<<=1,!(vl&62914560)&&(vl=4194304),t}function W(t){for(var a=[],i=0;31>i;i++)a.push(t);return a}function X(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function tt(t,a,i,r,h,d){var v=t.pendingLanes;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=i,t.entangledLanes&=i,t.errorRecoveryDisabledLanes&=i,t.shellSuspendCounter=0;var T=t.entanglements,H=t.expirationTimes,w=t.hiddenUpdates;for(i=v&~i;0<i;){var $=31-Se(i),Z=1<<$;T[$]=0,H[$]=-1;var et=w[$];if(et!==null)for(w[$]=null,$=0;$<et.length;$++){var ht=et[$];ht!==null&&(ht.lane&=-536870913)}i&=~Z}r!==0&&I(t,r,0),d!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=d&~(v&~a))}function I(t,a,i){t.pendingLanes|=a,t.suspendedLanes&=~a;var r=31-Se(a);t.entangledLanes|=a,t.entanglements[r]=t.entanglements[r]|1073741824|i&261930}function nt(t,a){var i=t.entangledLanes|=a;for(t=t.entanglements;i;){var r=31-Se(i),h=1<<r;h&a|t[r]&a&&(t[r]|=a),i&=~h}}function lt(t,a){var i=a&-a;return i=i&42?1:ct(i),i&(t.suspendedLanes|a)?0:i}function ct(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function B(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function V(t){if(typeof Qd=="function"&&Zd(t),_e&&typeof _e.setStrictMode=="function")try{_e.setStrictMode(ui,t)}catch{}}function at(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}function K(t){if(Cr===void 0)try{throw Error()}catch(i){var a=i.stack.trim().match(/\n( *(at )?)/);Cr=a&&a[1]||"",sh=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cr+t+sh}function E(t,a){if(!t||Er)return"";Er=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(a){var Z=function(){throw Error()};if(Object.defineProperty(Z.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Z,[])}catch(ht){var et=ht}Reflect.construct(t,[],Z)}else{try{Z.call()}catch(ht){et=ht}t.call(Z.prototype)}}else{try{throw Error()}catch(ht){et=ht}(Z=t())&&typeof Z.catch=="function"&&Z.catch(function(){})}}catch(ht){if(ht&&et&&typeof ht.stack=="string")return[ht.stack,et.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var d=r.DetermineComponentFrameRoot(),v=d[0],T=d[1];if(v&&T){var H=v.split(`
`),w=T.split(`
`);for(h=r=0;r<H.length&&!H[r].includes("DetermineComponentFrameRoot");)r++;for(;h<w.length&&!w[h].includes("DetermineComponentFrameRoot");)h++;if(r===H.length||h===w.length)for(r=H.length-1,h=w.length-1;1<=r&&0<=h&&H[r]!==w[h];)h--;for(;1<=r&&0<=h;r--,h--)if(H[r]!==w[h]){if(r!==1||h!==1)do if(r--,h--,0>h||H[r]!==w[h]){var $=`
`+H[r].replace(" at new "," at ");return t.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",t.displayName)),$}while(1<=r&&0<=h);break}}}finally{Er=!1,Error.prepareStackTrace=i}return(i=t?t.displayName||t.name:"")?K(i):""}function Y(t,a){switch(t.tag){case 26:case 27:case 5:return K(t.type);case 16:return K("Lazy");case 13:return t.child!==a&&a!==null?K("Suspense Fallback"):K("Suspense");case 19:return K("SuspenseList");case 0:case 15:return E(t.type,!1);case 11:return E(t.type.render,!1);case 1:return E(t.type,!0);case 31:return K("Activity");default:return""}}function D(t){try{var a="",i=null;do a+=Y(t,i),i=t,t=t.return;while(t);return a}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function q(t,a){if(typeof t=="object"&&t!==null){var i=rh.get(t);return i!==void 0?i:(a={value:t,source:a,stack:D(a)},rh.set(t,a),a)}return{value:t,source:a,stack:D(a)}}function F(t,a){En[Tn++]=oi,En[Tn++]=_l,_l=t,oi=a}function st(t,a,i){Re[Ne++]=Ve,Re[Ne++]=Ke,Re[Ne++]=_a,_a=t;var r=Ve;t=Ke;var h=32-Se(r)-1;r&=~(1<<h),i+=1;var d=32-Se(a)+h;if(30<d){var v=h-h%5;d=(r&(1<<v)-1).toString(32),r>>=v,h-=v,Ve=1<<32-Se(a)+h|i<<h|r,Ke=d+t}else Ve=1<<d|i<<h|r,Ke=t}function it(t){t.return!==null&&(F(t,1),st(t,1,0))}function Et(t){for(;t===_l;)_l=En[--Tn],En[Tn]=null,oi=En[--Tn],En[Tn]=null;for(;t===_a;)_a=Re[--Ne],Re[Ne]=null,Ke=Re[--Ne],Re[Ne]=null,Ve=Re[--Ne],Re[Ne]=null}function xt(t,a){Re[Ne++]=Ve,Re[Ne++]=Ke,Re[Ne++]=_a,Ve=a.id,Ke=a.overflow,_a=t}function Gt(t,a){_(ba,a),_(ci,t),_(ne,null),t=gf(a),C(ne),_(ne,t)}function ca(){C(ne),C(ci),C(ba)}function ns(t){t.memoizedState!==null&&_(bl,t);var a=ne.current,i=mf(a,t.type);a!==i&&(_(ci,t),_(ne,i))}function Li(t){ci.current===t&&(C(ne),C(ci)),bl.current===t&&(C(bl),$e?Ja._currentValue=Sn:Ja._currentValue2=Sn)}function Ze(t){var a=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kn(q(a,t)),Tr}function yu(t,a){if(!ue)throw Error(s(175));md(t.stateNode,t.type,t.memoizedProps,a,t)||Ze(t,!0)}function vu(t){for(ie=t.return;ie;)switch(ie.tag){case 5:case 31:case 13:ze=!1;return;case 27:case 3:ze=!0;return;default:ie=ie.return}}function cn(t){if(!ue||t!==ie)return!1;if(!vt)return vu(t),vt=!0,!1;var a=t.tag;if(Pt?a!==3&&a!==27&&(a!==5||Jc(t.type)&&!ml(t.type,t.memoizedProps))&&Bt&&Ze(t):a!==3&&(a!==5||Jc(t.type)&&!ml(t.type,t.memoizedProps))&&Bt&&Ze(t),vu(t),a===13){if(!ue)throw Error(s(316));if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));Bt=_d(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));Bt=Sd(t)}else Bt=Pt&&a===27?ld(t.type,Bt):ie?Zc(t.stateNode):null;return!0}function Ya(){ue&&(Bt=ie=null,vt=!1)}function is(){var t=Ca;return t!==null&&(me===null?me=t:me.push.apply(me,t),Ca=null),t}function Kn(t){Ca===null?Ca=[t]:Ca.push(t)}function ha(t,a,i){$e?(_(Cl,a._currentValue),a._currentValue=i):(_(Cl,a._currentValue2),a._currentValue2=i)}function Je(t){var a=Cl.current;$e?t._currentValue=a:t._currentValue2=a,C(Cl)}function ls(t,a,i){for(;t!==null;){var r=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,r!==null&&(r.childLanes|=a)):r!==null&&(r.childLanes&a)!==a&&(r.childLanes|=a),t===i)break;t=t.return}}function ss(t,a,i,r){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var d=h.dependencies;if(d!==null){var v=h.child;d=d.firstContext;t:for(;d!==null;){var T=d;d=h;for(var H=0;H<a.length;H++)if(T.context===a[H]){d.lanes|=i,T=d.alternate,T!==null&&(T.lanes|=i),ls(d.return,i,t),r||(v=null);break t}d=T.next}}else if(h.tag===18){if(v=h.return,v===null)throw Error(s(341));v.lanes|=i,d=v.alternate,d!==null&&(d.lanes|=i),ls(v,i,t),v=null}else v=h.child;if(v!==null)v.return=h;else for(v=h;v!==null;){if(v===t){v=null;break}if(h=v.sibling,h!==null){h.return=v.return,v=h;break}v=v.return}h=v}}function hn(t,a,i,r){t=null;for(var h=a,d=!1;h!==null;){if(!d){if(h.flags&524288)d=!0;else if(h.flags&262144)break}if(h.tag===10){var v=h.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var T=h.type;be(h.pendingProps.value,v.value)||(t!==null?t.push(T):t=[T])}}else if(h===bl.current){if(v=h.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(Ja):t=[Ja])}h=h.return}t!==null&&ss(a,t,i,r),a.flags|=262144}function Yi(t){for(t=t.firstContext;t!==null;){var a=t.context;if(!be($e?a._currentValue:a._currentValue2,t.memoizedValue))return!0;t=t.next}return!1}function Xa(t){Pa=t,ea=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function ee(t){return Su(Pa,t)}function Xi(t,a){return Pa===null&&Xa(t),Su(t,a)}function Su(t,a){var i=$e?a._currentValue:a._currentValue2;if(a={context:a,memoizedValue:i,next:null},ea===null){if(t===null)throw Error(s(308));ea=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else ea=ea.next=a;return i}function rs(){return{controller:new Pd,data:new Map,refCount:0}}function Qn(t){t.refCount--,t.refCount===0&&Fd(kd,function(){t.controller.abort()})}function wi(){}function we(t){t!==xn&&t.next===null&&(xn===null?El=xn=t:xn=xn.next=t),Tl=!0,xr||(xr=!0,B0())}function fn(t,a){if(!Ar&&Tl){Ar=!0;do for(var i=!1,r=El;r!==null;){if(t!==0){var h=r.pendingLanes;if(h===0)var d=0;else{var v=r.suspendedLanes,T=r.pingedLanes;d=(1<<31-Se(42|t)+1)-1,d&=h&~(v&~T),d=d&201326741?d&201326741|1:d?d|2:0}d!==0&&(i=!0,Tu(r,d))}else d=pt,d=A(r,r===Rt?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==Za),!(d&3)||z(r,d)||(i=!0,Tu(r,d));r=r.next}while(i);Ar=!1}}function _u(){bu()}function bu(){Tl=xr=!1;var t=0;Fa!==0&&Tf()&&(t=Fa);for(var a=de(),i=null,r=El;r!==null;){var h=r.next,d=Cu(r,a);d===0?(r.next=null,i===null?El=h:i.next=h,h===null&&(xn=i)):(i=r,(t!==0||d&3)&&(Tl=!0)),r=h}Ft!==0&&Ft!==5||fn(t),Fa!==0&&(Fa=0)}function Cu(t,a){for(var i=t.suspendedLanes,r=t.pingedLanes,h=t.expirationTimes,d=t.pendingLanes&-62914561;0<d;){var v=31-Se(d),T=1<<v,H=h[v];H===-1?(!(T&i)||T&r)&&(h[v]=L(T,a)):H<=a&&(t.expiredLanes|=T),d&=~T}if(a=Rt,i=pt,i=A(t,t===a?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==Za),r=t.callbackNode,i===0||t===a&&(At===2||At===9)||t.cancelPendingCommit!==null)return r!==null&&r!==null&&_r(r),t.callbackNode=null,t.callbackPriority=0;if(!(i&3)||z(t,i)){if(a=i&-i,a===t.callbackPriority)return a;switch(r!==null&&_r(r),B(i)){case 2:case 8:i=Vd;break;case 32:i=br;break;case 268435456:i=Kd;break;default:i=br}return r=Eu.bind(null,t),i=Sl(i,r),t.callbackPriority=a,t.callbackNode=i,a}return r!==null&&r!==null&&_r(r),t.callbackPriority=2,t.callbackNode=null,2}function Eu(t,a){if(Ft!==0&&Ft!==5)return t.callbackNode=null,t.callbackPriority=0,null;var i=t.callbackNode;if(ii()&&t.callbackNode!==i)return null;var r=pt;return r=A(t,t===Rt?r:0,t.cancelPendingCommit!==null||t.timeoutHandle!==Za),r===0?null:(rc(t,r,a),Cu(t,de()),t.callbackNode!=null&&t.callbackNode===i?Eu.bind(null,t):null)}function Tu(t,a){if(ii())return null;rc(t,a,!0)}function B0(){Of?Df(function(){gt&6?Sl(ih,_u):bu()}):Sl(ih,_u)}function us(){if(Fa===0){var t=An;t===0&&(t=pl,pl<<=1,!(pl&261888)&&(pl=256)),Fa=t}return Fa}function U0(t,a){if(hi===null){var i=hi=[];Mr=0,An=us(),Mn={status:"pending",value:void 0,then:function(r){i.push(r)}}}return Mr++,a.then(xu,xu),a}function xu(){if(--Mr===0&&hi!==null){Mn!==null&&(Mn.status="fulfilled");var t=hi;hi=null,An=0,Mn=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function L0(t,a){var i=[],r={status:"pending",value:null,reason:null,then:function(h){i.push(h)}};return t.then(function(){r.status="fulfilled",r.value=a;for(var h=0;h<i.length;h++)(0,i[h])(a)},function(h){for(r.status="rejected",r.reason=h,h=0;h<i.length;h++)(0,i[h])(void 0)}),r}function os(){var t=ka.current;return t!==null?t:Rt.pooledCache}function qi(t,a){a===null?_(ka,ka.current):_(ka,a.pool)}function Au(){var t=os();return t===null?null:{parent:$e?Ut._currentValue:Ut._currentValue2,pool:t}}function ji(t,a){if(be(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var i=Object.keys(t),r=Object.keys(a);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++){var h=i[r];if(!Jd.call(a,h)||!be(t[h],a[h]))return!1}return!0}function Mu(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Ru(t,a,i){switch(i=t[i],i===void 0?t.push(a):i!==a&&(a.then(wi,wi),a=i),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,zu(t),t;default:if(typeof a.status=="string")a.then(wi,wi);else{if(t=Rt,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=a,t.status="pending",t.then(function(r){if(a.status==="pending"){var h=a;h.status="fulfilled",h.value=r}},function(r){if(a.status==="pending"){var h=a;h.status="rejected",h.reason=r}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,zu(t),t}throw Wa=a,Rn}}function wa(t){try{var a=t._init;return a(t._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Wa=i,Rn):i}}function Nu(){if(Wa===null)throw Error(s(459));var t=Wa;return Wa=null,t}function zu(t){if(t===Rn||t===xl)throw Error(s(483))}function Vi(t){var a=fi;return fi+=1,Nn===null&&(Nn=[]),Ru(Nn,t,a)}function Zn(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function Ki(t,a){throw a.$$typeof===of?Error(s(525)):(t=Object.prototype.toString.call(a),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function Ou(t){function a(O,M){if(t){var G=O.deletions;G===null?(O.deletions=[M],O.flags|=16):G.push(M)}}function i(O,M){if(!t)return null;for(;M!==null;)a(O,M),M=M.sibling;return null}function r(O){for(var M=new Map;O!==null;)O.key!==null?M.set(O.key,O):M.set(O.index,O),O=O.sibling;return M}function h(O,M){return O=Ie(O,M),O.index=0,O.sibling=null,O}function d(O,M,G){return O.index=G,t?(G=O.alternate,G!==null?(G=G.index,G<M?(O.flags|=67108866,M):G):(O.flags|=67108866,M)):(O.flags|=1048576,M)}function v(O){return t&&O.alternate===null&&(O.flags|=67108866),O}function T(O,M,G,J){return M===null||M.tag!==6?(M=ir(G,O.mode,J),M.return=O,M):(M=h(M,G),M.return=O,M)}function H(O,M,G,J){var ut=G.type;return ut===vn?$(O,M,G.props.children,J,G.key):M!==null&&(M.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===Sa&&wa(ut)===M.type)?(M=h(M,G.props),Zn(M,G),M.return=O,M):(M=fl(G.type,G.key,G.props,null,O.mode,J),Zn(M,G),M.return=O,M)}function w(O,M,G,J){return M===null||M.tag!==4||M.stateNode.containerInfo!==G.containerInfo||M.stateNode.implementation!==G.implementation?(M=lr(G,O.mode,J),M.return=O,M):(M=h(M,G.children||[]),M.return=O,M)}function $(O,M,G,J,ut){return M===null||M.tag!==7?(M=Qa(G,O.mode,J,ut),M.return=O,M):(M=h(M,G),M.return=O,M)}function Z(O,M,G){if(typeof M=="string"&&M!==""||typeof M=="number"||typeof M=="bigint")return M=ir(""+M,O.mode,G),M.return=O,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case dl:return G=fl(M.type,M.key,M.props,null,O.mode,G),Zn(G,M),G.return=O,G;case yn:return M=lr(M,O.mode,G),M.return=O,M;case Sa:return M=wa(M),Z(O,M,G)}if(gl(M)||y(M))return M=Qa(M,O.mode,G,null),M.return=O,M;if(typeof M.then=="function")return Z(O,Vi(M),G);if(M.$$typeof===va)return Z(O,Xi(O,M),G);Ki(O,M)}return null}function et(O,M,G,J){var ut=M!==null?M.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return ut!==null?null:T(O,M,""+G,J);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case dl:return G.key===ut?H(O,M,G,J):null;case yn:return G.key===ut?w(O,M,G,J):null;case Sa:return G=wa(G),et(O,M,G,J)}if(gl(G)||y(G))return ut!==null?null:$(O,M,G,J,null);if(typeof G.then=="function")return et(O,M,Vi(G),J);if(G.$$typeof===va)return et(O,M,Xi(O,G),J);Ki(O,G)}return null}function ht(O,M,G,J,ut){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return O=O.get(G)||null,T(M,O,""+J,ut);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case dl:return O=O.get(J.key===null?G:J.key)||null,H(M,O,J,ut);case yn:return O=O.get(J.key===null?G:J.key)||null,w(M,O,J,ut);case Sa:return J=wa(J),ht(O,M,G,J,ut)}if(gl(J)||y(J))return O=O.get(G)||null,$(M,O,J,ut,null);if(typeof J.then=="function")return ht(O,M,G,Vi(J),ut);if(J.$$typeof===va)return ht(O,M,G,Xi(M,J),ut);Ki(M,J)}return null}function le(O,M,G,J){for(var ut=null,Lt=null,ot=M,bt=M=0,te=null;ot!==null&&bt<G.length;bt++){ot.index>bt?(te=ot,ot=null):te=ot.sibling;var Ct=et(O,ot,G[bt],J);if(Ct===null){ot===null&&(ot=te);break}t&&ot&&Ct.alternate===null&&a(O,ot),M=d(Ct,M,bt),Lt===null?ut=Ct:Lt.sibling=Ct,Lt=Ct,ot=te}if(bt===G.length)return i(O,ot),vt&&F(O,bt),ut;if(ot===null){for(;bt<G.length;bt++)ot=Z(O,G[bt],J),ot!==null&&(M=d(ot,M,bt),Lt===null?ut=ot:Lt.sibling=ot,Lt=ot);return vt&&F(O,bt),ut}for(ot=r(ot);bt<G.length;bt++)te=ht(ot,O,bt,G[bt],J),te!==null&&(t&&te.alternate!==null&&ot.delete(te.key===null?bt:te.key),M=d(te,M,bt),Lt===null?ut=te:Lt.sibling=te,Lt=te);return t&&ot.forEach(function(Ra){return a(O,Ra)}),vt&&F(O,bt),ut}function Si(O,M,G,J){if(G==null)throw Error(s(151));for(var ut=null,Lt=null,ot=M,bt=M=0,te=null,Ct=G.next();ot!==null&&!Ct.done;bt++,Ct=G.next()){ot.index>bt?(te=ot,ot=null):te=ot.sibling;var Ra=et(O,ot,Ct.value,J);if(Ra===null){ot===null&&(ot=te);break}t&&ot&&Ra.alternate===null&&a(O,ot),M=d(Ra,M,bt),Lt===null?ut=Ra:Lt.sibling=Ra,Lt=Ra,ot=te}if(Ct.done)return i(O,ot),vt&&F(O,bt),ut;if(ot===null){for(;!Ct.done;bt++,Ct=G.next())Ct=Z(O,Ct.value,J),Ct!==null&&(M=d(Ct,M,bt),Lt===null?ut=Ct:Lt.sibling=Ct,Lt=Ct);return vt&&F(O,bt),ut}for(ot=r(ot);!Ct.done;bt++,Ct=G.next())Ct=ht(ot,O,bt,Ct.value,J),Ct!==null&&(t&&Ct.alternate!==null&&ot.delete(Ct.key===null?bt:Ct.key),M=d(Ct,M,bt),Lt===null?ut=Ct:Lt.sibling=Ct,Lt=Ct);return t&&ot.forEach(function(t1){return a(O,t1)}),vt&&F(O,bt),ut}function en(O,M,G,J){if(typeof G=="object"&&G!==null&&G.type===vn&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case dl:t:{for(var ut=G.key;M!==null;){if(M.key===ut){if(ut=G.type,ut===vn){if(M.tag===7){i(O,M.sibling),J=h(M,G.props.children),J.return=O,O=J;break t}}else if(M.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===Sa&&wa(ut)===M.type){i(O,M.sibling),J=h(M,G.props),Zn(J,G),J.return=O,O=J;break t}i(O,M);break}else a(O,M);M=M.sibling}G.type===vn?(J=Qa(G.props.children,O.mode,J,G.key),J.return=O,O=J):(J=fl(G.type,G.key,G.props,null,O.mode,J),Zn(J,G),J.return=O,O=J)}return v(O);case yn:t:{for(ut=G.key;M!==null;){if(M.key===ut)if(M.tag===4&&M.stateNode.containerInfo===G.containerInfo&&M.stateNode.implementation===G.implementation){i(O,M.sibling),J=h(M,G.children||[]),J.return=O,O=J;break t}else{i(O,M);break}else a(O,M);M=M.sibling}J=lr(G,O.mode,J),J.return=O,O=J}return v(O);case Sa:return G=wa(G),en(O,M,G,J)}if(gl(G))return le(O,M,G,J);if(y(G)){if(ut=y(G),typeof ut!="function")throw Error(s(150));return G=ut.call(G),Si(O,M,G,J)}if(typeof G.then=="function")return en(O,M,Vi(G),J);if(G.$$typeof===va)return en(O,M,Xi(O,G),J);Ki(O,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,M!==null&&M.tag===6?(i(O,M.sibling),J=h(M,G),J.return=O,O=J):(i(O,M),J=ir(G,O.mode,J),J.return=O,O=J),v(O)):i(O,M)}return function(O,M,G,J){try{fi=0;var ut=en(O,M,G,J);return Nn=null,ut}catch(ot){if(ot===Rn||ot===xl)throw ot;var Lt=n(29,ot,null,O.mode);return Lt.lanes=J,Lt.return=O,Lt}finally{}}}function Qi(){for(var t=zn,a=Nr=zn=0;a<t;){var i=Oe[a];Oe[a++]=null;var r=Oe[a];Oe[a++]=null;var h=Oe[a];Oe[a++]=null;var d=Oe[a];if(Oe[a++]=null,r!==null&&h!==null){var v=r.pending;v===null?h.next=h:(h.next=v.next,v.next=h),r.pending=h}d!==0&&Du(i,h,d)}}function Zi(t,a,i,r){Oe[zn++]=t,Oe[zn++]=a,Oe[zn++]=i,Oe[zn++]=r,Nr|=r,t.lanes|=r,t=t.alternate,t!==null&&(t.lanes|=r)}function cs(t,a,i,r){return Zi(t,a,i,r),Ji(t)}function qa(t,a){return Zi(t,null,null,a),Ji(t)}function Du(t,a,i){t.lanes|=i;var r=t.alternate;r!==null&&(r.lanes|=i);for(var h=!1,d=t.return;d!==null;)d.childLanes|=i,r=d.alternate,r!==null&&(r.childLanes|=i),d.tag===22&&(t=d.stateNode,t===null||t._visibility&1||(h=!0)),t=d,d=d.return;return t.tag===3?(d=t.stateNode,h&&a!==null&&(h=31-Se(i),t=d.hiddenUpdates,r=t[h],r===null?t[h]=[a]:r.push(a),a.lane=i|536870912),d):null}function Ji(t){if(50<vi)throw vi=0,qr=null,Error(s(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}function hs(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fs(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function fa(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function da(t,a,i){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,gt&2){var h=r.pending;return h===null?a.next=a:(a.next=h.next,h.next=a),r.pending=a,a=Ji(t),Du(t,null,i),a}return Zi(t,r,a,i),Ji(t)}function Jn(t,a,i){if(a=a.updateQueue,a!==null&&(a=a.shared,(i&4194048)!==0)){var r=a.lanes;r&=t.pendingLanes,i|=r,a.lanes=i,nt(t,i)}}function ds(t,a){var i=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,i===r)){var h=null,d=null;if(i=i.firstBaseUpdate,i!==null){do{var v={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};d===null?h=d=v:d=d.next=v,i=i.next}while(i!==null);d===null?h=d=a:d=d.next=a}else h=d=a;i={baseState:r.baseState,firstBaseUpdate:h,lastBaseUpdate:d,shared:r.shared,callbacks:r.callbacks},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=a:t.next=a,i.lastBaseUpdate=a}function Pn(){if(zr){var t=Mn;if(t!==null)throw t}}function Fn(t,a,i,r){zr=!1;var h=t.updateQueue;Ea=!1;var d=h.firstBaseUpdate,v=h.lastBaseUpdate,T=h.shared.pending;if(T!==null){h.shared.pending=null;var H=T,w=H.next;H.next=null,v===null?d=w:v.next=w,v=H;var $=t.alternate;$!==null&&($=$.updateQueue,T=$.lastBaseUpdate,T!==v&&(T===null?$.firstBaseUpdate=w:T.next=w,$.lastBaseUpdate=H))}if(d!==null){var Z=h.baseState;v=0,$=w=H=null,T=d;do{var et=T.lane&-536870913,ht=et!==T.lane;if(ht?(pt&et)===et:(r&et)===et){et!==0&&et===An&&(zr=!0),$!==null&&($=$.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});t:{var le=t,Si=T;et=a;var en=i;switch(Si.tag){case 1:if(le=Si.payload,typeof le=="function"){Z=le.call(en,Z,et);break t}Z=le;break t;case 3:le.flags=le.flags&-65537|128;case 0:if(le=Si.payload,et=typeof le=="function"?le.call(en,Z,et):le,et==null)break t;Z=rr({},Z,et);break t;case 2:Ea=!0}}et=T.callback,et!==null&&(t.flags|=64,ht&&(t.flags|=8192),ht=h.callbacks,ht===null?h.callbacks=[et]:ht.push(et))}else ht={lane:et,tag:T.tag,payload:T.payload,callback:T.callback,next:null},$===null?(w=$=ht,H=Z):$=$.next=ht,v|=et;if(T=T.next,T===null){if(T=h.shared.pending,T===null)break;ht=T,T=ht.next,ht.next=null,h.lastBaseUpdate=ht,h.shared.pending=null}}while(!0);$===null&&(H=Z),h.baseState=H,h.firstBaseUpdate=w,h.lastBaseUpdate=$,d===null&&(h.shared.lanes=0),xa|=v,t.lanes=v,t.memoizedState=Z}}function Gu(t,a){if(typeof t!="function")throw Error(s(191,t));t.call(a)}function Hu(t,a){var i=t.callbacks;if(i!==null)for(t.callbacks=null,t=0;t<i.length;t++)Gu(i[t],a)}function Bu(t,a){t=ia,_(Ml,t),_(On,a),ia=t|a.baseLanes}function gs(){_(Ml,ia),_(On,On.current)}function ms(){ia=Ml.current,C(On),C(Ml)}function ga(t){var a=t.alternate;_(jt,jt.current&1),_(Ce,t),De===null&&(a===null||On.current!==null||a.memoizedState!==null)&&(De=t)}function ps(t){_(jt,jt.current),_(Ce,t),De===null&&(De=t)}function Uu(t){t.tag===22?(_(jt,jt.current),_(Ce,t),De===null&&(De=t)):ma()}function ma(){_(jt,jt.current),_(Ce,Ce.current)}function pe(t){C(Ce),De===t&&(De=null),C(jt)}function Pi(t){for(var a=t;a!==null;){if(a.tag===13){var i=a.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||pr(i)||yr(i)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function Xt(){throw Error(s(321))}function ys(t,a){if(a===null)return!1;for(var i=0;i<a.length&&i<t.length;i++)if(!be(t[i],a[i]))return!1;return!0}function vs(t,a,i,r,h,d){return aa=d,ft=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,rt.H=t===null||t.memoizedState===null?ch:Or,$a=!1,d=i(r,h),$a=!1,Dn&&(d=Yu(a,i,r,h)),Lu(t),d}function Lu(t){rt.H=gi;var a=Mt!==null&&Mt.next!==null;if(aa=0,Vt=Mt=ft=null,Rl=!1,di=0,Gn=null,a)throw Error(s(300));t===null||Kt||(t=t.dependencies,t!==null&&Yi(t)&&(Kt=!0))}function Yu(t,a,i,r){ft=t;var h=0;do{if(Dn&&(Gn=null),di=0,Dn=!1,25<=h)throw Error(s(301));if(h+=1,Vt=Mt=null,t.updateQueue!=null){var d=t.updateQueue;d.lastEffect=null,d.events=null,d.stores=null,d.memoCache!=null&&(d.memoCache.index=0)}rt.H=hh,d=a(i,r)}while(Dn);return d}function Y0(){var t=rt.H,a=t.useState()[0];return a=typeof a.then=="function"?kn(a):a,t=t.useState()[0],(Mt!==null?Mt.memoizedState:null)!==t&&(ft.flags|=1024),a}function Ss(){var t=Nl!==0;return Nl=0,t}function _s(t,a,i){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~i}function bs(t){if(Rl){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}Rl=!1}aa=0,Vt=Mt=ft=null,Dn=!1,di=Nl=0,Gn=null}function oe(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?ft.memoizedState=Vt=t:Vt=Vt.next=t,Vt}function qt(){if(Mt===null){var t=ft.alternate;t=t!==null?t.memoizedState:null}else t=Mt.next;var a=Vt===null?ft.memoizedState:Vt.next;if(a!==null)Vt=a,Mt=t;else{if(t===null)throw ft.alternate===null?Error(s(467)):Error(s(310));Mt=t,t={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},Vt===null?ft.memoizedState=Vt=t:Vt=Vt.next=t}return Vt}function Fi(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kn(t){var a=di;return di+=1,Gn===null&&(Gn=[]),t=Ru(Gn,t,a),a=ft,(Vt===null?a.memoizedState:Vt.next)===null&&(a=a.alternate,rt.H=a===null||a.memoizedState===null?ch:Or),t}function ki(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return kn(t);if(t.$$typeof===va)return ee(t)}throw Error(s(438,String(t)))}function Cs(t){var a=null,i=ft.updateQueue;if(i!==null&&(a=i.memoCache),a==null){var r=ft.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(a={data:r.data.map(function(h){return h.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),i===null&&(i=Fi(),ft.updateQueue=i),i.memoCache=a,i=a.data[a.index],i===void 0)for(i=a.data[a.index]=Array(t),r=0;r<t;r++)i[r]=cf;return a.index++,i}function Pe(t,a){return typeof a=="function"?a(t):a}function Wi(t){var a=qt();return Es(a,Mt,t)}function Es(t,a,i){var r=t.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=i;var h=t.baseQueue,d=r.pending;if(d!==null){if(h!==null){var v=h.next;h.next=d.next,d.next=v}a.baseQueue=h=d,r.pending=null}if(d=t.baseState,h===null)t.memoizedState=d;else{a=h.next;var T=v=null,H=null,w=a,$=!1;do{var Z=w.lane&-536870913;if(Z!==w.lane?(pt&Z)===Z:(aa&Z)===Z){var et=w.revertLane;if(et===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),Z===An&&($=!0);else if((aa&et)===et){w=w.next,et===An&&($=!0);continue}else Z={lane:0,revertLane:w.revertLane,gesture:null,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null},H===null?(T=H=Z,v=d):H=H.next=Z,ft.lanes|=et,xa|=et;Z=w.action,$a&&i(d,Z),d=w.hasEagerState?w.eagerState:i(d,Z)}else et={lane:Z,revertLane:w.revertLane,gesture:w.gesture,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null},H===null?(T=H=et,v=d):H=H.next=et,ft.lanes|=Z,xa|=Z;w=w.next}while(w!==null&&w!==a);if(H===null?v=d:H.next=T,!be(d,t.memoizedState)&&(Kt=!0,$&&(i=Mn,i!==null)))throw i;t.memoizedState=d,t.baseState=v,t.baseQueue=H,r.lastRenderedState=d}return h===null&&(r.lanes=0),[t.memoizedState,r.dispatch]}function Ts(t){var a=qt(),i=a.queue;if(i===null)throw Error(s(311));i.lastRenderedReducer=t;var r=i.dispatch,h=i.pending,d=a.memoizedState;if(h!==null){i.pending=null;var v=h=h.next;do d=t(d,v.action),v=v.next;while(v!==h);be(d,a.memoizedState)||(Kt=!0),a.memoizedState=d,a.baseQueue===null&&(a.baseState=d),i.lastRenderedState=d}return[d,r]}function Xu(t,a,i){var r=ft,h=qt(),d=vt;if(d){if(i===void 0)throw Error(s(407));i=i()}else i=a();var v=!be((Mt||h).memoizedState,i);if(v&&(h.memoizedState=i,Kt=!0),h=h.queue,Ms(ju.bind(null,r,h,t),[t]),h.getSnapshot!==a||v||Vt!==null&&Vt.memoizedState.tag&1){if(r.flags|=2048,dn(9,{destroy:void 0},qu.bind(null,r,h,i,a),null),Rt===null)throw Error(s(349));d||aa&127||wu(r,a,i)}return i}function wu(t,a,i){t.flags|=16384,t={getSnapshot:a,value:i},a=ft.updateQueue,a===null?(a=Fi(),ft.updateQueue=a,a.stores=[t]):(i=a.stores,i===null?a.stores=[t]:i.push(t))}function qu(t,a,i,r){a.value=i,a.getSnapshot=r,Vu(a)&&Ku(t)}function ju(t,a,i){return i(function(){Vu(a)&&Ku(t)})}function Vu(t){var a=t.getSnapshot;t=t.value;try{var i=a();return!be(t,i)}catch{return!0}}function Ku(t){var a=qa(t,2);a!==null&&fe(a,t,2)}function xs(t){var a=oe();if(typeof t=="function"){var i=t;if(t=i(),$a){V(!0);try{i()}finally{V(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:t},a}function Qu(t,a,i,r){return t.baseState=i,Es(t,Mt,typeof r=="function"?r:Pe)}function X0(t,a,i,r,h){if(tl(t))throw Error(s(485));if(t=a.action,t!==null){var d={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){d.listeners.push(v)}};rt.T!==null?i(!0):d.isTransition=!1,r(d),i=a.pending,i===null?(d.next=a.pending=d,Zu(a,d)):(d.next=i.next,a.pending=i.next=d)}}function Zu(t,a){var i=a.action,r=a.payload,h=t.state;if(a.isTransition){var d=rt.T,v={};rt.T=v;try{var T=i(h,r),H=rt.S;H!==null&&H(v,T),Ju(t,a,T)}catch(w){As(t,a,w)}finally{d!==null&&v.types!==null&&(d.types=v.types),rt.T=d}}else try{d=i(h,r),Ju(t,a,d)}catch(w){As(t,a,w)}}function Ju(t,a,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(r){Pu(t,a,r)},function(r){return As(t,a,r)}):Pu(t,a,i)}function Pu(t,a,i){a.status="fulfilled",a.value=i,Fu(a),t.state=i,a=t.pending,a!==null&&(i=a.next,i===a?t.pending=null:(i=i.next,a.next=i,Zu(t,i)))}function As(t,a,i){var r=t.pending;if(t.pending=null,r!==null){r=r.next;do a.status="rejected",a.reason=i,Fu(a),a=a.next;while(a!==r)}t.action=null}function Fu(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function ku(t,a){return a}function Wu(t,a){if(vt){var i=Rt.formState;if(i!==null){t:{var r=ft;if(vt){if(Bt){var h=nd(Bt,ze);if(h){Bt=Zc(h),r=id(h);break t}}Ze(r)}r=!1}r&&(a=i[0])}}i=oe(),i.memoizedState=i.baseState=a,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ku,lastRenderedState:a},i.queue=r,i=po.bind(null,ft,r),r.dispatch=i,r=xs(!1);var d=Os.bind(null,ft,!1,r.queue);return r=oe(),h={state:a,dispatch:null,action:t,pending:null},r.queue=h,i=X0.bind(null,ft,h,d,i),h.dispatch=i,r.memoizedState=t,[a,i,!1]}function Iu(t){var a=qt();return $u(a,Mt,t)}function $u(t,a,i){if(a=Es(t,a,ku)[0],t=Wi(Pe)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var r=kn(a)}catch(v){throw v===Rn?xl:v}else r=a;a=qt();var h=a.queue,d=h.dispatch;return i!==a.memoizedState&&(ft.flags|=2048,dn(9,{destroy:void 0},w0.bind(null,h,i),null)),[r,d,t]}function w0(t,a){t.action=a}function to(t){var a=qt(),i=Mt;if(i!==null)return $u(a,i,t);qt(),a=a.memoizedState,i=qt();var r=i.queue.dispatch;return i.memoizedState=t,[a,r,!1]}function dn(t,a,i,r){return t={tag:t,create:i,deps:r,inst:a,next:null},a=ft.updateQueue,a===null&&(a=Fi(),ft.updateQueue=a),i=a.lastEffect,i===null?a.lastEffect=t.next=t:(r=i.next,i.next=t,t.next=r,a.lastEffect=t),t}function eo(){return qt().memoizedState}function Ii(t,a,i,r){var h=oe();ft.flags|=t,h.memoizedState=dn(1|a,{destroy:void 0},i,r===void 0?null:r)}function $i(t,a,i,r){var h=qt();r=r===void 0?null:r;var d=h.memoizedState.inst;Mt!==null&&r!==null&&ys(r,Mt.memoizedState.deps)?h.memoizedState=dn(a,d,i,r):(ft.flags|=t,h.memoizedState=dn(1|a,d,i,r))}function ao(t,a){Ii(8390656,8,t,a)}function Ms(t,a){$i(2048,8,t,a)}function q0(t){ft.flags|=4;var a=ft.updateQueue;if(a===null)a=Fi(),ft.updateQueue=a,a.events=[t];else{var i=a.events;i===null?a.events=[t]:i.push(t)}}function no(t){var a=qt().memoizedState;return q0({ref:a,nextImpl:t}),function(){if(gt&2)throw Error(s(440));return a.impl.apply(void 0,arguments)}}function io(t,a){return $i(4,2,t,a)}function lo(t,a){return $i(4,4,t,a)}function so(t,a){if(typeof a=="function"){t=t();var i=a(t);return function(){typeof i=="function"?i():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function ro(t,a,i){i=i!=null?i.concat([t]):null,$i(4,4,so.bind(null,a,t),i)}function Rs(){}function uo(t,a){var i=qt();a=a===void 0?null:a;var r=i.memoizedState;return a!==null&&ys(a,r[1])?r[0]:(i.memoizedState=[t,a],t)}function oo(t,a){var i=qt();a=a===void 0?null:a;var r=i.memoizedState;if(a!==null&&ys(a,r[1]))return r[0];if(r=t(),$a){V(!0);try{t()}finally{V(!1)}}return i.memoizedState=[r,a],r}function Ns(t,a,i){return i===void 0||aa&1073741824&&!(pt&261930)?t.memoizedState=a:(t.memoizedState=i,t=sc(),ft.lanes|=t,xa|=t,i)}function co(t,a,i,r){return be(i,a)?i:On.current!==null?(t=Ns(t,i,r),be(t,a)||(Kt=!0),t):!(aa&42)||aa&1073741824&&!(pt&261930)?(Kt=!0,t.memoizedState=i):(t=sc(),ft.lanes|=t,xa|=t,a)}function ho(t,a,i,r,h){var d=ta();It(d!==0&&8>d?d:8);var v=rt.T,T={};rt.T=T,Os(t,!1,a,i);try{var H=h(),w=rt.S;if(w!==null&&w(T,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var $=L0(H,r);Wn(t,a,$,ye(t))}else Wn(t,a,r,ye(t))}catch(Z){Wn(t,a,{then:function(){},status:"rejected",reason:Z},ye())}finally{It(d),v!==null&&T.types!==null&&(v.types=T.types),rt.T=v}}function fo(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:Sn,baseState:Sn,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:Sn},next:null};var i={};return a.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:i},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function zs(){return ee(Ja)}function go(){return qt().memoizedState}function mo(){return qt().memoizedState}function j0(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var i=ye();t=fa(i);var r=da(a,t,i);r!==null&&(fe(r,a,i),Jn(r,a,i)),a={cache:rs()},t.payload=a;return}a=a.return}}function V0(t,a,i){var r=ye();i={lane:r,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},tl(t)?yo(a,i):(i=cs(t,a,i,r),i!==null&&(fe(i,t,r),vo(i,a,r)))}function po(t,a,i){var r=ye();Wn(t,a,i,r)}function Wn(t,a,i,r){var h={lane:r,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(tl(t))yo(a,h);else{var d=t.alternate;if(t.lanes===0&&(d===null||d.lanes===0)&&(d=a.lastRenderedReducer,d!==null))try{var v=a.lastRenderedState,T=d(v,i);if(h.hasEagerState=!0,h.eagerState=T,be(T,v))return Zi(t,a,h,0),Rt===null&&Qi(),!1}catch{}finally{}if(i=cs(t,a,h,r),i!==null)return fe(i,t,r),vo(i,a,r),!0}return!1}function Os(t,a,i,r){if(r={lane:2,revertLane:us(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},tl(t)){if(a)throw Error(s(479))}else a=cs(t,i,r,2),a!==null&&fe(a,t,2)}function tl(t){var a=t.alternate;return t===ft||a!==null&&a===ft}function yo(t,a){Dn=Rl=!0;var i=t.pending;i===null?a.next=a:(a.next=i.next,i.next=a),t.pending=a}function vo(t,a,i){if(i&4194048){var r=a.lanes;r&=t.pendingLanes,i|=r,a.lanes=i,nt(t,i)}}function Ds(t,a,i,r){a=t.memoizedState,i=i(r,a),i=i==null?a:rr({},a,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}function So(t,a,i,r,h,d,v){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,d,v):a.prototype&&a.prototype.isPureReactComponent?!ji(i,r)||!ji(h,d):!0}function _o(t,a,i,r){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(i,r),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(i,r),a.state!==t&&Dr.enqueueReplaceState(a,a.state,null)}function ja(t,a){var i=a;if("ref"in a){i={};for(var r in a)r!=="ref"&&(i[r]=a[r])}if(t=t.defaultProps){i===a&&(i=rr({},i));for(var h in t)i[h]===void 0&&(i[h]=t[h])}return i}function el(t,a){try{var i=t.onUncaughtError;i(a.value,{componentStack:a.stack})}catch(r){setTimeout(function(){throw r})}}function bo(t,a,i){try{var r=t.onCaughtError;r(i.value,{componentStack:i.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Gs(t,a,i){return i=fa(i),i.tag=3,i.payload={element:null},i.callback=function(){el(t,a)},i}function Co(t){return t=fa(t),t.tag=3,t}function Eo(t,a,i,r){var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var d=r.value;t.payload=function(){return h(d)},t.callback=function(){bo(a,i,r)}}var v=i.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(t.callback=function(){bo(a,i,r),typeof h!="function"&&(Aa===null?Aa=new Set([this]):Aa.add(this));var T=r.stack;this.componentDidCatch(r.value,{componentStack:T!==null?T:""})})}function K0(t,a,i,r,h){if(i.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(a=i.alternate,a!==null&&hn(a,i,h,!0),i=Ce.current,i!==null){switch(i.tag){case 31:case 13:return De===null?cl():i.alternate===null&&wt===0&&(wt=3),i.flags&=-257,i.flags|=65536,i.lanes=h,r===Al?i.flags|=16384:(a=i.updateQueue,a===null?i.updateQueue=new Set([r]):a.add(r),ar(t,r,h)),!1;case 22:return i.flags|=65536,r===Al?i.flags|=16384:(a=i.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([r])},i.updateQueue=a):(i=a.retryQueue,i===null?a.retryQueue=new Set([r]):i.add(r)),ar(t,r,h)),!1}throw Error(s(435,i.tag))}return ar(t,r,h),cl(),!1}if(vt)return a=Ce.current,a!==null?(!(a.flags&65536)&&(a.flags|=256),a.flags|=65536,a.lanes=h,r!==Tr&&(t=Error(s(422),{cause:r}),Kn(q(t,i)))):(r!==Tr&&(a=Error(s(423),{cause:r}),Kn(q(a,i))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,r=q(r,i),h=Gs(t.stateNode,r,h),ds(t,h),wt!==4&&(wt=2)),!1;var d=Error(s(520),{cause:r});if(d=q(d,i),pi===null?pi=[d]:pi.push(d),wt!==4&&(wt=2),a===null)return!0;r=q(r,i),i=a;do{switch(i.tag){case 3:return i.flags|=65536,t=h&-h,i.lanes|=t,t=Gs(i.stateNode,r,t),ds(i,t),!1;case 1:if(a=i.type,d=i.stateNode,(i.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(Aa===null||!Aa.has(d))))return i.flags|=65536,h&=-h,i.lanes|=h,h=Co(h),Eo(h,t,i,r),ds(i,h),!1}i=i.return}while(i!==null);return!1}function ae(t,a,i,r){a.child=t===null?oh(a,null,i,r):Ia(a,t.child,i,r)}function To(t,a,i,r,h){i=i.render;var d=a.ref;if("ref"in r){var v={};for(var T in r)T!=="ref"&&(v[T]=r[T])}else v=r;return Xa(a),r=vs(t,a,i,v,d,h),T=Ss(),t!==null&&!Kt?(_s(t,a,h),Fe(t,a,h)):(vt&&T&&it(a),a.flags|=1,ae(t,a,r,h),a.child)}function xo(t,a,i,r,h){if(t===null){var d=i.type;return typeof d=="function"&&!nr(d)&&d.defaultProps===void 0&&i.compare===null?(a.tag=15,a.type=d,Ao(t,a,d,r,h)):(t=fl(i.type,null,r,a,a.mode,h),t.ref=a.ref,t.return=a,a.child=t)}if(d=t.child,!ws(t,h)){var v=d.memoizedProps;if(i=i.compare,i=i!==null?i:ji,i(v,r)&&t.ref===a.ref)return Fe(t,a,h)}return a.flags|=1,t=Ie(d,r),t.ref=a.ref,t.return=a,a.child=t}function Ao(t,a,i,r,h){if(t!==null){var d=t.memoizedProps;if(ji(d,r)&&t.ref===a.ref)if(Kt=!1,a.pendingProps=r=d,ws(t,h))t.flags&131072&&(Kt=!0);else return a.lanes=t.lanes,Fe(t,a,h)}return Hs(t,a,i,r,h)}function Mo(t,a,i,r){var h=r.children,d=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if(a.flags&128){if(d=d!==null?d.baseLanes|i:i,t!==null){for(r=a.child=t.child,h=0;r!==null;)h=h|r.lanes|r.childLanes,r=r.sibling;r=h&~d}else r=0,a.child=null;return Ro(t,a,d,i,r)}if(i&536870912)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&qi(a,d!==null?d.cachePool:null),d!==null?Bu(a,d):gs(),Uu(a);else return r=a.lanes=536870912,Ro(t,a,d!==null?d.baseLanes|i:i,i,r)}else d!==null?(qi(a,d.cachePool),Bu(a,d),ma(),a.memoizedState=null):(t!==null&&qi(a,null),gs(),ma());return ae(t,a,h,i),a.child}function In(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Ro(t,a,i,r,h){var d=os();return d=d===null?null:{parent:$e?Ut._currentValue:Ut._currentValue2,pool:d},a.memoizedState={baseLanes:i,cachePool:d},t!==null&&qi(a,null),gs(),Uu(a),t!==null&&hn(t,a,r,!0),a.childLanes=h,null}function al(t,a){return a=il({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function No(t,a,i){return Ia(a,t.child,null,i),t=al(a,a.pendingProps),t.flags|=2,pe(a),a.memoizedState=null,t}function Q0(t,a,i){var r=a.pendingProps,h=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(vt){if(r.mode==="hidden")return t=al(a,r),a.lanes=536870912,In(null,t);if(ps(a),(t=Bt)?(t=dd(t,ze),t!==null&&(a.memoizedState={dehydrated:t,treeContext:_a!==null?{id:Ve,overflow:Ke}:null,retryLane:536870912,hydrationErrors:null},i=Ac(t),i.return=a,a.child=i,ie=a,Bt=null)):t=null,t===null)throw Ze(a);return a.lanes=536870912,null}return al(a,r)}var d=t.memoizedState;if(d!==null){var v=d.dehydrated;if(ps(a),h)if(a.flags&256)a.flags&=-257,a=No(t,a,i);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(s(558));else if(Kt||hn(t,a,i,!1),h=(i&t.childLanes)!==0,Kt||h){if(r=Rt,r!==null&&(v=lt(r,i),v!==0&&v!==d.retryLane))throw d.retryLane=v,qa(t,v),fe(r,t,v),Gr;cl(),a=No(t,a,i)}else t=d.treeContext,ue&&(Bt=ud(v),ie=a,vt=!0,Ca=null,ze=!1,t!==null&&xt(a,t)),a=al(a,r),a.flags|=4096;return a}return t=Ie(t.child,{mode:r.mode,children:r.children}),t.ref=a.ref,a.child=t,t.return=a,t}function nl(t,a){var i=a.ref;if(i===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(s(284));(t===null||t.ref!==i)&&(a.flags|=4194816)}}function Hs(t,a,i,r,h){return Xa(a),i=vs(t,a,i,r,void 0,h),r=Ss(),t!==null&&!Kt?(_s(t,a,h),Fe(t,a,h)):(vt&&r&&it(a),a.flags|=1,ae(t,a,i,h),a.child)}function zo(t,a,i,r,h,d){return Xa(a),a.updateQueue=null,i=Yu(a,r,i,h),Lu(t),r=Ss(),t!==null&&!Kt?(_s(t,a,d),Fe(t,a,d)):(vt&&r&&it(a),a.flags|=1,ae(t,a,i,d),a.child)}function Oo(t,a,i,r,h){if(Xa(a),a.stateNode===null){var d=Cn,v=i.contextType;typeof v=="object"&&v!==null&&(d=ee(v)),d=new i(r,d),a.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Dr,a.stateNode=d,d._reactInternals=a,d=a.stateNode,d.props=r,d.state=a.memoizedState,d.refs={},hs(a),v=i.contextType,d.context=typeof v=="object"&&v!==null?ee(v):Cn,d.state=a.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(Ds(a,i,v,r),d.state=a.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(v=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),v!==d.state&&Dr.enqueueReplaceState(d,d.state,null),Fn(a,r,d,h),Pn(),d.state=a.memoizedState),typeof d.componentDidMount=="function"&&(a.flags|=4194308),r=!0}else if(t===null){d=a.stateNode;var T=a.memoizedProps,H=ja(i,T);d.props=H;var w=d.context,$=i.contextType;v=Cn,typeof $=="object"&&$!==null&&(v=ee($));var Z=i.getDerivedStateFromProps;$=typeof Z=="function"||typeof d.getSnapshotBeforeUpdate=="function",T=a.pendingProps!==T,$||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(T||w!==v)&&_o(a,d,r,v),Ea=!1;var et=a.memoizedState;d.state=et,Fn(a,r,d,h),Pn(),w=a.memoizedState,T||et!==w||Ea?(typeof Z=="function"&&(Ds(a,i,Z,r),w=a.memoizedState),(H=Ea||So(a,i,H,r,et,w,v))?($||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(a.flags|=4194308)):(typeof d.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=r,a.memoizedState=w),d.props=r,d.state=w,d.context=v,r=H):(typeof d.componentDidMount=="function"&&(a.flags|=4194308),r=!1)}else{d=a.stateNode,fs(t,a),v=a.memoizedProps,$=ja(i,v),d.props=$,Z=a.pendingProps,et=d.context,w=i.contextType,H=Cn,typeof w=="object"&&w!==null&&(H=ee(w)),T=i.getDerivedStateFromProps,(w=typeof T=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(v!==Z||et!==H)&&_o(a,d,r,H),Ea=!1,et=a.memoizedState,d.state=et,Fn(a,r,d,h),Pn();var ht=a.memoizedState;v!==Z||et!==ht||Ea||t!==null&&t.dependencies!==null&&Yi(t.dependencies)?(typeof T=="function"&&(Ds(a,i,T,r),ht=a.memoizedState),($=Ea||So(a,i,$,r,et,ht,H)||t!==null&&t.dependencies!==null&&Yi(t.dependencies))?(w||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(r,ht,H),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(r,ht,H)),typeof d.componentDidUpdate=="function"&&(a.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof d.componentDidUpdate!="function"||v===t.memoizedProps&&et===t.memoizedState||(a.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&et===t.memoizedState||(a.flags|=1024),a.memoizedProps=r,a.memoizedState=ht),d.props=r,d.state=ht,d.context=H,r=$):(typeof d.componentDidUpdate!="function"||v===t.memoizedProps&&et===t.memoizedState||(a.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&et===t.memoizedState||(a.flags|=1024),r=!1)}return d=r,nl(t,a),r=(a.flags&128)!==0,d||r?(d=a.stateNode,i=r&&typeof i.getDerivedStateFromError!="function"?null:d.render(),a.flags|=1,t!==null&&r?(a.child=Ia(a,t.child,null,h),a.child=Ia(a,null,i,h)):ae(t,a,i,h),a.memoizedState=d.state,t=a.child):t=Fe(t,a,h),t}function Do(t,a,i,r){return Ya(),a.flags|=256,ae(t,a,i,r),a.child}function Bs(t){return{baseLanes:t,cachePool:Au()}}function Us(t,a,i){return t=t!==null?t.childLanes&~i:0,a&&(t|=Te),t}function Go(t,a,i){var r=a.pendingProps,h=!1,d=(a.flags&128)!==0,v;if((v=d)||(v=t!==null&&t.memoizedState===null?!1:(jt.current&2)!==0),v&&(h=!0,a.flags&=-129),v=(a.flags&32)!==0,a.flags&=-33,t===null){if(vt){if(h?ga(a):ma(),(t=Bt)?(t=gd(t,ze),t!==null&&(a.memoizedState={dehydrated:t,treeContext:_a!==null?{id:Ve,overflow:Ke}:null,retryLane:536870912,hydrationErrors:null},i=Ac(t),i.return=a,a.child=i,ie=a,Bt=null)):t=null,t===null)throw Ze(a);return yr(t)?a.lanes=32:a.lanes=536870912,null}var T=r.children;return r=r.fallback,h?(ma(),h=a.mode,T=il({mode:"hidden",children:T},h),r=Qa(r,h,i,null),T.return=a,r.return=a,T.sibling=r,a.child=T,r=a.child,r.memoizedState=Bs(i),r.childLanes=Us(t,v,i),a.memoizedState=Hr,In(null,r)):(ga(a),Ls(a,T))}var H=t.memoizedState;if(H!==null&&(T=H.dehydrated,T!==null)){if(d)a.flags&256?(ga(a),a.flags&=-257,a=Ys(t,a,i)):a.memoizedState!==null?(ma(),a.child=t.child,a.flags|=128,a=null):(ma(),T=r.fallback,h=a.mode,r=il({mode:"visible",children:r.children},h),T=Qa(T,h,i,null),T.flags|=2,r.return=a,T.return=a,r.sibling=T,a.child=r,Ia(a,t.child,null,i),r=a.child,r.memoizedState=Bs(i),r.childLanes=Us(t,v,i),a.memoizedState=Hr,a=In(null,r));else if(ga(a),yr(T))v=ed(T).digest,r=Error(s(419)),r.stack="",r.digest=v,Kn({value:r,source:null,stack:null}),a=Ys(t,a,i);else if(Kt||hn(t,a,i,!1),v=(i&t.childLanes)!==0,Kt||v){if(v=Rt,v!==null&&(r=lt(v,i),r!==0&&r!==H.retryLane))throw H.retryLane=r,qa(t,r),fe(v,t,r),Gr;pr(T)||cl(),a=Ys(t,a,i)}else pr(T)?(a.flags|=192,a.child=t.child,a=null):(t=H.treeContext,ue&&(Bt=od(T),ie=a,vt=!0,Ca=null,ze=!1,t!==null&&xt(a,t)),a=Ls(a,r.children),a.flags|=4096);return a}return h?(ma(),T=r.fallback,h=a.mode,H=t.child,d=H.sibling,r=Ie(H,{mode:"hidden",children:r.children}),r.subtreeFlags=H.subtreeFlags&65011712,d!==null?T=Ie(d,T):(T=Qa(T,h,i,null),T.flags|=2),T.return=a,r.return=a,r.sibling=T,a.child=r,In(null,r),r=a.child,T=t.child.memoizedState,T===null?T=Bs(i):(h=T.cachePool,h!==null?(H=$e?Ut._currentValue:Ut._currentValue2,h=h.parent!==H?{parent:H,pool:H}:h):h=Au(),T={baseLanes:T.baseLanes|i,cachePool:h}),r.memoizedState=T,r.childLanes=Us(t,v,i),a.memoizedState=Hr,In(t.child,r)):(ga(a),i=t.child,t=i.sibling,i=Ie(i,{mode:"visible",children:r.children}),i.return=a,i.sibling=null,t!==null&&(v=a.deletions,v===null?(a.deletions=[t],a.flags|=16):v.push(t)),a.child=i,a.memoizedState=null,i)}function Ls(t,a){return a=il({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function il(t,a){return t=n(22,t,null,a),t.lanes=0,t}function Ys(t,a,i){return Ia(a,t.child,null,i),t=Ls(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function Ho(t,a,i){t.lanes|=a;var r=t.alternate;r!==null&&(r.lanes|=a),ls(t.return,a,i)}function Xs(t,a,i,r,h,d){var v=t.memoizedState;v===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:r,tail:i,tailMode:h,treeForkCount:d}:(v.isBackwards=a,v.rendering=null,v.renderingStartTime=0,v.last=r,v.tail=i,v.tailMode=h,v.treeForkCount=d)}function Bo(t,a,i){var r=a.pendingProps,h=r.revealOrder,d=r.tail;r=r.children;var v=jt.current,T=(v&2)!==0;if(T?(v=v&1|2,a.flags|=128):v&=1,_(jt,v),ae(t,a,r,i),r=vt?oi:0,!T&&t!==null&&t.flags&128)t:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ho(t,i,a);else if(t.tag===19)Ho(t,i,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break t;for(;t.sibling===null;){if(t.return===null||t.return===a)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(h){case"forwards":for(i=a.child,h=null;i!==null;)t=i.alternate,t!==null&&Pi(t)===null&&(h=i),i=i.sibling;i=h,i===null?(h=a.child,a.child=null):(h=i.sibling,i.sibling=null),Xs(a,!1,h,i,d,r);break;case"backwards":case"unstable_legacy-backwards":for(i=null,h=a.child,a.child=null;h!==null;){if(t=h.alternate,t!==null&&Pi(t)===null){a.child=h;break}t=h.sibling,h.sibling=i,i=h,h=t}Xs(a,!0,i,null,d,r);break;case"together":Xs(a,!1,null,null,void 0,r);break;default:a.memoizedState=null}return a.child}function Fe(t,a,i){if(t!==null&&(a.dependencies=t.dependencies),xa|=a.lanes,!(i&a.childLanes))if(t!==null){if(hn(t,a,i,!1),(i&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(s(153));if(a.child!==null){for(t=a.child,i=Ie(t,t.pendingProps),a.child=i,i.return=a;t.sibling!==null;)t=t.sibling,i=i.sibling=Ie(t,t.pendingProps),i.return=a;i.sibling=null}return a.child}function ws(t,a){return t.lanes&a?!0:(t=t.dependencies,!!(t!==null&&Yi(t)))}function Z0(t,a,i){switch(a.tag){case 3:Gt(a,a.stateNode.containerInfo),ha(a,Ut,t.memoizedState.cache),Ya();break;case 27:case 5:ns(a);break;case 4:Gt(a,a.stateNode.containerInfo);break;case 10:ha(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,ps(a),null;break;case 13:var r=a.memoizedState;if(r!==null)return r.dehydrated!==null?(ga(a),a.flags|=128,null):i&a.child.childLanes?Go(t,a,i):(ga(a),t=Fe(t,a,i),t!==null?t.sibling:null);ga(a);break;case 19:var h=(t.flags&128)!==0;if(r=(i&a.childLanes)!==0,r||(hn(t,a,i,!1),r=(i&a.childLanes)!==0),h){if(r)return Bo(t,a,i);a.flags|=128}if(h=a.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),_(jt,jt.current),r)break;return null;case 22:return a.lanes=0,Mo(t,a,i,a.pendingProps);case 24:ha(a,Ut,t.memoizedState.cache)}return Fe(t,a,i)}function Uo(t,a,i){if(t!==null)if(t.memoizedProps!==a.pendingProps)Kt=!0;else{if(!ws(t,i)&&!(a.flags&128))return Kt=!1,Z0(t,a,i);Kt=!!(t.flags&131072)}else Kt=!1,vt&&a.flags&1048576&&st(a,oi,a.index);switch(a.lanes=0,a.tag){case 16:t:{var r=a.pendingProps;if(t=wa(a.elementType),a.type=t,typeof t=="function")nr(t)?(r=ja(t,r),a.tag=1,a=Oo(null,a,t,r,i)):(a.tag=0,a=Hs(null,a,t,r,i));else{if(t!=null){var h=t.$$typeof;if(h===or){a.tag=11,a=To(null,a,t,r,i);break t}else if(h===fr){a.tag=14,a=xo(null,a,t,r,i);break t}}throw a=S(t)||t,Error(s(306,a,""))}}return a;case 0:return Hs(t,a,a.type,a.pendingProps,i);case 1:return r=a.type,h=ja(r,a.pendingProps),Oo(t,a,r,h,i);case 3:t:{if(Gt(a,a.stateNode.containerInfo),t===null)throw Error(s(387));var d=a.pendingProps;h=a.memoizedState,r=h.element,fs(t,a),Fn(a,d,null,i);var v=a.memoizedState;if(d=v.cache,ha(a,Ut,d),d!==h.cache&&ss(a,[Ut],i,!0),Pn(),d=v.element,ue&&h.isDehydrated)if(h={element:d,isDehydrated:!1,cache:v.cache},a.updateQueue.baseState=h,a.memoizedState=h,a.flags&256){a=Do(t,a,d,i);break t}else if(d!==r){r=q(Error(s(424)),a),Kn(r),a=Do(t,a,d,i);break t}else for(ue&&(Bt=rd(a.stateNode.containerInfo),ie=a,vt=!0,Ca=null,ze=!0),i=oh(a,null,d,i),a.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Ya(),d===r){a=Fe(t,a,i);break t}ae(t,a,d,i)}a=a.child}return a;case 26:if(Le)return nl(t,a),t===null?(i=Fc(a.type,null,a.pendingProps,null))?a.memoizedState=i:vt||(a.stateNode=Hd(a.type,a.pendingProps,ba.current,a)):a.memoizedState=Fc(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:if(Pt)return ns(a),t===null&&Pt&&vt&&(r=a.stateNode=eh(a.type,a.pendingProps,ba.current,ne.current,!1),ie=a,ze=!0,Bt=cd(a.type,r,Bt)),ae(t,a,a.pendingProps.children,i),nl(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&vt&&(Od(a.type,a.pendingProps,ne.current),(h=r=Bt)&&(r=hd(r,a.type,a.pendingProps,ze),r!==null?(a.stateNode=r,ie=a,Bt=sd(r),ze=!1,h=!0):h=!1),h||Ze(a)),ns(a),h=a.type,d=a.pendingProps,v=t!==null?t.memoizedProps:null,r=d.children,ml(h,d)?r=null:v!==null&&ml(h,v)&&(a.flags|=32),a.memoizedState!==null&&(h=vs(t,a,Y0,null,null,i),$e?Ja._currentValue=h:Ja._currentValue2=h),nl(t,a),ae(t,a,r,i),a.child;case 6:return t===null&&vt&&(Dd(a.pendingProps,ne.current),(t=i=Bt)&&(i=fd(i,a.pendingProps,ze),i!==null?(a.stateNode=i,ie=a,Bt=null,t=!0):t=!1),t||Ze(a)),null;case 13:return Go(t,a,i);case 4:return Gt(a,a.stateNode.containerInfo),r=a.pendingProps,t===null?a.child=Ia(a,null,r,i):ae(t,a,r,i),a.child;case 11:return To(t,a,a.type,a.pendingProps,i);case 7:return ae(t,a,a.pendingProps,i),a.child;case 8:return ae(t,a,a.pendingProps.children,i),a.child;case 12:return ae(t,a,a.pendingProps.children,i),a.child;case 10:return r=a.pendingProps,ha(a,a.type,r.value),ae(t,a,r.children,i),a.child;case 9:return h=a.type._context,r=a.pendingProps.children,Xa(a),h=ee(h),r=r(h),a.flags|=1,ae(t,a,r,i),a.child;case 14:return xo(t,a,a.type,a.pendingProps,i);case 15:return Ao(t,a,a.type,a.pendingProps,i);case 19:return Bo(t,a,i);case 31:return Q0(t,a,i);case 22:return Mo(t,a,i,a.pendingProps);case 24:return Xa(a),r=ee(Ut),t===null?(h=os(),h===null&&(h=Rt,d=rs(),h.pooledCache=d,d.refCount++,d!==null&&(h.pooledCacheLanes|=i),h=d),a.memoizedState={parent:r,cache:h},hs(a),ha(a,Ut,h)):(t.lanes&i&&(fs(t,a),Fn(a,null,null,i),Pn()),h=t.memoizedState,d=a.memoizedState,h.parent!==r?(h={parent:r,cache:r},a.memoizedState=h,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=h),ha(a,Ut,r)):(r=d.cache,ha(a,Ut,r),r!==h.cache&&ss(a,[Ut],i,!0))),ae(t,a,a.pendingProps.children,i),a.child;case 29:throw a.pendingProps}throw Error(s(156,a.tag))}function He(t){t.flags|=4}function ll(t){je&&(t.flags|=8)}function Lo(t,a){if(t!==null&&t.child===a.child)return!1;if(a.flags&16)return!0;for(t=a.child;t!==null;){if(t.flags&8218||t.subtreeFlags&8218)return!0;t=t.sibling}return!1}function qs(t,a,i,r){if(re)for(i=a.child;i!==null;){if(i.tag===5||i.tag===6)gr(t,i.stateNode);else if(!(i.tag===4||Pt&&i.tag===27)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return;i=i.return}i.sibling.return=i.return,i=i.sibling}else if(je)for(var h=a.child;h!==null;){if(h.tag===5){var d=h.stateNode;i&&r&&(d=Kc(d,h.type,h.memoizedProps)),gr(t,d)}else if(h.tag===6)d=h.stateNode,i&&r&&(d=Qc(d,h.memoizedProps)),gr(t,d);else if(h.tag!==4){if(h.tag===22&&h.memoizedState!==null)d=h.child,d!==null&&(d.return=h),qs(t,h,!0,!0);else if(h.child!==null){h.child.return=h,h=h.child;continue}}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}}function Yo(t,a,i,r){var h=!1;if(je)for(var d=a.child;d!==null;){if(d.tag===5){var v=d.stateNode;i&&r&&(v=Kc(v,d.type,d.memoizedProps)),jc(t,v)}else if(d.tag===6)v=d.stateNode,i&&r&&(v=Qc(v,d.memoizedProps)),jc(t,v);else if(d.tag!==4){if(d.tag===22&&d.memoizedState!==null)h=d.child,h!==null&&(h.return=d),Yo(t,d,!0,!0),h=!0;else if(d.child!==null){d.child.return=d,d=d.child;continue}}if(d===a)break;for(;d.sibling===null;){if(d.return===null||d.return===a)return h;d=d.return}d.sibling.return=d.return,d=d.sibling}return h}function Xo(t,a){if(je&&Lo(t,a)){t=a.stateNode;var i=t.containerInfo,r=qc();Yo(r,a,!1,!1),t.pendingChildren=r,He(a),td(i,r)}}function js(t,a,i,r){if(re)t.memoizedProps!==r&&He(a);else if(je){var h=t.stateNode,d=t.memoizedProps;if((t=Lo(t,a))||d!==r){var v=ne.current;d=$f(h,i,d,r,!t,null),d===h?a.stateNode=h:(ll(a),Uc(d,i,r,v)&&He(a),a.stateNode=d,t&&qs(d,a,!1,!1))}else a.stateNode=h}}function Vs(t,a,i,r,h){if(t.mode&32&&(i===null?Af(a,r):Mf(a,i,r))){if(t.flags|=16777216,(h&335544128)===h||mr(a,r))if(Yc(t.stateNode,a,r))t.flags|=8192;else if(hc())t.flags|=8192;else throw Wa=Al,Rr}else t.flags&=-16777217}function wo(t,a){if(Ud(a)){if(t.flags|=16777216,!th(a))if(hc())t.flags|=8192;else throw Wa=Al,Rr}else t.flags&=-16777217}function sl(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?U():536870912,t.lanes|=a,Un|=a)}function $n(t,a){if(!vt)switch(t.tailMode){case"hidden":a=t.tail;for(var i=null;a!==null;)a.alternate!==null&&(i=a),a=a.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var r=null;i!==null;)i.alternate!==null&&(r=i),i=i.sibling;r===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ht(t){var a=t.alternate!==null&&t.alternate.child===t.child,i=0,r=0;if(a)for(var h=t.child;h!==null;)i|=h.lanes|h.childLanes,r|=h.subtreeFlags&65011712,r|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)i|=h.lanes|h.childLanes,r|=h.subtreeFlags,r|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=r,t.childLanes=i,a}function J0(t,a,i){var r=a.pendingProps;switch(Et(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(a),null;case 1:return Ht(a),null;case 3:return i=a.stateNode,r=null,t!==null&&(r=t.memoizedState.cache),a.memoizedState.cache!==r&&(a.flags|=2048),Je(Ut),ca(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(cn(a)?He(a):t===null||t.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,is())),Xo(t,a),Ht(a),null;case 26:if(Le){var h=a.type,d=a.memoizedState;return t===null?(He(a),d!==null?(Ht(a),wo(a,d)):(Ht(a),Vs(a,h,null,r,i))):d?d!==t.memoizedState?(He(a),Ht(a),wo(a,d)):(Ht(a),a.flags&=-16777217):(d=t.memoizedProps,re?d!==r&&He(a):js(t,a,h,r),Ht(a),Vs(a,h,d,r,i)),null}case 27:if(Pt){if(Li(a),i=ba.current,h=a.type,t!==null&&a.stateNode!=null)re?t.memoizedProps!==r&&He(a):js(t,a,h,r);else{if(!r){if(a.stateNode===null)throw Error(s(166));return Ht(a),null}t=ne.current,cn(a)?yu(a,t):(t=eh(h,r,i,t,!0),a.stateNode=t,He(a))}return Ht(a),null}case 5:if(Li(a),h=a.type,t!==null&&a.stateNode!=null)js(t,a,h,r);else{if(!r){if(a.stateNode===null)throw Error(s(166));return Ht(a),null}if(d=ne.current,cn(a))yu(a,d),xd(a.stateNode,h,r,d)&&(a.flags|=64);else{var v=vf(h,r,ba.current,d,a);ll(a),qs(v,a,!1,!1),a.stateNode=v,Uc(v,h,r,d)&&He(a)}}return Ht(a),Vs(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,i),null;case 6:if(t&&a.stateNode!=null)i=t.memoizedProps,re?i!==r&&He(a):je&&(i!==r?(t=ba.current,i=ne.current,ll(a),a.stateNode=Lc(r,t,i,a)):a.stateNode=t.stateNode);else{if(typeof r!="string"&&a.stateNode===null)throw Error(s(166));if(t=ba.current,i=ne.current,cn(a)){if(!ue)throw Error(s(176));if(t=a.stateNode,i=a.memoizedProps,r=null,h=ie,h!==null)switch(h.tag){case 27:case 5:r=h.memoizedProps}pd(t,i,a,r)||Ze(a,!0)}else ll(a),a.stateNode=Lc(r,t,i,a)}return Ht(a),null;case 31:if(i=a.memoizedState,t===null||t.memoizedState!==null){if(r=cn(a),i!==null){if(t===null){if(!r)throw Error(s(318));if(!ue)throw Error(s(556));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(557));yd(t,a)}else Ya(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Ht(a),t=!1}else i=is(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),t=!0;if(!t)return a.flags&256?(pe(a),a):(pe(a),null);if(a.flags&128)throw Error(s(558))}return Ht(a),null;case 13:if(r=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=cn(a),r!==null&&r.dehydrated!==null){if(t===null){if(!h)throw Error(s(318));if(!ue)throw Error(s(344));if(h=a.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));vd(h,a)}else Ya(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Ht(a),h=!1}else h=is(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return a.flags&256?(pe(a),a):(pe(a),null)}return pe(a),a.flags&128?(a.lanes=i,a):(i=r!==null,t=t!==null&&t.memoizedState!==null,i&&(r=a.child,h=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(h=r.alternate.memoizedState.cachePool.pool),d=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(d=r.memoizedState.cachePool.pool),d!==h&&(r.flags|=2048)),i!==t&&i&&(a.child.flags|=8192),sl(a,a.updateQueue),Ht(a),null);case 4:return ca(),Xo(t,a),t===null&&Cf(a.stateNode.containerInfo),Ht(a),null;case 10:return Je(a.type),Ht(a),null;case 19:if(C(jt),r=a.memoizedState,r===null)return Ht(a),null;if(h=(a.flags&128)!==0,d=r.rendering,d===null)if(h)$n(r,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=a.child;t!==null;){if(d=Pi(t),d!==null){for(a.flags|=128,$n(r,!1),t=d.updateQueue,a.updateQueue=t,sl(a,t),a.subtreeFlags=0,t=i,i=a.child;i!==null;)xc(i,t),i=i.sibling;return _(jt,jt.current&1|2),vt&&F(a,r.treeForkCount),a.child}t=t.sibling}r.tail!==null&&de()>yi&&(a.flags|=128,h=!0,$n(r,!1),a.lanes=4194304)}else{if(!h)if(t=Pi(d),t!==null){if(a.flags|=128,h=!0,t=t.updateQueue,a.updateQueue=t,sl(a,t),$n(r,!0),r.tail===null&&r.tailMode==="hidden"&&!d.alternate&&!vt)return Ht(a),null}else 2*de()-r.renderingStartTime>yi&&i!==536870912&&(a.flags|=128,h=!0,$n(r,!1),a.lanes=4194304);r.isBackwards?(d.sibling=a.child,a.child=d):(t=r.last,t!==null?t.sibling=d:a.child=d,r.last=d)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=de(),t.sibling=null,i=jt.current,_(jt,h?i&1|2:i&1),vt&&F(a,r.treeForkCount),t):(Ht(a),null);case 22:case 23:return pe(a),ms(),r=a.memoizedState!==null,t!==null?t.memoizedState!==null!==r&&(a.flags|=8192):r&&(a.flags|=8192),r?i&536870912&&!(a.flags&128)&&(Ht(a),a.subtreeFlags&6&&(a.flags|=8192)):Ht(a),i=a.updateQueue,i!==null&&sl(a,i.retryQueue),i=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==i&&(a.flags|=2048),t!==null&&C(ka),null;case 24:return i=null,t!==null&&(i=t.memoizedState.cache),a.memoizedState.cache!==i&&(a.flags|=2048),Je(Ut),Ht(a),null;case 25:return null;case 30:return null}throw Error(s(156,a.tag))}function P0(t,a){switch(Et(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return Je(Ut),ca(),t=a.flags,t&65536&&!(t&128)?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return Li(a),null;case 31:if(a.memoizedState!==null){if(pe(a),a.alternate===null)throw Error(s(340));Ya()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(pe(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(s(340));Ya()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return C(jt),null;case 4:return ca(),null;case 10:return Je(a.type),null;case 22:case 23:return pe(a),ms(),t!==null&&C(ka),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return Je(Ut),null;case 25:return null;default:return null}}function qo(t,a){switch(Et(a),a.tag){case 3:Je(Ut),ca();break;case 26:case 27:case 5:Li(a);break;case 4:ca();break;case 31:a.memoizedState!==null&&pe(a);break;case 13:pe(a);break;case 19:C(jt);break;case 10:Je(a.type);break;case 22:case 23:pe(a),ms(),t!==null&&C(ka);break;case 24:Je(Ut)}}function ti(t,a){try{var i=a.updateQueue,r=i!==null?i.lastEffect:null;if(r!==null){var h=r.next;i=h;do{if((i.tag&t)===t){r=void 0;var d=i.create,v=i.inst;r=d(),v.destroy=r}i=i.next}while(i!==h)}}catch(T){_t(a,a.return,T)}}function pa(t,a,i){try{var r=a.updateQueue,h=r!==null?r.lastEffect:null;if(h!==null){var d=h.next;r=d;do{if((r.tag&t)===t){var v=r.inst,T=v.destroy;if(T!==void 0){v.destroy=void 0,h=a;var H=i,w=T;try{w()}catch($){_t(h,H,$)}}}r=r.next}while(r!==d)}}catch($){_t(a,a.return,$)}}function jo(t){var a=t.updateQueue;if(a!==null){var i=t.stateNode;try{Hu(a,i)}catch(r){_t(t,t.return,r)}}}function Vo(t,a,i){i.props=ja(t.type,t.memoizedProps),i.state=t.memoizedState;try{i.componentWillUnmount()}catch(r){_t(t,a,r)}}function ei(t,a){try{var i=t.ref;if(i!==null){switch(t.tag){case 26:case 27:case 5:var r=li(t.stateNode);break;case 30:r=t.stateNode;break;default:r=t.stateNode}typeof i=="function"?t.refCleanup=i(r):i.current=r}}catch(h){_t(t,a,h)}}function qe(t,a){var i=t.ref,r=t.refCleanup;if(i!==null)if(typeof r=="function")try{r()}catch(h){_t(t,a,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(h){_t(t,a,h)}else i.current=null}function Ko(t){var a=t.type,i=t.memoizedProps,r=t.stateNode;try{jf(r,a,i,t)}catch(h){_t(t,t.return,h)}}function Ks(t,a,i){try{Vf(t.stateNode,t.type,i,a,t)}catch(r){_t(t,t.return,r)}}function Qo(t){return t.tag===5||t.tag===3||(Le?t.tag===26:!1)||(Pt?t.tag===27&&_n(t.type):!1)||t.tag===4}function Qs(t){t:for(;;){for(;t.sibling===null;){if(t.return===null||Qo(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(Pt&&t.tag===27&&_n(t.type)||t.flags&2||t.child===null||t.tag===4)continue t;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Zs(t,a,i){var r=t.tag;if(r===5||r===6)t=t.stateNode,a?Qf(i,t,a):wf(i,t);else if(r!==4&&(Pt&&r===27&&_n(t.type)&&(i=t.stateNode,a=null),t=t.child,t!==null))for(Zs(t,a,i),t=t.sibling;t!==null;)Zs(t,a,i),t=t.sibling}function rl(t,a,i){var r=t.tag;if(r===5||r===6)t=t.stateNode,a?Kf(i,t,a):Xf(i,t);else if(r!==4&&(Pt&&r===27&&_n(t.type)&&(i=t.stateNode),t=t.child,t!==null))for(rl(t,a,i),t=t.sibling;t!==null;)rl(t,a,i),t=t.sibling}function Zo(t,a,i){t=t.containerInfo;try{Vc(t,i)}catch(r){_t(a,a.return,r)}}function Jo(t){var a=t.stateNode,i=t.memoizedProps;try{Yd(t.type,i,a,t)}catch(r){_t(t,t.return,r)}}function F0(t,a){for(pf(t.containerInfo),$t=a;$t!==null;)if(t=$t,a=t.child,(t.subtreeFlags&1028)!==0&&a!==null)a.return=t,$t=a;else for(;$t!==null;){t=$t;var i=t.alternate;switch(a=t.flags,t.tag){case 0:if(a&4&&(a=t.updateQueue,a=a!==null?a.events:null,a!==null))for(var r=0;r<a.length;r++){var h=a[r];h.ref.impl=h.nextImpl}break;case 11:case 15:break;case 1:if(a&1024&&i!==null){a=void 0,r=t,h=i.memoizedProps,i=i.memoizedState;var d=r.stateNode;try{var v=ja(r.type,h);a=d.getSnapshotBeforeUpdate(v,i),d.__reactInternalSnapshotBeforeUpdate=a}catch(T){_t(r,r.return,T)}}break;case 3:a&1024&&re&&If(t.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(a&1024)throw Error(s(163))}if(a=t.sibling,a!==null){a.return=t.return,$t=a;break}$t=t.return}}function Po(t,a,i){var r=i.flags;switch(i.tag){case 0:case 11:case 15:ke(t,i),r&4&&ti(5,i);break;case 1:if(ke(t,i),r&4)if(t=i.stateNode,a===null)try{t.componentDidMount()}catch(v){_t(i,i.return,v)}else{var h=ja(i.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(h,a,t.__reactInternalSnapshotBeforeUpdate)}catch(v){_t(i,i.return,v)}}r&64&&jo(i),r&512&&ei(i,i.return);break;case 3:if(ke(t,i),r&64&&(r=i.updateQueue,r!==null)){if(t=null,i.child!==null)switch(i.child.tag){case 27:case 5:t=li(i.child.stateNode);break;case 1:t=i.child.stateNode}try{Hu(r,t)}catch(v){_t(i,i.return,v)}}break;case 27:Pt&&a===null&&r&4&&Jo(i);case 26:case 5:if(ke(t,i),a===null){if(r&4)Ko(i);else if(r&64){t=i.type,a=i.memoizedProps,h=i.stateNode;try{bd(h,t,a,i)}catch(v){_t(i,i.return,v)}}}r&512&&ei(i,i.return);break;case 12:ke(t,i);break;case 31:ke(t,i),r&4&&ko(t,i);break;case 13:ke(t,i),r&4&&Wo(t,i),r&64&&(r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(i=af.bind(null,i),ad(r,i))));break;case 22:if(r=i.memoizedState!==null||na,!r){a=a!==null&&a.memoizedState!==null||Qt,h=na;var d=Qt;na=r,(Qt=a)&&!d?We(t,i,(i.subtreeFlags&8772)!==0):ke(t,i),na=h,Qt=d}break;case 30:break;default:ke(t,i)}}function Fo(t){var a=t.alternate;a!==null&&(t.alternate=null,Fo(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&xf(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Be(t,a,i){for(i=i.child;i!==null;)Js(t,a,i),i=i.sibling}function Js(t,a,i){if(_e&&typeof _e.onCommitFiberUnmount=="function")try{_e.onCommitFiberUnmount(ui,i)}catch{}switch(i.tag){case 26:if(Le){Qt||qe(i,a),Be(t,a,i),i.memoizedState?Wc(i.memoizedState):i.stateNode&&$c(i.stateNode);break}case 27:if(Pt){Qt||qe(i,a);var r=Zt,h=ge;_n(i.type)&&(Zt=i.stateNode,ge=!1),Be(t,a,i),ah(i.stateNode),Zt=r,ge=h;break}case 5:Qt||qe(i,a);case 6:if(re){if(r=Zt,h=ge,Zt=null,Be(t,a,i),Zt=r,ge=h,Zt!==null)if(ge)try{Jf(Zt,i.stateNode)}catch(d){_t(i,a,d)}else try{Zf(Zt,i.stateNode)}catch(d){_t(i,a,d)}}else Be(t,a,i);break;case 18:re&&Zt!==null&&(ge?Rd(Zt,i.stateNode):Md(Zt,i.stateNode));break;case 4:re?(r=Zt,h=ge,Zt=i.stateNode.containerInfo,ge=!0,Be(t,a,i),Zt=r,ge=h):(je&&Zo(i.stateNode,i,qc()),Be(t,a,i));break;case 0:case 11:case 14:case 15:pa(2,i,a),Qt||pa(4,i,a),Be(t,a,i);break;case 1:Qt||(qe(i,a),r=i.stateNode,typeof r.componentWillUnmount=="function"&&Vo(i,a,r)),Be(t,a,i);break;case 21:Be(t,a,i);break;case 22:Qt=(r=Qt)||i.memoizedState!==null,Be(t,a,i),Qt=r;break;default:Be(t,a,i)}}function ko(t,a){if(ue&&a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Ed(t)}catch(i){_t(a,a.return,i)}}}function Wo(t,a){if(ue&&a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Td(t)}catch(i){_t(a,a.return,i)}}function k0(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new fh),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new fh),a;default:throw Error(s(435,t.tag))}}function ul(t,a){var i=k0(t);a.forEach(function(r){if(!i.has(r)){i.add(r);var h=nf.bind(null,t,r);r.then(h,h)}})}function se(t,a){var i=a.deletions;if(i!==null)for(var r=0;r<i.length;r++){var h=i[r],d=t,v=a;if(re){var T=v;t:for(;T!==null;){switch(T.tag){case 27:if(Pt){if(_n(T.type)){Zt=T.stateNode,ge=!1;break t}break}case 5:Zt=T.stateNode,ge=!1;break t;case 3:case 4:Zt=T.stateNode.containerInfo,ge=!0;break t}T=T.return}if(Zt===null)throw Error(s(160));Js(d,v,h),Zt=null,ge=!1}else Js(d,v,h);d=h.alternate,d!==null&&(d.return=null),h.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Io(a,t),a=a.sibling}function Io(t,a){var i=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:se(a,t),ce(t),r&4&&(pa(3,t,t.return),ti(3,t),pa(5,t,t.return));break;case 1:se(a,t),ce(t),r&512&&(Qt||i===null||qe(i,i.return)),r&64&&na&&(t=t.updateQueue,t!==null&&(r=t.callbacks,r!==null&&(i=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=i===null?r:i.concat(r))));break;case 26:if(Le){var h=Ye;if(se(a,t),ce(t),r&512&&(Qt||i===null||qe(i,i.return)),r&4){r=i!==null?i.memoizedState:null;var d=t.memoizedState;i===null?d===null?t.stateNode===null?t.stateNode=Gd(h,t.type,t.memoizedProps,t):Ic(h,t.type,t.stateNode):t.stateNode=kc(h,d,t.memoizedProps):r!==d?(r===null?i.stateNode!==null&&$c(i.stateNode):Wc(r),d===null?Ic(h,t.type,t.stateNode):kc(h,d,t.memoizedProps)):d===null&&t.stateNode!==null&&Ks(t,t.memoizedProps,i.memoizedProps)}break}case 27:if(Pt){se(a,t),ce(t),r&512&&(Qt||i===null||qe(i,i.return)),i!==null&&r&4&&Ks(t,t.memoizedProps,i.memoizedProps);break}case 5:if(se(a,t),ce(t),r&512&&(Qt||i===null||qe(i,i.return)),re){if(t.flags&32){h=t.stateNode;try{wc(h)}catch(Z){_t(t,t.return,Z)}}r&4&&t.stateNode!=null&&(h=t.memoizedProps,Ks(t,h,i!==null?i.memoizedProps:h)),r&1024&&(Br=!0)}else je&&t.alternate!==null&&(t.alternate.stateNode=t.stateNode);break;case 6:if(se(a,t),ce(t),r&4&&re){if(t.stateNode===null)throw Error(s(162));r=t.memoizedProps,i=i!==null?i.memoizedProps:r,h=t.stateNode;try{qf(h,i,r)}catch(Z){_t(t,t.return,Z)}}break;case 3:if(Le?(Bd(),h=Ye,Ye=vr(a.containerInfo),se(a,t),Ye=h):se(a,t),ce(t),r&4){if(re&&ue&&i!==null&&i.memoizedState.isDehydrated)try{Cd(a.containerInfo)}catch(Z){_t(t,t.return,Z)}if(je){r=a.containerInfo,i=a.pendingChildren;try{Vc(r,i)}catch(Z){_t(t,t.return,Z)}}}Br&&(Br=!1,$o(t));break;case 4:Le?(i=Ye,Ye=vr(t.stateNode.containerInfo),se(a,t),ce(t),Ye=i):(se(a,t),ce(t)),r&4&&je&&Zo(t.stateNode,t,t.stateNode.pendingChildren);break;case 12:se(a,t),ce(t);break;case 31:se(a,t),ce(t),r&4&&(r=t.updateQueue,r!==null&&(t.updateQueue=null,ul(t,r)));break;case 13:se(a,t),ce(t),t.child.flags&8192&&t.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(Bl=de()),r&4&&(r=t.updateQueue,r!==null&&(t.updateQueue=null,ul(t,r)));break;case 22:h=t.memoizedState!==null;var v=i!==null&&i.memoizedState!==null,T=na,H=Qt;if(na=T||h,Qt=H||v,se(a,t),Qt=H,na=T,ce(t),r&8192&&(a=t.stateNode,a._visibility=h?a._visibility&-2:a._visibility|1,h&&(i===null||v||na||Qt||Va(t)),re)){t:if(i=null,re)for(a=t;;){if(a.tag===5||Le&&a.tag===26){if(i===null){v=i=a;try{d=v.stateNode,h?Pf(d):kf(v.stateNode,v.memoizedProps)}catch(Z){_t(v,v.return,Z)}}}else if(a.tag===6){if(i===null){v=a;try{var w=v.stateNode;h?Ff(w):Wf(w,v.memoizedProps)}catch(Z){_t(v,v.return,Z)}}}else if(a.tag===18){if(i===null){v=a;try{var $=v.stateNode;h?Nd($):zd(v.stateNode)}catch(Z){_t(v,v.return,Z)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break t;for(;a.sibling===null;){if(a.return===null||a.return===t)break t;i===a&&(i=null),a=a.return}i===a&&(i=null),a.sibling.return=a.return,a=a.sibling}}r&4&&(r=t.updateQueue,r!==null&&(i=r.retryQueue,i!==null&&(r.retryQueue=null,ul(t,i))));break;case 19:se(a,t),ce(t),r&4&&(r=t.updateQueue,r!==null&&(t.updateQueue=null,ul(t,r)));break;case 30:break;case 21:break;default:se(a,t),ce(t)}}function ce(t){var a=t.flags;if(a&2){try{for(var i,r=t.return;r!==null;){if(Qo(r)){i=r;break}r=r.return}if(re){if(i==null)throw Error(s(160));switch(i.tag){case 27:if(Pt){var h=i.stateNode,d=Qs(t);rl(t,d,h);break}case 5:var v=i.stateNode;i.flags&32&&(wc(v),i.flags&=-33);var T=Qs(t);rl(t,T,v);break;case 3:case 4:var H=i.stateNode.containerInfo,w=Qs(t);Zs(t,w,H);break;default:throw Error(s(161))}}}catch($){_t(t,t.return,$)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function $o(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;$o(a),a.tag===5&&a.flags&1024&&zf(a.stateNode),t=t.sibling}}function ke(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Po(t,a.alternate,a),a=a.sibling}function Va(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:pa(4,a,a.return),Va(a);break;case 1:qe(a,a.return);var i=a.stateNode;typeof i.componentWillUnmount=="function"&&Vo(a,a.return,i),Va(a);break;case 27:Pt&&ah(a.stateNode);case 26:case 5:qe(a,a.return),Va(a);break;case 22:a.memoizedState===null&&Va(a);break;case 30:Va(a);break;default:Va(a)}t=t.sibling}}function We(t,a,i){for(i=i&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var r=a.alternate,h=t,d=a,v=d.flags;switch(d.tag){case 0:case 11:case 15:We(h,d,i),ti(4,d);break;case 1:if(We(h,d,i),r=d,h=r.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(w){_t(r,r.return,w)}if(r=d,h=r.updateQueue,h!==null){var T=r.stateNode;try{var H=h.shared.hiddenCallbacks;if(H!==null)for(h.shared.hiddenCallbacks=null,h=0;h<H.length;h++)Gu(H[h],T)}catch(w){_t(r,r.return,w)}}i&&v&64&&jo(d),ei(d,d.return);break;case 27:Pt&&Jo(d);case 26:case 5:We(h,d,i),i&&r===null&&v&4&&Ko(d),ei(d,d.return);break;case 12:We(h,d,i);break;case 31:We(h,d,i),i&&v&4&&ko(h,d);break;case 13:We(h,d,i),i&&v&4&&Wo(h,d);break;case 22:d.memoizedState===null&&We(h,d,i),ei(d,d.return);break;case 30:break;default:We(h,d,i)}a=a.sibling}}function Ps(t,a){var i=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==i&&(t!=null&&t.refCount++,i!=null&&Qn(i))}function Fs(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Qn(t))}function Ue(t,a,i,r){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)tc(t,a,i,r),a=a.sibling}function tc(t,a,i,r){var h=a.flags;switch(a.tag){case 0:case 11:case 15:Ue(t,a,i,r),h&2048&&ti(9,a);break;case 1:Ue(t,a,i,r);break;case 3:Ue(t,a,i,r),h&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Qn(t)));break;case 12:if(h&2048){Ue(t,a,i,r),t=a.stateNode;try{var d=a.memoizedProps,v=d.id,T=d.onPostCommit;typeof T=="function"&&T(v,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(H){_t(a,a.return,H)}}else Ue(t,a,i,r);break;case 31:Ue(t,a,i,r);break;case 13:Ue(t,a,i,r);break;case 23:break;case 22:d=a.stateNode,v=a.alternate,a.memoizedState!==null?d._visibility&2?Ue(t,a,i,r):ai(t,a):d._visibility&2?Ue(t,a,i,r):(d._visibility|=2,gn(t,a,i,r,(a.subtreeFlags&10256)!==0||!1)),h&2048&&Ps(v,a);break;case 24:Ue(t,a,i,r),h&2048&&Fs(a.alternate,a);break;default:Ue(t,a,i,r)}}function gn(t,a,i,r,h){for(h=h&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var d=t,v=a,T=i,H=r,w=v.flags;switch(v.tag){case 0:case 11:case 15:gn(d,v,T,H,h),ti(8,v);break;case 23:break;case 22:var $=v.stateNode;v.memoizedState!==null?$._visibility&2?gn(d,v,T,H,h):ai(d,v):($._visibility|=2,gn(d,v,T,H,h)),h&&w&2048&&Ps(v.alternate,v);break;case 24:gn(d,v,T,H,h),h&&w&2048&&Fs(v.alternate,v);break;default:gn(d,v,T,H,h)}a=a.sibling}}function ai(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var i=t,r=a,h=r.flags;switch(r.tag){case 22:ai(i,r),h&2048&&Ps(r.alternate,r);break;case 24:ai(i,r),h&2048&&Fs(r.alternate,r);break;default:ai(i,r)}a=a.sibling}}function Ka(t,a,i){if(t.subtreeFlags&Hn)for(t=t.child;t!==null;)ec(t,a,i),t=t.sibling}function ec(t,a,i){switch(t.tag){case 26:if(Ka(t,a,i),t.flags&Hn)if(t.memoizedState!==null)Ld(i,Ye,t.memoizedState,t.memoizedProps);else{var r=t.stateNode,h=t.type;t=t.memoizedProps,((a&335544128)===a||mr(h,t))&&Xc(i,r,h,t)}break;case 5:Ka(t,a,i),t.flags&Hn&&(r=t.stateNode,h=t.type,t=t.memoizedProps,((a&335544128)===a||mr(h,t))&&Xc(i,r,h,t));break;case 3:case 4:Le?(r=Ye,Ye=vr(t.stateNode.containerInfo),Ka(t,a,i),Ye=r):Ka(t,a,i);break;case 22:t.memoizedState===null&&(r=t.alternate,r!==null&&r.memoizedState!==null?(r=Hn,Hn=16777216,Ka(t,a,i),Hn=r):Ka(t,a,i));break;default:Ka(t,a,i)}}function ac(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function ni(t){var a=t.deletions;if(t.flags&16){if(a!==null)for(var i=0;i<a.length;i++){var r=a[i];$t=r,ic(r,t)}ac(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)nc(t),t=t.sibling}function nc(t){switch(t.tag){case 0:case 11:case 15:ni(t),t.flags&2048&&pa(9,t,t.return);break;case 3:ni(t);break;case 12:ni(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,ol(t)):ni(t);break;default:ni(t)}}function ol(t){var a=t.deletions;if(t.flags&16){if(a!==null)for(var i=0;i<a.length;i++){var r=a[i];$t=r,ic(r,t)}ac(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:pa(8,a,a.return),ol(a);break;case 22:i=a.stateNode,i._visibility&2&&(i._visibility&=-3,ol(a));break;default:ol(a)}t=t.sibling}}function ic(t,a){for(;$t!==null;){var i=$t;switch(i.tag){case 0:case 11:case 15:pa(8,i,a);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var r=i.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:Qn(i.memoizedState.cache)}if(r=i.child,r!==null)r.return=i,$t=r;else t:for(i=t;$t!==null;){r=$t;var h=r.sibling,d=r.return;if(Fo(r),r===i){$t=null;break t}if(h!==null){h.return=d,$t=h;break t}$t=d}}}function ks(t){var a=bf(t);if(a!=null){if(typeof a.memoizedProps["data-testname"]!="string")throw Error(s(364));return a}if(t=Gf(t),t===null)throw Error(s(362));return t.stateNode.current}function Ws(t,a){var i=t.tag;switch(a.$$typeof){case zl:if(t.type===a.value)return!0;break;case Ol:t:{for(a=a.value,t=[t,0],i=0;i<t.length;){var r=t[i++],h=r.tag,d=t[i++],v=a[d];if(h!==5&&h!==26&&h!==27||!ri(r)){for(;v!=null&&Ws(r,v);)d++,v=a[d];if(d===a.length){a=!0;break t}else for(r=r.child;r!==null;)t.push(r,d),r=r.sibling}}a=!1}return a;case Dl:if((i===5||i===26||i===27)&&Uf(t.stateNode,a.value))return!0;break;case Hl:if((i===5||i===6||i===26||i===27)&&(t=Bf(t),t!==null&&0<=t.indexOf(a.value)))return!0;break;case Gl:if((i===5||i===26||i===27)&&(t=t.memoizedProps["data-testname"],typeof t=="string"&&t.toLowerCase()===a.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function Is(t){switch(t.$$typeof){case zl:return"<"+(S(t.value)||"Unknown")+">";case Ol:return":has("+(Is(t)||"")+")";case Dl:return'[role="'+t.value+'"]';case Hl:return'"'+t.value+'"';case Gl:return'[data-testname="'+t.value+'"]';default:throw Error(s(365))}}function lc(t,a){var i=[];t=[t,0];for(var r=0;r<t.length;){var h=t[r++],d=h.tag,v=t[r++],T=a[v];if(d!==5&&d!==26&&d!==27||!ri(h)){for(;T!=null&&Ws(h,T);)v++,T=a[v];if(v===a.length)i.push(h);else for(h=h.child;h!==null;)t.push(h,v),h=h.sibling}}return i}function $s(t,a){if(!si)throw Error(s(363));t=ks(t),t=lc(t,a),a=[],t=Array.from(t);for(var i=0;i<t.length;){var r=t[i++],h=r.tag;if(h===5||h===26||h===27)ri(r)||a.push(r.stateNode);else for(r=r.child;r!==null;)t.push(r),r=r.sibling}return a}function ye(){return gt&2&&pt!==0?pt&-pt:rt.T!==null?us():Ef()}function sc(){if(Te===0)if(!(pt&536870912)||vt){var t=yl;yl<<=1,!(yl&3932160)&&(yl=262144),Te=t}else Te=536870912;return t=Ce.current,t!==null&&(t.flags|=32),Te}function fe(t,a,i){(t===Rt&&(At===2||At===9)||t.cancelPendingCommit!==null)&&(mn(t,0),ya(t,pt,Te,!1)),X(t,i),(!(gt&2)||t!==Rt)&&(t===Rt&&(!(gt&2)&&(tn|=i),wt===4&&ya(t,pt,Te,!1)),we(t))}function rc(t,a,i){if(gt&6)throw Error(s(327));var r=!i&&(a&127)===0&&(a&t.expiredLanes)===0||z(t,a),h=r?$0(t,a):er(t,a,!0),d=r;do{if(h===0){Bn&&!r&&ya(t,a,0,!1);break}else{if(i=t.current.alternate,d&&!W0(i)){h=er(t,a,!1),d=!1;continue}if(h===2){if(d=a,t.errorRecoveryDisabledLanes&d)var v=0;else v=t.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){a=v;t:{var T=t;h=pi;var H=ue&&T.current.memoizedState.isDehydrated;if(H&&(mn(T,v).flags|=256),v=er(T,v,!1),v!==2){if(Ur&&!H){T.errorRecoveryDisabledLanes|=d,tn|=d,h=4;break t}d=me,me=h,d!==null&&(me===null?me=d:me.push.apply(me,d))}h=v}if(d=!1,h!==2)continue}}if(h===1){mn(t,0),ya(t,a,0,!0);break}t:{switch(r=t,d=h,d){case 0:case 1:throw Error(s(345));case 4:if((a&4194048)!==a)break;case 6:ya(r,a,Te,!Ta);break t;case 2:me=null;break;case 3:case 5:break;default:throw Error(s(329))}if((a&62914560)===a&&(h=Bl+300-de(),10<h)){if(ya(r,a,Te,!Ta),A(r,0,!0)!==0)break t;la=a,r.timeoutHandle=Sf(uc.bind(null,r,i,me,Ul,Yr,a,Te,tn,Un,Ta,d,"Throttled",-0,0),h);break t}uc(r,i,me,Ul,Yr,a,Te,tn,Un,Ta,d,null,-0,0)}}break}while(!0);we(t)}function uc(t,a,i,r,h,d,v,T,H,w,$,Z,et,ht){if(t.timeoutHandle=Za,Z=a.subtreeFlags,Z&8192||(Z&16785408)===16785408){Z=Rf(),ec(a,d,Z);var le=(d&62914560)===d?Bl-de():(d&4194048)===d?dh-de():0;if(le=Nf(Z,le),le!==null){la=d,t.cancelPendingCommit=le(yc.bind(null,t,a,d,i,r,h,v,T,H,$,Z,null,et,ht)),ya(t,d,v,!w);return}}yc(t,a,d,i,r,h,v,T,H)}function W0(t){for(var a=t;;){var i=a.tag;if((i===0||i===11||i===15)&&a.flags&16384&&(i=a.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var r=0;r<i.length;r++){var h=i[r],d=h.getSnapshot;h=h.value;try{if(!be(d(),h))return!1}catch{return!1}}if(i=a.child,a.subtreeFlags&16384&&i!==null)i.return=a,a=i;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ya(t,a,i,r){a&=~Lr,a&=~tn,t.suspendedLanes|=a,t.pingedLanes&=~a,r&&(t.warmLanes|=a),r=t.expirationTimes;for(var h=a;0<h;){var d=31-Se(h),v=1<<d;r[d]=-1,h&=~v}i!==0&&I(t,i,a)}function oc(){return gt&6?!0:(fn(0),!1)}function tr(){if(mt!==null){if(At===0)var t=mt.return;else t=mt,ea=Pa=null,bs(t),Nn=null,fi=0,t=mt;for(;t!==null;)qo(t.alternate,t),t=t.return;mt=null}}function mn(t,a){var i=t.timeoutHandle;i!==Za&&(t.timeoutHandle=Za,_f(i)),i=t.cancelPendingCommit,i!==null&&(t.cancelPendingCommit=null,i()),la=0,tr(),Rt=t,mt=i=Ie(t.current,null),pt=a,At=0,Ee=null,Ta=!1,Bn=z(t,a),Ur=!1,Un=Te=Lr=tn=xa=wt=0,me=pi=null,Yr=!1,a&8&&(a|=a&32);var r=t.entangledLanes;if(r!==0)for(t=t.entanglements,r&=a;0<r;){var h=31-Se(r),d=1<<h;a|=t[h],r&=~d}return ia=a,Qi(),i}function cc(t,a){ft=null,rt.H=gi,a===Rn||a===xl?(a=Nu(),At=3):a===Rr?(a=Nu(),At=4):At=a===Gr?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ee=a,mt===null&&(wt=1,el(t,q(a,t.current)))}function hc(){var t=Ce.current;return t===null?!0:(pt&4194048)===pt?De===null:(pt&62914560)===pt||pt&536870912?t===De:!1}function fc(){var t=rt.H;return rt.H=gi,t===null?gi:t}function dc(){var t=rt.A;return rt.A=Id,t}function cl(){wt=4,Ta||(pt&4194048)!==pt&&Ce.current!==null||(Bn=!0),!(xa&134217727)&&!(tn&134217727)||Rt===null||ya(Rt,pt,Te,!1)}function er(t,a,i){var r=gt;gt|=2;var h=fc(),d=dc();(Rt!==t||pt!==a)&&(Ul=null,mn(t,a)),a=!1;var v=wt;t:do try{if(At!==0&&mt!==null){var T=mt,H=Ee;switch(At){case 8:tr(),v=6;break t;case 3:case 2:case 9:case 6:Ce.current===null&&(a=!0);var w=At;if(At=0,Ee=null,pn(t,T,H,w),i&&Bn){v=0;break t}break;default:w=At,At=0,Ee=null,pn(t,T,H,w)}}I0(),v=wt;break}catch($){cc(t,$)}while(!0);return a&&t.shellSuspendCounter++,ea=Pa=null,gt=r,rt.H=h,rt.A=d,mt===null&&(Rt=null,pt=0,Qi()),v}function I0(){for(;mt!==null;)gc(mt)}function $0(t,a){var i=gt;gt|=2;var r=fc(),h=dc();Rt!==t||pt!==a?(Ul=null,yi=de()+500,mn(t,a)):Bn=z(t,a);t:do try{if(At!==0&&mt!==null){a=mt;var d=Ee;e:switch(At){case 1:At=0,Ee=null,pn(t,a,d,1);break;case 2:case 9:if(Mu(d)){At=0,Ee=null,mc(a);break}a=function(){At!==2&&At!==9||Rt!==t||(At=7),we(t)},d.then(a,a);break t;case 3:At=7;break t;case 4:At=5;break t;case 7:Mu(d)?(At=0,Ee=null,mc(a)):(At=0,Ee=null,pn(t,a,d,7));break;case 5:var v=null;switch(mt.tag){case 26:v=mt.memoizedState;case 5:case 27:var T=mt,H=T.type,w=T.pendingProps;if(v?th(v):Yc(T.stateNode,H,w)){At=0,Ee=null;var $=T.sibling;if($!==null)mt=$;else{var Z=T.return;Z!==null?(mt=Z,hl(Z)):mt=null}break e}}At=0,Ee=null,pn(t,a,d,5);break;case 6:At=0,Ee=null,pn(t,a,d,6);break;case 8:tr(),wt=6;break t;default:throw Error(s(462))}}tf();break}catch(et){cc(t,et)}while(!0);return ea=Pa=null,rt.H=r,rt.A=h,gt=i,mt!==null?0:(Rt=null,pt=0,Qi(),wt)}function tf(){for(;mt!==null&&!qd();)gc(mt)}function gc(t){var a=Uo(t.alternate,t,ia);t.memoizedProps=t.pendingProps,a===null?hl(t):mt=a}function mc(t){var a=t,i=a.alternate;switch(a.tag){case 15:case 0:a=zo(i,a,a.pendingProps,a.type,void 0,pt);break;case 11:a=zo(i,a,a.pendingProps,a.type.render,a.ref,pt);break;case 5:bs(a);default:qo(i,a),a=mt=xc(a,ia),a=Uo(i,a,ia)}t.memoizedProps=t.pendingProps,a===null?hl(t):mt=a}function pn(t,a,i,r){ea=Pa=null,bs(a),Nn=null,fi=0;var h=a.return;try{if(K0(t,h,a,i,pt)){wt=1,el(t,q(i,t.current)),mt=null;return}}catch(d){if(h!==null)throw mt=h,d;wt=1,el(t,q(i,t.current)),mt=null;return}a.flags&32768?(vt||r===1?t=!0:Bn||pt&536870912?t=!1:(Ta=t=!0,(r===2||r===9||r===3||r===6)&&(r=Ce.current,r!==null&&r.tag===13&&(r.flags|=16384))),pc(a,t)):hl(a)}function hl(t){var a=t;do{if(a.flags&32768){pc(a,Ta);return}t=a.return;var i=J0(a.alternate,a,ia);if(i!==null){mt=i;return}if(a=a.sibling,a!==null){mt=a;return}mt=a=t}while(a!==null);wt===0&&(wt=5)}function pc(t,a){do{var i=P0(t.alternate,t);if(i!==null){i.flags&=32767,mt=i;return}if(i=t.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!a&&(t=t.sibling,t!==null)){mt=t;return}mt=t=i}while(t!==null);wt=6,mt=null}function yc(t,a,i,r,h,d,v,T,H){t.cancelPendingCommit=null;do ii();while(Ft!==0);if(gt&6)throw Error(s(327));if(a!==null){if(a===t.current)throw Error(s(177));if(d=a.lanes|a.childLanes,d|=Nr,tt(t,i,d,v,T,H),t===Rt&&(mt=Rt=null,pt=0),Ln=a,Ma=t,la=i,Xr=d,wr=h,gh=r,a.subtreeFlags&10256||a.flags&10256?(t.callbackNode=null,t.callbackPriority=0,lf(br,function(){return Cc(),null})):(t.callbackNode=null,t.callbackPriority=0),r=(a.flags&13878)!==0,a.subtreeFlags&13878||r){r=rt.T,rt.T=null,h=ta(),It(2),v=gt,gt|=4;try{F0(t,a,i)}finally{gt=v,It(h),rt.T=r}}Ft=1,vc(),Sc(),_c()}}function vc(){if(Ft===1){Ft=0;var t=Ma,a=Ln,i=(a.flags&13878)!==0;if(a.subtreeFlags&13878||i){i=rt.T,rt.T=null;var r=ta();It(2);var h=gt;gt|=4;try{Io(a,t),yf(t.containerInfo)}finally{gt=h,It(r),rt.T=i}}t.current=a,Ft=2}}function Sc(){if(Ft===2){Ft=0;var t=Ma,a=Ln,i=(a.flags&8772)!==0;if(a.subtreeFlags&8772||i){i=rt.T,rt.T=null;var r=ta();It(2);var h=gt;gt|=4;try{Po(t,a.alternate,a)}finally{gt=h,It(r),rt.T=i}}Ft=3}}function _c(){if(Ft===4||Ft===3){Ft=0,jd();var t=Ma,a=Ln,i=la,r=gh;a.subtreeFlags&10256||a.flags&10256?Ft=5:(Ft=0,Ln=Ma=null,bc(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(Aa=null),B(i),a=a.stateNode,_e&&typeof _e.onCommitFiberRoot=="function")try{_e.onCommitFiberRoot(ui,a,void 0,(a.current.flags&128)===128)}catch{}if(r!==null){a=rt.T,h=ta(),It(2),rt.T=null;try{for(var d=t.onRecoverableError,v=0;v<r.length;v++){var T=r[v];d(T.value,{componentStack:T.stack})}}finally{rt.T=a,It(h)}}la&3&&ii(),we(t),h=t.pendingLanes,i&261930&&h&42?t===qr?vi++:(vi=0,qr=t):vi=0,ue&&Ad(),fn(0)}}function bc(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,Qn(a)))}function ii(){return vc(),Sc(),_c(),Cc()}function Cc(){if(Ft!==5)return!1;var t=Ma,a=Xr;Xr=0;var i=B(la),r=32>i?32:i;i=rt.T;var h=ta();try{It(r),rt.T=null,r=wr,wr=null;var d=Ma,v=la;if(Ft=0,Ln=Ma=null,la=0,gt&6)throw Error(s(331));var T=gt;if(gt|=4,nc(d.current),tc(d,d.current,v,r),gt=T,fn(0,!1),_e&&typeof _e.onPostCommitFiberRoot=="function")try{_e.onPostCommitFiberRoot(ui,d)}catch{}return!0}finally{It(h),rt.T=i,bc(t,a)}}function Ec(t,a,i){a=q(i,a),a=Gs(t.stateNode,a,2),t=da(t,a,2),t!==null&&(X(t,2),we(t))}function _t(t,a,i){if(t.tag===3)Ec(t,t,i);else for(;a!==null;){if(a.tag===3){Ec(a,t,i);break}else if(a.tag===1){var r=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Aa===null||!Aa.has(r))){t=q(i,t),i=Co(2),r=da(a,i,2),r!==null&&(Eo(i,r,a,t),X(r,2),we(r));break}}a=a.return}}function ar(t,a,i){var r=t.pingCache;if(r===null){r=t.pingCache=new $d;var h=new Set;r.set(a,h)}else h=r.get(a),h===void 0&&(h=new Set,r.set(a,h));h.has(i)||(Ur=!0,h.add(i),t=ef.bind(null,t,a,i),a.then(t,t))}function ef(t,a,i){var r=t.pingCache;r!==null&&r.delete(a),t.pingedLanes|=t.suspendedLanes&i,t.warmLanes&=~i,Rt===t&&(pt&i)===i&&(wt===4||wt===3&&(pt&62914560)===pt&&300>de()-Bl?!(gt&2)&&mn(t,0):Lr|=i,Un===pt&&(Un=0)),we(t)}function Tc(t,a){a===0&&(a=U()),t=qa(t,a),t!==null&&(X(t,a),we(t))}function af(t){var a=t.memoizedState,i=0;a!==null&&(i=a.retryLane),Tc(t,i)}function nf(t,a){var i=0;switch(t.tag){case 31:case 13:var r=t.stateNode,h=t.memoizedState;h!==null&&(i=h.retryLane);break;case 19:r=t.stateNode;break;case 22:r=t.stateNode._retryCache;break;default:throw Error(s(314))}r!==null&&r.delete(a),Tc(t,i)}function lf(t,a){return Sl(t,a)}function sf(t,a,i,r){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ie(t,a){var i=t.alternate;return i===null?(i=n(t.tag,a,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=a,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&65011712,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,a=t.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i.refCleanup=t.refCleanup,i}function xc(t,a){t.flags&=65011714;var i=t.alternate;return i===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,t.type=i.type,a=i.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function fl(t,a,i,r,h,d){var v=0;if(r=t,typeof t=="function")nr(t)&&(v=1);else if(typeof t=="string")v=Le&&Pt?Pc(t,i,ne.current)?26:nh(t)?27:5:Le?Pc(t,i,ne.current)?26:5:Pt&&nh(t)?27:5;else t:switch(t){case dr:return t=n(31,i,a,h),t.elementType=dr,t.lanes=d,t;case vn:return Qa(i.children,h,d,a);case Dc:v=8,h|=24;break;case ur:return t=n(12,i,a,h|2),t.elementType=ur,t.lanes=d,t;case cr:return t=n(13,i,a,h),t.elementType=cr,t.lanes=d,t;case hr:return t=n(19,i,a,h),t.elementType=hr,t.lanes=d,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case va:v=10;break t;case Gc:v=9;break t;case or:v=11;break t;case fr:v=14;break t;case Sa:v=16,r=null;break t}v=29,i=Error(s(130,t===null?"null":typeof t,"")),r=null}return a=n(v,i,a,h),a.elementType=t,a.type=r,a.lanes=d,a}function Qa(t,a,i,r){return t=n(7,t,r,a),t.lanes=i,t}function ir(t,a,i){return t=n(6,t,null,a),t.lanes=i,t}function Ac(t){var a=n(18,null,null,0);return a.stateNode=t,a}function lr(t,a,i){return a=n(4,t.children!==null?t.children:[],t.key,a),a.lanes=i,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}function rf(t,a,i,r,h,d,v,T,H){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Za,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=W(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=W(0),this.hiddenUpdates=W(null),this.identifierPrefix=r,this.onUncaughtError=h,this.onCaughtError=d,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function Mc(t,a,i,r,h,d,v,T,H,w,$,Z){return t=new rf(t,a,i,v,H,w,$,Z,T),a=1,d===!0&&(a|=24),d=n(3,null,null,a),t.current=d,d.stateNode=t,a=rs(),a.refCount++,t.pooledCache=a,a.refCount++,d.memoizedState={element:r,isDehydrated:i,cache:a},hs(d),t}function Rc(t){return t?(t=Cn,t):Cn}function Nc(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=f(a),t=t!==null?g(t):null,t===null?null:li(t.stateNode)}function zc(t,a,i,r,h,d){h=Rc(h),r.context===null?r.context=h:r.pendingContext=h,r=fa(a),r.payload={element:i},d=d===void 0?null:d,d!==null&&(r.callback=d),i=da(t,r,a),i!==null&&(fe(i,t,a),Jn(i,t,a))}function Oc(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<a?i:a}}function sr(t,a){Oc(t,a),(t=t.alternate)&&Oc(t,a)}var dt={},uf=St,ve=z3(),rr=Object.assign,of=Symbol.for("react.element"),dl=Symbol.for("react.transitional.element"),yn=Symbol.for("react.portal"),vn=Symbol.for("react.fragment"),Dc=Symbol.for("react.strict_mode"),ur=Symbol.for("react.profiler"),Gc=Symbol.for("react.consumer"),va=Symbol.for("react.context"),or=Symbol.for("react.forward_ref"),cr=Symbol.for("react.suspense"),hr=Symbol.for("react.suspense_list"),fr=Symbol.for("react.memo"),Sa=Symbol.for("react.lazy"),dr=Symbol.for("react.activity"),cf=Symbol.for("react.memo_cache_sentinel"),Hc=Symbol.iterator,hf=Symbol.for("react.client.reference"),gl=Array.isArray,rt=uf.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ff=e.rendererVersion,df=e.rendererPackageName,Bc=e.extraDevToolsConfig,li=e.getPublicInstance,gf=e.getRootHostContext,mf=e.getChildHostContext,pf=e.prepareForCommit,yf=e.resetAfterCommit,vf=e.createInstance;e.cloneMutableInstance;var gr=e.appendInitialChild,Uc=e.finalizeInitialChildren,ml=e.shouldSetTextContent,Lc=e.createTextInstance;e.cloneMutableTextInstance;var Sf=e.scheduleTimeout,_f=e.cancelTimeout,Za=e.noTimeout,$e=e.isPrimaryRenderer;e.warnsIfNotActing;var re=e.supportsMutation,je=e.supportsPersistence,ue=e.supportsHydration,bf=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var Cf=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var It=e.setCurrentUpdatePriority,ta=e.getCurrentUpdatePriority,Ef=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var Tf=e.shouldAttemptEagerTransition,xf=e.detachDeletedInstance;e.requestPostPaintCallback;var Af=e.maySuspendCommit,Mf=e.maySuspendCommitOnUpdate,mr=e.maySuspendCommitInSyncRender,Yc=e.preloadInstance,Rf=e.startSuspendingCommit,Xc=e.suspendInstance;e.suspendOnActiveViewTransition;var Nf=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var Sn=e.NotPendingTransition,Ja=e.HostTransitionContext,zf=e.resetFormInstance;e.bindToConsole;var Of=e.supportsMicrotasks,Df=e.scheduleMicrotask,si=e.supportsTestSelectors,Gf=e.findFiberRoot,Hf=e.getBoundingRect,Bf=e.getTextContent,ri=e.isHiddenSubtree,Uf=e.matchAccessibilityRole,Lf=e.setFocusIfFocusable,Yf=e.setupIntersectionObserver,Xf=e.appendChild,wf=e.appendChildToContainer,qf=e.commitTextUpdate,jf=e.commitMount,Vf=e.commitUpdate,Kf=e.insertBefore,Qf=e.insertInContainerBefore,Zf=e.removeChild,Jf=e.removeChildFromContainer,wc=e.resetTextContent,Pf=e.hideInstance,Ff=e.hideTextInstance,kf=e.unhideInstance,Wf=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var If=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var $f=e.cloneInstance,qc=e.createContainerChildSet,jc=e.appendChildToContainerChildSet,td=e.finalizeContainerChildren,Vc=e.replaceContainerChildren,Kc=e.cloneHiddenInstance,Qc=e.cloneHiddenTextInstance,pr=e.isSuspenseInstancePending,yr=e.isSuspenseInstanceFallback,ed=e.getSuspenseInstanceFallbackErrorDetails,ad=e.registerSuspenseInstanceRetry,nd=e.canHydrateFormStateMarker,id=e.isFormStateMarkerMatching,Zc=e.getNextHydratableSibling,ld=e.getNextHydratableSiblingAfterSingleton,sd=e.getFirstHydratableChild,rd=e.getFirstHydratableChildWithinContainer,ud=e.getFirstHydratableChildWithinActivityInstance,od=e.getFirstHydratableChildWithinSuspenseInstance,cd=e.getFirstHydratableChildWithinSingleton,hd=e.canHydrateInstance,fd=e.canHydrateTextInstance,dd=e.canHydrateActivityInstance,gd=e.canHydrateSuspenseInstance,md=e.hydrateInstance,pd=e.hydrateTextInstance,yd=e.hydrateActivityInstance,vd=e.hydrateSuspenseInstance,Sd=e.getNextHydratableInstanceAfterActivityInstance,_d=e.getNextHydratableInstanceAfterSuspenseInstance,bd=e.commitHydratedInstance,Cd=e.commitHydratedContainer,Ed=e.commitHydratedActivityInstance,Td=e.commitHydratedSuspenseInstance,xd=e.finalizeHydratedChildren,Ad=e.flushHydrationEvents;e.clearActivityBoundary;var Md=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var Rd=e.clearSuspenseBoundaryFromContainer,Nd=e.hideDehydratedBoundary,zd=e.unhideDehydratedBoundary,Jc=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Od=e.validateHydratableInstance,Dd=e.validateHydratableTextInstance,Le=e.supportsResources,Pc=e.isHostHoistableType,vr=e.getHoistableRoot,Fc=e.getResource,kc=e.acquireResource,Wc=e.releaseResource,Gd=e.hydrateHoistable,Ic=e.mountHoistable,$c=e.unmountHoistable,Hd=e.createHoistableInstance,Bd=e.prepareToCommitHoistables,Ud=e.mayResourceSuspendCommit,th=e.preloadResource,Ld=e.suspendResource,Pt=e.supportsSingletons,eh=e.resolveSingletonInstance,Yd=e.acquireSingletonInstance,ah=e.releaseSingletonInstance,nh=e.isHostSingletonType,_n=e.isSingletonScope,Sr=[],bn=-1,Cn={},Se=Math.clz32?Math.clz32:R,Xd=Math.log,wd=Math.LN2,pl=256,yl=262144,vl=4194304,Sl=ve.unstable_scheduleCallback,_r=ve.unstable_cancelCallback,qd=ve.unstable_shouldYield,jd=ve.unstable_requestPaint,de=ve.unstable_now,ih=ve.unstable_ImmediatePriority,Vd=ve.unstable_UserBlockingPriority,br=ve.unstable_NormalPriority,Kd=ve.unstable_IdlePriority,Qd=ve.log,Zd=ve.unstable_setDisableYieldValue,ui=null,_e=null,be=typeof Object.is=="function"?Object.is:at,lh=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Jd=Object.prototype.hasOwnProperty,Cr,sh,Er=!1,rh=new WeakMap,En=[],Tn=0,_l=null,oi=0,Re=[],Ne=0,_a=null,Ve=1,Ke="",ne=p(null),ci=p(null),ba=p(null),bl=p(null),ie=null,Bt=null,vt=!1,Ca=null,ze=!1,Tr=Error(s(519)),Cl=p(null),Pa=null,ea=null,Pd=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(i,r){t.push(r)}};this.abort=function(){a.aborted=!0,t.forEach(function(i){return i()})}},Fd=ve.unstable_scheduleCallback,kd=ve.unstable_NormalPriority,Ut={$$typeof:va,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},El=null,xn=null,xr=!1,Tl=!1,Ar=!1,Fa=0,hi=null,Mr=0,An=0,Mn=null,uh=rt.S;rt.S=function(t,a){dh=de(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&U0(t,a),uh!==null&&uh(t,a)};var ka=p(null),Rn=Error(s(460)),Rr=Error(s(474)),xl=Error(s(542)),Al={then:function(){}},Wa=null,Nn=null,fi=0,Ia=Ou(!0),oh=Ou(!1),Oe=[],zn=0,Nr=0,Ea=!1,zr=!1,On=p(null),Ml=p(0),Ce=p(null),De=null,jt=p(0),aa=0,ft=null,Mt=null,Vt=null,Rl=!1,Dn=!1,$a=!1,Nl=0,di=0,Gn=null,Wd=0,gi={readContext:ee,use:ki,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useLayoutEffect:Xt,useInsertionEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useSyncExternalStore:Xt,useId:Xt,useHostTransitionStatus:Xt,useFormState:Xt,useActionState:Xt,useOptimistic:Xt,useMemoCache:Xt,useCacheRefresh:Xt};gi.useEffectEvent=Xt;var ch={readContext:ee,use:ki,useCallback:function(t,a){return oe().memoizedState=[t,a===void 0?null:a],t},useContext:ee,useEffect:ao,useImperativeHandle:function(t,a,i){i=i!=null?i.concat([t]):null,Ii(4194308,4,so.bind(null,a,t),i)},useLayoutEffect:function(t,a){return Ii(4194308,4,t,a)},useInsertionEffect:function(t,a){Ii(4,2,t,a)},useMemo:function(t,a){var i=oe();a=a===void 0?null:a;var r=t();if($a){V(!0);try{t()}finally{V(!1)}}return i.memoizedState=[r,a],r},useReducer:function(t,a,i){var r=oe();if(i!==void 0){var h=i(a);if($a){V(!0);try{i(a)}finally{V(!1)}}}else h=a;return r.memoizedState=r.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},r.queue=t,t=t.dispatch=V0.bind(null,ft,t),[r.memoizedState,t]},useRef:function(t){var a=oe();return t={current:t},a.memoizedState=t},useState:function(t){t=xs(t);var a=t.queue,i=po.bind(null,ft,a);return a.dispatch=i,[t.memoizedState,i]},useDebugValue:Rs,useDeferredValue:function(t,a){var i=oe();return Ns(i,t,a)},useTransition:function(){var t=xs(!1);return t=ho.bind(null,ft,t.queue,!0,!1),oe().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,i){var r=ft,h=oe();if(vt){if(i===void 0)throw Error(s(407));i=i()}else{if(i=a(),Rt===null)throw Error(s(349));pt&127||wu(r,a,i)}h.memoizedState=i;var d={value:i,getSnapshot:a};return h.queue=d,ao(ju.bind(null,r,d,t),[t]),r.flags|=2048,dn(9,{destroy:void 0},qu.bind(null,r,d,i,a),null),i},useId:function(){var t=oe(),a=Rt.identifierPrefix;if(vt){var i=Ke,r=Ve;i=(r&~(1<<32-Se(r)-1)).toString(32)+i,a="_"+a+"R_"+i,i=Nl++,0<i&&(a+="H"+i.toString(32)),a+="_"}else i=Wd++,a="_"+a+"r_"+i.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:zs,useFormState:Wu,useActionState:Wu,useOptimistic:function(t){var a=oe();a.memoizedState=a.baseState=t;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=i,a=Os.bind(null,ft,!0,i),i.dispatch=a,[t,a]},useMemoCache:Cs,useCacheRefresh:function(){return oe().memoizedState=j0.bind(null,ft)},useEffectEvent:function(t){var a=oe(),i={impl:t};return a.memoizedState=i,function(){if(gt&2)throw Error(s(440));return i.impl.apply(void 0,arguments)}}},Or={readContext:ee,use:ki,useCallback:uo,useContext:ee,useEffect:Ms,useImperativeHandle:ro,useInsertionEffect:io,useLayoutEffect:lo,useMemo:oo,useReducer:Wi,useRef:eo,useState:function(){return Wi(Pe)},useDebugValue:Rs,useDeferredValue:function(t,a){var i=qt();return co(i,Mt.memoizedState,t,a)},useTransition:function(){var t=Wi(Pe)[0],a=qt().memoizedState;return[typeof t=="boolean"?t:kn(t),a]},useSyncExternalStore:Xu,useId:go,useHostTransitionStatus:zs,useFormState:Iu,useActionState:Iu,useOptimistic:function(t,a){var i=qt();return Qu(i,Mt,t,a)},useMemoCache:Cs,useCacheRefresh:mo};Or.useEffectEvent=no;var hh={readContext:ee,use:ki,useCallback:uo,useContext:ee,useEffect:Ms,useImperativeHandle:ro,useInsertionEffect:io,useLayoutEffect:lo,useMemo:oo,useReducer:Ts,useRef:eo,useState:function(){return Ts(Pe)},useDebugValue:Rs,useDeferredValue:function(t,a){var i=qt();return Mt===null?Ns(i,t,a):co(i,Mt.memoizedState,t,a)},useTransition:function(){var t=Ts(Pe)[0],a=qt().memoizedState;return[typeof t=="boolean"?t:kn(t),a]},useSyncExternalStore:Xu,useId:go,useHostTransitionStatus:zs,useFormState:to,useActionState:to,useOptimistic:function(t,a){var i=qt();return Mt!==null?Qu(i,Mt,t,a):(i.baseState=t,[t,i.queue.dispatch])},useMemoCache:Cs,useCacheRefresh:mo};hh.useEffectEvent=no;var Dr={enqueueSetState:function(t,a,i){t=t._reactInternals;var r=ye(),h=fa(r);h.payload=a,i!=null&&(h.callback=i),a=da(t,h,r),a!==null&&(fe(a,t,r),Jn(a,t,r))},enqueueReplaceState:function(t,a,i){t=t._reactInternals;var r=ye(),h=fa(r);h.tag=1,h.payload=a,i!=null&&(h.callback=i),a=da(t,h,r),a!==null&&(fe(a,t,r),Jn(a,t,r))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var i=ye(),r=fa(i);r.tag=2,a!=null&&(r.callback=a),a=da(t,r,i),a!==null&&(fe(a,t,i),Jn(a,t,i))}},Gr=Error(s(461)),Kt=!1,Hr={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},na=!1,Qt=!1,Br=!1,fh=typeof WeakSet=="function"?WeakSet:Set,$t=null,Zt=null,ge=!1,Ye=null,Hn=8192,Id={getCacheForType:function(t){var a=ee(Ut),i=a.data.get(t);return i===void 0&&(i=t(),a.data.set(t,i)),i},cacheSignal:function(){return ee(Ut).controller.signal}},zl=0,Ol=1,Dl=2,Gl=3,Hl=4;if(typeof Symbol=="function"&&Symbol.for){var mi=Symbol.for;zl=mi("selector.component"),Ol=mi("selector.has_pseudo_class"),Dl=mi("selector.role"),Gl=mi("selector.test_id"),Hl=mi("selector.text")}var $d=typeof WeakMap=="function"?WeakMap:Map,gt=0,Rt=null,mt=null,pt=0,At=0,Ee=null,Ta=!1,Bn=!1,Ur=!1,ia=0,wt=0,xa=0,tn=0,Lr=0,Te=0,Un=0,pi=null,me=null,Yr=!1,Bl=0,dh=0,yi=1/0,Ul=null,Aa=null,Ft=0,Ma=null,Ln=null,la=0,Xr=0,wr=null,gh=null,vi=0,qr=null;return dt.attemptContinuousHydration=function(t){if(t.tag===13||t.tag===31){var a=qa(t,67108864);a!==null&&fe(a,t,67108864),sr(t,67108864)}},dt.attemptHydrationAtCurrentPriority=function(t){if(t.tag===13||t.tag===31){var a=ye();a=ct(a);var i=qa(t,a);i!==null&&fe(i,t,a),sr(t,a)}},dt.attemptSynchronousHydration=function(t){switch(t.tag){case 3:if(t=t.stateNode,t.current.memoizedState.isDehydrated){var a=N(t.pendingLanes);if(a!==0){for(t.pendingLanes|=2,t.entangledLanes|=2;a;){var i=1<<31-Se(a);t.entanglements[1]|=i,a&=~i}we(t),!(gt&6)&&(yi=de()+500,fn(0))}}break;case 31:case 13:a=qa(t,2),a!==null&&fe(a,t,2),oc(),sr(t,2)}},dt.batchedUpdates=function(t,a){return t(a)},dt.createComponentSelector=function(t){return{$$typeof:zl,value:t}},dt.createContainer=function(t,a,i,r,h,d,v,T,H,w){return Mc(t,a,!1,null,i,r,d,null,v,T,H,w)},dt.createHasPseudoClassSelector=function(t){return{$$typeof:Ol,value:t}},dt.createHydrationContainer=function(t,a,i,r,h,d,v,T,H,w,$,Z,et,ht){return t=Mc(i,r,!0,t,h,d,T,ht,H,w,$,Z),t.context=Rc(null),i=t.current,r=ye(),r=ct(r),h=fa(r),h.callback=a??null,da(i,h,r),a=r,t.current.lanes=a,X(t,a),we(t),t},dt.createPortal=function(t,a,i){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yn,key:r==null?null:""+r,children:t,containerInfo:a,implementation:i}},dt.createRoleSelector=function(t){return{$$typeof:Dl,value:t}},dt.createTestNameSelector=function(t){return{$$typeof:Gl,value:t}},dt.createTextSelector=function(t){return{$$typeof:Hl,value:t}},dt.defaultOnCaughtError=function(t){console.error(t)},dt.defaultOnRecoverableError=function(t){lh(t)},dt.defaultOnUncaughtError=function(t){lh(t)},dt.deferredUpdates=function(t){var a=rt.T,i=ta();try{return It(32),rt.T=null,t()}finally{It(i),rt.T=a}},dt.discreteUpdates=function(t,a,i,r,h){var d=rt.T,v=ta();try{return It(2),rt.T=null,t(a,i,r,h)}finally{It(v),rt.T=d,gt===0&&(yi=de()+500)}},dt.findAllNodes=$s,dt.findBoundingRects=function(t,a){if(!si)throw Error(s(363));a=$s(t,a),t=[];for(var i=0;i<a.length;i++)t.push(Hf(a[i]));for(a=t.length-1;0<a;a--){i=t[a];for(var r=i.x,h=r+i.width,d=i.y,v=d+i.height,T=a-1;0<=T;T--)if(a!==T){var H=t[T],w=H.x,$=w+H.width,Z=H.y,et=Z+H.height;if(r>=w&&d>=Z&&h<=$&&v<=et){t.splice(a,1);break}else if(r!==w||i.width!==H.width||et<d||Z>v){if(!(d!==Z||i.height!==H.height||$<r||w>h)){w>r&&(H.width+=w-r,H.x=r),$<h&&(H.width=h-w),t.splice(a,1);break}}else{Z>d&&(H.height+=Z-d,H.y=d),et<v&&(H.height=v-Z),t.splice(a,1);break}}}return t},dt.findHostInstance=Nc,dt.findHostInstanceWithNoPortals=function(t){return t=f(t),t=t!==null?m(t):null,t===null?null:li(t.stateNode)},dt.findHostInstanceWithWarning=function(t){return Nc(t)},dt.flushPassiveEffects=ii,dt.flushSyncFromReconciler=function(t){var a=gt;gt|=1;var i=rt.T,r=ta();try{if(It(2),rt.T=null,t)return t()}finally{It(r),rt.T=i,gt=a,!(gt&6)&&fn(0)}},dt.flushSyncWork=oc,dt.focusWithin=function(t,a){if(!si)throw Error(s(363));for(t=ks(t),a=lc(t,a),a=Array.from(a),t=0;t<a.length;){var i=a[t++],r=i.tag;if(!ri(i)){if((r===5||r===26||r===27)&&Lf(i.stateNode))return!0;for(i=i.child;i!==null;)a.push(i),i=i.sibling}}return!1},dt.getFindAllNodesFailureDescription=function(t,a){if(!si)throw Error(s(363));var i=0,r=[];t=[ks(t),0];for(var h=0;h<t.length;){var d=t[h++],v=d.tag,T=t[h++],H=a[T];if((v!==5&&v!==26&&v!==27||!ri(d))&&(Ws(d,H)&&(r.push(Is(H)),T++,T>i&&(i=T)),T<a.length))for(d=d.child;d!==null;)t.push(d,T),d=d.sibling}if(i<a.length){for(t=[];i<a.length;i++)t.push(Is(a[i]));return`findAllNodes was able to match part of the selector:
  `+(r.join(" > ")+`

No matching component was found for:
  `)+t.join(" > ")}return null},dt.getPublicRootInstance=function(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 27:case 5:return li(t.child.stateNode);default:return t.child.stateNode}},dt.injectIntoDevTools=function(){var t={bundleType:0,version:ff,rendererPackageName:df,currentDispatcherRef:rt,reconcilerVersion:"19.2.0"};if(Bc!==null&&(t.rendererConfig=Bc),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")t=!1;else{var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled||!a.supportsFiber)t=!0;else{try{ui=a.inject(t),_e=a}catch{}t=!!a.checkDCE}}return t},dt.isAlreadyRendering=function(){return(gt&6)!==0},dt.observeVisibleRects=function(t,a,i,r){if(!si)throw Error(s(363));t=$s(t,a);var h=Yf(t,i,r).disconnect;return{disconnect:function(){h()}}},dt.shouldError=function(){return null},dt.shouldSuspend=function(){return!1},dt.startHostTransition=function(t,a,i,r){if(t.tag!==5)throw Error(s(476));var h=fo(t).queue;ho(t,h,a,Sn,i===null?l:function(){var d=fo(t);return d.next===null&&(d=t.alternate.memoizedState),Wn(t,d.next.queue,{},ye()),i(r)})},dt.updateContainer=function(t,a,i,r){var h=a.current,d=ye();return zc(h,d,t,a,i,r),d},dt.updateContainerSync=function(t,a,i,r){return zc(a.current,2,t,a,i,r),2},dt},u.exports.default=u.exports,Object.defineProperty(u.exports,"__esModule",{value:!0})})(x0);var O3=x0.exports;T0.exports=O3;var D3=T0.exports;const G3=e1(D3);var A0={exports:{}},Ua={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Ua.ConcurrentRoot=1;Ua.ContinuousEventPriority=8;Ua.DefaultEventPriority=32;Ua.DiscreteEventPriority=2;Ua.IdleEventPriority=268435456;Ua.LegacyRoot=0;Ua.NoEventPriority=0;A0.exports=Ua;var es=A0.exports;const Vh={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let Kh=!1,Qh=!1;const Wl=".react-konva-event",H3=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,B3=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,U3={};function as(u,e,n=U3){if(!Kh&&"zIndex"in e&&(console.warn(B3),Kh=!0),!Qh&&e.draggable){var l=e.x!==void 0||e.y!==void 0,s=e.onDragEnd||e.onDragMove;l&&!s&&(console.warn(H3),Qh=!0)}for(var o in n)if(!Vh[o]){var c=o.slice(0,2)==="on",f=n[o]!==e[o];if(c&&f){var g=o.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),u.off(g,n[o])}var m=!e.hasOwnProperty(o);m&&u.setAttr(o,void 0)}var y=e._useStrictMode,S={},p=!1;const C={};for(var o in e)if(!Vh[o]){var c=o.slice(0,2)==="on",_=n[o]!==e[o];if(c&&_){var g=o.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),e[o]&&(C[g]=e[o])}!c&&(e[o]!==n[o]||y&&e[o]!==u.getAttr(o))&&(p=!0,S[o]=e[o])}p&&(u.setAttrs(S),La(u));for(var g in C)u.off(g+Wl),u.on(g+Wl,C[g])}function La(u){if(!k.autoDrawEnabled){var e=u.getLayer()||u.getStage();e&&e.batchDraw()}}var M0={exports:{}},R0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(u){function e(E,Y){var D=E.length;E.push(Y);t:for(;0<D;){var q=D-1>>>1,F=E[q];if(0<s(F,Y))E[q]=Y,E[D]=F,D=q;else break t}}function n(E){return E.length===0?null:E[0]}function l(E){if(E.length===0)return null;var Y=E[0],D=E.pop();if(D!==Y){E[0]=D;t:for(var q=0,F=E.length,st=F>>>1;q<st;){var it=2*(q+1)-1,Et=E[it],xt=it+1,Gt=E[xt];if(0>s(Et,D))xt<F&&0>s(Gt,Et)?(E[q]=Gt,E[xt]=D,q=xt):(E[q]=Et,E[it]=D,q=it);else if(xt<F&&0>s(Gt,D))E[q]=Gt,E[xt]=D,q=xt;else break t}}return Y}function s(E,Y){var D=E.sortIndex-Y.sortIndex;return D!==0?D:E.id-Y.id}if(u.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;u.unstable_now=function(){return o.now()}}else{var c=Date,f=c.now();u.unstable_now=function(){return c.now()-f}}var g=[],m=[],y=1,S=null,p=3,C=!1,_=!1,R=!1,N=!1,A=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function U(E){for(var Y=n(m);Y!==null;){if(Y.callback===null)l(m);else if(Y.startTime<=E)l(m),Y.sortIndex=Y.expirationTime,e(g,Y);else break;Y=n(m)}}function W(E){if(R=!1,U(E),!_)if(n(g)!==null)_=!0,X||(X=!0,B());else{var Y=n(m);Y!==null&&K(W,Y.startTime-E)}}var X=!1,tt=-1,I=5,nt=-1;function lt(){return N?!0:!(u.unstable_now()-nt<I)}function ct(){if(N=!1,X){var E=u.unstable_now();nt=E;var Y=!0;try{t:{_=!1,R&&(R=!1,z(tt),tt=-1),C=!0;var D=p;try{e:{for(U(E),S=n(g);S!==null&&!(S.expirationTime>E&&lt());){var q=S.callback;if(typeof q=="function"){S.callback=null,p=S.priorityLevel;var F=q(S.expirationTime<=E);if(E=u.unstable_now(),typeof F=="function"){S.callback=F,U(E),Y=!0;break e}S===n(g)&&l(g),U(E)}else l(g);S=n(g)}if(S!==null)Y=!0;else{var st=n(m);st!==null&&K(W,st.startTime-E),Y=!1}}break t}finally{S=null,p=D,C=!1}Y=void 0}}finally{Y?B():X=!1}}}var B;if(typeof L=="function")B=function(){L(ct)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,at=V.port2;V.port1.onmessage=ct,B=function(){at.postMessage(null)}}else B=function(){A(ct,0)};function K(E,Y){tt=A(function(){E(u.unstable_now())},Y)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(E){E.callback=null},u.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<E?Math.floor(1e3/E):5},u.unstable_getCurrentPriorityLevel=function(){return p},u.unstable_next=function(E){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var D=p;p=Y;try{return E()}finally{p=D}},u.unstable_requestPaint=function(){N=!0},u.unstable_runWithPriority=function(E,Y){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var D=p;p=E;try{return Y()}finally{p=D}},u.unstable_scheduleCallback=function(E,Y,D){var q=u.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?q+D:q):D=q,E){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=D+F,E={id:y++,callback:Y,priorityLevel:E,startTime:D,expirationTime:F,sortIndex:-1},D>q?(E.sortIndex=D,e(m,E),n(g)===null&&E===n(m)&&(R?(z(tt),tt=-1):R=!0,K(W,D-q))):(E.sortIndex=F,e(g,E),_||C||(_=!0,X||(X=!0,B()))),E},u.unstable_shouldYield=lt,u.unstable_wrapCallback=function(E){var Y=p;return function(){var D=p;p=Y;try{return E.apply(this,arguments)}finally{p=D}}}})(R0);M0.exports=R0;var Ir=M0.exports;const N0={},L3={};jn.Node.prototype._applyProps=as;let z0=es.DefaultEventPriority;function Y3(u,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}u.add(e),La(u)}function X3(u,e,n){let l=jn[u];l||(console.error(`Konva has no node with the type ${u}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${u}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),l=jn.Group);const s={},o={};for(var c in e)if(c!=="ref"){var f=c.slice(0,2)==="on";f?o[c]=e[c]:s[c]=e[c]}const g=new l(s);return as(g,o),g}function w3(u,e,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${u}"`)}function q3(u,e,n){return!1}function j3(u){return u}function V3(){return null}function K3(){return null}function Q3(u,e,n,l){return L3}function Z3(){}function J3(u){}function P3(u,e){return!1}function F3(){return N0}function k3(){return N0}const W3=setTimeout,I3=clearTimeout,$3=!0,t5=u=>{u()},e5=-1;function a5(u,e){return!1}const n5=!1,i5=!1,l5=!0,s5=!1,r5=!1;function u5(u,e){e.parent===u?e.moveToTop():u.add(e),La(u)}function o5(u,e){e.parent===u?e.moveToTop():u.add(e),La(u)}function O0(u,e,n){e._remove(),u.add(e),e.setZIndex(n.getZIndex()),La(u)}function c5(u,e,n){O0(u,e,n)}function h5(u,e){e.destroy(),e.off(Wl),La(u)}function f5(u,e){e.destroy(),e.off(Wl),La(u)}function d5(u,e,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function g5(u,e,n){}function m5(u,e,n,l){as(u,l,n)}function p5(u){u.hide(),La(u)}function y5(u){}function v5(u,e){(e.visible==null||e.visible)&&u.show()}function S5(u,e){}function _5(u){}function b5(){}function C5(){return null}function E5(){}function T5(){}function x5(){return es.DefaultEventPriority}function A5(){}function M5(){return null}function R5(u){z0=u}function N5(){return z0}function z5(){return es.DiscreteEventPriority}function O5(){return!1}function D5(){}function G5(){return null}function H5(){return-1.1}function B5(){}function U5(){return!1}function L5(){return!0}function Y5(){}function X5(){}function w5(){return null}const q5=null,j5=kt.createContext(null);function V5(){}const K5=Object.freeze(Object.defineProperty({__proto__:null,HostTransitionContext:j5,NotPendingTransition:q5,afterActiveInstanceBlur:T5,appendChild:u5,appendChildToContainer:o5,appendInitialChild:Y3,beforeActiveInstanceBlur:E5,cancelTimeout:I3,clearContainer:_5,commitMount:g5,commitTextUpdate:d5,commitUpdate:m5,createInstance:X3,createTextInstance:w3,detachDeletedInstance:b5,finalizeInitialChildren:q3,getChildHostContext:k3,getCurrentEventPriority:x5,getCurrentUpdatePriority:N5,getInstanceFromNode:C5,getInstanceFromScope:M5,getPublicInstance:j3,getRootHostContext:F3,hideInstance:p5,hideTextInstance:y5,idlePriority:Ir.unstable_IdlePriority,insertBefore:O0,insertInContainerBefore:c5,isPrimaryRenderer:n5,maySuspendCommit:U5,noTimeout:e5,now:Ir.unstable_now,preloadInstance:L5,prepareForCommit:V3,preparePortalMount:K3,prepareScopeUpdate:A5,prepareUpdate:Q3,removeChild:h5,removeChildFromContainer:f5,requestPostPaintCallback:B5,resetAfterCommit:Z3,resetFormInstance:V5,resetTextContent:J3,resolveEventTimeStamp:H5,resolveEventType:G5,resolveUpdatePriority:z5,run:Ir.unstable_runWithPriority,scheduleMicrotask:t5,scheduleTimeout:W3,setCurrentUpdatePriority:R5,shouldAttemptEagerTransition:O5,shouldDeprioritizeSubtree:P3,shouldSetTextContent:a5,startSuspendingCommit:Y5,supportsHydration:r5,supportsMicrotasks:$3,supportsMutation:l5,supportsPersistence:s5,suspendInstance:X5,trackSchedulerEvent:D5,unhideInstance:v5,unhideTextInstance:S5,waitForCommitToBeReady:w5,warnsIfNotActing:i5},Symbol.toStringTag,{value:"Module"}));function D0(u,e,n){if(!u)return;if(n(u)===!0)return u;let l=u.child;for(;l;){const s=D0(l,e,n);if(s)return s;l=l.sibling}}function G0(u){try{return Object.defineProperties(u,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return u}}const pu=G0(St.createContext(null));class H0 extends St.Component{render(){return St.createElement(pu.Provider,{value:this._reactInternals},this.props.children)}}function Q5(){const u=St.useContext(pu);if(u===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=St.useId();return St.useMemo(()=>{for(const n of[u,u==null?void 0:u.alternate]){if(!n)continue;const l=D0(n,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(l)return l}},[u,e])}const Z5=Symbol.for("react.context"),J5=u=>u!==null&&typeof u=="object"&&"$$typeof"in u&&u.$$typeof===Z5;function P5(){const u=Q5(),[e]=St.useState(()=>new Map);e.clear();let n=u;for(;n;){const l=n.type;J5(l)&&l!==pu&&!e.has(l)&&e.set(l,St.use(G0(l))),n=n.return}return e}function F5(){const u=P5();return St.useMemo(()=>Array.from(u.keys()).reduce((e,n)=>l=>St.createElement(e,null,St.createElement(n.Provider,{...l,value:u.get(n)})),e=>St.createElement(H0,{...e})),[u])}if(kt.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function k5(u){const e=kt.useRef({});return kt.useLayoutEffect(()=>{e.current=u}),kt.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const W5=()=>{const u=kt.useRef(0);return kt.useMemo(()=>{u.current++},[]),u.current>1},I5=u=>{const e=kt.useRef(null),n=kt.useRef(null),l=kt.useRef(null),s=k5(u),o=F5(),c=kt.useRef(null),f=y=>{const{forwardedRef:S}=u;S&&(typeof S=="function"?S(y):S.current=y)},g=W5(),m=()=>{var y;f(null),Jl.updateContainer(null,l.current,null),(y=n.current)==null||y.destroy(),n.current=null};return kt.useLayoutEffect(()=>(c.current&&(clearTimeout(c.current),c.current=null),n.current?f(n.current):(n.current=new jn.Stage({width:u.width,height:u.height,container:e.current}),f(n.current),l.current=Jl.createContainer(n.current,es.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),Jl.updateContainer(kt.createElement(o,{},u.children),l.current,null,()=>{})),()=>{g?c.current=setTimeout(m,0):m()}),[]),kt.useLayoutEffect(()=>{f(n.current),as(n.current,u,s),Jl.updateContainer(kt.createElement(o,{},u.children),l.current,null)}),kt.createElement("div",{ref:e,id:u.id,accessKey:u.accessKey,className:u.className,role:u.role,style:u.style,tabIndex:u.tabIndex,title:u.title})},$5="Layer",t4="Rect",e4="Ellipse",Zh="Line",a4="Text",n4="Arrow",Jl=G3(K5),i4=kt.forwardRef((u,e)=>kt.createElement(H0,{},kt.createElement(I5,{...u,forwardedRef:e}))),he={blue:"#3b82f6",red:"#ef4444",green:"#22c55e",yellow:"#fbbf24",orange:"#f97316",purple:"#a855f7",pink:"#ec4899",cyan:"#06b6d4",black:"#1e293b",white:"#ffffff",gray:"#64748b"},l4=[{type:"function",name:"draw_shape",description:"",parameters:{type:"object",properties:{shape:{type:"string",enum:["rect","ellipse","diamond"],description:""},x:{type:"number",description:"X"},y:{type:"number",description:"Y"},width:{type:"number",description:"",default:150},height:{type:"number",description:"",default:80},color:{type:"string",description:": blue/red/green/yellow/purple/cyan",default:"blue"},label:{type:"string",description:""}},required:["shape","x","y"]}},{type:"function",name:"draw_text",description:"",parameters:{type:"object",properties:{text:{type:"string",description:""},x:{type:"number",description:"X"},y:{type:"number",description:"Y"},fontSize:{type:"number",description:"",default:20},color:{type:"string",description:"",default:"black"}},required:["text","x","y"]}},{type:"function",name:"draw_arrow",description:"",parameters:{type:"object",properties:{fromX:{type:"number",description:"X"},fromY:{type:"number",description:"Y"},toX:{type:"number",description:"X"},toY:{type:"number",description:"Y"},color:{type:"string",description:"",default:"gray"}},required:["fromX","fromY","toX","toY"]}},{type:"function",name:"draw_flowchart",description:"",parameters:{type:"object",properties:{title:{type:"string",description:""},steps:{type:"array",items:{type:"object",properties:{id:{type:"string"},label:{type:"string"},type:{type:"string",enum:["start","end","process","decision"]}}},description:""},connections:{type:"array",items:{type:"object",properties:{from:{type:"string"},to:{type:"string"},label:{type:"string"}}},description:""}},required:["steps","connections"]}},{type:"function",name:"draw_architecture",description:"/",parameters:{type:"object",properties:{title:{type:"string",description:""},layers:{type:"array",items:{type:"object",properties:{name:{type:"string"},components:{type:"array",items:{type:"string"}}}},description:""}},required:["layers"]}},{type:"function",name:"clear_canvas",description:"",parameters:{type:"object",properties:{}}}],s4=` Cecelia


- draw_shape: 
- draw_text: 
- draw_arrow: 
- draw_flowchart: 
- draw_architecture: /
- clear_canvas: 


1. ""  draw_flowchart
2. ""  draw_architecture
3.    draw_shape
4. (0,0) 1200x700
5. `;function m4(){const[u,e]=St.useState([]),[n,l]=St.useState({width:1200,height:700}),[s,o]=St.useState(!1),[c,f]=St.useState(!1),[g,m]=St.useState(""),[y,S]=St.useState(""),p=St.useRef(null),C=St.useRef(null),_=St.useRef(null),R=St.useRef(null),N=St.useRef(null);St.useEffect(()=>{const B=()=>{p.current&&l({width:p.current.offsetWidth,height:p.current.offsetHeight})};return B(),window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]);const A=St.useCallback(B=>{e(V=>[...V,{...B,id:B.id||`s-${Date.now()}-${Math.random()}`}])},[]),z=St.useCallback(B=>{const{shape:V,x:at,y:K,width:E=150,height:Y=80,color:D="blue",label:q}=B,F=he[D]||he.blue,st=`shape-${Date.now()}`;return A({id:st,type:V,x:Number(at),y:Number(K),width:Number(E),height:Number(Y),fill:F}),q&&A({id:`${st}-label`,type:"text",x:Number(at)+Number(E)/2,y:Number(K)+Number(Y)/2,text:String(q),fontSize:14,fill:"#fff"}),{success:!0}},[A]),L=St.useCallback(B=>{const{text:V,x:at,y:K,fontSize:E=20,color:Y="black"}=B;return A({id:`text-${Date.now()}`,type:"text",x:Number(at),y:Number(K),text:String(V),fontSize:Number(E),fill:he[Y]||he.black}),{success:!0}},[A]),U=St.useCallback(B=>{const{fromX:V,fromY:at,toX:K,toY:E,color:Y="gray"}=B;return A({id:`arrow-${Date.now()}`,type:"arrow",x:0,y:0,points:[Number(V),Number(at),Number(K),Number(E)],stroke:he[Y]||he.gray}),{success:!0}},[A]),W=St.useCallback(B=>{const{title:V,steps:at=[],connections:K=[]}=B,E=140,Y=50,D=100,q=80,F=100;V&&A({id:"title",type:"text",x:D,y:30,text:V,fontSize:24,fill:he.black});const st=new Map;return at.forEach((it,Et)=>{const xt=D,Gt=q+Et*F;st.set(it.id,{x:xt,y:Gt});const ca=it.type==="start"?he.green:it.type==="end"?he.red:it.type==="decision"?he.yellow:he.blue;A({id:`node-${it.id}`,type:it.type==="decision"?"diamond":it.type==="start"||it.type==="end"?"ellipse":"rect",x:xt,y:Gt,width:E,height:Y,fill:ca}),A({id:`label-${it.id}`,type:"text",x:xt+E/2,y:Gt+Y/2,text:it.label,fontSize:13,fill:"#fff"})}),K.forEach((it,Et)=>{const xt=st.get(it.from),Gt=st.get(it.to);xt&&Gt&&A({id:`conn-${Et}`,type:"arrow",x:0,y:0,points:[xt.x+E/2,xt.y+Y,Gt.x+E/2,Gt.y],stroke:he.gray})}),{success:!0,nodes:at.length}},[A]),X=St.useCallback(B=>{const{title:V,layers:at=[]}=B,K=60,E=80,Y=120,D=40,q=20;return V&&A({id:"arch-title",type:"text",x:50,y:20,text:V,fontSize:22,fill:he.black}),at.forEach((F,st)=>{const it=K+st*(E+30);A({id:`layer-${st}`,type:"text",x:50,y:it+10,text:F.name,fontSize:16,fill:he.gray}),F.components.forEach((Et,xt)=>{const Gt=50+xt*(Y+q);A({id:`comp-${st}-${xt}`,type:"rect",x:Gt,y:it+30,width:Y,height:D,fill:he.blue}),A({id:`comp-label-${st}-${xt}`,type:"text",x:Gt+Y/2,y:it+30+D/2,text:Et,fontSize:12,fill:"#fff"})})}),{success:!0}},[A]),tt=St.useCallback(()=>(e([]),{success:!0}),[]),I=St.useCallback(async(B,V,at)=>{var E;console.log("[Tool]",B,V);let K;switch(B){case"draw_shape":K=z(V);break;case"draw_text":K=L(V);break;case"draw_arrow":K=U(V);break;case"draw_flowchart":K=W(V);break;case"draw_architecture":K=X(V);break;case"clear_canvas":K=tt();break;default:K={error:"Unknown tool"}}((E=_.current)==null?void 0:E.readyState)==="open"&&(_.current.send(JSON.stringify({type:"conversation.item.create",item:{type:"function_call_output",call_id:at,output:JSON.stringify(K)}})),_.current.send(JSON.stringify({type:"response.create"})))},[z,L,U,W,X,tt]),nt=St.useCallback(async()=>{var B;if(!(s||c)){f(!0),m("...");try{const V=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});C.current=V;const at=document.createElement("audio");at.autoplay=!0,R.current=at,V.ontrack=q=>{at.srcObject=q.streams[0]};const K=await navigator.mediaDevices.getUserMedia({audio:!0});N.current=K,V.addTrack(K.getTracks()[0]);const E=V.createDataChannel("oai-events");_.current=E,E.onopen=()=>{f(!1),o(!0),m("..."),E.send(JSON.stringify({type:"session.update",session:{instructions:s4,tools:l4,tool_choice:"auto",input_audio_transcription:{model:"whisper-1"}}}))},E.onmessage=q=>{var st;const F=JSON.parse(q.data);if(F.type==="input_audio_buffer.speech_started"&&(m("..."),S("")),F.type==="conversation.item.input_audio_transcription.completed"&&m(": "+F.transcript),F.type==="response.output_audio_transcript.delta"&&S(it=>it+(F.delta||"")),F.type==="response.function_call_arguments.done")try{const it=JSON.parse(F.arguments);I(F.name,it,F.call_id)}catch(it){console.error("Parse error:",it)}F.type==="error"&&m(": "+((st=F.error)==null?void 0:st.message))},await V.setLocalDescription(),await new Promise(q=>{V.iceGatheringState==="complete"?q():(V.onicegatheringstatechange=()=>V.iceGatheringState==="complete"&&q(),setTimeout(q,3e3))});const D=await(await fetch("/api/cecelia/realtime-sdp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sdp:(B=V.localDescription)==null?void 0:B.sdp,model:"gpt-4o-realtime-preview-2024-12-17"})})).json();if(!D.success)throw new Error(D.error);await V.setRemoteDescription({type:"answer",sdp:D.sdp})}catch(V){console.error("Connection error:",V),m(": "+(V instanceof Error?V.message:String(V))),f(!1)}}},[s,c,I]),lt=St.useCallback(()=>{var B,V,at;(B=_.current)==null||B.close(),(V=N.current)==null||V.getTracks().forEach(K=>K.stop()),(at=C.current)==null||at.close(),_.current=C.current=null,N.current=null,o(!1),f(!1)},[]),ct=B=>{const V=B.id;switch(B.type){case"rect":return Jt.jsx(t4,{x:B.x,y:B.y,width:B.width,height:B.height,fill:B.fill,cornerRadius:6,shadowBlur:8,shadowOpacity:.2},V);case"ellipse":return Jt.jsx(e4,{x:B.x+B.width/2,y:B.y+B.height/2,radiusX:B.width/2,radiusY:B.height/2,fill:B.fill,shadowBlur:8,shadowOpacity:.2},V);case"diamond":{const at=B.x+B.width/2,K=B.y+B.height/2;return Jt.jsx(Zh,{points:[at,B.y,B.x+B.width,K,at,B.y+B.height,B.x,K],closed:!0,fill:B.fill,shadowBlur:8,shadowOpacity:.2},V)}case"text":return Jt.jsx(a4,{x:B.x,y:B.y,text:B.text,fontSize:B.fontSize,fill:B.fill,align:"center",verticalAlign:"middle",offsetX:B.text?B.text.length*(B.fontSize||14)*.3:0,offsetY:(B.fontSize||14)/2},V);case"arrow":return Jt.jsx(n4,{points:B.points,stroke:B.stroke,strokeWidth:2,fill:B.stroke,pointerLength:8,pointerWidth:6},V);case"line":return Jt.jsx(Zh,{points:B.points,stroke:B.stroke,strokeWidth:2},V);default:return null}};return Jt.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",background:"#f1f5f9"},children:[Jt.jsx("div",{ref:p,style:{flex:1},children:Jt.jsx(i4,{width:n.width,height:n.height,style:{background:"#fff"},children:Jt.jsx($5,{children:u.map(ct)})})}),Jt.jsxs("div",{style:{height:64,background:"#1e293b",display:"flex",alignItems:"center",justifyContent:"center",gap:16,padding:"0 20px"},children:[(g||y)&&Jt.jsxs("div",{style:{flex:1,maxWidth:500,padding:"8px 14px",background:"#334155",borderRadius:8,fontSize:13},children:[Jt.jsx("span",{style:{color:"#94a3b8"},children:g}),y&&Jt.jsx("span",{style:{color:"#a5b4fc",marginLeft:8},children:y})]}),Jt.jsx("button",{onClick:tt,style:{width:40,height:40,borderRadius:8,border:"none",background:"#475569",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:Jt.jsx(a1,{size:18,color:"#fff"})}),Jt.jsx("button",{onClick:s?lt:nt,disabled:c,style:{width:52,height:52,borderRadius:"50%",border:"none",cursor:"pointer",background:s?"#ef4444":c?"#64748b":"#8b5cf6",display:"flex",alignItems:"center",justifyContent:"center"},children:c?Jt.jsx(n1,{size:22,color:"#fff",className:"animate-spin"}):s?Jt.jsx(i1,{size:22,color:"#fff"}):Jt.jsx(l1,{size:22,color:"#fff"})})]})]})}export{m4 as default};

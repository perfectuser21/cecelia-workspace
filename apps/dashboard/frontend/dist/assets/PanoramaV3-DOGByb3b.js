import{j as e,$ as v,bg as k,ay as S,aA as $,aB as P,T as R,bh as B,r as d,aE as y,aK as E,_,d as T,C as w,aR as A,aq as U,R as F,a2 as V,bi as z,A as G,e as D,aG as H}from"./index-CScgfzHC.js";const C="/api/panorama";async function I(){try{return await(await fetch(`${C}/vitals`)).json()}catch(s){return{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async function L(){try{return await(await fetch(`${C}/plan`)).json()}catch(s){return{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}function q({data:s,loading:n}){if(n)return e.jsx("div",{className:"space-y-3",children:[1,2,3].map(l=>e.jsx("div",{className:"h-8 bg-slate-100 dark:bg-slate-700/50 rounded-lg animate-pulse"},l))});if(!s||s.items.length===0)return e.jsxs("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e.jsx("p",{className:"text-sm",children:"No tasks for today"}),e.jsx("p",{className:"text-xs mt-1 opacity-75",children:"Create a .plan.md file to add tasks"})]});const o=s.items.filter(l=>l.completed).length,a=s.items.length,x=a>0?o/a*100:0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all duration-500",style:{width:`${x}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:[o,"/",a]})]}),e.jsx("div",{className:"space-y-2",children:s.items.map(l=>e.jsxs("div",{className:`
              flex items-start gap-3 p-3 rounded-xl transition-colors
              ${l.completed?"bg-emerald-50 dark:bg-emerald-900/20":"bg-slate-50 dark:bg-slate-700/30"}
            `,children:[l.completed?e.jsx(v,{className:"w-5 h-5 text-emerald-500 flex-shrink-0 mt-0.5"}):e.jsx(k,{className:"w-5 h-5 text-slate-400 dark:text-slate-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:`
                text-sm
                ${l.completed?"text-slate-500 dark:text-slate-400 line-through":"text-slate-700 dark:text-slate-300"}
              `,children:l.content}),l.priority==="high"&&!l.completed&&e.jsx("span",{className:"ml-auto text-xs px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-full",children:"High"})]},l.id))}),e.jsxs("p",{className:"text-xs text-slate-400 dark:text-slate-500",children:["Source: ",s.source]})]})}function g(s){return`${(s/1073741824).toFixed(1)} GB`}function M(s){return s>=90?"text-red-500":s>=70?"text-amber-500":"text-emerald-500"}function O(s){return s>=90?"bg-red-500":s>=70?"bg-amber-500":"bg-emerald-500"}function K({data:s,loading:n}){if(n)return e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[1,2,3,4].map(a=>e.jsx("div",{className:"h-24 bg-slate-100 dark:bg-slate-700/50 rounded-xl animate-pulse"},a))});if(!s)return e.jsx("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:e.jsx("p",{className:"text-sm",children:"Unable to fetch system vitals"})});const o=[{icon:S,label:"CPU",value:`${s.cpu.usage.toFixed(1)}%`,percent:s.cpu.usage,detail:`${s.cpu.cores} cores`},{icon:$,label:"Memory",value:`${s.memory.percent.toFixed(1)}%`,percent:s.memory.percent,detail:`${g(s.memory.used)} / ${g(s.memory.total)}`},{icon:P,label:"Disk",value:`${s.disk.percent.toFixed(1)}%`,percent:s.disk.percent,detail:`${g(s.disk.used)} / ${g(s.disk.total)}`},{icon:R,label:"Uptime",value:s.uptime.formatted,percent:0,detail:`Load: ${s.load.map(a=>a.toFixed(2)).join(", ")}`,noBar:!0}];return e.jsx("div",{className:"grid grid-cols-2 gap-4",children:o.map(a=>e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-700/30 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(a.icon,{className:"w-4 h-4 text-slate-500 dark:text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:a.label})]}),e.jsx("p",{className:`text-xl font-bold ${a.noBar?"text-slate-700 dark:text-slate-200":M(a.percent)}`,children:a.value}),!a.noBar&&e.jsx("div",{className:"mt-2 h-1.5 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${O(a.percent)}`,style:{width:`${a.percent}%`}})}),e.jsx("p",{className:"mt-2 text-xs text-slate-500 dark:text-slate-400",children:a.detail})]},a.label))})}function X({loading:s}){return s?e.jsx("div",{className:"h-32 bg-slate-100 dark:bg-slate-700/50 rounded-xl animate-pulse"}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-slate-400 dark:text-slate-500",children:[e.jsx(B,{className:"w-12 h-12 mb-3 opacity-50"}),e.jsx("p",{className:"text-sm font-medium",children:"Coming Soon"}),e.jsx("p",{className:"text-xs mt-1 opacity-75",children:"Business metrics will be displayed here"})]})}const N=["zenithjoy-engine","zenithjoy-core","zenithjoy-autopilot"];function J({loading:s}){const[n,o]=d.useState([]),[a,x]=d.useState(!0);if(d.useEffect(()=>{async function r(){try{const u=await Promise.all(N.map(async t=>{var c,i,j,m;try{const b=await(await fetch(`/api/github/commits?repo=${t}`)).json();return{name:t,branch:((c=b.data)==null?void 0:c.currentBranch)||"develop",status:"clean",openPRs:0,lastCommit:((m=(j=(i=b.data)==null?void 0:i.develop)==null?void 0:j[0])==null?void 0:m.message)||"No commits"}}catch{return{name:t,branch:"unknown",status:"clean",openPRs:0,lastCommit:"Unable to fetch"}}}));o(u)}finally{x(!1)}}s||r()},[s]),a||s)return e.jsx("div",{className:"space-y-3",children:N.map(r=>e.jsx("div",{className:"h-16 bg-slate-100 dark:bg-slate-700/50 rounded-xl animate-pulse"},r))});if(n.length===0)return e.jsx("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:e.jsx("p",{className:"text-sm",children:"No repositories configured"})});const l=r=>{switch(r){case"clean":return e.jsx(T,{className:"w-4 h-4 text-emerald-500"});case"modified":return e.jsx(k,{className:"w-4 h-4 text-amber-500"});default:return e.jsx(_,{className:"w-4 h-4 text-red-500"})}};return e.jsx("div",{className:"space-y-3",children:n.map(r=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-50 dark:bg-slate-700/30 rounded-xl",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-200",children:r.name.replace("zenithjoy-","")}),l(r.status)]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate mt-1",children:r.lastCommit})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500 dark:text-slate-400",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:r.branch})]}),r.openPRs>0&&e.jsxs("div",{className:"flex items-center gap-1.5 text-purple-500",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:r.openPRs})]})]})]},r.name))})}function Q({loading:s}){const[n,o]=d.useState([]),[a,x]=d.useState(!0);if(d.useEffect(()=>{async function t(){try{const i=await(await fetch("/api/cecelia/overview")).json();i.success&&i.data&&o(i.data.runs||[])}catch{}finally{x(!1)}}s||t()},[s]),a||s)return e.jsx("div",{className:"space-y-3",children:[1,2].map(t=>e.jsx("div",{className:"h-20 bg-slate-100 dark:bg-slate-700/50 rounded-xl animate-pulse"},t))});const l=n.filter(t=>t.status==="running"),r=n.filter(t=>t.status!=="running").slice(0,3);if(l.length===0&&r.length===0)return e.jsxs("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e.jsx("p",{className:"text-sm",children:"No active executions"}),e.jsx("p",{className:"text-xs mt-1 opacity-75",children:"Cecelia is idle"})]});const u=t=>{switch(t){case"running":return{icon:U,color:"text-blue-500",bg:"bg-blue-50 dark:bg-blue-900/20",label:"Running"};case"completed":return{icon:v,color:"text-emerald-500",bg:"bg-emerald-50 dark:bg-emerald-900/20",label:"Completed"};case"failed":return{icon:A,color:"text-red-500",bg:"bg-red-50 dark:bg-red-900/20",label:"Failed"};default:return{icon:w,color:"text-slate-500",bg:"bg-slate-50 dark:bg-slate-700/30",label:"Pending"}}};return e.jsxs("div",{className:"space-y-4",children:[l.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"Active"}),l.map(t=>{const c=u(t.status),i=t.total_steps>0?t.current_step/t.total_steps*100:0;return e.jsxs("div",{className:`p-4 rounded-xl ${c.bg}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c.icon,{className:`w-4 h-4 ${c.color} animate-pulse`}),e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-200",children:t.prd_id})]}),e.jsxs("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Step ",t.current_step,"/",t.total_steps]})]}),e.jsx("div",{className:"h-1.5 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-500",style:{width:`${i}%`}})}),t.feature_branch&&e.jsxs("p",{className:"mt-2 text-xs text-slate-500 dark:text-slate-400",children:["Branch: ",t.feature_branch]})]},t.id)})]}),r.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"Recent"}),r.map(t=>{const c=u(t.status);return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl ${c.bg}`,children:[e.jsx(c.icon,{className:`w-4 h-4 ${c.color}`}),e.jsx("span",{className:"flex-1 text-sm text-slate-700 dark:text-slate-300",children:t.prd_id}),e.jsx("span",{className:`text-xs ${c.color}`,children:c.label})]},t.id)})]})]})}const h=({children:s,className:n=""})=>e.jsx("div",{className:`
      rounded-2xl
      bg-white dark:bg-slate-800/80
      backdrop-blur-xl
      border border-slate-200 dark:border-slate-700
      shadow-lg shadow-slate-200/50 dark:shadow-black/30
      transition-all duration-300 ease-out
      ${n}
    `,children:s}),p=({icon:s,title:n,subtitle:o})=>e.jsxs("div",{className:"flex items-center gap-3 px-5 py-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-2 rounded-xl bg-slate-100 dark:bg-slate-700/50",children:e.jsx(s,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 uppercase tracking-wider",children:n}),o&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:o})]})]});function Y(){const[s,n]=d.useState(null),[o,a]=d.useState(null),[x,l]=d.useState(!0),[r,u]=d.useState(null),[t,c]=d.useState(null),i=d.useCallback(async()=>{try{l(!0),u(null);const[m,f]=await Promise.all([I(),L()]);m.success&&m.data&&n(m.data),f.success&&f.data&&a(f.data),c(new Date)}catch{u("Failed to connect to server")}finally{l(!1)}},[]);d.useEffect(()=>{i()},[i]),d.useEffect(()=>{const m=setInterval(i,3e4);return()=>clearInterval(m)},[i]);const j=()=>{i()};return e.jsx("div",{className:"min-h-screen -m-8 -mt-8 p-8 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800",children:e.jsxs("div",{className:"space-y-6 p-2 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"VPS Panorama"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"System Overview"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[t&&e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1",children:[e.jsx(w,{className:"w-3 h-3"}),t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})]}),e.jsx("button",{onClick:j,disabled:x,className:"p-2 text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 hover:bg-white dark:hover:bg-slate-700 rounded-lg transition-colors disabled:opacity-50",title:"Refresh",children:e.jsx(F,{className:`w-5 h-5 ${x?"animate-spin":""}`})})]})]}),r&&e.jsx(h,{className:"p-6 border-red-200 dark:border-red-800/50",children:e.jsxs("div",{className:"flex items-center gap-3 text-red-600 dark:text-red-400",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Connection Error"}),e.jsx("p",{className:"text-sm opacity-75",children:r})]})]})}),e.jsxs(h,{className:"overflow-hidden",children:[e.jsx(p,{icon:z,title:"Plan",subtitle:"Today's Tasks"}),e.jsx("div",{className:"p-5",children:e.jsx(q,{data:o,loading:x})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(h,{className:"overflow-hidden",children:[e.jsx(p,{icon:G,title:"Vitals",subtitle:"System Health"}),e.jsx("div",{className:"p-5",children:e.jsx(K,{data:s,loading:x})})]}),e.jsxs(h,{className:"overflow-hidden",children:[e.jsx(p,{icon:D,title:"Business",subtitle:"Coming Soon"}),e.jsx("div",{className:"p-5",children:e.jsx(X,{loading:x})})]})]}),e.jsxs(h,{className:"overflow-hidden",children:[e.jsx(p,{icon:y,title:"Projects",subtitle:"Repository Status"}),e.jsx("div",{className:"p-5",children:e.jsx(J,{loading:x})})]}),e.jsxs(h,{className:"overflow-hidden",children:[e.jsx(p,{icon:H,title:"Cecelia",subtitle:"Active Executions"}),e.jsx("div",{className:"p-5",children:e.jsx(Q,{loading:x})})]})]})})}export{Y as default};

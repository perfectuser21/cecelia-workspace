import{r as l,j as e,m as T,a5 as A,B as R,R as L,f as D,d as E,_ as B,e as F}from"./index-Cs8Vqz41.js";import{p as K}from"./publish.api-D33NbTu_.js";import{g as P,B as h,f as z,R as o,C as O,T as n,L as j}from"./generateCategoricalChart-DHELD3X2.js";import{P as $,a as M}from"./PieChart-DTzpGfj7.js";import{X as m,Y as g,C as k}from"./YAxis-CDvDUJQR.js";import{L as _,a as N}from"./LineChart-DU5__Ke2.js";import"./client-DyfwnZmM.js";import"./index-B9ygI19o.js";import"./tiny-invariant-BaFNuDhB.js";var U=P({chartName:"BarChart",GraphicalChild:h,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:m},{axisType:"yAxis",AxisComp:g}],formatAxisMap:z});const X={draft:"#94a3b8",pending:"#fbbf24",processing:"#60a5fa",completed:"#34d399",failed:"#f87171",partial:"#fb923c"},G={draft:"草稿",pending:"待发布",processing:"发布中",completed:"成功",failed:"失败",partial:"部分成功"},W={douyin:"抖音",kuaishou:"快手",xiaohongshu:"小红书",toutiao:"头条",weibo:"微博",videoNumber:"视频号",wechat:"公众号",zhihu:"知乎",website:"官网"};function te(){const[a,w]=l.useState(null),[d,b]=l.useState(!0),[y,p]=l.useState(null),i=async()=>{b(!0),p(null);try{const t=await K.getStats();w(t)}catch(t){p(t instanceof Error?t.message:"加载统计数据失败")}finally{b(!1)}};if(l.useEffect(()=>{i()},[]),d&&!a)return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(T,{className:"w-8 h-8 animate-spin text-blue-500"})});if(y)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-96",children:[e.jsx(A,{className:"w-12 h-12 text-red-500 dark:text-red-400 mb-4"}),e.jsx("p",{className:"text-red-600 dark:text-red-400 mb-3",children:y}),e.jsx("button",{onClick:i,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 shadow-lg shadow-blue-500/25",children:"重试"})]});if(!a)return null;const x=a.total-(a.byStatus.draft||0),f=a.byStatus.completed||0,v=(a.byStatus.failed||0)+(a.byStatus.partial||0),C=x>0?(f/x*100).toFixed(1):"0.0",c=Object.entries(a.byStatus).filter(([t])=>t!=="draft").map(([t,s])=>({name:G[t]||t,value:s,color:X[t]||"#94a3b8"})),r=Object.entries(a.byPlatform).map(([t,s])=>({platform:W[t]||t,total:s.total,success:s.success,failed:s.failed,successRate:s.total>0?(s.success/s.total*100).toFixed(1):"0"})).sort((t,s)=>s.total-t.total),u=a.recentTrend.map(t=>({date:new Date(t.date).toLocaleDateString("zh-CN",{month:"numeric",day:"numeric"}),success:t.success,failed:t.failed}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-purple-500/25",children:e.jsx(R,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"发布统计"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"多平台发布数据分析"})]})]}),e.jsx("button",{onClick:i,disabled:d,className:"p-2 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-xl transition-colors",children:e.jsx(L,{className:`w-5 h-5 ${d?"animate-spin":""}`})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/25",children:e.jsx(D,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"总发布数"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["草稿 ",a.byStatus.draft||0," 个"]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg shadow-green-500/25",children:e.jsx(E,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"成功数"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:f}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:"全部成功完成"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-red-500 to-orange-500 rounded-xl flex items-center justify-center shadow-lg shadow-red-500/25",children:e.jsx(B,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"失败数"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:v}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:"部分或全部失败"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg shadow-purple-500/25",children:e.jsx(F,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"成功率"})]}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[C,"%"]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:"全部完成的比例"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"按状态分布"}),c.length===0?e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-400 dark:text-gray-500",children:"暂无数据"}):e.jsx(o,{width:"100%",height:300,children:e.jsxs($,{children:[e.jsx(M,{data:c,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:s})=>`${t} ${(s*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:c.map((t,s)=>e.jsx(O,{fill:t.color},`cell-${s}`))}),e.jsx(n,{})]})})]}),e.jsxs("div",{className:"col-span-2 bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"按平台统计"}),r.length===0?e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-400 dark:text-gray-500",children:"暂无数据"}):e.jsx(o,{width:"100%",height:300,children:e.jsxs(U,{data:r,children:[e.jsx(k,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),e.jsx(m,{dataKey:"platform",stroke:"#94a3b8",style:{fontSize:"12px"}}),e.jsx(g,{stroke:"#94a3b8",style:{fontSize:"12px"}}),e.jsx(n,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #475569",borderRadius:"8px",color:"#fff"},formatter:(t,s)=>[t,{total:"总数",success:"成功",failed:"失败"}[s]||s]}),e.jsx(j,{formatter:t=>({total:"总数",success:"成功",failed:"失败"})[t]||t}),e.jsx(h,{dataKey:"success",fill:"#34d399",radius:[4,4,0,0]}),e.jsx(h,{dataKey:"failed",fill:"#f87171",radius:[4,4,0,0]})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"平台详情"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"平台"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"发布总数"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"成功数"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"失败数"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"成功率"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-400 dark:text-gray-500",children:"暂无数据"})}):r.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:t.platform}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 dark:text-white text-right",children:t.total}),e.jsx("td",{className:"px-6 py-4 text-sm text-green-600 dark:text-green-400 text-right",children:t.success}),e.jsx("td",{className:"px-6 py-4 text-sm text-red-600 dark:text-red-400 text-right",children:t.failed}),e.jsx("td",{className:"px-6 py-4 text-sm text-right",children:e.jsxs("span",{className:`inline-flex px-2.5 py-1 rounded-lg text-xs font-medium ${parseFloat(t.successRate)>=80?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":parseFloat(t.successRate)>=50?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400"}`,children:[t.successRate,"%"]})})]},t.platform))})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"最近7天趋势"}),u.length===0?e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-400 dark:text-gray-500",children:"暂无数据"}):e.jsx(o,{width:"100%",height:300,children:e.jsxs(_,{data:u,children:[e.jsx(k,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),e.jsx(m,{dataKey:"date",stroke:"#94a3b8",style:{fontSize:"12px"}}),e.jsx(g,{stroke:"#94a3b8",style:{fontSize:"12px"}}),e.jsx(n,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #475569",borderRadius:"8px",color:"#fff"},formatter:(t,s)=>[t,{success:"成功",failed:"失败"}[s]||s]}),e.jsx(j,{formatter:t=>({success:"成功",failed:"失败"})[t]||t}),e.jsx(N,{type:"monotone",dataKey:"success",stroke:"#34d399",strokeWidth:2,dot:{fill:"#34d399",r:4},activeDot:{r:6}}),e.jsx(N,{type:"monotone",dataKey:"failed",stroke:"#f87171",strokeWidth:2,dot:{fill:"#f87171",r:4},activeDot:{r:6}})]})})]})]})}export{te as default};

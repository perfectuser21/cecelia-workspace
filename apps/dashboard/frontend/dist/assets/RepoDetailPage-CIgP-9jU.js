import{aa as E,a9 as _,r as g,j as e,y as P,aH as y,bj as S,aW as F,ap as C,x as $,ab as O,C as L,bg as A,_ as B,$ as q}from"./index-COSEfhnc.js";import{a as z}from"./qa-report.api-wEreUZo6.js";import"./index-B9ygI19o.js";const f=s=>s>=80?"text-emerald-500":s>=60?"text-amber-500":"text-red-500",R=({status:s,size:d="sm"})=>{const a=d==="lg"?"w-6 h-6":"w-4 h-4";switch(s){case"pass":case"resolved":case"covered":return e.jsx(q,{className:`${a} text-emerald-500`});case"fail":case"open":case"missing":return e.jsx(B,{className:`${a} text-red-500`});case"partial":return e.jsx(A,{className:`${a} text-amber-500 fill-amber-500/30`});default:return e.jsx(L,{className:`${a} text-white/40`})}},v=({priority:s})=>{const d=s.toLowerCase(),a={p0:"bg-red-500 text-white",p1:"bg-orange-500 text-white",p2:"bg-amber-500 text-black",p3:"bg-gray-500 text-white"};return e.jsx("span",{className:`px-1.5 py-0.5 text-xs font-bold rounded ${a[d]||a.p3}`,children:s.toUpperCase()})},k=({trigger:s})=>{const d={pr:"bg-violet-500/20 text-violet-300 border-violet-500/30",release:"bg-blue-500/20 text-blue-300 border-blue-500/30",nightly:"bg-cyan-500/20 text-cyan-300 border-cyan-500/30"};return e.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded border ${d[s.toLowerCase()]||"bg-white/10 text-white/60"}`,children:s})},I=({method:s})=>e.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${s==="auto"?"bg-emerald-500/20 text-emerald-300":"bg-amber-500/20 text-amber-300"}`,children:s});function w({title:s,icon:d,count:a,badge:o,status:h,children:c,defaultOpen:x=!1}){const[l,n]=g.useState(x);return e.jsxs("div",{className:"bg-white/5 rounded-lg border border-white/10 overflow-hidden",children:[e.jsxs("button",{onClick:()=>n(!l),className:"w-full p-4 flex items-center justify-between hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[d,e.jsx("span",{className:"font-medium",children:s}),e.jsxs("span",{className:"text-white/40",children:["(",a,")"]}),o]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-sm ${h==="good"?"text-emerald-500":h==="warning"?"text-amber-500":"text-red-500"}`,children:h==="good"?"All good":h==="warning"?"Needs attention":"Issues found"}),l?e.jsx(C,{className:"w-4 h-4"}):e.jsx($,{className:"w-4 h-4"})]})]}),l&&e.jsx("div",{className:"border-t border-white/10 p-4",children:c})]})}function M({path:s,features:d,rcis:a}){var m,j;const[o,h]=g.useState(!1),c=s.covers_features?d.filter(i=>s.covers_features.includes(i.id)):[],x=s.rcis?a.filter(i=>s.rcis.includes(i.id)):[],l=((m=s.steps)==null?void 0:m.filter(i=>i.verified).length)||0,n=((j=s.steps)==null?void 0:j.length)||0;return e.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-blue-500/10 rounded-xl border border-purple-500/20 overflow-hidden",children:[e.jsxs("button",{onClick:()=>h(!o),className:"w-full p-4 text-left",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${s.verified?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"}`,children:e.jsx(y,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-white/40",children:s.id}),e.jsx("span",{className:"font-medium",children:s.name})]}),e.jsx("p",{className:"text-sm text-white/50",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.steps&&e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-lg font-bold ${l===n?"text-emerald-500":"text-amber-500"}`,children:[l,"/",n]}),e.jsx("div",{className:"text-xs text-white/40",children:"steps"})]}),o?e.jsx(C,{className:"w-4 h-4"}):e.jsx($,{className:"w-4 h-4"})]})]}),e.jsxs("div",{className:"flex gap-4 mt-3 text-xs",children:[c.length>0&&e.jsxs("span",{className:"text-blue-400",children:[c.length," features covered"]}),x.length>0&&e.jsxs("span",{className:"text-violet-400",children:[x.length," RCIs verified"]})]})]}),o&&e.jsxs("div",{className:"border-t border-white/10 p-4 space-y-4",children:[s.steps&&s.steps.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/40 uppercase mb-3",children:"Workflow Steps"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-3 left-3 right-3 h-0.5 bg-white/10",children:e.jsx("div",{className:"h-full bg-emerald-500 transition-all",style:{width:`${l/n*100}%`}})}),e.jsx("div",{className:"relative flex justify-between",children:s.steps.map(i=>e.jsxs("div",{className:"flex flex-col items-center",style:{width:`${100/s.steps.length}%`},children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold z-10 ${i.verified?"bg-emerald-500 text-white":"bg-white/10 text-white/50"}`,children:i.verified?"âœ“":i.order}),e.jsx("div",{className:`mt-1 text-[10px] text-center px-1 ${i.verified?"text-white/70":"text-white/40"}`,children:i.name})]},i.order))})]})]}),c.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/40 uppercase mb-2",children:"Covered Features"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(i=>e.jsxs("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-300 text-xs rounded flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"}),i.id,": ",i.name]},i.id))})]}),x.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/40 uppercase mb-2",children:"Verified RCIs"}),e.jsx("div",{className:"space-y-1",children:x.map(i=>e.jsxs("div",{className:"flex items-center gap-2 text-xs p-2 bg-white/5 rounded",children:[e.jsx(v,{priority:i.priority}),e.jsx("span",{className:"font-mono text-white/40",children:i.id}),e.jsx("span",{className:"text-white/70",children:i.name||i.title})]},i.id))})]})]})]})}function U({feature:s,rcis:d,goldenPaths:a}){const[o,h]=g.useState(!1),c=s.rcis?d.filter(l=>s.rcis.includes(l.id)):d.filter(l=>l.feature===s.id),x=s.in_golden_paths?a.filter(l=>s.in_golden_paths.includes(l.id)):a.filter(l=>{var n;return(n=l.covers_features)==null?void 0:n.includes(s.id)});return e.jsxs("div",{className:"bg-white/5 rounded-lg border border-white/10 overflow-hidden",children:[e.jsxs("button",{onClick:()=>h(!o),className:"w-full p-3 text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{status:s.status}),e.jsx("span",{className:"font-mono text-xs text-white/40",children:s.id}),e.jsx("span",{className:"flex-1 font-medium",children:s.name}),e.jsxs("span",{className:`text-sm font-bold ${f(s.coverage)}`,children:[s.coverage,"%"]}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("div",{className:`w-1.5 h-4 rounded ${s.layers.meta?"bg-emerald-500":"bg-white/10"}`,title:"Meta"}),e.jsx("div",{className:`w-1.5 h-4 rounded ${s.layers.unit?"bg-emerald-500":"bg-white/10"}`,title:"Unit"}),e.jsx("div",{className:`w-1.5 h-4 rounded ${s.layers.e2e?"bg-emerald-500":"bg-white/10"}`,title:"E2E"})]}),o?e.jsx(C,{className:"w-4 h-4"}):e.jsx($,{className:"w-4 h-4"})]}),e.jsx("div",{className:"flex gap-4 mt-2 text-xs ml-7",children:s.description&&e.jsx("span",{className:"text-white/50",children:s.description})}),e.jsxs("div",{className:"flex gap-4 mt-1 text-xs ml-7",children:[c.length>0&&e.jsxs("span",{className:"text-amber-400",children:[c.length," RCIs"]}),x.length>0&&e.jsxs("span",{className:"text-purple-400",children:[x.length," Golden Paths"]})]})]}),o&&e.jsxs("div",{className:"border-t border-white/10 p-3 space-y-3",children:[c.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/40 uppercase mb-2",children:"Related RCIs"}),e.jsx("div",{className:"space-y-1",children:c.map(l=>e.jsxs("div",{className:"flex items-center gap-2 text-xs p-2 bg-white/5 rounded",children:[e.jsx(v,{priority:l.priority}),e.jsx("span",{className:"font-mono text-white/40",children:l.id}),e.jsx("span",{className:"flex-1 text-white/70",children:l.name||l.title}),l.trigger&&l.trigger.map(n=>e.jsx(k,{trigger:n},n)),l.method&&e.jsx(I,{method:l.method})]},l.id))})]}),x.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/40 uppercase mb-2",children:"In Golden Paths"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(l=>e.jsxs("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-300 text-xs rounded flex items-center gap-1",children:[e.jsx(y,{className:"w-3 h-3"}),l.id,": ",l.name]},l.id))})]})]})]})}function D({rci:s}){return e.jsxs("div",{className:`p-3 rounded-lg ${s.status==="open"?"bg-red-500/10":"bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(R,{status:s.status||"pending"}),e.jsx(v,{priority:s.priority}),e.jsx("span",{className:"font-mono text-xs text-white/40",children:s.id}),e.jsx("span",{className:"flex-1 truncate",children:s.name||s.title}),s.trigger&&s.trigger.map(d=>e.jsx(k,{trigger:d},d)),s.method&&e.jsx(I,{method:s.method})]}),s.description&&e.jsx("p",{className:"text-xs text-white/40 mt-1 ml-6",children:s.description}),e.jsxs("div",{className:"flex gap-4 mt-1 ml-6 text-xs",children:[s.feature&&e.jsxs("span",{className:"text-blue-400",children:["Feature: ",s.feature]}),s.scope&&e.jsxs("span",{className:"text-white/40",children:["Scope: ",s.scope]}),s.status&&e.jsx("span",{className:`capitalize ${s.status==="open"?"text-red-400":s.status==="resolved"?"text-emerald-400":"text-amber-400"}`,children:s.status})]})]})}function T({gates:s,rcis:d}){var n,m,j,i,b,N;const a=u=>u&&typeof u=="object"&&"count"in u&&"rcis"in u,o=(u,p)=>{if(!p)return null;if(a(p)){const t=p.rcis?d.filter(r=>p.rcis.includes(r.id)):[];return e.jsxs("div",{className:"p-4 bg-white/5 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"font-medium",children:u}),e.jsxs("span",{className:"text-lg font-bold text-violet-400",children:[p.count," checks"]})]}),t.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/40 mb-2",children:"Verified RCIs"}),e.jsx("div",{className:"space-y-1",children:t.map(r=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(v,{priority:r.priority}),e.jsx("span",{className:"font-mono text-white/40",children:r.id}),e.jsx("span",{className:"text-white/70",children:r.name||r.title})]},r.id))})]})]})}else if(Array.isArray(p)){const t=p.filter(r=>r.status==="pass").length;return e.jsxs("div",{className:"p-4 bg-white/5 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"font-medium",children:u}),e.jsxs("span",{className:`text-lg font-bold ${t===p.length?"text-emerald-500":"text-amber-500"}`,children:[t,"/",p.length]})]}),e.jsx("div",{className:"space-y-1",children:p.map(r=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded text-sm ${r.status==="fail"?"bg-red-500/10":""}`,children:[e.jsx(R,{status:r.status}),e.jsx("span",{className:"flex-1",children:r.name}),r.required&&e.jsx("span",{className:"text-xs text-violet-400",children:"required"})]},r.id))})]})}return null},h=o("PR Gate",s.pr),c=o("Release Gate",s.release),x=o("Nightly Gate",s.nightly);if(!h&&!c&&!x)return null;const l=(((n=s.pr)==null?void 0:n.count)||((m=s.pr)==null?void 0:m.length)||0)+(((j=s.release)==null?void 0:j.count)||((i=s.release)==null?void 0:i.length)||0)+(((b=s.nightly)==null?void 0:b.count)||((N=s.nightly)==null?void 0:N.length)||0);return e.jsx(w,{title:"Quality Gates",icon:e.jsx(O,{className:"w-5 h-5 text-emerald-400"}),count:l,status:"good",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h,c,x]})})}function Q(){var u,p;const s=E(),{repo:d}=_(),[a,o]=g.useState(null),[h,c]=g.useState(!0),[x,l]=g.useState(null);if(g.useEffect(()=>{d&&(c(!0),z(d).then(t=>{t.success&&t.data?o(t.data):l(t.error||"Failed to load report"),c(!1)}))},[d]),h)return e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] text-white flex items-center justify-center",children:e.jsx("div",{className:"text-white/50",children:"Loading..."})});if(x||!a)return e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] text-white p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("button",{onClick:()=>s("/qa"),className:"flex items-center gap-2 text-white/60 hover:text-white mb-6",children:[e.jsx(P,{className:"w-4 h-4"})," Back"]}),e.jsx("div",{className:"text-center py-12 text-white/50",children:x||"Not found"})]})});const n=a.features||[],m=((u=a.rcis)==null?void 0:u.items)||[],j=a.goldenPaths||[],i={};for(const t of n)i[t.scope]||(i[t.scope]=[]),i[t.scope].push(t);const b=m.filter(t=>t.status==="open").length,N=m.filter(t=>t.priority.toLowerCase()==="p0"&&t.status==="open").length;return e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] text-white p-6",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s("/qa"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold",children:a.repo}),e.jsxs("p",{className:"text-white/50",children:["v",a.version]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-4xl font-bold ${f(a.summary.overall)}`,children:a.summary.overall}),e.jsx("div",{className:"text-xs text-white/40",children:"Overall Score"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 bg-white/5 rounded-lg p-3 text-center",children:[e.jsx("div",{className:`text-xl font-bold ${f(a.summary.meta)}`,children:a.summary.meta}),e.jsx("div",{className:"text-xs text-white/40",children:"Meta"})]}),e.jsxs("div",{className:"flex-1 bg-white/5 rounded-lg p-3 text-center",children:[e.jsx("div",{className:`text-xl font-bold ${f(a.summary.unit)}`,children:a.summary.unit}),e.jsx("div",{className:"text-xs text-white/40",children:"Unit"})]}),e.jsxs("div",{className:"flex-1 bg-white/5 rounded-lg p-3 text-center",children:[e.jsx("div",{className:`text-xl font-bold ${f(a.summary.e2e)}`,children:a.summary.e2e}),e.jsx("div",{className:"text-xs text-white/40",children:"E2E"})]}),e.jsxs("div",{className:"flex-1 bg-white/5 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-white/70",children:n.length}),e.jsx("div",{className:"text-xs text-white/40",children:"Features"})]}),e.jsxs("div",{className:"flex-1 bg-white/5 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-violet-400",children:j.length}),e.jsx("div",{className:"text-xs text-white/40",children:"Golden Paths"})]})]}),j.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-purple-400"}),"Golden Paths (",j.length,")"]}),j.map(t=>e.jsx(M,{path:t,features:n,rcis:m},t.id))]}),a.gates&&e.jsx(T,{gates:a.gates,rcis:m}),n.length>0&&e.jsx(w,{title:"Features",icon:e.jsx(S,{className:"w-5 h-5 text-blue-400"}),count:n.length,badge:e.jsx("div",{className:"flex gap-1",children:Object.entries(i).map(([t,r])=>e.jsxs("span",{className:"px-1.5 py-0.5 text-xs bg-white/10 rounded",children:[r.length," ",t,"s"]},t))}),status:n.some(t=>t.status==="missing")?"error":n.some(t=>t.status==="partial")?"warning":"good",defaultOpen:!0,children:e.jsx("div",{className:"space-y-4",children:Object.entries(i).map(([t,r])=>e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-white/40 uppercase mb-2",children:[t,"s (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(G=>e.jsx(U,{feature:G,rcis:m,goldenPaths:j},G.id))})]},t))})}),m.length>0&&e.jsx(w,{title:"RCIs (Risk/Concern/Issue)",icon:e.jsx(F,{className:"w-5 h-5 text-amber-400"}),count:m.length,badge:e.jsx("div",{className:"flex gap-1",children:((p=a.rcis)==null?void 0:p.byPriority)&&Object.entries(a.rcis.byPriority).map(([t,r])=>r>0&&e.jsx(v,{priority:t},t))}),status:N>0?"error":b>0?"warning":"good",defaultOpen:N>0,children:e.jsx("div",{className:"space-y-2",children:m.map(t=>e.jsx(D,{rci:t},t.id))})})]})})}export{Q as default};

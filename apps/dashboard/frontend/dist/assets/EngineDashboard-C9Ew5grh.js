import{r as n,j as e,aD as M,S as Q,a as q,b as z,c as G,T as B,P as U,Q as Y,A as N,$ as D,a5 as _,aJ as w,C as J,ad as S,aK as Z,az as K,av as V,aL as X,Z as W}from"./index-CgNREcvu.js";import{g as ee}from"./dev-tracker.api-CFjw6oWP.js";import{g as te}from"./engine.api-Cc7KQEmz.js";import"./client-2fFfTFJr.js";import"./index-B9ygI19o.js";const se=()=>({user:{name:"Developer"}}),L=[{text:"把每一件简单的事做好就是不简单。",author:"稻盛和夫"},{text:"不要等待机会，而要创造机会。",author:"林肯"},{text:"成功不是终点，失败也不是终结，唯有勇气才是永恒。",author:"丘吉尔"},{text:"今天的努力是明天的礼物。",author:"佚名"},{text:"专注于当下，未来自然清晰。",author:"佚名"},{text:"Code is poetry.",author:"WordPress"},{text:"Talk is cheap. Show me the code.",author:"Linus Torvalds"},{text:"代码写得好，BUG 少不了。",author:"程序员"},{text:"今天的 TODO，就是明天的 DONE。",author:"乐观开发者"},{text:"Stay hungry, stay foolish.",author:"Steve Jobs"}],ae={"01-01":{name:"元旦",greeting:"新年快乐"},"02-14":{name:"情人节",greeting:"愿你被爱包围"},"05-01":{name:"劳动节",greeting:"休息一下吧"},"10-01":{name:"国庆节",greeting:"祖国生日快乐"},"12-25":{name:"圣诞节",greeting:"Merry Christmas"}},le=()=>{const s=new Date,a=`${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`;return ae[a]||null},re=()=>{const s=new Date,a=s.getFullYear()*1e4+(s.getMonth()+1)*100+s.getDate();return L[a%L.length]},O=()=>{const s=new Date,a=s.getDay();if(a===0||a===6)return null;const i=s.getHours()+s.getMinutes()/60;if(i<8.5||i>=18)return null;const d=new Date(s);d.setHours(18,0,0,0);const m=d.getTime()-s.getTime();return{hours:Math.floor(m/36e5),minutes:Math.floor(m%36e5/6e4)}},ne=()=>{const s=new Date().getDay();return s===0||s===6?null:6-s},de=s=>{const a=parseInt(s);return a>=600&&a<700?"snow":a>=200&&a<600?"rain":a===800?"sun":"cloud"},ie=s=>{const a=new Date().getHours(),i=new Date().getDay();return s?{greeting:`${s.name}快乐`,subtitle:s.greeting}:i===0||i===6?{greeting:"周末好",subtitle:"享受你的时光"}:a<9?{greeting:"早上好",subtitle:"新的一天，新的可能"}:a<12?{greeting:"上午好",subtitle:"保持专注，效率拉满"}:a<14?{greeting:"中午好",subtitle:"记得吃饭休息"}:a<18?{greeting:"下午好",subtitle:"继续加油"}:a<21?{greeting:"晚上好",subtitle:"辛苦了，注意休息"}:{greeting:"夜深了",subtitle:"早点休息吧"}},ce=(s,a=800)=>{const[i,d]=n.useState(0),m=n.useRef(null),u=n.useRef(null);return n.useEffect(()=>{if(s===0){d(0);return}const f=c=>{m.current||(m.current=c);const j=Math.min((c-m.current)/a,1),b=1-Math.pow(1-j,4);d(Math.floor(b*s)),j<1?u.current=requestAnimationFrame(f):d(s)};return m.current=null,u.current=requestAnimationFrame(f),()=>{u.current&&cancelAnimationFrame(u.current)}},[s,a]),i},$=({className:s=""})=>e.jsx("div",{className:`rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 ${s}`,children:e.jsx("div",{className:"animate-pulse p-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-200 dark:bg-slate-700 rounded-xl"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-slate-200 dark:bg-slate-700 rounded w-1/3"}),e.jsx("div",{className:"h-6 bg-slate-200 dark:bg-slate-700 rounded w-1/4"})]})]})})}),oe=()=>e.jsx("div",{className:"rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 p-6",children:e.jsxs("div",{className:"animate-pulse flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded w-48"}),e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-32"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-slate-200 dark:bg-slate-700 rounded w-12"}),e.jsx("div",{className:"h-5 bg-slate-200 dark:bg-slate-700 rounded w-16"})]}),e.jsx("div",{className:"w-16 h-16 bg-slate-200 dark:bg-slate-700 rounded-2xl"})]})]})}),xe=()=>e.jsxs("div",{className:"rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 lg:col-span-2",children:[e.jsx("div",{className:"p-5 border-b border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"h-5 bg-slate-200 dark:bg-slate-700 rounded w-24 animate-pulse"})}),e.jsx("div",{className:"p-4 space-y-3",children:[1,2,3].map(s=>e.jsx("div",{className:"animate-pulse p-3 bg-slate-50 dark:bg-slate-700/50 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-200 dark:bg-slate-600 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-600 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-slate-200 dark:bg-slate-600 rounded w-1/2"})]})]})},s))})]}),me=({value:s})=>{const a=ce(s,800);return e.jsx("span",{children:a})},g=({children:s,className:a="",delay:i=0})=>e.jsx("div",{className:`
      rounded-2xl
      bg-white dark:bg-slate-800/80
      backdrop-blur-xl
      border border-slate-200 dark:border-slate-700
      shadow-lg shadow-slate-200/50 dark:shadow-black/30
      transition-all duration-300 ease-out
      hover:scale-[1.02] hover:-translate-y-0.5 hover:shadow-xl
      animate-fade-in-up
      ${a}
    `,style:{animationDelay:`${i}ms`},children:s});function je(){var E;const{user:s}=se(),[a,i]=n.useState([]),[d,m]=n.useState(null),[u,f]=n.useState(!0),[c,j]=n.useState(null),[b,R]=n.useState(O()),H=n.useMemo(()=>le(),[]),A=n.useMemo(()=>re(),[]),I=ie(H),y=ne();n.useEffect(()=>{const t=async()=>{try{const[r,o]=await Promise.all([ee(),te()]);r.success&&r.data&&i(r.data),o.success&&o.engine&&m(o.engine)}catch(r){console.error("Failed to fetch:",r)}finally{f(!1)}};t();const l=setInterval(t,3e4);return()=>clearInterval(l)},[]),n.useEffect(()=>{const t=setInterval(()=>R(O()),6e4);return()=>clearInterval(t)},[]),n.useEffect(()=>{const t=async()=>{var r,o,v,h,x;try{const C=await fetch("https://wttr.in/Xi'an?format=j1");if(C.ok){const p=(r=(await C.json()).current_condition)==null?void 0:r[0];p&&j({temp:p.temp_C,desc:((v=(o=p.lang_zh)==null?void 0:o[0])==null?void 0:v.value)||((x=(h=p.weatherDesc)==null?void 0:h[0])==null?void 0:x.value)||"未知",icon:de(p.weatherCode),city:"西安"})}}catch{console.log("天气获取失败")}};t();const l=setInterval(t,30*60*1e3);return()=>clearInterval(l)},[]);const T=a.flatMap(t=>{const l=[],{repo:r,task:o,steps:v,quality:h}=t;return o.createdAt&&l.push({id:`${r.name}-start`,type:"task_start",title:`开始: ${o.name||t.branches.current}`,project:r.name,time:o.createdAt,branch:t.branches.current}),v.items.filter(x=>x.status==="done"&&x.completedAt).forEach(x=>{l.push({id:`${r.name}-step-${x.id}`,type:"task_complete",title:`Step ${x.id}: ${x.name}`,project:r.name,time:x.completedAt,branch:t.branches.current})}),h.ci==="passed"?l.push({id:`${r.name}-ci`,type:"ci_pass",title:"CI 通过",project:r.name,time:h.lastCheck,branch:t.branches.current}):h.ci==="failed"&&l.push({id:`${r.name}-ci`,type:"ci_fail",title:"CI 失败",project:r.name,time:h.lastCheck,branch:t.branches.current}),l}).sort((t,l)=>new Date(l.time).getTime()-new Date(t.time).getTime()).slice(0,8),k={active:a.filter(t=>t.steps.current>0&&t.steps.current<10).length,completed:a.filter(t=>t.steps.items.every(l=>l.status==="done"||l.status==="skipped")).length,failed:a.filter(t=>t.quality.ci==="failed").length,repos:new Set(a.map(t=>t.repo.name)).size},F=t=>({commit:e.jsx(w,{className:"w-4 h-4 text-slate-500"}),pr:e.jsx(w,{className:"w-4 h-4 text-slate-400"}),task_start:e.jsx(W,{className:"w-4 h-4 text-slate-500"}),task_complete:e.jsx(D,{className:"w-4 h-4 text-slate-400"}),ci_pass:e.jsx(D,{className:"w-4 h-4 text-slate-400"}),ci_fail:e.jsx(_,{className:"w-4 h-4 text-slate-500"})})[t]||e.jsx(N,{className:"w-4 h-4 text-slate-400"}),P=t=>{const l=Math.floor((Date.now()-new Date(t).getTime())/6e4);return l<1?"刚刚":l<60?`${l}分钟前`:l<1440?`${Math.floor(l/60)}小时前`:new Date(t).toLocaleDateString("zh-CN",{month:"short",day:"numeric"})};return u?e.jsx("div",{className:"min-h-screen -m-8 -mt-8 p-8",children:e.jsxs("div",{className:"relative space-y-6 p-2",children:[e.jsx(oe,{}),e.jsx("div",{className:"flex flex-wrap gap-3",children:[1,2,3].map(t=>e.jsx("div",{className:"animate-pulse h-9 bg-slate-200 dark:bg-slate-700 rounded-full w-32"},t))}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[1,2,3,4].map(t=>e.jsx($,{},t))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(xe,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{className:"h-40"}),e.jsx($,{className:"h-32"})]})]})]})}):e.jsx("div",{className:"min-h-screen -m-8 -mt-8 p-8",children:e.jsxs("div",{className:"relative space-y-6 p-2",children:[e.jsx(g,{className:"p-6",delay:0,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-[#1d1d1f] dark:text-white mb-2",children:[I.greeting,"，",s==null?void 0:s.name]}),e.jsx("p",{className:"text-[#86868b] dark:text-slate-300",children:I.subtitle})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[d&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-[#86868b] dark:text-slate-300",children:"Engine"}),e.jsxs("p",{className:"text-xl font-mono text-slate-600 dark:text-slate-400",children:["v",d.version]})]}),e.jsx("div",{className:"p-4 bg-gradient-to-br from-slate-500 to-slate-600 rounded-2xl shadow-lg",children:e.jsx(M,{className:"w-10 h-10 text-white"})})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[c&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700/80 rounded-full border border-slate-200 dark:border-slate-600 shadow-sm",children:[c.icon==="sun"&&e.jsx(Q,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),c.icon==="cloud"&&e.jsx(q,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),c.icon==="rain"&&e.jsx(z,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),c.icon==="snow"&&e.jsx(G,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),e.jsxs("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:[c.city," ",e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[c.temp,"°"]})," ",c.desc]})]}),b&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700/80 rounded-full border border-slate-200 dark:border-slate-600 shadow-sm",children:[e.jsx(B,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),e.jsxs("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:["下班倒计时 ",e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[b.hours,"h ",b.minutes,"m"]})]})]}),y!==null&&y>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700/80 rounded-full border border-slate-200 dark:border-slate-600 shadow-sm",children:[e.jsx(U,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),e.jsxs("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:["周末还有 ",e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[y,"天"]})]})]}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700/80 rounded-full border border-slate-200 dark:border-slate-600 shadow-sm",children:[e.jsx(Y,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),e.jsxs("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:[A.text," ",e.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["— ",A.author]})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"进行中",value:k.active,icon:N,iconColor:"text-violet-600 dark:text-violet-400",bgColor:"bg-violet-500/10"},{label:"已完成",value:k.completed,icon:D,iconColor:"text-slate-600 dark:text-slate-400",bgColor:"bg-slate-500/10"},{label:"需关注",value:k.failed,icon:_,iconColor:"text-slate-600 dark:text-slate-400",bgColor:"bg-slate-500/10"},{label:"活跃仓库",value:k.repos,icon:w,iconColor:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-500/10"}].map((t,l)=>e.jsx(g,{className:"p-5",delay:200+l*100,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${t.bgColor} transition-transform group-hover:scale-110`,children:e.jsx(t.icon,{className:`w-5 h-5 ${t.iconColor}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-[#86868b] dark:text-slate-300",children:t.label}),e.jsx("p",{className:"text-2xl font-semibold text-[#1d1d1f] dark:text-white",children:e.jsx(me,{value:t.value})})]})]})},t.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(g,{className:"lg:col-span-2",delay:600,children:[e.jsxs("div",{className:"p-5 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-slate-500 dark:text-slate-400"}),"最近活动"]}),e.jsxs(S,{to:"/engine/dev",className:"text-sm text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200 flex items-center gap-1 transition-colors",children:["查看全部 ",e.jsx(Z,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"p-4 space-y-3",children:T.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-500 dark:text-slate-400",children:[e.jsx(N,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"暂无最近活动"})]}):T.map(t=>e.jsx("div",{className:"p-3 bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-xl transition-all border border-slate-200 dark:border-slate-600",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 p-1.5 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:F(t.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white truncate",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("span",{className:"font-mono bg-slate-200 dark:bg-slate-600 px-2 py-0.5 rounded-md text-slate-600 dark:text-slate-300",children:t.project}),t.branch&&e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 dark:text-slate-400",children:[e.jsx(w,{className:"w-3 h-3"}),t.branch]})]})]}),e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 bg-slate-100 dark:bg-slate-600 px-2 py-1 rounded-md",children:P(t.time)})]})},t.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(g,{className:"p-5",delay:700,children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-slate-500 dark:text-slate-400"}),"进行中"]}),a.filter(t=>t.steps.current>0&&t.steps.current<10).length===0?e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 py-4 text-center",children:"暂无进行中的任务"}):e.jsx("div",{className:"space-y-3",children:a.filter(t=>t.steps.current>0&&t.steps.current<10).slice(0,3).map(t=>e.jsxs(S,{to:"/engine/dev",className:"block p-3 bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-xl transition-all border border-slate-200 dark:border-slate-600 shadow-sm hover:shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white truncate",children:t.task.name||t.branches.current}),e.jsxs("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-300 bg-slate-200 dark:bg-slate-600 px-2 py-0.5 rounded-full",children:[t.steps.current,"/10"]})]}),e.jsx("div",{className:"w-full h-2 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-violet-500 to-purple-400 dark:from-violet-400 dark:to-purple-300 rounded-full transition-all",style:{width:`${t.steps.current/10*100}%`}})})]},t.repo.name))})]}),e.jsxs(g,{className:"p-5",delay:800,children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-white mb-4",children:"快捷入口"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{to:"/engine",icon:M,label:"能力概览",accent:!1},{to:"/engine/tasks",icon:N,label:"任务监控",accent:!0},{to:"/engine/dev",icon:V,label:"开发任务",accent:!0},{to:"/cecilia",icon:X,label:"Cecilia",accent:!1}].map(t=>e.jsxs(S,{to:t.to,className:`flex items-center gap-2.5 p-3 rounded-xl transition-all group border shadow-sm hover:shadow ${t.accent?"bg-violet-50 dark:bg-violet-900/20 hover:bg-violet-100 dark:hover:bg-violet-900/30 border-violet-200 dark:border-violet-700/50":"bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 border-slate-200 dark:border-slate-600"}`,children:[e.jsx(t.icon,{className:`w-4 h-4 transition-colors ${t.accent?"text-violet-500 dark:text-violet-400 group-hover:text-violet-600 dark:group-hover:text-violet-300":"text-slate-500 dark:text-slate-400 group-hover:text-slate-700 dark:group-hover:text-white"}`}),e.jsx("span",{className:`text-sm font-medium transition-colors ${t.accent?"text-violet-700 dark:text-violet-300 group-hover:text-violet-800 dark:group-hover:text-violet-200":"text-slate-700 dark:text-slate-200 group-hover:text-slate-900 dark:group-hover:text-white"}`,children:t.label})]},t.to))})]}),d&&e.jsxs(g,{className:"p-5",delay:900,children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4 text-slate-500 dark:text-slate-400"}),"Engine 能力"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center p-2.5 bg-slate-50 dark:bg-slate-700/50 rounded-lg border border-slate-200 dark:border-slate-600",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Skills"}),e.jsxs("span",{className:"font-semibold text-slate-800 dark:text-white",children:[d.skills.length," 个"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-2.5 bg-slate-50 dark:bg-slate-700/50 rounded-lg border border-slate-200 dark:border-slate-600",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Hooks"}),e.jsxs("span",{className:"font-semibold text-slate-800 dark:text-white",children:[d.hooks.length," 个"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-2.5 bg-slate-50 dark:bg-slate-700/50 rounded-lg border border-slate-200 dark:border-slate-600",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"更新"}),e.jsx("span",{className:"font-semibold text-slate-800 dark:text-white",children:((E=d.changelog[0])==null?void 0:E.date)||"-"})]})]})]})]})]})]})})}export{je as default};

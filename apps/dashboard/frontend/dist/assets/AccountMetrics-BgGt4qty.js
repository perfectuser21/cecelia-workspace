import{j as e,e as u,av as S,aw as A,am as D,a9 as T,r as d,y as R,ax as $,E,H as M,k as U}from"./index-Cs8Vqz41.js";import{a as p}from"./accounts.api-DGdZkcl4.js";import{R as j,T as b,L as f}from"./generateCategoricalChart-DHELD3X2.js";import{L as y,a as N}from"./LineChart-DU5__Ke2.js";import{C as w,X as v,Y as k}from"./YAxis-CDvDUJQR.js";import"./client-DyfwnZmM.js";import"./index-B9ygI19o.js";import"./tiny-invariant-BaFNuDhB.js";const x=({title:r,value:m,change:t,changeLabel:i,icon:a,iconColor:l="text-blue-600",iconBgColor:g="bg-blue-100"})=>{const c=()=>t==null?null:t>0?e.jsx(u,{className:"w-4 h-4"}):t<0?e.jsx(S,{className:"w-4 h-4"}):e.jsx(A,{className:"w-4 h-4"}),h=()=>t==null?"text-gray-500":t>0?"text-green-600":t<0?"text-red-600":"text-gray-500";return e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:r}),e.jsx("div",{className:"flex items-baseline gap-2 mb-2",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:m})}),t!=null&&e.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${h()}`,children:[c(),e.jsxs("span",{children:[t>0?"+":"",t,i&&e.jsx("span",{className:"ml-1 text-gray-500",children:i})]})]})]}),a&&e.jsx("div",{className:`p-3 rounded-lg ${g}`,children:e.jsx(a,{className:`w-6 h-6 ${l}`})})]})})};function X(){const{id:r}=D(),m=T(),[t,i]=d.useState(null),[a,l]=d.useState("month"),[g,c]=d.useState(!0);d.useEffect(()=>{r&&h()},[r,a]);const h=async()=>{if(r)try{c(!0);const s=new Date;let o;a==="week"?o=new Date(s.getTime()-6048e5).toISOString().split("T")[0]:a==="month"&&(o=new Date(s.getTime()-2592e6).toISOString().split("T")[0]);const n=await p.getAccountMetrics(r,o);i(n)}catch(s){console.error("Failed to load metrics:",s)}finally{c(!1)}},C=async()=>{if(r)try{const s=await p.exportAccountData(r,"csv"),o=URL.createObjectURL(s),n=document.createElement("a");n.href=o,n.download=`account-${r}-metrics-${Date.now()}.csv`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o)}catch(s){console.error("Failed to export data:",s),alert("导出失败")}};return g?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m("/accounts"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(R,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.displayName}),e.jsxs("p",{className:"text-gray-500 mt-1",children:[t.platform," - ",t.accountId]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-lg border border-gray-200 p-1",children:[e.jsx("button",{onClick:()=>l("week"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${a==="week"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"近7天"}),e.jsx("button",{onClick:()=>l("month"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${a==="month"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"近30天"}),e.jsx("button",{onClick:()=>l("all"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${a==="all"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"全部"})]}),e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 border border-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"导出数据"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(x,{title:"粉丝总数",value:t.followers.total.toLocaleString(),change:t.followers.delta,changeLabel:"增长",icon:u,iconColor:"text-blue-600",iconBgColor:"bg-blue-100"}),e.jsx(x,{title:"总曝光量",value:t.impressions.total.toLocaleString(),icon:E,iconColor:"text-purple-600",iconBgColor:"bg-purple-100"}),e.jsx(x,{title:"总互动量",value:t.engagement.total.toLocaleString(),icon:M,iconColor:"text-pink-600",iconBgColor:"bg-pink-100"}),e.jsx(x,{title:"平均互动率",value:`${t.engagement.averageRate.toFixed(2)}%`,icon:u,iconColor:"text-green-600",iconBgColor:"bg-green-100"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"粉丝增长趋势"}),e.jsx(j,{width:"100%",height:300,children:e.jsxs(y,{data:t.followers.trend,children:[e.jsx(w,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(v,{dataKey:"date",stroke:"#6b7280"}),e.jsx(k,{stroke:"#6b7280"}),e.jsx(b,{}),e.jsx(f,{}),e.jsx(N,{type:"monotone",dataKey:"count",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},name:"粉丝数"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"互动趋势"}),e.jsx(j,{width:"100%",height:300,children:e.jsxs(y,{data:t.engagement.trend,children:[e.jsx(w,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(v,{dataKey:"date",stroke:"#6b7280"}),e.jsx(k,{stroke:"#6b7280"}),e.jsx(b,{}),e.jsx(f,{}),e.jsx(N,{type:"monotone",dataKey:"count",stroke:"#ec4899",strokeWidth:2,dot:{fill:"#ec4899",r:4},name:"互动量"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"优质内容"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"标题"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"互动量"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"曝光量"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"发布时间"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.content.topPerformingPosts.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline line-clamp-1",children:s.title})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.engagement.toLocaleString()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-600",children:s.impressions.toLocaleString()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),new Date(s.publishedAt).toLocaleDateString("zh-CN")]})})]},s.id))})]})})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"暂无数据"})})}export{X as default};

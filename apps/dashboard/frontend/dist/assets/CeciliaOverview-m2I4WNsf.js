import{a$ as f,R as c,Z as o,j as e,x as y,a9 as v,r as i,_ as j,ay as w,C,$ as k}from"./index-Cs8Vqz41.js";import{f as $,m as T}from"./agents.api-CoMOOMR_.js";const S={Zap:o,RefreshCw:c,Diamond:f};function A({agent:t,onClick:a}){const d=S[t.icon]||o,r=t.status==="planned",x=t.stats.todayRunning>0;return e.jsxs("button",{onClick:a,disabled:r,className:`
        w-full text-left p-5 rounded-xl border transition-all duration-200
        ${r?"bg-slate-800/50 border-slate-700 opacity-60 cursor-not-allowed":`bg-gradient-to-br ${t.gradient.from} ${t.gradient.to} bg-opacity-10
             dark:bg-slate-800 hover:scale-[1.02] hover:shadow-lg ${t.gradient.border}`}
      `,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`
          p-3 rounded-xl
          ${r?"bg-slate-700":`bg-gradient-to-br ${t.gradient.from} ${t.gradient.to}`}
        `,children:e.jsx(d,{className:"w-6 h-6 text-white"})}),!r&&e.jsx(y,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-400 mb-1",children:[t.role," · ",t.codename]}),r?e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-700",children:e.jsx("span",{className:"text-sm text-gray-500",children:"待激活"})}):e.jsx("div",{className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold text-white",children:t.stats.todayTotal}),e.jsx("span",{className:"text-sm text-gray-400 ml-1",children:"今日"})]}),t.stats.todaySuccess>0&&e.jsxs("div",{className:"text-emerald-400 text-sm",children:[t.stats.todaySuccess," 成功"]}),t.stats.todayError>0&&e.jsxs("div",{className:"text-red-400 text-sm",children:[t.stats.todayError," 失败"]})]}),x&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-blue-500/20 rounded-full",children:[e.jsx(c,{className:"w-3 h-3 text-blue-400 animate-spin"}),e.jsx("span",{className:"text-xs text-blue-400",children:"工作中"})]})]})})]})}function R(){const t=v(),[a,d]=i.useState(null),[r,x]=i.useState(!0),[m,h]=i.useState(null),[u,N]=i.useState(null),n=async()=>{try{const s=await $();d(s),h(null),N(new Date)}catch(s){h(s.message)}finally{x(!1)}};i.useEffect(()=>{n();const s=setInterval(n,3e4);return()=>clearInterval(s)},[]);const g=s=>{switch(s){case"success":return e.jsx(k,{className:"w-4 h-4 text-emerald-500"});case"running":return e.jsx(c,{className:"w-4 h-4 text-blue-500 animate-spin"});case"error":return e.jsx(j,{className:"w-4 h-4 text-red-500"});default:return e.jsx(C,{className:"w-4 h-4 text-gray-400"})}},b=s=>new Date(s).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),p=s=>T(s.workflowName);return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(c,{className:"w-8 h-8 text-blue-500 animate-spin"})}):m?e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-xl p-6 text-center",children:[e.jsx(j,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),e.jsxs("p",{className:"text-red-400",children:["加载失败: ",m]}),e.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-red-900/30 text-red-400 rounded-lg hover:bg-red-900/50 transition-colors",children:"重试"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(w,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Cecilia"}),e.jsxs("p",{className:"text-gray-400",children:["Your AI Butler · ",a==null?void 0:a.activeAgents," Agents · 今日 ",a==null?void 0:a.todayTotalTasks," 次任务"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[u&&e.jsx("span",{className:"text-sm text-gray-500",children:u.toLocaleTimeString("zh-CN")}),e.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(c,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:a==null?void 0:a.agents.map(s=>e.jsx(A,{agent:s,onClick:()=>t(`/cecilia/agents/${s.id}`)},s.id))}),e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-700 flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-white",children:"最近任务"}),e.jsx("button",{onClick:()=>t("/cecilia/runs"),className:"text-sm text-blue-400 hover:text-blue-300",children:"查看全部"})]}),a!=null&&a.recentTasks&&a.recentTasks.length>0?e.jsx("div",{className:"divide-y divide-slate-700",children:a.recentTasks.map(s=>{const l=p(s);return e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[g(s.status),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsx("span",{className:`
                            text-xs px-2 py-0.5 rounded-full
                            bg-gradient-to-r ${l.gradient.from} ${l.gradient.to} text-white
                          `,children:l.name}),e.jsx("span",{className:"text-white",children:s.workflowName})]})})]}),e.jsx("span",{className:"text-sm text-gray-500",children:b(s.startedAt)})]},s.id)})}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(o,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"暂无任务"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"通过 N8N 工作流触发 Cecilia 执行任务"})]})]})]})}export{R as default};

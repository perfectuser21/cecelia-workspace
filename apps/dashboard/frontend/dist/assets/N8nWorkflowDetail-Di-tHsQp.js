import{c as o,m as U,l as F,r as c,j as e,b as B,B as Z,Z as y,T as q,A as O}from"./index-BrpX3zYB.js";import{P as V,n as j}from"./n8n-workflows.api-BAn6cw71.js";import{L as X}from"./loader-2-D4NEYREP.js";import{A as N}from"./alert-circle-9zYQafBP.js";import{A as H}from"./arrow-left-Bu1lvJRd.js";import{S as _}from"./server-CN1clXcx.js";import{C as G}from"./cloud-Ivw5HROy.js";import{E as J}from"./external-link-BXwLYa6X.js";import{P as K}from"./play-Bz6oQnNS.js";import{L as Q}from"./layers-J1jEqpGi.js";import{C as Y}from"./calendar-DnpIOUft.js";import{C as f}from"./check-circle-2-7a5kcsXI.js";import{X as k}from"./x-circle-AHNN8mlN.js";import{C as ee}from"./clock-CNhARQel.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=o("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.25V14",key:"re2vv1"}],["path",{d:"M22 16a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z",key:"ame013"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=o("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=o("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);function ye(){var b,p;const{instance:s,id:i}=U(),v=F(),[t,w]=c.useState(null),[r,C]=c.useState(null),[n,g]=c.useState(!0),[m,h]=c.useState(null),[S,L]=c.useState(""),x=async()=>{if(!(!s||!i))try{const[a,l]=await Promise.all([j.getWorkflowDetail(s,i),j.getWorkflowExecutions(s,i,50)]);w(a),C(l),L(new Date().toLocaleTimeString("zh-CN")),h(null)}catch(a){h(a instanceof Error?a.message:"Failed to fetch data")}finally{g(!1)}};c.useEffect(()=>{x();const a=setInterval(x,3e4);return()=>clearInterval(a)},[s,i]);const u=()=>{g(!0),x()},M=a=>{switch(a){case"success":return"text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-400";case"error":case"crashed":return"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400";case"running":case"waiting":return"text-blue-600 bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400";default:return"text-gray-600 bg-gray-100 dark:bg-gray-900/30 dark:text-gray-400"}},T=a=>{switch(a){case"success":return e.jsx(f,{className:"w-4 h-4"});case"error":case"crashed":return e.jsx(k,{className:"w-4 h-4"});case"running":case"waiting":return e.jsx(O,{className:"w-4 h-4 animate-pulse"});default:return e.jsx(N,{className:"w-4 h-4"})}},A=a=>{switch(a){case"success":return"Success";case"error":return"Failed";case"crashed":return"Crashed";case"running":return"Running";case"waiting":return"Waiting";default:return a}},D=a=>{switch(a){case"schedule":return e.jsx(te,{className:"w-4 h-4"});case"webhook":return e.jsx(re,{className:"w-4 h-4"});case"manual":return e.jsx(ae,{className:"w-4 h-4"});default:return e.jsx(y,{className:"w-4 h-4"})}},$=a=>{switch(a){case"schedule":return"Scheduled";case"webhook":return"Webhook";case"manual":return"Manual";default:return"Other"}},E=a=>new Date(a).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),R=a=>new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),I=(a,l)=>{if(!l)return"-";const P=new Date(a).getTime(),z=new Date(l).getTime(),d=Math.round((z-P)/1e3);return d<60?`${d}s`:d<3600?`${Math.floor(d/60)}m ${d%60}s`:`${Math.floor(d/3600)}h ${Math.floor(d%3600/60)}m`};if(n&&!t)return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(X,{className:"w-8 h-8 animate-spin text-blue-500"})});if(m&&!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-96",children:[e.jsx(N,{className:"w-12 h-12 text-red-500 dark:text-red-400 mb-4"}),e.jsx("p",{className:"text-red-600 dark:text-red-400 mb-3",children:m}),e.jsx("button",{onClick:u,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 shadow-lg shadow-blue-500/25",children:"Retry"})]});const W=s==="local"?"http://localhost:5679":"#";return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{onClick:()=>v("/settings/n8n-workflows"),className:"mt-1 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition text-gray-500 dark:text-gray-400",children:e.jsx(H,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(t==null?void 0:t.name)||"Loading..."}),e.jsxs("span",{className:`px-2.5 py-1 rounded-lg text-xs font-medium flex items-center gap-1 ${s==="local"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400"}`,children:[s==="local"?e.jsx(_,{className:"w-3 h-3"}):e.jsx(G,{className:"w-3 h-3"}),s==="local"?"Local":"Cloud"]})]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Updated at ",S]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("a",{href:`${W}/workflow/${i}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 border border-gray-200 dark:border-slate-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-50 dark:hover:bg-slate-700 transition",children:[e.jsx(J,{className:"w-4 h-4"}),"Open in n8n"]}),e.jsxs("button",{onClick:u,disabled:n,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 shadow-lg shadow-blue-500/25",children:[e.jsx(B,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${t!=null&&t.active?"bg-gradient-to-br from-green-500 to-emerald-600 shadow-lg shadow-green-500/25":"bg-gradient-to-br from-gray-400 to-gray-500 shadow-lg shadow-gray-500/25"}`,children:t!=null&&t.active?e.jsx(K,{className:"w-5 h-5 text-white"}):e.jsx(V,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Status"}),e.jsx("div",{className:`text-lg font-bold ${t!=null&&t.active?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400"}`,children:t!=null&&t.active?"Active":"Inactive"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg shadow-purple-500/25",children:D(t==null?void 0:t.triggerType)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Trigger"}),e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:$(t==null?void 0:t.triggerType)}),(t==null?void 0:t.triggerInfo)&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate max-w-[120px]",title:t.triggerInfo,children:t.triggerInfo})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl flex items-center justify-center shadow-lg shadow-orange-500/25",children:e.jsx(Q,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Nodes"}),e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(t==null?void 0:t.nodeCount)||0})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/25",children:e.jsx(Y,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Created"}),e.jsx("div",{className:"text-sm font-bold text-gray-900 dark:text-white",children:t!=null&&t.createdAt?R(t.createdAt):"-"})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2 mb-5",children:[e.jsx(Z,{className:"w-5 h-5"}),"Execution Statistics"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 text-sm mb-1",children:[e.jsx(y,{className:"w-4 h-4"}),"Total"]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(r==null?void 0:r.total)||0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400 text-sm mb-1",children:[e.jsx(f,{className:"w-4 h-4"}),"Success"]}),e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:(r==null?void 0:r.success)||0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400 text-sm mb-1",children:[e.jsx(k,{className:"w-4 h-4"}),"Failed"]}),e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:(r==null?void 0:r.error)||0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600 dark:text-emerald-400 text-sm mb-1",children:[e.jsx(q,{className:"w-4 h-4"}),"Success Rate"]}),e.jsxs("div",{className:`text-2xl font-bold ${((r==null?void 0:r.successRate)||0)>=90?"text-green-600 dark:text-green-400":((r==null?void 0:r.successRate)||0)>=70?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,children:[(r==null?void 0:r.successRate)||0,"%"]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-gray-700 dark:text-gray-300"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Executions"}),e.jsxs("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:["(Last ",((b=r==null?void 0:r.executions)==null?void 0:b.length)||0,")"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Mode"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Started"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Duration"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:(p=r==null?void 0:r.executions)!=null&&p.length?r.executions.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-3",children:e.jsxs("span",{className:"text-sm font-mono text-gray-600 dark:text-gray-300",children:["#",a.id]})}),e.jsx("td",{className:"px-6 py-3",children:e.jsxs("span",{className:`px-2.5 py-1 rounded-lg text-xs font-medium flex items-center gap-1 w-fit ${M(a.status)}`,children:[T(a.status),A(a.status)]})}),e.jsx("td",{className:"px-6 py-3 text-sm text-gray-500 dark:text-gray-400",children:a.mode}),e.jsx("td",{className:"px-6 py-3 text-sm text-gray-500 dark:text-gray-400",children:E(a.startedAt)}),e.jsx("td",{className:"px-6 py-3 text-sm text-gray-500 dark:text-gray-400 font-mono",children:I(a.startedAt,a.stoppedAt)})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500 dark:text-gray-400",children:"No executions yet"})})})]})})]}),(t==null?void 0:t.description)&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Description"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.description})]})]})}export{ye as default};

import{c as P,r as i,j as e,R as Q,l as I,S as z,A as f,L as N,C as q,n as B,Z as T}from"./index-BUrbYsph.js";import{g as Y}from"./dev-tracker.api-w6q3zFSY.js";import{g as F}from"./engine.api-BjsWQDog.js";import{C as U}from"./cloud-Nc-4yqT3.js";import{C as Z,a as J,P as V,Q as X}from"./quote-BsL3_cb7.js";import{T as K}from"./timer-D0vrh9fr.js";import{C as y}from"./check-circle-2-CtSB_Rsz.js";import{A}from"./alert-circle-Dy2pvf21.js";import{G as k}from"./client-BFa2vKjc.js";import{C as ee}from"./clock-WW8L8Vn1.js";import{T as te}from"./terminal-8DKbdei2.js";import"./index-B9ygI19o.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=P("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),ae=()=>({user:{name:"Developer"}}),E=[{text:"把每一件简单的事做好就是不简单。",author:"稻盛和夫"},{text:"不要等待机会，而要创造机会。",author:"林肯"},{text:"成功不是终点，失败也不是终结，唯有勇气才是永恒。",author:"丘吉尔"},{text:"今天的努力是明天的礼物。",author:"佚名"},{text:"专注于当下，未来自然清晰。",author:"佚名"},{text:"Code is poetry.",author:"WordPress"},{text:"Talk is cheap. Show me the code.",author:"Linus Torvalds"},{text:"代码写得好，BUG 少不了。",author:"程序员"},{text:"今天的 TODO，就是明天的 DONE。",author:"乐观开发者"},{text:"Stay hungry, stay foolish.",author:"Steve Jobs"}],re={"01-01":{name:"元旦",greeting:"新年快乐"},"02-14":{name:"情人节",greeting:"愿你被爱包围"},"05-01":{name:"劳动节",greeting:"休息一下吧"},"10-01":{name:"国庆节",greeting:"祖国生日快乐"},"12-25":{name:"圣诞节",greeting:"Merry Christmas"}},le=()=>{const s=new Date,a=`${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`;return re[a]||null},ne=()=>{const s=new Date,a=s.getFullYear()*1e4+(s.getMonth()+1)*100+s.getDate();return E[a%E.length]},M=()=>{const s=new Date,a=s.getDay();if(a===0||a===6)return null;const x=s.getHours()+s.getMinutes()/60;if(x<8.5||x>=18)return null;const c=new Date(s);c.setHours(18,0,0,0);const g=c.getTime()-s.getTime();return{hours:Math.floor(g/36e5),minutes:Math.floor(g%36e5/6e4)}},oe=()=>{const s=new Date().getDay();return s===0||s===6?null:6-s},ie=s=>{const a=parseInt(s);return a>=600&&a<700?"snow":a>=200&&a<600?"rain":a===800?"sun":"cloud"},ce=s=>{const a=new Date().getHours(),x=new Date().getDay();return s?{greeting:`${s.name}快乐`,subtitle:s.greeting}:x===0||x===6?{greeting:"周末好",subtitle:"享受你的时光"}:a<9?{greeting:"早上好",subtitle:"新的一天，新的可能"}:a<12?{greeting:"上午好",subtitle:"保持专注，效率拉满"}:a<14?{greeting:"中午好",subtitle:"记得吃饭休息"}:a<18?{greeting:"下午好",subtitle:"继续加油"}:a<21?{greeting:"晚上好",subtitle:"辛苦了，注意休息"}:{greeting:"夜深了",subtitle:"早点休息吧"}},h=({children:s,className:a=""})=>e.jsx("div",{className:`
    rounded-2xl
    bg-white dark:bg-slate-800/80
    backdrop-blur-xl
    border border-slate-200 dark:border-slate-700
    shadow-lg shadow-slate-200/50 dark:shadow-black/30
    ${a}
  `,children:s});function Ne(){var $;const{user:s}=ae(),[a,x]=i.useState([]),[c,g]=i.useState(null),[_,W]=i.useState(!0),[d,L]=i.useState(null),[j,R]=i.useState(M()),O=i.useMemo(()=>le(),[]),C=i.useMemo(()=>ne(),[]),D=ce(O),w=oe();i.useEffect(()=>{const t=async()=>{try{const[l,n]=await Promise.all([Y(),F()]);l.success&&l.data&&x(l.data),n.success&&n.engine&&g(n.engine)}catch(l){console.error("Failed to fetch:",l)}finally{W(!1)}};t();const r=setInterval(t,3e4);return()=>clearInterval(r)},[]),i.useEffect(()=>{const t=setInterval(()=>R(M()),6e4);return()=>clearInterval(t)},[]),i.useEffect(()=>{const t=async()=>{var l,n,b,m,o;try{const v=await fetch("https://wttr.in/Xi'an?format=j1");if(v.ok){const u=(l=(await v.json()).current_condition)==null?void 0:l[0];u&&L({temp:u.temp_C,desc:((b=(n=u.lang_zh)==null?void 0:n[0])==null?void 0:b.value)||((o=(m=u.weatherDesc)==null?void 0:m[0])==null?void 0:o.value)||"未知",icon:ie(u.weatherCode),city:"西安"})}}catch{console.log("天气获取失败")}};t();const r=setInterval(t,30*60*1e3);return()=>clearInterval(r)},[]);const S=a.flatMap(t=>{const r=[],{repo:l,task:n,steps:b,quality:m}=t;return n.createdAt&&r.push({id:`${l.name}-start`,type:"task_start",title:`开始: ${n.name||t.branches.current}`,project:l.name,time:n.createdAt,branch:t.branches.current}),b.items.filter(o=>o.status==="done"&&o.completedAt).forEach(o=>{r.push({id:`${l.name}-step-${o.id}`,type:"task_complete",title:`Step ${o.id}: ${o.name}`,project:l.name,time:o.completedAt,branch:t.branches.current})}),m.ci==="passed"?r.push({id:`${l.name}-ci`,type:"ci_pass",title:"CI 通过",project:l.name,time:m.lastCheck,branch:t.branches.current}):m.ci==="failed"&&r.push({id:`${l.name}-ci`,type:"ci_fail",title:"CI 失败",project:l.name,time:m.lastCheck,branch:t.branches.current}),r}).sort((t,r)=>new Date(r.time).getTime()-new Date(t.time).getTime()).slice(0,8),p={active:a.filter(t=>t.steps.current>0&&t.steps.current<10).length,completed:a.filter(t=>t.steps.items.every(r=>r.status==="done"||r.status==="skipped")).length,failed:a.filter(t=>t.quality.ci==="failed").length,repos:new Set(a.map(t=>t.repo.name)).size},H=t=>({commit:e.jsx(k,{className:"w-4 h-4 text-slate-500"}),pr:e.jsx(k,{className:"w-4 h-4 text-slate-400"}),task_start:e.jsx(T,{className:"w-4 h-4 text-slate-500"}),task_complete:e.jsx(y,{className:"w-4 h-4 text-slate-400"}),ci_pass:e.jsx(y,{className:"w-4 h-4 text-slate-400"}),ci_fail:e.jsx(A,{className:"w-4 h-4 text-slate-500"})})[t]||e.jsx(f,{className:"w-4 h-4 text-slate-400"}),G=t=>{const r=Math.floor((Date.now()-new Date(t).getTime())/6e4);return r<1?"刚刚":r<60?`${r}分钟前`:r<1440?`${Math.floor(r/60)}小时前`:new Date(t).toLocaleDateString("zh-CN",{month:"short",day:"numeric"})};return _?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Q,{className:"w-8 h-8 text-violet-600 animate-spin"})}):e.jsx("div",{className:"min-h-screen -m-8 -mt-8 p-8",children:e.jsxs("div",{className:"relative space-y-6 p-2",children:[e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-[#1d1d1f] dark:text-white mb-2",children:[D.greeting,"，",s==null?void 0:s.name]}),e.jsx("p",{className:"text-[#86868b] dark:text-slate-300",children:D.subtitle})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[c&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-[#86868b] dark:text-slate-300",children:"Engine"}),e.jsxs("p",{className:"text-xl font-mono text-slate-600 dark:text-slate-400",children:["v",c.version]})]}),e.jsx("div",{className:"p-4 bg-gradient-to-br from-slate-500 to-slate-600 rounded-2xl shadow-lg",children:e.jsx(I,{className:"w-10 h-10 text-white"})})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[d&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700/80 rounded-full border border-slate-200 dark:border-slate-600 shadow-sm",children:[d.icon==="sun"&&e.jsx(z,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),d.icon==="cloud"&&e.jsx(U,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),d.icon==="rain"&&e.jsx(Z,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),d.icon==="snow"&&e.jsx(J,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),e.jsxs("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:[d.city," ",e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[d.temp,"°"]})," ",d.desc]})]}),j&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700/80 rounded-full border border-slate-200 dark:border-slate-600 shadow-sm",children:[e.jsx(K,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),e.jsxs("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:["下班倒计时 ",e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[j.hours,"h ",j.minutes,"m"]})]})]}),w!==null&&w>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700/80 rounded-full border border-slate-200 dark:border-slate-600 shadow-sm",children:[e.jsx(V,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),e.jsxs("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:["周末还有 ",e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[w,"天"]})]})]}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700/80 rounded-full border border-slate-200 dark:border-slate-600 shadow-sm",children:[e.jsx(X,{className:"w-4 h-4 text-slate-500 dark:text-slate-300"}),e.jsxs("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:[C.text," ",e.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["— ",C.author]})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"进行中",value:p.active,icon:f,iconColor:"text-violet-600 dark:text-violet-400",bgColor:"bg-violet-500/10"},{label:"已完成",value:p.completed,icon:y,iconColor:"text-slate-600 dark:text-slate-400",bgColor:"bg-slate-500/10"},{label:"需关注",value:p.failed,icon:A,iconColor:"text-slate-600 dark:text-slate-400",bgColor:"bg-slate-500/10"},{label:"活跃仓库",value:p.repos,icon:k,iconColor:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-500/10"}].map(t=>e.jsx(h,{className:"p-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${t.bgColor}`,children:e.jsx(t.icon,{className:`w-5 h-5 ${t.iconColor}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-[#86868b] dark:text-slate-300",children:t.label}),e.jsx("p",{className:"text-2xl font-semibold text-[#1d1d1f] dark:text-white",children:t.value})]})]})},t.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(h,{className:"lg:col-span-2",children:[e.jsxs("div",{className:"p-5 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-slate-500 dark:text-slate-400"}),"最近活动"]}),e.jsxs(N,{to:"/engine/dev",className:"text-sm text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200 flex items-center gap-1 transition-colors",children:["查看全部 ",e.jsx(se,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"p-4 space-y-3",children:S.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-500 dark:text-slate-400",children:[e.jsx(f,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"暂无最近活动"})]}):S.map(t=>e.jsx("div",{className:"p-3 bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-xl transition-all border border-slate-200 dark:border-slate-600",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 p-1.5 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:H(t.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white truncate",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("span",{className:"font-mono bg-slate-200 dark:bg-slate-600 px-2 py-0.5 rounded-md text-slate-600 dark:text-slate-300",children:t.project}),t.branch&&e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 dark:text-slate-400",children:[e.jsx(k,{className:"w-3 h-3"}),t.branch]})]})]}),e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 bg-slate-100 dark:bg-slate-600 px-2 py-1 rounded-md",children:G(t.time)})]})},t.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(h,{className:"p-5",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-slate-500 dark:text-slate-400"}),"进行中"]}),a.filter(t=>t.steps.current>0&&t.steps.current<10).length===0?e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 py-4 text-center",children:"暂无进行中的任务"}):e.jsx("div",{className:"space-y-3",children:a.filter(t=>t.steps.current>0&&t.steps.current<10).slice(0,3).map(t=>e.jsxs(N,{to:"/engine/dev",className:"block p-3 bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-xl transition-all border border-slate-200 dark:border-slate-600 shadow-sm hover:shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white truncate",children:t.task.name||t.branches.current}),e.jsxs("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-300 bg-slate-200 dark:bg-slate-600 px-2 py-0.5 rounded-full",children:[t.steps.current,"/10"]})]}),e.jsx("div",{className:"w-full h-2 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-violet-500 to-purple-400 dark:from-violet-400 dark:to-purple-300 rounded-full transition-all",style:{width:`${t.steps.current/10*100}%`}})})]},t.repo.name))})]}),e.jsxs(h,{className:"p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-white mb-4",children:"快捷入口"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{to:"/engine",icon:I,label:"能力概览",accent:!1},{to:"/engine/tasks",icon:f,label:"任务监控",accent:!0},{to:"/engine/dev",icon:q,label:"开发任务",accent:!0},{to:"/cecilia",icon:B,label:"Cecilia",accent:!1}].map(t=>e.jsxs(N,{to:t.to,className:`flex items-center gap-2.5 p-3 rounded-xl transition-all group border shadow-sm hover:shadow ${t.accent?"bg-violet-50 dark:bg-violet-900/20 hover:bg-violet-100 dark:hover:bg-violet-900/30 border-violet-200 dark:border-violet-700/50":"bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 border-slate-200 dark:border-slate-600"}`,children:[e.jsx(t.icon,{className:`w-4 h-4 transition-colors ${t.accent?"text-violet-500 dark:text-violet-400 group-hover:text-violet-600 dark:group-hover:text-violet-300":"text-slate-500 dark:text-slate-400 group-hover:text-slate-700 dark:group-hover:text-white"}`}),e.jsx("span",{className:`text-sm font-medium transition-colors ${t.accent?"text-violet-700 dark:text-violet-300 group-hover:text-violet-800 dark:group-hover:text-violet-200":"text-slate-700 dark:text-slate-200 group-hover:text-slate-900 dark:group-hover:text-white"}`,children:t.label})]},t.to))})]}),c&&e.jsxs(h,{className:"p-5",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-slate-500 dark:text-slate-400"}),"Engine 能力"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center p-2.5 bg-slate-50 dark:bg-slate-700/50 rounded-lg border border-slate-200 dark:border-slate-600",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Skills"}),e.jsxs("span",{className:"font-semibold text-slate-800 dark:text-white",children:[c.skills.length," 个"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-2.5 bg-slate-50 dark:bg-slate-700/50 rounded-lg border border-slate-200 dark:border-slate-600",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Hooks"}),e.jsxs("span",{className:"font-semibold text-slate-800 dark:text-white",children:[c.hooks.length," 个"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-2.5 bg-slate-50 dark:bg-slate-700/50 rounded-lg border border-slate-200 dark:border-slate-600",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"更新"}),e.jsx("span",{className:"font-semibold text-slate-800 dark:text-white",children:(($=c.changelog[0])==null?void 0:$.date)||"-"})]})]})]})]})]})]})})}export{Ne as default};

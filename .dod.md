---
id: dod-trd-template-engine
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

# DoD - TRD 模板引擎（KR 上下文感知）

QA: docs/QA-DECISION.md

## 验收标准

### 功能验收 - generateTrdFromGoalKR
- [ ] 函数接受 {title, description, kr, project, milestones} 参数
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 返回 TRD markdown 包含 8 个节（概述、系统架构、数据模型、PRD 拆解、接口设计、技术决策、验收标准、附录）
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] TRD 包含 KR 上下文（kr.title, kr.progress, kr.priority）
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] milestones 生成 PRD 依赖图和清单表格
      Test: apps/core/src/brain/__tests__/templates.test.js

### 功能验收 - API 端点
- [ ] POST /api/brain/generate/trd-from-kr 返回 {success: true, data: {trd_content, metadata}}
      Test: apps/core/src/brain/__tests__/templates.test.js

### 回归验收
- [ ] 现有 generateTrdFromGoal() 测试全部通过
      Test: manual:vitest run
- [ ] validateTrd() 验证新生成的 TRD 返回 valid: true
      Test: apps/core/src/brain/__tests__/templates.test.js

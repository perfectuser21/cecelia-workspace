---
id: dod-kr2-prd-trd-validation
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

# DoD - PRD/TRD 验证与标准化增强

QA: docs/QA-DECISION.md

## 验收标准

### validatePrd 函数
- [ ] 对缺少"需求来源"的内容返回 valid: false + error
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 对缺少"功能描述"的内容返回 valid: false + error
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 对缺少"成功标准"的内容返回 valid: false + error
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 对缺少"非目标"返回 warning（不是 error）
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 对 renderPrd() 输出返回 valid: true
      Test: apps/core/src/brain/__tests__/templates.test.js

### validateTrd 函数
- [ ] 对缺少必需 section 返回 error
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 对 renderTrd() 输出返回 valid: true
      Test: apps/core/src/brain/__tests__/templates.test.js

### API 端点
- [ ] POST /api/brain/validate/prd → 200 + { valid, errors, warnings }
      Test: manual curl
- [ ] POST /api/brain/validate/trd → 200 + { valid, errors, warnings }
      Test: manual curl
- [ ] 缺少 content → 400
      Test: manual curl

### Planner 集成
- [ ] generateTaskPRD() 日志输出 [PRD-VALIDATE]
      Test: log inspection

### 回归
- [ ] 现有 templates.test.js 全部通过
- [ ] 现有 planner 测试全部通过

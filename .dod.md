# DoD: 可观测性 Dashboard

## 验收标准

### 1. API 层
- [ ] `src/api/observability.api.ts` 文件已创建
- [ ] 定义了所有 TypeScript 接口（RunEvent, ActiveRun, FailureStats, StuckRun, Artifact）
- [ ] 导出了 observabilityApi 对象，包含 7 个 API 函数
- [ ] 所有 API 调用使用 apiClient
- [ ] TypeScript 类型检查通过

### 2. 组件实现
- [ ] `src/components/observability/ActiveRunsPanel.tsx` 已创建
  - 显示活跃运行列表
  - 支持点击选中
  - 5 秒自动刷新
- [ ] `src/components/observability/ExecutionTraceViewer.tsx` 已创建
  - 展示层级树（L0→L1→L2→L3→L4）
  - 显示 status badge
  - 显示执行时长
- [ ] `src/components/observability/FailureAnalysisChart.tsx` 已创建
  - 使用 recharts 柱状图
  - 按 reason_kind 着色
- [ ] `src/components/observability/StuckDetectionPanel.tsx` 已创建
  - 红色告警样式
  - 显示卡住时长

### 3. 主页面
- [ ] `src/pages/ObservabilityDashboard.tsx` 已创建
- [ ] 4 区域布局（指标卡片 + 左右分栏 + 底部）
- [ ] 集成所有组件
- [ ] 实时数据刷新（5 秒轮询）
- [ ] 加载/错误状态处理

### 4. 路由集成
- [ ] 在 `src/config/navigation.config.ts` 添加导航项
- [ ] 路由路径：`/observability`
- [ ] 图标：Activity（lucide-react）

### 5. 功能验证
- [ ] 能看到所有活跃运行
- [ ] 点击运行能查看执行追踪
- [ ] Top 10 失败原因图表正常显示
- [ ] Stuck 检测正常显示
- [ ] 数据自动刷新

### 6. 代码质量
- [ ] TypeScript 编译通过（无错误）
- [ ] 组件符合现有代码风格
- [ ] 使用 Tailwind CSS
- [ ] 响应式布局

## 测试

### 单元测试
- [ ] ActiveRunsPanel 组件测试
- [ ] ExecutionTraceViewer 组件测试
- [ ] API 调用 mock 测试

### 集成测试
- [ ] Dashboard 页面渲染测试
- [ ] 数据刷新功能测试

### E2E 测试（可选）
- [ ] 从导航菜单进入 Observability 页面
- [ ] 查看活跃运行详情
- [ ] 查看失败分析图表

## 产物清单

- [ ] `apps/dashboard/src/api/observability.api.ts`
- [ ] `apps/dashboard/src/components/observability/ActiveRunsPanel.tsx`
- [ ] `apps/dashboard/src/components/observability/ExecutionTraceViewer.tsx`
- [ ] `apps/dashboard/src/components/observability/FailureAnalysisChart.tsx`
- [ ] `apps/dashboard/src/components/observability/StuckDetectionPanel.tsx`
- [ ] `apps/dashboard/src/pages/ObservabilityDashboard.tsx`
- [ ] `apps/dashboard/src/config/navigation.config.ts` (修改)

## 非功能需求

- [ ] 初次加载 < 2 秒
- [ ] TypeScript 严格模式通过
- [ ] 无 console.error
- [ ] 无未使用的 import

---
id: dod-trd-template-engine-kr
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

# DoD - TRD 模板引擎（KR 上下文感知）

QA: docs/QA-DECISION.md

## 验收标准

### 功能验收 - generateTrdFromGoalKR
- [ ] 全参数调用返回包含 `KR:` 来源信息的 TRD markdown
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 生成的 TRD 通过 validateTrd() 返回 valid: true
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] milestones 映射为实施计划中的有序任务列表
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 无 KR 参数时仍包含 5 个必需 TRD 节
      Test: apps/core/src/brain/__tests__/templates.test.js

### 功能验收 - 路由增强
- [ ] POST /api/brain/generate/trd 接受 kr + project 参数返回 success: true
      Test: manual:curl

### 回归验收
- [ ] 现有 templates.test.js 测试全部通过
      Test: manual:vitest run

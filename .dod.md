---
id: dod-trd-template-engine-kr
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

# DoD - TRD 模板引擎（KR 上下文感知）

QA: docs/QA-DECISION.md

## 验收标准

### 功能验收
- [ ] generateTrdFromGoalKR({ title: 'Test' }) 返回包含 frontmatter 的 TRD markdown，validateTrd() 返回 valid: true
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 传入 kr: { title: 'KR2', progress: 50, priority: 'P1' } 时，TRD 技术背景章节包含 "KR: KR2 (progress: 50%, priority: P1)"
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] 传入 project: { name: 'test', repo_path: '/home/xx/dev/test' } 时，TRD 包含 "Project: /home/xx/dev/test"
      Test: apps/core/src/brain/__tests__/templates.test.js
- [ ] POST /api/brain/generate/trd-from-kr 传入 { title: 'Test' } 返回 HTTP 200，body 含 success: true
      Test: manual:curl POST localhost:5212/api/brain/generate/trd-from-kr

### 测试验收
- [ ] 现有测试全部通过
      Test: manual:vitest run

---
id: dod-trd-template-engine-kr
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

# DoD - TRD 模板引擎 KR 上下文增强

## 验收清单

- [ ] `generateTrdFromGoalKR({title, description, kr, project})` 函数存在于 templates.js
      Test: 单元测试调用函数，验证返回 string 类型
- [ ] 返回的 TRD 包含 YAML frontmatter（id, version, created, updated, changelog）
      Test: 解析返回值，验证 frontmatter 字段
- [ ] 技术背景章节包含 KR 来源信息（标题、进度、优先级）
      Test: 传入 kr 对象，验证输出包含 kr.title 和 kr.progress
- [ ] validateTrd() 对生成的 TRD 返回 valid: true
      Test: generateTrdFromGoalKR → validateTrd，验证 valid === true
- [ ] POST /api/brain/generate/trd-from-kr 返回 200 且含 TRD 内容
      Test: 集成测试或手动 curl 验证
- [ ] 无 KR 时退化为基本 TRD（不报错）
      Test: 不传 kr 参数，验证函数正常返回
- [ ] 函数已在 templates.js 中导出
      Test: import { generateTrdFromGoalKR } 不报错

## QA 决策引用

参考 docs/QA-DECISION.md

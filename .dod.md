---
id: dod-phase5-plan-commit
version: 1.0.0
created: 2026-01-30
---

# DoD: Phase 5.3 - Plan Commit & Loop Verification

QA: docs/QA-DECISION.md (NO_RCI)

## 验收清单

### 5.3a: PlanTask 结构升级
- [x] PlanTask 接口添加 why 字段
- [x] PlanTask 接口添加 expected_evidence 字段
- [x] PlanTask 接口添加 source_refs 字段
- [x] generatePlan() 填充新字段

### 5.3b: Plan Commit 端点
- [x] POST /api/system/plan/:planId/commit 实现
- [x] 落库 P0 任务到 tasks 表
- [x] 返回 committed_tasks 列表
- [x] 支持 limit 参数

### 5.3c: Plan Loop 验收脚本
- [x] scripts/verify-plan-loop.sh 创建
- [x] 验证 tasks 有 why + expected_evidence
- [x] 验证 commit 后 tasks 表有记录
- [x] 输出 PASS/FAIL

### 测试
- [x] 生成计划包含 why/evidence (17/17 tests pass)
- [x] commit 端点落库成功
- [x] verify-plan-loop.sh PASS

# DoD: TaskDatabase 容错性修复

## 功能完成标准

### 1. 核心数据加载
- [x] tasks/goals/projects API 必须成功
- [x] 任一核心 API 失败时显示错误页面
- **Test**: 模拟核心 API 500 错误，验证显示 error 状态

### 2. Brain 数据容错
- [x] quarantine API 失败时设置空数组
- [x] focus API 失败时设置 null
- [x] Brain API 失败不影响页面渲染
- **Test**: 停止 Brain 服务，验证页面仍显示任务数据

### 3. 页面功能完整性
- [x] Table 视图正常显示
- [x] Board 视图正常显示
- [x] 拖拽功能正常
- [x] 内联编辑功能正常
- **Test**: Brain 挂掉时，所有 UI 交互仍可用

## 代码质量

### 4. 代码规范
- [x] fetchAll 函数拆分为核心 + 可选两部分
- [x] Brain API 使用独立 try-catch
- [x] 状态设置逻辑清晰
- **Test**: Code review 通过

### 5. 构建测试
- [x] `npm run build` 通过
- [x] TypeScript 类型检查通过
- [x] 无 console 错误
- **Test**: 本地构建无错误

## RCI (Regression Contract Interface)

### TaskDatabase.fetchAll()
```typescript
// Input: 无参数
// Output: 设置 React state (tasks/goals/projects/quarantine/focus/error/loading)
// Contract:
//   - 核心 API 失败 → error 有值，loading = false
//   - Brain API 失败 → quarantine = [], focus = null，不设置 error
//   - 全部成功 → 所有数据填充，error = null
```

## 交付清单

- [x] .prd.md - 需求文档
- [x] .dod.md - 本文件
- [x] TaskDatabase.tsx 修改
- [x] quality-summary.json (Step 7 生成)
- [x] PR 描述包含测试场景

# DoD - Planner Agent

QA: docs/QA-DECISION.md

## 验收标准

### 功能验收
- [ ] `planNextTask()` 能选出最该推进的 KR → Project → Task
      Test: tests/brain/planner.test.js
- [ ] 没有 queued task 时，planner 返回 null
      Test: tests/brain/planner.test.js
- [ ] tick 集成 planner：queued=0 时自动触发规划
      Test: tests/brain/planner.test.js
- [ ] `POST /api/brain/plan` 接受输入，创建正确层级记录
      Test: tests/brain/planner.test.js
- [ ] `GET /api/brain/plan/status` 返回当前规划状态
      Test: tests/brain/planner.test.js
- [ ] Project 表有 repo_path/prd_content/scope 字段
      Test: manual:检查 migration
- [ ] project_kr_links 表创建成功
      Test: manual:检查 migration
- [ ] 五条硬约束在代码中强制执行
      Test: tests/brain/planner.test.js

### 测试验收
- [ ] 所有新增测试通过
      Test: tests/brain/planner.test.js
